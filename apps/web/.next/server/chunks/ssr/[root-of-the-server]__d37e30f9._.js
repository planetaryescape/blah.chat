module.exports=[367303,a=>{"use strict";let b=(0,a.i(366705).default)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]);a.s(["Maximize2",()=>b],367303)},957544,a=>{"use strict";let b=(0,a.i(366705).default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);a.s(["Globe",()=>b],957544)},651197,a=>{"use strict";var b=a.i(648615),c=a.i(525662),d=a.i(366705);let e=(0,d.default)("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]]);var f=a.i(954439),g=a.i(957544),h=a.i(651386),i=a.i(639439),i=i;let j=(0,d.default)("wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]);var k=a.i(469110),l=a.i(711106);function m(a){let b=(0,l.getModelConfig)(a);return b?b.capabilities.includes("vision")?f.Eye:b.capabilities.includes("thinking")||b.capabilities.includes("extended-thinking")?h.Sparkles:k.Zap:h.Sparkles}function n(a){return({openai:h.Sparkles,anthropic:k.Zap,google:i.default,xai:c.Brain,perplexity:g.Globe,groq:e,cerebras:e,minimax:b.Bot,deepseek:c.Brain,kimi:b.Bot,zai:c.Brain,meta:b.Bot,mistral:j,alibaba:b.Bot,zhipu:b.Bot})[a]||h.Sparkles}a.s(["getModelIcon",()=>m,"getProviderIcon",()=>n],651197)},105530,a=>{"use strict";let b=(0,a.i(366705).default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);a.s(["Square",()=>b],105530)},334432,(a,b,c)=>{var d=/[\\\/\-_+.# \t"@\[\(\{&]/,e=/[\\\/\-_+.# \t"@\[\(\{&]/g;b.exports=function(a,b){return function a(b,c,f,g,h,i){if(i===c.length)return h===b.length?1:.99;for(var j,k,l,m=g.charAt(i),n=f.indexOf(m,h),o=0;n>=0;)(j=a(b,c,f,g,n+1,i+1))>o&&(n===h?j*=1:d.test(b.charAt(n-1))?(j*=.9,(l=b.slice(h,n-1).match(e))&&h>0&&(j*=Math.pow(.999,l.length))):(d.test(b.slice(h,n-1))?j*=0:j*=.3,h>0&&(j*=Math.pow(.999,n-h))),b.charAt(n)!==c.charAt(i)&&(j*=.9999)),j<.1&&f.charAt(n-1)===g.charAt(i+1)&&f.charAt(n-1)!==g.charAt(i)&&.1*(k=a(b,c,f,g,n+1,i+2))>j&&(j=.1*k),j>o&&(o=j),n=f.indexOf(m,n+1);return o}(a,b,a.toLowerCase(),b.toLowerCase(),0,0)}},23480,a=>{"use strict";var b,c=a.i(367146),d=a.i(537500),e=a.i(572521),f=a.i(626468),g=a.i(550481),h=a.i(588808),i=a.i(950437),j=a.i(612426),k=a.i(621930),l=a.i(506122),m=a.i(346770),n="HoverCard",[o,p]=(0,f.createContextScope)(n,[i.createPopperScope]),q=(0,i.createPopperScope)(),[r,s]=o(n),t=a=>{let{__scopeHoverCard:b,children:e,open:f,defaultOpen:h,onOpenChange:j,openDelay:k=700,closeDelay:l=300}=a,m=q(b),o=d.useRef(0),p=d.useRef(0),s=d.useRef(!1),t=d.useRef(!1),[u,v]=(0,g.useControllableState)({prop:f,defaultProp:h??!1,onChange:j,caller:n}),w=d.useCallback(()=>{clearTimeout(p.current),o.current=window.setTimeout(()=>v(!0),k)},[k,v]),x=d.useCallback(()=>{clearTimeout(o.current),s.current||t.current||(p.current=window.setTimeout(()=>v(!1),l))},[l,v]),y=d.useCallback(()=>v(!1),[v]);return d.useEffect(()=>()=>{clearTimeout(o.current),clearTimeout(p.current)},[]),(0,c.jsx)(r,{scope:b,open:u,onOpenChange:v,onOpen:w,onClose:x,onDismiss:y,hasSelectionRef:s,isPointerDownOnContentRef:t,children:(0,c.jsx)(i.Root,{...m,children:e})})};t.displayName=n;var u="HoverCardTrigger",v=d.forwardRef((a,b)=>{let{__scopeHoverCard:d,...f}=a,g=s(u,d),h=q(d);return(0,c.jsx)(i.Anchor,{asChild:!0,...h,children:(0,c.jsx)(l.Primitive.a,{"data-state":g.open?"open":"closed",...f,ref:b,onPointerEnter:(0,e.composeEventHandlers)(a.onPointerEnter,D(g.onOpen)),onPointerLeave:(0,e.composeEventHandlers)(a.onPointerLeave,D(g.onClose)),onFocus:(0,e.composeEventHandlers)(a.onFocus,g.onOpen),onBlur:(0,e.composeEventHandlers)(a.onBlur,g.onClose),onTouchStart:(0,e.composeEventHandlers)(a.onTouchStart,a=>a.preventDefault())})})});v.displayName=u;var w="HoverCardPortal",[x,y]=o(w,{forceMount:void 0}),z=a=>{let{__scopeHoverCard:b,forceMount:d,children:e,container:f}=a,g=s(w,b);return(0,c.jsx)(x,{scope:b,forceMount:d,children:(0,c.jsx)(k.Presence,{present:d||g.open,children:(0,c.jsx)(j.Portal,{asChild:!0,container:f,children:e})})})};z.displayName=w;var A="HoverCardContent",B=d.forwardRef((a,b)=>{let d=y(A,a.__scopeHoverCard),{forceMount:f=d.forceMount,...g}=a,h=s(A,a.__scopeHoverCard);return(0,c.jsx)(k.Presence,{present:f||h.open,children:(0,c.jsx)(C,{"data-state":h.open?"open":"closed",...g,onPointerEnter:(0,e.composeEventHandlers)(a.onPointerEnter,D(h.onOpen)),onPointerLeave:(0,e.composeEventHandlers)(a.onPointerLeave,D(h.onClose)),ref:b})})});B.displayName=A;var C=d.forwardRef((a,f)=>{let{__scopeHoverCard:g,onEscapeKeyDown:j,onPointerDownOutside:k,onFocusOutside:l,onInteractOutside:n,...o}=a,p=s(A,g),r=q(g),t=d.useRef(null),u=(0,h.useComposedRefs)(f,t),[v,w]=d.useState(!1);return d.useEffect(()=>{if(v){let a=document.body;return b=a.style.userSelect||a.style.webkitUserSelect,a.style.userSelect="none",a.style.webkitUserSelect="none",()=>{a.style.userSelect=b,a.style.webkitUserSelect=b}}},[v]),d.useEffect(()=>{if(t.current){let a=()=>{w(!1),p.isPointerDownOnContentRef.current=!1,setTimeout(()=>{document.getSelection()?.toString()!==""&&(p.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",a),()=>{document.removeEventListener("pointerup",a),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!1}}},[p.isPointerDownOnContentRef,p.hasSelectionRef]),d.useEffect(()=>{t.current&&(function(a){let b=[],c=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;c.nextNode();)b.push(c.currentNode);return b})(t.current).forEach(a=>a.setAttribute("tabindex","-1"))}),(0,c.jsx)(m.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:n,onEscapeKeyDown:j,onPointerDownOutside:k,onFocusOutside:(0,e.composeEventHandlers)(l,a=>{a.preventDefault()}),onDismiss:p.onDismiss,children:(0,c.jsx)(i.Content,{...r,...o,onPointerDown:(0,e.composeEventHandlers)(o.onPointerDown,a=>{a.currentTarget.contains(a.target)&&w(!0),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!0}),ref:u,style:{...o.style,userSelect:v?"text":void 0,WebkitUserSelect:v?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})});function D(a){return b=>"touch"===b.pointerType?void 0:a()}d.forwardRef((a,b)=>{let{__scopeHoverCard:d,...e}=a,f=q(d);return(0,c.jsx)(i.Arrow,{...f,...e,ref:b})}).displayName="HoverCardArrow";var E=a.i(700760);function F({...a}){return(0,c.jsx)(t,{"data-slot":"hover-card",...a})}function G({...a}){return(0,c.jsx)(v,{"data-slot":"hover-card-trigger",...a})}function H({className:a,align:b="center",sideOffset:d=4,...e}){return(0,c.jsx)(z,{"data-slot":"hover-card-portal",children:(0,c.jsx)(B,{"data-slot":"hover-card-content",align:b,sideOffset:d,className:(0,E.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 origin-(--radix-hover-card-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",a),...e})})}a.s(["HoverCard",()=>F,"HoverCardContent",()=>H,"HoverCardTrigger",()=>G],23480)},494110,a=>{"use strict";var b=a.i(367146),c=a.i(130487),d=a.i(334432);a.i(16243);var e=a.i(182234),f=a.i(358176),g=a.i(286028),h=a.i(537500),i=a.i(753884),j=a.i(539524),k=a.i(371135),l=a.i(772949),m=a.i(525527),n=a.i(525662),o=a.i(39979),p=a.i(283116),q=a.i(954439),r=a.i(366705);let s=(0,r.default)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var t=a.i(957544),u=a.i(651386),v=a.i(469110),w=a.i(797424);let x=[{id:"all",label:"All Models",filter:()=>!0,description:"All available models"},{id:"free",label:"Free",icon:s,filter:a=>0===a.pricing.input&&0===a.pricing.output,description:"Completely free to use"},{id:"speed",label:"Speed",icon:v.Zap,filter:a=>{let b=(0,w.computeModelMetrics)(a);return"ultra-fast"===b.speedTier||"fast"===b.speedTier},description:"Fast models for quick answers and simple tasks"},{id:"budget",label:"Budget",icon:p.DollarSign,filter:a=>"budget"===(0,w.computeModelMetrics)(a).costTier,description:"Cost-effective for high-volume use"},{id:"coding",label:"Coding",icon:o.Code,filter:a=>((0,w.getBenchmarkScores)(a).coding??0)>=70,description:"Best for software development tasks"},{id:"reasoning",label:"Reasoning",icon:u.Sparkles,filter:a=>a.capabilities.includes("extended-thinking")||a.capabilities.includes("thinking"),description:"Deep thinking for complex problems (slower/pricier)"},{id:"intelligence",label:"Intelligence",icon:n.Brain,filter:a=>((0,w.getBenchmarkScores)(a).intelligence??0)>=85,description:"Highest capability for sophisticated tasks (expensive)"},{id:"vision",label:"Vision",icon:q.Eye,filter:a=>a.capabilities.includes("vision"),description:"Image analysis and multimodal understanding"},{id:"web-search",label:"Web Search",icon:t.Globe,filter:a=>"perplexity"===a.provider||(a.knowledgeCutoff?.includes("Real-time")??!1),description:"Real-time internet access"}];var y=a.i(711106),z=a.i(638600),A=a.i(700760);function B({activeCategory:a,onCategoryChange:c,allModels:d}){return(0,b.jsxs)("div",{className:"w-[180px] border-r bg-muted/30 p-2 flex flex-col gap-1 shrink-0 overflow-y-auto",children:[(0,b.jsx)("div",{className:"px-2 py-1.5 text-xs font-medium text-muted-foreground uppercase tracking-wider mb-1",children:"Categories"}),x.map(e=>{var f;let g,h=(f=e.id,(g=x.find(a=>a.id===f))?d.filter(g.filter).length:0),i=e.icon,j=a===e.id;return(0,b.jsxs)("button",{onClick:()=>c(e.id),className:(0,A.cn)("w-full flex items-center justify-between px-2.5 py-2 rounded-md text-sm transition-colors",j?"bg-primary/10 text-primary font-medium":"text-muted-foreground hover:bg-muted/50 hover:text-foreground"),children:[(0,b.jsxs)("div",{className:"flex items-center gap-2.5",children:[i&&(0,b.jsx)(i,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:e.label})]}),h>0&&(0,b.jsx)("span",{className:(0,A.cn)("text-[10px] tabular-nums px-1.5 py-0.5 rounded-full",j?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"),children:h})]},e.id)})]})}var C=a.i(730843),D=a.i(379670),E=a.i(374838),F=a.i(23480);let G=(0,r.default)("square-function",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M9 17c2 0 2.8-1 2.8-2.8V10c0-2 1-3.3 3.2-3",key:"m1af9g"}],["path",{d:"M9 11.2h5.7",key:"3zgcl2"}]]);var H=a.i(822735),I=a.i(651197),J=a.i(349977),K=a.i(214754),L=a.i(965025);function M({label:a,value:c,comparative:d,inverted:e=!1}){return(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,b.jsx)("span",{className:"font-medium text-muted-foreground",children:a}),(0,b.jsx)("span",{className:"text-foreground font-medium",children:d})]}),(0,b.jsx)(L.Progress,{value:e?100-c:c,className:"h-1.5 bg-muted/40",indicatorClassName:"bg-foreground/80"})]})}function N({model:a,metrics:c,compact:d=!1}){let e=(0,w.getBenchmarkScores)(a);return(0,b.jsxs)("div",{className:(0,A.cn)("grid gap-4 pt-1",d&&"gap-3"),children:[(0,b.jsx)(M,{label:"Speed",value:(a=>{switch(a){case"ultra-fast":return 100;case"fast":return 75;case"medium":default:return 50;case"slow":return 25}})(c.speedTier),comparative:(0,w.getSpeedText)(c)}),(0,b.jsx)(M,{label:"Cost Efficiency",value:(a=>{switch(a){case"budget":return 25;case"balanced":default:return 50;case"premium":return 75}})(c.costTier),comparative:(0,w.getCostText)(c),inverted:!0}),(0,b.jsx)(M,{label:"Intelligence",value:c.intelligencePercentile??e.intelligence??50,comparative:(0,w.getIntelligenceText)(c.intelligencePercentile)}),!c.hasPublicBenchmarks&&(0,b.jsxs)("div",{className:"text-[10px] text-muted-foreground/50 pt-1 flex items-center gap-1.5",children:[(0,b.jsx)(K.Info,{className:"w-2.5 h-2.5"}),(0,b.jsx)("span",{children:"Estimated metrics based on provider data"})]})]})}function O({modelId:a,variant:c="popover"}){var d;let e=(0,y.getModelConfig)(a),f=(0,l.useUserPreference)("showModelProvider");if(!e)return null;let g=(0,I.getProviderIcon)(e.provider),i=(d=e.contextWindow)>=1e6?`${(d/1e6).toFixed(1)}M tokens`:d>=1e3?`${(d/1e3).toFixed(0)}K tokens`:`${d} tokens`,j=(0,h.useMemo)(()=>(0,J.getModelMetrics)(e.id),[e.id]);return(0,b.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"bg-muted p-1.5 rounded-md mt-0.5",children:(0,b.jsx)(g,{className:"w-5 h-5 text-foreground/80"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-base leading-none mb-1",children:e.name}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground capitalize",children:[e.provider," • ",e.isLocal?"Local":"Cloud"]}),f&&!e.isLocal&&(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground/60 block",children:["via"," ","openrouter"===e.gateway?"OpenRouter":"Vercel AI Gateway"]})]})]}),e.userFriendlyDescription&&(0,b.jsx)("div",{className:"text-muted-foreground leading-relaxed",children:e.userFriendlyDescription}),e.capabilities.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2 text-xs text-muted-foreground/80",children:e.capabilities.map(a=>(0,b.jsxs)("span",{className:"flex items-center gap-1.5 bg-muted/50 px-2.5 py-1 rounded-md border border-border/50",children:[function(a){switch(a){case"vision":return(0,b.jsx)(q.Eye,{className:"w-3.5 h-3.5"});case"function-calling":return(0,b.jsx)(G,{className:"w-3.5 h-3.5"});case"thinking":return(0,b.jsx)(u.Sparkles,{className:"w-3.5 h-3.5 text-purple-500"});case"extended-thinking":return(0,b.jsx)(v.Zap,{className:"w-3.5 h-3.5 text-purple-600"});case"image-generation":return(0,b.jsx)(H.Image,{className:"w-3.5 h-3.5"});default:return null}}(a),(0,b.jsx)("span",{className:"capitalize",children:a.replace("-"," ")})]},a))}),(0,b.jsxs)("div",{className:"pt-3 border-t grid grid-cols-2 gap-y-3 gap-x-2 text-xs",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground block mb-0.5 font-medium",children:"Context Window"}),(0,b.jsx)("span",{className:"font-medium text-foreground",children:i})]}),e.knowledgeCutoff&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground block mb-0.5 font-medium",children:"Knowledge Access"}),(0,b.jsx)("span",{children:e.knowledgeCutoff})]}),!e.isLocal&&(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("span",{className:"text-muted-foreground block mb-0.5 font-medium",children:"Pricing (Input / Output)"}),(0,b.jsxs)("div",{className:"font-mono text-muted-foreground",children:[(0,b.jsxs)("span",{className:"text-foreground",children:["$",e.pricing.input]})," /",(0,b.jsxs)("span",{className:"text-foreground",children:[" $",e.pricing.output]}),(0,b.jsx)("span",{className:"opacity-50 ml-1",children:"per million tokens"})]})]})]}),j&&(0,b.jsx)("div",{className:"pt-3 border-t",children:(0,b.jsx)(N,{model:e,metrics:j,compact:!0})}),e.bestFor&&(0,b.jsxs)("div",{className:"pt-3 border-t bg-muted/20 -mx-4 px-4 pb-1",children:[(0,b.jsx)("span",{className:"text-[10px] uppercase tracking-wider text-muted-foreground font-semibold mb-1 block",children:"Best Used For"}),(0,b.jsx)("p",{className:"text-xs text-foreground/80 italic",children:e.bestFor})]})]})}function P({model:a,isSelected:c,isFavorite:d,mode:e,showDefaultBadge:g=!1,activeCategory:h,onSelect:i,onToggleFavorite:l,isPro:m=!1,proAccessRemaining:n=null,isDisabled:o=!1}){var p;"all"===h&&x.filter(b=>"all"!==b.id&&b.filter(a)).map(a=>a.id);let q=(0,b.jsxs)(k.CommandItem,{value:a.id,keywords:[a.name,a.provider,a.description||""],onSelect:()=>i(a.id),className:(0,A.cn)("group flex items-center justify-between px-3 py-3 rounded-lg cursor-pointer aria-selected:bg-muted/50 data-[selected=true]:bg-muted/50 transition-colors",c?"bg-primary/5":"",o&&"opacity-50 cursor-not-allowed"),children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,b.jsx)("div",{className:(0,A.cn)("flex items-center justify-center w-4 h-4 rounded-full border transition-all",c?"bg-primary border-primary text-primary-foreground":"border-muted-foreground/30 group-hover:border-primary/50"),children:c&&(0,b.jsx)(C.Check,{className:"w-2.5 h-2.5"})}),(0,b.jsxs)("div",{className:"flex flex-col min-w-0 gap-0.5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:(0,A.cn)("font-medium text-sm truncate",c?"text-primary":"text-foreground"),children:a.name}),g&&(0,b.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-primary/10 text-primary font-medium",children:"Default"}),a.reasoning&&(0,b.jsxs)("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-purple-500/10 text-purple-600 dark:text-purple-400 font-medium flex items-center gap-0.5",children:[(0,b.jsx)(v.Zap,{className:"w-2.5 h-2.5"}),"Reasoning"]}),m&&(0,b.jsxs)("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-amber-500/10 text-amber-600 dark:text-amber-400 font-medium flex items-center gap-0.5",children:[(0,b.jsx)(D.Crown,{className:"w-2.5 h-2.5"}),"Pro"]}),m&&o&&(0,b.jsx)("span",{className:"text-[10px] text-amber-600 dark:text-amber-400",children:"Upgrade"}),m&&!o&&null!=n&&n!==1/0&&(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground",children:0===n?"Limit reached":`${n} left`})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{className:"capitalize",children:a.provider}),(0,b.jsx)("span",{className:"text-muted-foreground/30",children:"•"}),(0,b.jsx)("span",{children:(p=a.contextWindow)>=1e6?`${(p/1e6).toFixed(1)}M`:p>=1e3?`${(p/1e3).toFixed(0)}K`:`${p}`}),a.capabilities?.includes("vision")&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-muted-foreground/30",children:"•"}),(0,b.jsx)("span",{children:"Vision"})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 pl-2",children:[!a.isLocal&&(0,b.jsxs)("div",{className:"hidden sm:flex flex-col items-end text-[10px] text-muted-foreground/50 tabular-nums leading-tight",children:[(0,b.jsxs)("span",{children:["In: $",a.pricing.input]}),(0,b.jsxs)("span",{children:["Out: $",a.pricing.output]})]}),(0,b.jsx)(j.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-transparent -mr-2 opacity-0 group-hover:opacity-100 transition-opacity focus:opacity-100",onClick:b=>{b.preventDefault(),b.stopPropagation(),l(a.id)},children:(0,b.jsx)(E.Star,{className:(0,A.cn)("h-4 w-4 transition-colors",d?"fill-amber-400 text-amber-400 opacity-100":"text-muted-foreground hover:text-amber-400")})}),"single"===e&&(0,b.jsx)(f.ChevronRight,{className:"w-4 h-4 text-muted-foreground/30"})]})]},a.id);return"single"===e?(0,b.jsxs)(F.HoverCard,{openDelay:200,children:[(0,b.jsx)(F.HoverCardTrigger,{asChild:!0,children:q}),(0,b.jsx)(F.HoverCardContent,{side:"right",align:"start",className:"w-80 p-4",sideOffset:10,children:(0,b.jsx)(O,{modelId:a.id,variant:"sidebar"})})]},a.id):q}var Q=a.i(23944),R=a.i(968177);function S({selectedIds:a,allModels:c,onRemove:d}){return 0===a.length?null:(0,b.jsx)("div",{className:"flex gap-2 px-3 py-2 border-b flex-wrap bg-background/50 backdrop-blur-sm",children:a.map(a=>{let e=c.find(b=>b.id===a);return(0,b.jsxs)(R.Badge,{variant:"secondary",className:"gap-1 pl-2 pr-1 py-1 h-7",children:[e?.name,(0,b.jsx)(j.Button,{variant:"ghost",size:"icon",className:"h-4 w-4 ml-1 hover:bg-destructive/10 hover:text-destructive rounded-full",onClick:()=>d(a),children:(0,b.jsx)(Q.X,{className:"h-3 w-3"})})]},a)})})}var T=a.i(452549),U=a.i(227759);function V({open:a,onOpenChange:d,currentTier:f}){let[g,k]=(0,h.useState)(!1),l=(0,e.useMutation)(c.api.feedback.createFeedback),m=async()=>{k(!0);try{await l({feedbackType:"feature",description:`Upgrade request: User on ${f} tier requesting pro model access`,page:"/chat"}),i.toast.success("Request sent! Admins will review your upgrade request."),d(!1)}catch(a){i.toast.error("Failed to send request")}finally{k(!1)}};return(0,b.jsx)(U.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(U.DialogContent,{className:"sm:max-w-md",children:[(0,b.jsxs)(U.DialogHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-amber-500/10",children:(0,b.jsx)(D.Crown,{className:"w-5 h-5 text-amber-500"})}),(0,b.jsx)(U.DialogTitle,{children:"Pro Models"})]}),(0,b.jsxs)(U.DialogDescription,{className:"text-left space-y-3 pt-2",children:[(0,b.jsx)("p",{children:"Pro models require an upgraded account. We haven't set up payments yet, but you can request access."}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Your request will be reviewed by an admin who can upgrade your account manually."})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,b.jsx)(j.Button,{variant:"ghost",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsxs)(j.Button,{onClick:m,disabled:g,children:[g&&(0,b.jsx)(T.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Request Access"]})]})]})})}function W({open:a,onOpenChange:n,currentModel:o,onSelectModel:p,mode:q="single",selectedModels:r=[],onSelectedModelsChange:s,showTrigger:t=!1}){let u=(0,y.getModelsByProvider)(),{favorites:v,toggleFavorite:w,isFavorite:A}=function(){let a=(0,l.useUserPreference)("favoriteModels"),b=(0,e.useMutation)(c.api.users.updatePreferences),[d,f]=(0,h.useState)([]);(0,h.useEffect)(()=>{f(a)},[a]);let g=async a=>{let c=d.includes(a)?d.filter(b=>b!==a):[...d,a];f(c);try{await b({preferences:{favoriteModels:c}})}catch(a){f(d),i.toast.error("Failed to update favorites")}};return{favorites:d,toggleFavorite:g,isFavorite:a=>d.includes(a)}}(),{recents:C,addRecent:D}=(0,m.useRecentModels)();(0,e.useQuery)(c.api.users.getCurrentUser);let E=(0,e.useQuery)(c.api.adminSettings.getProModelAccess),F=(0,l.useUserPreference)("defaultModel"),G=a=>!0===a.isPro||(a.pricing?.input??0)>=5||(a.pricing?.output??0)>=15,[H,I]=(0,h.useState)([]),[J,K]=(0,h.useState)("all"),[L,M]=(0,h.useState)(!1),N=(0,h.useRef)(a);(0,h.useEffect)(()=>{let b=a&&!N.current;N.current=a,b&&"multiple"===q&&I(r||[]),b&&z.analytics.track("quick_switcher_opened",{mode:q,currentModel:o})},[a,q,r,o]);let O=Object.values(u).flat(),{defaultModel:Q,favorites:R,recents:T,rest:U}=function(a,b,c,d=[]){let e=a.find(a=>a.id===b),f=a.filter(a=>c.includes(a.id)&&a.id!==b).sort((a,b)=>a.name.localeCompare(b.name));return{defaultModel:e,favorites:f,recents:a.filter(a=>d.includes(a.id)&&a.id!==b&&!c.includes(a.id)).sort((a,b)=>d.indexOf(a.id)-d.indexOf(b.id)),rest:a.filter(a=>a.id!==b&&!c.includes(a.id)&&!d.includes(a.id))}}(O,F,v,C),W=(0,h.useMemo)(()=>{let a=x.find(a=>a.id===J);return a&&"all"!==a.id?{defaultModel:Q&&a.filter(Q)?Q:void 0,favorites:R.filter(a.filter),recents:T.filter(a.filter),rest:U.filter(a.filter)}:{defaultModel:Q,favorites:R,recents:T,rest:U}},[J,Q,R,T,U]),X=W.rest.reduce((a,b)=>{let c=b.provider;return a[c]||(a[c]=[]),a[c].push(b),a},{}),Y=a=>{"multiple"===q?I(b=>b.includes(a)?b.filter(b=>b!==a):b.length>=4?(i.toast.error("Maximum 4 models for comparison"),b):[...b,a]):(D(a),p(a),n(!1),z.analytics.track("model_selected",{model:a,previousModel:o,source:"quick_switcher"}),setTimeout(()=>{window.dispatchEvent(new CustomEvent("focus-chat-input"))},0))},Z=(a,c=!1)=>{let d=G(a)&&E&&!E.canUse;return(0,b.jsx)(P,{model:a,isSelected:"single"===q?o===a.id:H.includes(a.id),isFavorite:A(a.id),mode:q,showDefaultBadge:c,activeCategory:J,onSelect:d?()=>M(!0):Y,onToggleFavorite:w,isPro:G(a),proAccessRemaining:G(a)&&E?E.remainingDaily??E.remainingMonthly??null:null,isDisabled:d},a.id)};return(0,b.jsxs)(b.Fragment,{children:[t&&(0,b.jsxs)(j.Button,{variant:"ghost",onClick:()=>n(!0),className:"h-8 px-2.5 text-sm font-medium bg-transparent hover:bg-muted/50 border-0 transition-all group gap-1.5 min-w-0",children:[(0,b.jsx)("span",{className:"truncate max-w-[120px] text-muted-foreground group-hover:text-foreground transition-colors",children:"single"===q?O.find(a=>a.id===o)?.name||"Select model":`${H.length} models`}),(0,b.jsx)(f.ChevronRight,{className:"w-3 h-3 text-muted-foreground/40 group-hover:text-muted-foreground rotate-90 transition-all"})]}),(0,b.jsxs)(k.CommandDialog,{open:a,onOpenChange:n,commandProps:{filter:(a,b,c)=>{let e=`${a} ${c?.join(" ")||""}`;return(0,d.default)(e,b)}},className:"max-w-[95vw] md:max-w-4xl h-[85vh] md:h-[600px] p-0 gap-0 overflow-hidden bg-background/95 backdrop-blur-xl border-border/50 shadow-2xl",children:[(0,b.jsxs)("div",{className:"flex items-center border-b px-4 py-3 shrink-0",children:[(0,b.jsx)(g.Search,{className:"w-4 h-4 mr-2 text-muted-foreground"}),(0,b.jsx)(k.CommandInput,{placeholder:`Search ${"all"===J?"":`${J} `}models...`,className:"flex-1 h-9 bg-transparent border-0 ring-0 focus:ring-0 text-sm"})]}),(0,b.jsxs)("div",{className:"flex h-[500px] overflow-hidden",children:[(0,b.jsx)(B,{activeCategory:J,onCategoryChange:a=>{K(a),z.analytics.track("category_filter_changed",{category:a,mode:q})},allModels:O}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col min-w-0 bg-background/50",children:["multiple"===q&&(0,b.jsx)(S,{selectedIds:H,allModels:O,onRemove:a=>I(b=>b.filter(b=>b!==a))}),(0,b.jsxs)(k.CommandList,{className:"max-h-[600px] overflow-y-auto p-2",children:[(0,b.jsx)(k.CommandEmpty,{children:"No models found."}),W.defaultModel&&(0,b.jsx)(k.CommandGroup,{heading:"Default",children:Z(W.defaultModel,!0)}),W.favorites.length>0&&(0,b.jsx)(k.CommandGroup,{heading:"Favorites",children:W.favorites.map(a=>Z(a))}),W.recents.length>0&&(0,b.jsx)(k.CommandGroup,{heading:"Recent",children:W.recents.map(a=>Z(a))}),(W.defaultModel||W.favorites.length>0||W.recents.length>0)&&(0,b.jsx)(k.CommandSeparator,{}),Object.entries(X).map(([a,c])=>(0,b.jsx)(k.CommandGroup,{heading:a.charAt(0).toUpperCase()+a.slice(1),className:"px-2",children:c.map(a=>Z(a))},a))]}),E&&!E.canUse&&(0,b.jsx)("div",{className:"p-3 border-t text-center",children:(0,b.jsx)("button",{type:"button",onClick:()=>M(!0),className:"text-sm text-primary hover:underline",children:"Request pro model access →"})})]})]}),"multiple"===q&&(0,b.jsxs)("div",{className:"border-t p-3 flex justify-between items-center",children:[(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[H.length,"/4 selected"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(j.Button,{variant:"ghost",onClick:()=>n(!1),size:"sm",children:"Cancel"}),(0,b.jsx)(j.Button,{onClick:()=>{H.length<2?i.toast.error("Select at least 2 models to compare"):(s?.(H),n(!1),z.analytics.track("comparison_models_selected",{modelCount:H.length,models:H.join(",")}))},disabled:H.length<2,size:"sm",children:"Compare Models"})]})]})]}),(0,b.jsx)(V,{open:L,onOpenChange:M,currentTier:E?.tier||"free"})]})}a.s(["QuickModelSwitcher",()=>W],494110)},264590,a=>{"use strict";var b=a.i(537500);function c(a={}){let{threshold:d=.01,rootMargin:e="50px 0px",mobileOnly:f=!0}=a,g=(0,b.useRef)(null),[h,i]=(0,b.useState)(!1),[j,k]=(0,b.useState)(!1);return(0,b.useEffect)(()=>{let a=()=>{k(window.innerWidth<768)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),(0,b.useEffect)(()=>{if(f&&!j)return void i(!0);if(!g.current)return;if(!("IntersectionObserver"in window))return void i(!0);let a=new IntersectionObserver(b=>{b.forEach(b=>{b.isIntersecting&&(i(!0),a.disconnect())})},{threshold:d,rootMargin:e});return a.observe(g.current),()=>{a.disconnect()}},[d,e,j,f]),{observeRef:g,isRendered:h,isMobile:j}}a.s(["useLazyMathRenderer",()=>c])},992234,a=>{"use strict";var b=a.i(537500),c=a.i(638600);let d=[{regex:/\\int_\{(.+?)\}\^\{(.+?)\}(.+?)d([a-z])/,describe:a=>`Integral from ${a[1]} to ${a[2]} of ${a[3]} with respect to ${a[4]}`},{regex:/\\int\s*(.+?)d([a-z])/,describe:a=>`Integral of ${a[1]} with respect to ${a[2]}`},{regex:/\\oint/,describe:()=>"Contour integral"},{regex:/\\frac\{d\}\{d([a-z])\}/,describe:a=>`Derivative with respect to ${a[1]}`},{regex:/\\frac\{d(.+?)\}\{d([a-z])\}/,describe:a=>`Derivative of ${a[1]} with respect to ${a[2]}`},{regex:/\\frac\{\\partial\}\{\\partial\s*([a-z])\}/,describe:a=>`Partial derivative with respect to ${a[1]}`},{regex:/\\frac\{\\partial(.+?)\}\{\\partial\s*([a-z])\}/,describe:a=>`Partial derivative of ${a[1]} with respect to ${a[2]}`},{regex:/\\nabla/,describe:()=>"Gradient or del operator"},{regex:/\\lim_\{(.+?)\\to\s*(.+?)\}/,describe:a=>`Limit as ${a[1]} approaches ${a[2]}`},{regex:/\\sum_\{(.+?)\}\^\{(.+?)\}/,describe:a=>`Sum from ${a[1]} to ${a[2]}`},{regex:/\\sum_\{(.+?)\}\^\{\\infty\}/,describe:a=>`Infinite sum starting from ${a[1]}`},{regex:/\\prod_\{(.+?)\}\^\{(.+?)\}/,describe:a=>`Product from ${a[1]} to ${a[2]}`},{regex:/\\begin\{(b|p|v|B|V|small)?matrix\}/,describe:a=>{let b=a[1]||"",c="b"===b?"square-bracketed":"p"===b?"parenthesized":"v"===b?"bar-bracketed":"";return`${c?`${c} `:""}Matrix`.trim()}},{regex:/\\det\s*\((.+?)\)|\\begin\{vmatrix\}/,describe:()=>"Determinant"},{regex:/\\vec\{(.+?)\}/,describe:a=>`Vector ${a[1]}`},{regex:/\\cdot/,describe:()=>"Dot product"},{regex:/\\times/,describe:()=>"Cross product or Cartesian product"},{regex:/\\lVert(.+?)\\rVert|\\norm\{(.+?)\}/,describe:a=>`Norm of ${a[1]||a[2]}`},{regex:/\\mathbb\{E\}\[(.+?)\]/,describe:a=>`Expected value of ${a[1]}`},{regex:/\\text\{Var\}\[(.+?)\]/,describe:a=>`Variance of ${a[1]}`},{regex:/P\((.+?)\)/,describe:a=>`Probability of ${a[1]}`},{regex:/P\((.+?)\|(.+?)\)/,describe:a=>`Probability of ${a[1]} given ${a[2]}`},{regex:/\\mathcal\{N\}\((.+?),\s*(.+?)\)/,describe:a=>`Normal distribution with mean ${a[1]} and variance ${a[2]}`},{regex:/\\frac\{(.+?)\}\{(.+?)\}/,describe:a=>`Fraction: ${a[1]} over ${a[2]}`},{regex:/\\sqrt\{(.+?)\}/,describe:a=>`Square root of ${a[1]}`},{regex:/\\sqrt\[(.+?)\]\{(.+?)\}/,describe:a=>`${a[1]}-th root of ${a[2]}`},{regex:/\\cup/,describe:()=>"Set union"},{regex:/\\cap/,describe:()=>"Set intersection"},{regex:/\\subset/,describe:()=>"Subset relation"},{regex:/\\in/,describe:()=>"Element of"},{regex:/\\emptyset/,describe:()=>"Empty set"},{regex:/\\forall/,describe:()=>"For all"},{regex:/\\exists/,describe:()=>"There exists"},{regex:/\\Rightarrow|\\implies/,describe:()=>"Implies"},{regex:/\\Leftrightarrow|\\iff/,describe:()=>"If and only if"},{regex:/\\neg/,describe:()=>"Not"},{regex:/\\(mu|sigma|alpha|beta|gamma|delta)/,describe:a=>{let b=a[1];return"mu"===b?"Statistical parameter mu":"sigma"===b?"Standard deviation sigma":"alpha"===b||"beta"===b?"Statistical parameter":"Greek letter expression"}},{regex:/\\(theta|phi|psi)/,describe:()=>"Angle expression"},{regex:/\\ce\{(.+?)\}/,describe:a=>`Chemical formula: ${a[1]}`},{regex:/\\pu\{(.+?)\}/,describe:a=>`Physical unit: ${a[1]}`},{regex:/\\infty/,describe:()=>"Expression involving infinity"},{regex:/\\approx/,describe:()=>"Approximately equal to"},{regex:/\\propto/,describe:()=>"Proportional to"}],e=[{test:a=>a.includes("\\int"),label:"Integral expression"},{test:a=>a.includes("\\sum"),label:"Summation"},{test:a=>a.includes("\\prod"),label:"Product"},{test:a=>a.includes("\\frac"),label:"Fraction"},{test:a=>a.includes("\\sqrt"),label:"Root expression"},{test:a=>a.includes("matrix"),label:"Matrix or array expression"},{test:a=>a.includes("\\lim"),label:"Limit expression"},{test:a=>a.includes("\\partial"),label:"Partial derivative"},{test:a=>a.includes("\\mathbb{E}")||a.includes("\\text{Var}")||a.includes("\\sigma"),label:"Statistical expression"},{test:a=>a.includes("\\Rightarrow")||a.includes("\\Leftarrow")||a.includes("\\iff"),label:"Logical implication"},{test:a=>a.includes("\\cup")||a.includes("\\cap"),label:"Set operation"}];function f(a,g=!1){let h=(0,b.useRef)(new Set);(0,b.useEffect)(()=>{a.current&&a.current.querySelectorAll(".katex-display, .katex:not(.katex-display)").forEach(a=>{let b;if(h.current.has(a))return;let f=a.querySelector('annotation[encoding="application/x-tex"]'),i=f?.textContent||"",j=a.classList.contains("katex-display"),k=(b=performance.now(),()=>{let a=performance.now()-b;c.analytics.track("math_rendered",{displayMode:j,equationLength:i.length,renderTimeMs:Math.round(a),isStreaming:g}),a>50&&console.warn(`[Math] Slow render: ${Math.round(a)}ms for ${i.length} chars`,{latex:i.slice(0,50)})}),l=function(a){if(!a)return"Mathematical expression";for(let b of d){let c=a.match(b.regex);if(c)return b.describe(c)}for(let b of e)if(b.test(a))return b.label;return"Mathematical expression"}(i);a.setAttribute("role","math"),a.setAttribute("aria-label",l),g&&(a.setAttribute("aria-live","polite"),a.setAttribute("aria-atomic","true"));let m=a.querySelector("math");if(m||console.warn("[Accessibility] MathML not found - ensure KaTeX output: 'htmlAndMathml' is set"),"MathMLElement"in window&&!m&&i)try{let b=document.createElement("span");b.setAttribute("aria-hidden","true"),b.style.position="absolute",b.style.clip="rect(1px, 1px, 1px, 1px)";let c=document.createElementNS("http://www.w3.org/1998/Math/MathML","math"),d=document.createElementNS("http://www.w3.org/1998/Math/MathML","annotation");d.setAttribute("encoding","application/x-tex"),d.textContent=i,c.appendChild(d),b.appendChild(c),a.appendChild(b)}catch(a){console.debug("[Accessibility] MathML enhancement failed",a)}h.current.add(a),k()})},[a,g])}a.s(["useMathAccessibility",()=>f],992234)},255663,a=>{"use strict";var b=a.i(537500),c=a.i(638600);function d(a){let c=(0,b.useRef)(new Set);(0,b.useEffect)(()=>{let a=a=>{if((a.metaKey||a.ctrlKey)&&"c"===a.key){let b=a.target;if(b.classList.contains("katex")||b.classList.contains("katex-display")){let c=b.querySelector('annotation[encoding="application/x-tex"]'),d=c?.textContent;d&&(a.preventDefault(),e(d,b))}}};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[]),(0,b.useEffect)(()=>{if(!a.current)return;let b=a.current.querySelectorAll(".katex-display"),d=a.current.querySelectorAll(".katex:not(.katex-display)");b.forEach(a=>{let b,d;if(c.current.has(a))return;let e=a.querySelector('annotation[encoding="application/x-tex"]'),h=e?.textContent||"";if(!h)return;let i=document.createElement("div");i.className="group relative",a.parentNode?.insertBefore(i,a),i.appendChild(a);let j=document.createElement("button");j.className="absolute right-2 top-2 h-8 w-8 flex items-center justify-center rounded-md border border-border bg-background opacity-0 transition-opacity group-hover:opacity-100 focus-visible:opacity-100 hover:bg-accent hover:text-accent-foreground",j.setAttribute("aria-label","Copy LaTeX source"),j.setAttribute("type","button");let k=g(),l=((b=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("width","16"),b.setAttribute("height","16"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.setAttribute("stroke","currentColor"),b.setAttribute("stroke-width","2"),b.setAttribute("stroke-linecap","round"),b.setAttribute("stroke-linejoin","round"),b.classList.add("check-icon","hidden","text-green-500"),(d=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M20 6 9 17l-5-5"),b.appendChild(d),b);j.appendChild(k),j.appendChild(l),j.addEventListener("click",async b=>{b.preventDefault(),b.stopPropagation(),await f(h,a,k,l,!0)}),i.appendChild(j),c.current.add(a)}),d.forEach(a=>{if(c.current.has(a))return;let b=a.querySelector('annotation[encoding="application/x-tex"]'),d=b?.textContent||"";if(!d)return;a.setAttribute("tabindex","0"),a.setAttribute("role","button"),a.setAttribute("aria-label",`Math: ${d}`);let f=document.createElement("button");f.className="inline-math-copy",f.setAttribute("aria-label","Copy LaTeX"),f.setAttribute("type","button");let h=g();f.appendChild(h),f.addEventListener("click",async b=>{b.preventDefault(),b.stopPropagation(),await e(d,a)}),a.appendChild(f),c.current.add(a)})},[a])}async function e(a,b){let d=b.classList.contains("katex-display");try{let e=d?`$$${a}$$`:`\\(${a}\\)`,f=b.querySelector(".katex-html"),g=f?d?`<div class="math-display">${f.innerHTML}</div>`:`<span class="math-inline">${f.innerHTML}</span>`:"";if(navigator.clipboard&&ClipboardItem){let b={"text/plain":new Blob([e],{type:"text/plain"})};if(g&&(b["text/html"]=new Blob([g],{type:"text/html"})),"MathMLElement"in window&&a)try{let c=`<math><annotation encoding="application/x-tex">${a}</annotation></math>`;b["application/mathml+xml"]=new Blob([c],{type:"application/mathml+xml"})}catch{}await navigator.clipboard.write([new ClipboardItem(b)])}else await navigator.clipboard.writeText(e);c.analytics.track("math_copied",{format:g?"both":"latex",equationLength:a.length})}catch(b){console.error("Failed to copy math:",b);try{await navigator.clipboard.writeText(d?`$$${a}$$`:`\\(${a}\\)`)}catch(a){console.error("Fallback copy failed:",a)}}}async function f(a,b,c,d,f){await e(a,b),c.classList.add("hidden"),d.classList.remove("hidden"),setTimeout(()=>{c.classList.remove("hidden"),d.classList.add("hidden")},2e3)}function g(){let a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("width","16"),a.setAttribute("height","16"),a.setAttribute("viewBox","0 0 24 24"),a.setAttribute("fill","none"),a.setAttribute("stroke","currentColor"),a.setAttribute("stroke-width","2"),a.setAttribute("stroke-linecap","round"),a.setAttribute("stroke-linejoin","round"),a.classList.add("copy-icon");let b=document.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("width","14"),b.setAttribute("height","14"),b.setAttribute("x","8"),b.setAttribute("y","8"),b.setAttribute("rx","2"),b.setAttribute("ry","2");let c=document.createElementNS("http://www.w3.org/2000/svg","path");return c.setAttribute("d","M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"),a.appendChild(b),a.appendChild(c),a}a.s(["useMathCopyButtons",()=>d])},726800,a=>{"use strict";var b=a.i(537500);function c(a){if(!a)return"";let b=a,c=a.match(/```/g);if((c?.length??0)%2!=0){let c=a.lastIndexOf("```");b=a.slice(0,c)}let d=b,e=d.match(/(?<!`)`(?!`)/g);if((e?.length??0)%2!=0){let a=d.lastIndexOf("`");b=d.slice(0,a)}let f=b.slice(-20),g=f.match(/(\*\*(?!\*\*)(?:[^*]|(?!\*\*)\*)*$)/)||f.match(/((?<!\*)\*(?!\*)(?:[^*])*$)/)||f.match(/(__(?!__)(?:[^_]|(?!__)_)*$)/)||f.match(/((?<!_)_(?!_)(?:[^_])*$)/);if(g){let a=g[0].length;b=b.slice(0,-a)}let h=b.match(/(!?\[[^\]]*?)$/);if(h){let a=h[0].length;b=b.slice(0,-a)}let i=b.match(/\[[^\]]+\]\((?:[^)]*?)$/);if(i){let a=i[0].length;b=b.slice(0,-a)}return b}function d(a,d,e){let[f,g]=(0,b.useState)(""),h=e?.charsPerSecond??200,i=e?.minTokenSize??3,j=e?.adaptiveThreshold??5e3,k=(0,b.useRef)(""),l=(0,b.useRef)(""),m=(0,b.useRef)(void 0),n=(0,b.useRef)(Date.now()),o=k.current.length>0;return(0,b.useEffect)(()=>{if(a!==l.current){if(a.length>l.current.length&&a.startsWith(l.current)){let b=a.slice(l.current.length);k.current+=b}else g(a),k.current="",n.current=Date.now();l.current=a}if(!d){k.current.length>0?(g(a),k.current=""):f!==a&&g(a),m.current&&(cancelAnimationFrame(m.current),m.current=void 0);return}let b=()=>{let a=Date.now(),d=Math.floor((a-n.current)/1e3*(k.current.length>j?2*h:h));if(d>0&&k.current.length>0){let b=function(a,b,d=3){if(a.length<=b)return c(a);for(let e=b;e>=d;e--){let b=a[e];if(/[\s.,;:!?)\]}>]/.test(b))return c(a.slice(0,e+1))}return c(a.slice(0,Math.max(b,d)))}(k.current,d,i);b.length>0&&(g(a=>a+b),k.current=k.current.slice(b.length),n.current=a)}m.current=requestAnimationFrame(b)};return m.current||(n.current=Date.now(),m.current=requestAnimationFrame(b)),()=>{m.current&&(cancelAnimationFrame(m.current),m.current=void 0)}},[a,d,h,i,j,f]),{displayContent:f,hasBufferedContent:o}}a.s(["useStreamBuffer",()=>d],726800)},287544,a=>{"use strict";var b=a.i(907364);b.default.__defineMacro("\\ce",function(a){return c(a.consumeArgs(1)[0],"ce")}),b.default.__defineMacro("\\pu",function(a){return c(a.consumeArgs(1)[0],"pu")}),b.default.__defineMacro("\\tripledash","{\\vphantom{-}\\raisebox{2.56mu}{$\\mkern2mu\\tiny\\text{-}\\mkern1mu\\text{-}\\mkern1mu\\text{-}\\mkern2mu$}}");var c=function(a,b){for(var c="",f=a.length&&a[a.length-1].loc.start,g=a.length-1;g>=0;g--)a[g].loc.start>f&&(c+=" ",f=a[g].loc.start),c+=a[g].text,f+=a[g].text.length;return e.go(d.go(c,b))},d={go:function(a,b){if(!a)return[];void 0===b&&(b="ce");var c="0",e={};e.parenthesisLevel=0,a=(a=(a=a.replace(/\n/g," ")).replace(/[\u2212\u2013\u2014\u2010]/g,"-")).replace(/[\u2026]/g,"...");for(var f=10,g=[];;){l!==a?(f=10,l=a):f--;for(var h=d.stateMachines[b],i=h.transitions[c]||h.transitions["*"],j=0;j<i.length;j++){var k=d.patterns.match_(i[j].pattern,a);if(k){for(var l,m,n=i[j].task,o=0;o<n.action_.length;o++){if(h.actions[n.action_[o].type_])m=h.actions[n.action_[o].type_](e,k.match_,n.action_[o].option);else if(d.actions[n.action_[o].type_])m=d.actions[n.action_[o].type_](e,k.match_,n.action_[o].option);else throw["MhchemBugA","mhchem bug A. Please report. ("+n.action_[o].type_+")"];d.concatArray(g,m)}if(c=n.nextState||c,!(a.length>0))return g;if(n.revisit||(a=k.remainder),!n.toContinue)break}}if(f<=0)throw["MhchemBugU","mhchem bug U. Please report."]}},concatArray:function(a,b){if(b)if(Array.isArray(b))for(var c=0;c<b.length;c++)a.push(b[c]);else a.push(b)},patterns:{patterns:{empty:/^$/,else:/^./,else2:/^./,space:/^\s/,"space A":/^\s(?=[A-Z\\$])/,space$:/^\s$/,"a-z":/^[a-z]/,x:/^x/,x$:/^x$/,i$:/^i$/,letters:/^(?:[a-zA-Z\u03B1-\u03C9\u0391-\u03A9?@]|(?:\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\s+|\{\}|(?![a-zA-Z]))))+/,"\\greek":/^\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|Gamma|Delta|Theta|Lambda|Xi|Pi|Sigma|Upsilon|Phi|Psi|Omega)(?:\s+|\{\}|(?![a-zA-Z]))/,"one lowercase latin letter $":/^(?:([a-z])(?:$|[^a-zA-Z]))$/,"$one lowercase latin letter$ $":/^\$(?:([a-z])(?:$|[^a-zA-Z]))\$$/,"one lowercase greek letter $":/^(?:\$?[\u03B1-\u03C9]\$?|\$?\\(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega)\s*\$?)(?:\s+|\{\}|(?![a-zA-Z]))$/,digits:/^[0-9]+/,"-9.,9":/^[+\-]?(?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))/,"-9.,9 no missing 0":/^[+\-]?[0-9]+(?:[.,][0-9]+)?/,"(-)(9.,9)(e)(99)":function(a){var b=a.match(/^(\+\-|\+\/\-|\+|\-|\\pm\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))?(\((?:[0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+))\))?(?:([eE]|\s*(\*|x|\\times|\u00D7)\s*10\^)([+\-]?[0-9]+|\{[+\-]?[0-9]+\}))?/);return b&&b[0]?{match_:b.splice(1),remainder:a.substr(b[0].length)}:null},"(-)(9)^(-9)":function(a){var b=a.match(/^(\+\-|\+\/\-|\+|\-|\\pm\s?)?([0-9]+(?:[,.][0-9]+)?|[0-9]*(?:\.[0-9]+)?)\^([+\-]?[0-9]+|\{[+\-]?[0-9]+\})/);return b&&b[0]?{match_:b.splice(1),remainder:a.substr(b[0].length)}:null},"state of aggregation $":function(a){var b=d.patterns.findObserveGroups(a,"",/^\([a-z]{1,3}(?=[\),])/,")","");if(b&&b.remainder.match(/^($|[\s,;\)\]\}])/))return b;var c=a.match(/^(?:\((?:\\ca\s?)?\$[amothc]\$\))/);return c?{match_:c[0],remainder:a.substr(c[0].length)}:null},"_{(state of aggregation)}$":/^_\{(\([a-z]{1,3}\))\}/,"{[(":/^(?:\\\{|\[|\()/,")]}":/^(?:\)|\]|\\\})/,", ":/^[,;]\s*/,",":/^[,;]/,".":/^[.]/,". ":/^([.\u22C5\u00B7\u2022])\s*/,"...":/^\.\.\.(?=$|[^.])/,"* ":/^([*])\s*/,"^{(...)}":function(a){return d.patterns.findObserveGroups(a,"^{","","","}")},"^($...$)":function(a){return d.patterns.findObserveGroups(a,"^","$","$","")},"^a":/^\^([0-9]+|[^\\_])/,"^\\x{}{}":function(a){return d.patterns.findObserveGroups(a,"^",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"^\\x{}":function(a){return d.patterns.findObserveGroups(a,"^",/^\\[a-zA-Z]+\{/,"}","")},"^\\x":/^\^(\\[a-zA-Z]+)\s*/,"^(-1)":/^\^(-?\d+)/,"'":/^'/,"_{(...)}":function(a){return d.patterns.findObserveGroups(a,"_{","","","}")},"_($...$)":function(a){return d.patterns.findObserveGroups(a,"_","$","$","")},_9:/^_([+\-]?[0-9]+|[^\\])/,"_\\x{}{}":function(a){return d.patterns.findObserveGroups(a,"_",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"_\\x{}":function(a){return d.patterns.findObserveGroups(a,"_",/^\\[a-zA-Z]+\{/,"}","")},"_\\x":/^_(\\[a-zA-Z]+)\s*/,"^_":/^(?:\^(?=_)|\_(?=\^)|[\^_]$)/,"{}":/^\{\}/,"{...}":function(a){return d.patterns.findObserveGroups(a,"","{","}","")},"{(...)}":function(a){return d.patterns.findObserveGroups(a,"{","","","}")},"$...$":function(a){return d.patterns.findObserveGroups(a,"","$","$","")},"${(...)}$":function(a){return d.patterns.findObserveGroups(a,"${","","","}$")},"$(...)$":function(a){return d.patterns.findObserveGroups(a,"$","","","$")},"=<>":/^[=<>]/,"#":/^[#\u2261]/,"+":/^\+/,"-$":/^-(?=[\s_},;\]/]|$|\([a-z]+\))/,"-9":/^-(?=[0-9])/,"- orbital overlap":/^-(?=(?:[spd]|sp)(?:$|[\s,;\)\]\}]))/,"-":/^-/,"pm-operator":/^(?:\\pm|\$\\pm\$|\+-|\+\/-)/,operator:/^(?:\+|(?:[\-=<>]|<<|>>|\\approx|\$\\approx\$)(?=\s|$|-?[0-9]))/,arrowUpDown:/^(?:v|\(v\)|\^|\(\^\))(?=$|[\s,;\)\]\}])/,"\\bond{(...)}":function(a){return d.patterns.findObserveGroups(a,"\\bond{","","","}")},"->":/^(?:<->|<-->|->|<-|<=>>|<<=>|<=>|[\u2192\u27F6\u21CC])/,CMT:/^[CMT](?=\[)/,"[(...)]":function(a){return d.patterns.findObserveGroups(a,"[","","","]")},"1st-level escape":/^(&|\\\\|\\hline)\s*/,"\\,":/^(?:\\[,\ ;:])/,"\\x{}{}":function(a){return d.patterns.findObserveGroups(a,"",/^\\[a-zA-Z]+\{/,"}","","","{","}","",!0)},"\\x{}":function(a){return d.patterns.findObserveGroups(a,"",/^\\[a-zA-Z]+\{/,"}","")},"\\ca":/^\\ca(?:\s+|(?![a-zA-Z]))/,"\\x":/^(?:\\[a-zA-Z]+\s*|\\[_&{}%])/,orbital:/^(?:[0-9]{1,2}[spdfgh]|[0-9]{0,2}sp)(?=$|[^a-zA-Z])/,others:/^[\/~|]/,"\\frac{(...)}":function(a){return d.patterns.findObserveGroups(a,"\\frac{","","","}","{","","","}")},"\\overset{(...)}":function(a){return d.patterns.findObserveGroups(a,"\\overset{","","","}","{","","","}")},"\\underset{(...)}":function(a){return d.patterns.findObserveGroups(a,"\\underset{","","","}","{","","","}")},"\\underbrace{(...)}":function(a){return d.patterns.findObserveGroups(a,"\\underbrace{","","","}_","{","","","}")},"\\color{(...)}0":function(a){return d.patterns.findObserveGroups(a,"\\color{","","","}")},"\\color{(...)}{(...)}1":function(a){return d.patterns.findObserveGroups(a,"\\color{","","","}","{","","","}")},"\\color(...){(...)}2":function(a){return d.patterns.findObserveGroups(a,"\\color","\\","",/^(?=\{)/,"{","","","}")},"\\ce{(...)}":function(a){return d.patterns.findObserveGroups(a,"\\ce{","","","}")},oxidation$:/^(?:[+-][IVX]+|\\pm\s*0|\$\\pm\$\s*0)$/,"d-oxidation$":/^(?:[+-]?\s?[IVX]+|\\pm\s*0|\$\\pm\$\s*0)$/,"roman numeral":/^[IVX]+/,"1/2$":/^[+\-]?(?:[0-9]+|\$[a-z]\$|[a-z])\/[0-9]+(?:\$[a-z]\$|[a-z])?$/,amount:function(a){if(b=a.match(/^(?:(?:(?:\([+\-]?[0-9]+\/[0-9]+\)|[+\-]?(?:[0-9]+|\$[a-z]\$|[a-z])\/[0-9]+|[+\-]?[0-9]+[.,][0-9]+|[+\-]?\.[0-9]+|[+\-]?[0-9]+)(?:[a-z](?=\s*[A-Z]))?)|[+\-]?[a-z](?=\s*[A-Z])|\+(?!\s))/))return{match_:b[0],remainder:a.substr(b[0].length)};var b,c=d.patterns.findObserveGroups(a,"","$","$","");return c&&(b=c.match_.match(/^\$(?:\(?[+\-]?(?:[0-9]*[a-z]?[+\-])?[0-9]*[a-z](?:[+\-][0-9]*[a-z]?)?\)?|\+|-)\$$/))?{match_:b[0],remainder:a.substr(b[0].length)}:null},amount2:function(a){return this.amount(a)},"(KV letters),":/^(?:[A-Z][a-z]{0,2}|i)(?=,)/,formula$:function(a){if(a.match(/^\([a-z]+\)$/))return null;var b=a.match(/^(?:[a-z]|(?:[0-9\ \+\-\,\.\(\)]+[a-z])+[0-9\ \+\-\,\.\(\)]*|(?:[a-z][0-9\ \+\-\,\.\(\)]+)+[a-z]?)$/);return b?{match_:b[0],remainder:a.substr(b[0].length)}:null},uprightEntities:/^(?:pH|pOH|pC|pK|iPr|iBu)(?=$|[^a-zA-Z])/,"/":/^\s*(\/)\s*/,"//":/^\s*(\/\/)\s*/,"*":/^\s*[*.]\s*/},findObserveGroups:function(a,b,c,d,e,f,g,h,i,j){var k=function(a,b){if("string"==typeof b)return 0!==a.indexOf(b)?null:b;var c=a.match(b);return c?c[0]:null},l=k(a,b);if(null===l||null===(l=k(a=a.substr(l.length),c)))return null;var m=function(a,b,c){for(var d=0;b<a.length;){var e=a.charAt(b),f=k(a.substr(b),c);if(null!==f&&0===d)return{endMatchBegin:b,endMatchEnd:b+f.length};if("{"===e)d++;else if("}"===e)if(0===d)throw["ExtraCloseMissingOpen","Extra close brace or missing open brace"];else d--;b++}return null}(a,l.length,d||e);if(null===m)return null;var n=a.substring(0,d?m.endMatchEnd:m.endMatchBegin);if(!(f||g))return{match_:n,remainder:a.substr(m.endMatchEnd)};var o=this.findObserveGroups(a.substr(m.endMatchEnd),f,g,h,i);if(null===o)return null;var p=[n,o.match_];return{match_:j?p.join(""):p,remainder:o.remainder}},match_:function(a,b){var c=d.patterns.patterns[a];if(void 0===c)throw["MhchemBugP","mhchem bug P. Please report. ("+a+")"];if("function"==typeof c)return d.patterns.patterns[a](b);var e=b.match(c);return e?{match_:e[2]?[e[1],e[2]]:e[1]?e[1]:e[0],remainder:b.substr(e[0].length)}:null}},actions:{"a=":function(a,b){a.a=(a.a||"")+b},"b=":function(a,b){a.b=(a.b||"")+b},"p=":function(a,b){a.p=(a.p||"")+b},"o=":function(a,b){a.o=(a.o||"")+b},"q=":function(a,b){a.q=(a.q||"")+b},"d=":function(a,b){a.d=(a.d||"")+b},"rm=":function(a,b){a.rm=(a.rm||"")+b},"text=":function(a,b){a.text_=(a.text_||"")+b},insert:function(a,b,c){return{type_:c}},"insert+p1":function(a,b,c){return{type_:c,p1:b}},"insert+p1+p2":function(a,b,c){return{type_:c,p1:b[0],p2:b[1]}},copy:function(a,b){return b},rm:function(a,b){return{type_:"rm",p1:b||""}},text:function(a,b){return d.go(b,"text")},"{text}":function(a,b){var c=["{"];return d.concatArray(c,d.go(b,"text")),c.push("}"),c},"tex-math":function(a,b){return d.go(b,"tex-math")},"tex-math tight":function(a,b){return d.go(b,"tex-math tight")},bond:function(a,b,c){return{type_:"bond",kind_:c||b}},"color0-output":function(a,b){return{type_:"color0",color:b[0]}},ce:function(a,b){return d.go(b)},"1/2":function(a,b){var c=[];b.match(/^[+\-]/)&&(c.push(b.substr(0,1)),b=b.substr(1));var d=b.match(/^([0-9]+|\$[a-z]\$|[a-z])\/([0-9]+)(\$[a-z]\$|[a-z])?$/);return d[1]=d[1].replace(/\$/g,""),c.push({type_:"frac",p1:d[1],p2:d[2]}),d[3]&&(d[3]=d[3].replace(/\$/g,""),c.push({type_:"tex-math",p1:d[3]})),c},"9,9":function(a,b){return d.go(b,"9,9")}},createTransitions:function(a){var b,c,d,e,f={};for(b in a)for(c in a[b])for(e=0,d=c.split("|"),a[b][c].stateArray=d;e<d.length;e++)f[d[e]]=[];for(b in a)for(c in a[b])for(e=0,d=a[b][c].stateArray||[];e<d.length;e++){var g=a[b][c];if(g.action_){g.action_=[].concat(g.action_);for(var h=0;h<g.action_.length;h++)"string"==typeof g.action_[h]&&(g.action_[h]={type_:g.action_[h]})}else g.action_=[];for(var i=b.split("|"),j=0;j<i.length;j++)if("*"===d[e])for(var k in f)f[k].push({pattern:i[j],task:g});else f[d[e]].push({pattern:i[j],task:g})}return f},stateMachines:{}};d.stateMachines={ce:{transitions:d.createTransitions({empty:{"*":{action_:"output"}},else:{"0|1|2":{action_:"beginsWithBond=false",revisit:!0,toContinue:!0}},oxidation$:{0:{action_:"oxidation-output"}},CMT:{r:{action_:"rdt=",nextState:"rt"},rd:{action_:"rqt=",nextState:"rdt"}},arrowUpDown:{"0|1|2|as":{action_:["sb=false","output","operator"],nextState:"1"}},uprightEntities:{"0|1|2":{action_:["o=","output"],nextState:"1"}},orbital:{"0|1|2|3":{action_:"o=",nextState:"o"}},"->":{"0|1|2|3":{action_:"r=",nextState:"r"},"a|as":{action_:["output","r="],nextState:"r"},"*":{action_:["output","r="],nextState:"r"}},"+":{o:{action_:"d= kv",nextState:"d"},"d|D":{action_:"d=",nextState:"d"},q:{action_:"d=",nextState:"qd"},"qd|qD":{action_:"d=",nextState:"qd"},dq:{action_:["output","d="],nextState:"d"},3:{action_:["sb=false","output","operator"],nextState:"0"}},amount:{"0|2":{action_:"a=",nextState:"a"}},"pm-operator":{"0|1|2|a|as":{action_:["sb=false","output",{type_:"operator",option:"\\pm"}],nextState:"0"}},operator:{"0|1|2|a|as":{action_:["sb=false","output","operator"],nextState:"0"}},"-$":{"o|q":{action_:["charge or bond","output"],nextState:"qd"},d:{action_:"d=",nextState:"d"},D:{action_:["output",{type_:"bond",option:"-"}],nextState:"3"},q:{action_:"d=",nextState:"qd"},qd:{action_:"d=",nextState:"qd"},"qD|dq":{action_:["output",{type_:"bond",option:"-"}],nextState:"3"}},"-9":{"3|o":{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"3"}},"- orbital overlap":{o:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"},d:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"}},"-":{"0|1|2":{action_:[{type_:"output",option:1},"beginsWithBond=true",{type_:"bond",option:"-"}],nextState:"3"},3:{action_:{type_:"bond",option:"-"}},a:{action_:["output",{type_:"insert",option:"hyphen"}],nextState:"2"},as:{action_:[{type_:"output",option:2},{type_:"bond",option:"-"}],nextState:"3"},b:{action_:"b="},o:{action_:{type_:"- after o/d",option:!1},nextState:"2"},q:{action_:{type_:"- after o/d",option:!1},nextState:"2"},"d|qd|dq":{action_:{type_:"- after o/d",option:!0},nextState:"2"},"D|qD|p":{action_:["output",{type_:"bond",option:"-"}],nextState:"3"}},amount2:{"1|3":{action_:"a=",nextState:"a"}},letters:{"0|1|2|3|a|as|b|p|bp|o":{action_:"o=",nextState:"o"},"q|dq":{action_:["output","o="],nextState:"o"},"d|D|qd|qD":{action_:"o after d",nextState:"o"}},digits:{o:{action_:"q=",nextState:"q"},"d|D":{action_:"q=",nextState:"dq"},q:{action_:["output","o="],nextState:"o"},a:{action_:"o=",nextState:"o"}},"space A":{"b|p|bp":{}},space:{a:{nextState:"as"},0:{action_:"sb=false"},"1|2":{action_:"sb=true"},"r|rt|rd|rdt|rdq":{action_:"output",nextState:"0"},"*":{action_:["output","sb=true"],nextState:"1"}},"1st-level escape":{"1|2":{action_:["output",{type_:"insert+p1",option:"1st-level escape"}]},"*":{action_:["output",{type_:"insert+p1",option:"1st-level escape"}],nextState:"0"}},"[(...)]":{"r|rt":{action_:"rd=",nextState:"rd"},"rd|rdt":{action_:"rq=",nextState:"rdq"}},"...":{"o|d|D|dq|qd|qD":{action_:["output",{type_:"bond",option:"..."}],nextState:"3"},"*":{action_:[{type_:"output",option:1},{type_:"insert",option:"ellipsis"}],nextState:"1"}},". |* ":{"*":{action_:["output",{type_:"insert",option:"addition compound"}],nextState:"1"}},"state of aggregation $":{"*":{action_:["output","state of aggregation"],nextState:"1"}},"{[(":{"a|as|o":{action_:["o=","output","parenthesisLevel++"],nextState:"2"},"0|1|2|3":{action_:["o=","output","parenthesisLevel++"],nextState:"2"},"*":{action_:["output","o=","output","parenthesisLevel++"],nextState:"2"}},")]}":{"0|1|2|3|b|p|bp|o":{action_:["o=","parenthesisLevel--"],nextState:"o"},"a|as|d|D|q|qd|qD|dq":{action_:["output","o=","parenthesisLevel--"],nextState:"o"}},", ":{"*":{action_:["output","comma"],nextState:"0"}},"^_":{"*":{}},"^{(...)}|^($...$)":{"0|1|2|as":{action_:"b=",nextState:"b"},p:{action_:"b=",nextState:"bp"},"3|o":{action_:"d= kv",nextState:"D"},q:{action_:"d=",nextState:"qD"},"d|D|qd|qD|dq":{action_:["output","d="],nextState:"D"}},"^a|^\\x{}{}|^\\x{}|^\\x|'":{"0|1|2|as":{action_:"b=",nextState:"b"},p:{action_:"b=",nextState:"bp"},"3|o":{action_:"d= kv",nextState:"d"},q:{action_:"d=",nextState:"qd"},"d|qd|D|qD":{action_:"d="},dq:{action_:["output","d="],nextState:"d"}},"_{(state of aggregation)}$":{"d|D|q|qd|qD|dq":{action_:["output","q="],nextState:"q"}},"_{(...)}|_($...$)|_9|_\\x{}{}|_\\x{}|_\\x":{"0|1|2|as":{action_:"p=",nextState:"p"},b:{action_:"p=",nextState:"bp"},"3|o":{action_:"q=",nextState:"q"},"d|D":{action_:"q=",nextState:"dq"},"q|qd|qD|dq":{action_:["output","q="],nextState:"q"}},"=<>":{"0|1|2|3|a|as|o|q|d|D|qd|qD|dq":{action_:[{type_:"output",option:2},"bond"],nextState:"3"}},"#":{"0|1|2|3|a|as|o":{action_:[{type_:"output",option:2},{type_:"bond",option:"#"}],nextState:"3"}},"{}":{"*":{action_:{type_:"output",option:1},nextState:"1"}},"{...}":{"0|1|2|3|a|as|b|p|bp":{action_:"o=",nextState:"o"},"o|d|D|q|qd|qD|dq":{action_:["output","o="],nextState:"o"}},"$...$":{a:{action_:"a="},"0|1|2|3|as|b|p|bp|o":{action_:"o=",nextState:"o"},"as|o":{action_:"o="},"q|d|D|qd|qD|dq":{action_:["output","o="],nextState:"o"}},"\\bond{(...)}":{"*":{action_:[{type_:"output",option:2},"bond"],nextState:"3"}},"\\frac{(...)}":{"*":{action_:[{type_:"output",option:1},"frac-output"],nextState:"3"}},"\\overset{(...)}":{"*":{action_:[{type_:"output",option:2},"overset-output"],nextState:"3"}},"\\underset{(...)}":{"*":{action_:[{type_:"output",option:2},"underset-output"],nextState:"3"}},"\\underbrace{(...)}":{"*":{action_:[{type_:"output",option:2},"underbrace-output"],nextState:"3"}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:[{type_:"output",option:2},"color-output"],nextState:"3"}},"\\color{(...)}0":{"*":{action_:[{type_:"output",option:2},"color0-output"]}},"\\ce{(...)}":{"*":{action_:[{type_:"output",option:2},"ce"],nextState:"3"}},"\\,":{"*":{action_:[{type_:"output",option:1},"copy"],nextState:"1"}},"\\x{}{}|\\x{}|\\x":{"0|1|2|3|a|as|b|p|bp|o|c0":{action_:["o=","output"],nextState:"3"},"*":{action_:["output","o=","output"],nextState:"3"}},others:{"*":{action_:[{type_:"output",option:1},"copy"],nextState:"3"}},else2:{a:{action_:"a to o",nextState:"o",revisit:!0},as:{action_:["output","sb=true"],nextState:"1",revisit:!0},"r|rt|rd|rdt|rdq":{action_:["output"],nextState:"0",revisit:!0},"*":{action_:["output","copy"],nextState:"3"}}}),actions:{"o after d":function(a,b){var c;if((a.d||"").match(/^[0-9]+$/)){var e=a.d;a.d=void 0,c=this.output(a),a.b=e}else c=this.output(a);return d.actions["o="](a,b),c},"d= kv":function(a,b){a.d=b,a.dType="kv"},"charge or bond":function(a,b){if(a.beginsWithBond){var c=[];return d.concatArray(c,this.output(a)),d.concatArray(c,d.actions.bond(a,b,"-")),c}a.d=b},"- after o/d":function(a,b,c){var e=d.patterns.match_("orbital",a.o||""),f=d.patterns.match_("one lowercase greek letter $",a.o||""),g=d.patterns.match_("one lowercase latin letter $",a.o||""),h=d.patterns.match_("$one lowercase latin letter$ $",a.o||""),i="-"===b&&(e&&""===e.remainder||f||g||h);!i||a.a||a.b||a.p||a.d||a.q||e||!g||(a.o="$"+a.o+"$");var j=[];return i?(d.concatArray(j,this.output(a)),j.push({type_:"hyphen"})):(e=d.patterns.match_("digits",a.d||""),c&&e&&""===e.remainder?(d.concatArray(j,d.actions["d="](a,b)),d.concatArray(j,this.output(a))):(d.concatArray(j,this.output(a)),d.concatArray(j,d.actions.bond(a,b,"-")))),j},"a to o":function(a){a.o=a.a,a.a=void 0},"sb=true":function(a){a.sb=!0},"sb=false":function(a){a.sb=!1},"beginsWithBond=true":function(a){a.beginsWithBond=!0},"beginsWithBond=false":function(a){a.beginsWithBond=!1},"parenthesisLevel++":function(a){a.parenthesisLevel++},"parenthesisLevel--":function(a){a.parenthesisLevel--},"state of aggregation":function(a,b){return{type_:"state of aggregation",p1:d.go(b,"o")}},comma:function(a,b){var c=b.replace(/\s*$/,"");return c!==b&&0===a.parenthesisLevel?{type_:"comma enumeration L",p1:c}:{type_:"comma enumeration M",p1:c}},output:function(a,b,c){var e,f,g;for(var h in a.r?(f="M"===a.rdt?d.go(a.rd,"tex-math"):"T"===a.rdt?[{type_:"text",p1:a.rd||""}]:d.go(a.rd),g="M"===a.rqt?d.go(a.rq,"tex-math"):"T"===a.rqt?[{type_:"text",p1:a.rq||""}]:d.go(a.rq),e={type_:"arrow",r:a.r,rd:f,rq:g}):(e=[],(a.a||a.b||a.p||a.o||a.q||a.d||c)&&(a.sb&&e.push({type_:"entitySkip"}),a.o||a.q||a.d||a.b||a.p||2===c?a.o||a.q||a.d||!a.b&&!a.p?a.o&&"kv"===a.dType&&d.patterns.match_("d-oxidation$",a.d||"")?a.dType="oxidation":a.o&&"kv"===a.dType&&!a.q&&(a.dType=void 0):(a.o=a.a,a.d=a.b,a.q=a.p,a.a=a.b=a.p=void 0):(a.o=a.a,a.a=void 0),e.push({type_:"chemfive",a:d.go(a.a,"a"),b:d.go(a.b,"bd"),p:d.go(a.p,"pq"),o:d.go(a.o,"o"),q:d.go(a.q,"pq"),d:d.go(a.d,"oxidation"===a.dType?"oxidation":"bd"),dType:a.dType}))),a)"parenthesisLevel"!==h&&"beginsWithBond"!==h&&delete a[h];return e},"oxidation-output":function(a,b){var c=["{"];return d.concatArray(c,d.go(b,"oxidation")),c.push("}"),c},"frac-output":function(a,b){return{type_:"frac-ce",p1:d.go(b[0]),p2:d.go(b[1])}},"overset-output":function(a,b){return{type_:"overset",p1:d.go(b[0]),p2:d.go(b[1])}},"underset-output":function(a,b){return{type_:"underset",p1:d.go(b[0]),p2:d.go(b[1])}},"underbrace-output":function(a,b){return{type_:"underbrace",p1:d.go(b[0]),p2:d.go(b[1])}},"color-output":function(a,b){return{type_:"color",color1:b[0],color2:d.go(b[1])}},"r=":function(a,b){a.r=b},"rdt=":function(a,b){a.rdt=b},"rd=":function(a,b){a.rd=b},"rqt=":function(a,b){a.rqt=b},"rq=":function(a,b){a.rq=b},operator:function(a,b,c){return{type_:"operator",kind_:c||b}}}},a:{transitions:d.createTransitions({empty:{"*":{}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"1",revisit:!0}},"$(...)$":{"*":{action_:"tex-math tight",nextState:"1"}},",":{"*":{action_:{type_:"insert",option:"commaDecimal"}}},else2:{"*":{action_:"copy"}}}),actions:{}},o:{transitions:d.createTransitions({empty:{"*":{}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"1",revisit:!0}},letters:{"*":{action_:"rm"}},"\\ca":{"*":{action_:{type_:"insert",option:"circa"}}},"\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"{text}"}},else2:{"*":{action_:"copy"}}}),actions:{}},text:{transitions:d.createTransitions({empty:{"*":{action_:"output"}},"{...}":{"*":{action_:"text="}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"\\greek":{"*":{action_:["output","rm"]}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:["output","copy"]}},else:{"*":{action_:"text="}}}),actions:{output:function(a){if(a.text_){var b={type_:"text",p1:a.text_};for(var c in a)delete a[c];return b}}}},pq:{transitions:d.createTransitions({empty:{"*":{}},"state of aggregation $":{"*":{action_:"state of aggregation"}},i$:{0:{nextState:"!f",revisit:!0}},"(KV letters),":{0:{action_:"rm",nextState:"0"}},formula$:{0:{nextState:"f",revisit:!0}},"1/2$":{0:{action_:"1/2"}},else:{0:{nextState:"!f",revisit:!0}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"text"}},"a-z":{f:{action_:"tex-math"}},letters:{"*":{action_:"rm"}},"-9.,9":{"*":{action_:"9,9"}},",":{"*":{action_:{type_:"insert+p1",option:"comma enumeration S"}}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:"color-output"}},"\\color{(...)}0":{"*":{action_:"color0-output"}},"\\ce{(...)}":{"*":{action_:"ce"}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},else2:{"*":{action_:"copy"}}}),actions:{"state of aggregation":function(a,b){return{type_:"state of aggregation subscript",p1:d.go(b,"o")}},"color-output":function(a,b){return{type_:"color",color1:b[0],color2:d.go(b[1],"pq")}}}},bd:{transitions:d.createTransitions({empty:{"*":{}},x$:{0:{nextState:"!f",revisit:!0}},formula$:{0:{nextState:"f",revisit:!0}},else:{0:{nextState:"!f",revisit:!0}},"-9.,9 no missing 0":{"*":{action_:"9,9"}},".":{"*":{action_:{type_:"insert",option:"electron dot"}}},"a-z":{f:{action_:"tex-math"}},x:{"*":{action_:{type_:"insert",option:"KV x"}}},letters:{"*":{action_:"rm"}},"'":{"*":{action_:{type_:"insert",option:"prime"}}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},"{(...)}":{"*":{action_:"text"}},"\\color{(...)}{(...)}1|\\color(...){(...)}2":{"*":{action_:"color-output"}},"\\color{(...)}0":{"*":{action_:"color0-output"}},"\\ce{(...)}":{"*":{action_:"ce"}},"\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"copy"}},else2:{"*":{action_:"copy"}}}),actions:{"color-output":function(a,b){return{type_:"color",color1:b[0],color2:d.go(b[1],"bd")}}}},oxidation:{transitions:d.createTransitions({empty:{"*":{}},"roman numeral":{"*":{action_:"roman-numeral"}},"${(...)}$|$(...)$":{"*":{action_:"tex-math"}},else:{"*":{action_:"copy"}}}),actions:{"roman-numeral":function(a,b){return{type_:"roman numeral",p1:b||""}}}},"tex-math":{transitions:d.createTransitions({empty:{"*":{action_:"output"}},"\\ce{(...)}":{"*":{action_:["output","ce"]}},"{...}|\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"o="}},else:{"*":{action_:"o="}}}),actions:{output:function(a){if(a.o){var b={type_:"tex-math",p1:a.o};for(var c in a)delete a[c];return b}}}},"tex-math tight":{transitions:d.createTransitions({empty:{"*":{action_:"output"}},"\\ce{(...)}":{"*":{action_:["output","ce"]}},"{...}|\\,|\\x{}{}|\\x{}|\\x":{"*":{action_:"o="}},"-|+":{"*":{action_:"tight operator"}},else:{"*":{action_:"o="}}}),actions:{"tight operator":function(a,b){a.o=(a.o||"")+"{"+b+"}"},output:function(a){if(a.o){var b={type_:"tex-math",p1:a.o};for(var c in a)delete a[c];return b}}}},"9,9":{transitions:d.createTransitions({empty:{"*":{}},",":{"*":{action_:"comma"}},else:{"*":{action_:"copy"}}}),actions:{comma:function(){return{type_:"commaDecimal"}}}},pu:{transitions:d.createTransitions({empty:{"*":{action_:"output"}},space$:{"*":{action_:["output","space"]}},"{[(|)]}":{"0|a":{action_:"copy"}},"(-)(9)^(-9)":{0:{action_:"number^",nextState:"a"}},"(-)(9.,9)(e)(99)":{0:{action_:"enumber",nextState:"a"}},space:{"0|a":{}},"pm-operator":{"0|a":{action_:{type_:"operator",option:"\\pm"},nextState:"0"}},operator:{"0|a":{action_:"copy",nextState:"0"}},"//":{d:{action_:"o=",nextState:"/"}},"/":{d:{action_:"o=",nextState:"/"}},"{...}|else":{"0|d":{action_:"d=",nextState:"d"},a:{action_:["space","d="],nextState:"d"},"/|q":{action_:"q=",nextState:"q"}}}),actions:{enumber:function(a,b){var c=[];return"+-"===b[0]||"+/-"===b[0]?c.push("\\pm "):b[0]&&c.push(b[0]),b[1]&&(d.concatArray(c,d.go(b[1],"pu-9,9")),b[2]&&(b[2].match(/[,.]/)?d.concatArray(c,d.go(b[2],"pu-9,9")):c.push(b[2])),b[3]=b[4]||b[3],b[3]&&(b[3]=b[3].trim(),"e"===b[3]||"*"===b[3].substr(0,1)?c.push({type_:"cdot"}):c.push({type_:"times"}))),b[3]&&c.push("10^{"+b[5]+"}"),c},"number^":function(a,b){var c=[];return"+-"===b[0]||"+/-"===b[0]?c.push("\\pm "):b[0]&&c.push(b[0]),d.concatArray(c,d.go(b[1],"pu-9,9")),c.push("^{"+b[2]+"}"),c},operator:function(a,b,c){return{type_:"operator",kind_:c||b}},space:function(){return{type_:"pu-space-1"}},output:function(a){var b,c=d.patterns.match_("{(...)}",a.d||"");c&&""===c.remainder&&(a.d=c.match_);var e=d.patterns.match_("{(...)}",a.q||"");if(e&&""===e.remainder&&(a.q=e.match_),a.d&&(a.d=a.d.replace(/\u00B0C|\^oC|\^{o}C/g,"{}^{\\circ}C"),a.d=a.d.replace(/\u00B0F|\^oF|\^{o}F/g,"{}^{\\circ}F")),a.q){a.q=a.q.replace(/\u00B0C|\^oC|\^{o}C/g,"{}^{\\circ}C"),a.q=a.q.replace(/\u00B0F|\^oF|\^{o}F/g,"{}^{\\circ}F");var f={d:d.go(a.d,"pu"),q:d.go(a.q,"pu")};"//"===a.o?b={type_:"pu-frac",p1:f.d,p2:f.q}:(b=f.d,f.d.length>1||f.q.length>1?b.push({type_:" / "}):b.push({type_:"/"}),d.concatArray(b,f.q))}else b=d.go(a.d,"pu-2");for(var g in a)delete a[g];return b}}},"pu-2":{transitions:d.createTransitions({empty:{"*":{action_:"output"}},"*":{"*":{action_:["output","cdot"],nextState:"0"}},"\\x":{"*":{action_:"rm="}},space:{"*":{action_:["output","space"],nextState:"0"}},"^{(...)}|^(-1)":{1:{action_:"^(-1)"}},"-9.,9":{0:{action_:"rm=",nextState:"0"},1:{action_:"^(-1)",nextState:"0"}},"{...}|else":{"*":{action_:"rm=",nextState:"1"}}}),actions:{cdot:function(){return{type_:"tight cdot"}},"^(-1)":function(a,b){a.rm+="^{"+b+"}"},space:function(){return{type_:"pu-space-2"}},output:function(a){var b=[];if(a.rm){var c=d.patterns.match_("{(...)}",a.rm||"");b=c&&""===c.remainder?d.go(c.match_,"pu"):{type_:"rm",p1:a.rm}}for(var e in a)delete a[e];return b}}},"pu-9,9":{transitions:d.createTransitions({empty:{0:{action_:"output-0"},o:{action_:"output-o"}},",":{0:{action_:["output-0","comma"],nextState:"o"}},".":{0:{action_:["output-0","copy"],nextState:"o"}},else:{"*":{action_:"text="}}}),actions:{comma:function(){return{type_:"commaDecimal"}},"output-0":function(a){var b=[];if(a.text_=a.text_||"",a.text_.length>4){var c=a.text_.length%3;0===c&&(c=3);for(var d=a.text_.length-3;d>0;d-=3)b.push(a.text_.substr(d,3)),b.push({type_:"1000 separator"});b.push(a.text_.substr(0,c)),b.reverse()}else b.push(a.text_);for(var e in a)delete a[e];return b},"output-o":function(a){var b=[];if(a.text_=a.text_||"",a.text_.length>4){for(var c=a.text_.length-3,d=0;d<c;d+=3)b.push(a.text_.substr(d,3)),b.push({type_:"1000 separator"});b.push(a.text_.substr(d))}else b.push(a.text_);for(var e in a)delete a[e];return b}}}};var e={go:function(a,b){if(!a)return"";for(var c="",d=!1,f=0;f<a.length;f++){var g=a[f];"string"==typeof g?c+=g:(c+=e._go2(g),"1st-level escape"===g.type_&&(d=!0))}return b||d||!c||(c="{"+c+"}"),c},_goInner:function(a){return a?e.go(a,!0):a},_go2:function(a){var b;switch(a.type_){case"chemfive":b="";var c={a:e._goInner(a.a),b:e._goInner(a.b),p:e._goInner(a.p),o:e._goInner(a.o),q:e._goInner(a.q),d:e._goInner(a.d)};c.a&&(c.a.match(/^[+\-]/)&&(c.a="{"+c.a+"}"),b+=c.a+"\\,"),(c.b||c.p)&&(b+="{\\vphantom{X}}",b+="^{\\hphantom{"+(c.b||"")+"}}_{\\hphantom{"+(c.p||"")+"}}",b+="{\\vphantom{X}}",b+="^{\\smash[t]{\\vphantom{2}}\\mathllap{"+(c.b||"")+"}}",b+="_{\\vphantom{2}\\mathllap{\\smash[t]{"+(c.p||"")+"}}}"),c.o&&(c.o.match(/^[+\-]/)&&(c.o="{"+c.o+"}"),b+=c.o),"kv"===a.dType?((c.d||c.q)&&(b+="{\\vphantom{X}}"),c.d&&(b+="^{"+c.d+"}"),c.q&&(b+="_{\\smash[t]{"+c.q+"}}")):"oxidation"===a.dType?(c.d&&(b+="{\\vphantom{X}}",b+="^{"+c.d+"}"),c.q&&(b+="{\\vphantom{X}}",b+="_{\\smash[t]{"+c.q+"}}")):(c.q&&(b+="{\\vphantom{X}}",b+="_{\\smash[t]{"+c.q+"}}"),c.d&&(b+="{\\vphantom{X}}",b+="^{"+c.d+"}"));break;case"rm":case"roman numeral":b="\\mathrm{"+a.p1+"}";break;case"text":a.p1.match(/[\^_]/)?(a.p1=a.p1.replace(" ","~").replace("-","\\text{-}"),b="\\mathrm{"+a.p1+"}"):b="\\text{"+a.p1+"}";break;case"state of aggregation":b="\\mskip2mu "+e._goInner(a.p1);break;case"state of aggregation subscript":b="\\mskip1mu "+e._goInner(a.p1);break;case"bond":if(!(b=e._getBond(a.kind_)))throw["MhchemErrorBond","mhchem Error. Unknown bond type ("+a.kind_+")"];break;case"frac":var d="\\frac{"+a.p1+"}{"+a.p2+"}";b="\\mathchoice{\\textstyle"+d+"}{"+d+"}{"+d+"}{"+d+"}";break;case"pu-frac":var f="\\frac{"+e._goInner(a.p1)+"}{"+e._goInner(a.p2)+"}";b="\\mathchoice{\\textstyle"+f+"}{"+f+"}{"+f+"}{"+f+"}";break;case"tex-math":case"1st-level escape":b=a.p1+" ";break;case"frac-ce":b="\\frac{"+e._goInner(a.p1)+"}{"+e._goInner(a.p2)+"}";break;case"overset":b="\\overset{"+e._goInner(a.p1)+"}{"+e._goInner(a.p2)+"}";break;case"underset":b="\\underset{"+e._goInner(a.p1)+"}{"+e._goInner(a.p2)+"}";break;case"underbrace":b="\\underbrace{"+e._goInner(a.p1)+"}_{"+e._goInner(a.p2)+"}";break;case"color":b="{\\color{"+a.color1+"}{"+e._goInner(a.color2)+"}}";break;case"color0":b="\\color{"+a.color+"}";break;case"arrow":var g={rd:e._goInner(a.rd),rq:e._goInner(a.rq)},h="\\x"+e._getArrow(a.r);g.rq&&(h+="[{"+g.rq+"}]"),g.rd?h+="{"+g.rd+"}":h+="{}",b=h;break;case"operator":b=e._getOperator(a.kind_);break;case"space":b=" ";break;case"entitySkip":case"pu-space-1":b="~";break;case"pu-space-2":b="\\mkern3mu ";break;case"1000 separator":b="\\mkern2mu ";break;case"commaDecimal":b="{,}";break;case"comma enumeration L":b="{"+a.p1+"}\\mkern6mu ";break;case"comma enumeration M":b="{"+a.p1+"}\\mkern3mu ";break;case"comma enumeration S":b="{"+a.p1+"}\\mkern1mu ";break;case"hyphen":b="\\text{-}";break;case"addition compound":b="\\,{\\cdot}\\,";break;case"electron dot":b="\\mkern1mu \\bullet\\mkern1mu ";break;case"KV x":b="{\\times}";break;case"prime":b="\\prime ";break;case"cdot":b="\\cdot ";break;case"tight cdot":b="\\mkern1mu{\\cdot}\\mkern1mu ";break;case"times":b="\\times ";break;case"circa":b="{\\sim}";break;case"^":b="uparrow";break;case"v":b="downarrow";break;case"ellipsis":b="\\ldots ";break;case"/":b="/";break;case" / ":b="\\,/\\,";break;default:throw["MhchemBugT","mhchem bug T. Please report."]}return b},_getArrow:function(a){switch(a){case"->":case"→":case"⟶":return"rightarrow";case"<-":return"leftarrow";case"<->":return"leftrightarrow";case"<-->":return"rightleftarrows";case"<=>":case"⇌":return"rightleftharpoons";case"<=>>":return"rightequilibrium";case"<<=>":return"leftequilibrium";default:throw["MhchemBugT","mhchem bug T. Please report."]}},_getBond:function(a){switch(a){case"-":case"1":return"{-}";case"=":case"2":return"{=}";case"#":case"3":return"{\\equiv}";case"~":return"{\\tripledash}";case"~-":return"{\\mathrlap{\\raisebox{-.1em}{$-$}}\\raisebox{.1em}{$\\tripledash$}}";case"~=":case"~--":return"{\\mathrlap{\\raisebox{-.2em}{$-$}}\\mathrlap{\\raisebox{.2em}{$\\tripledash$}}-}";case"-~-":return"{\\mathrlap{\\raisebox{-.2em}{$-$}}\\mathrlap{\\raisebox{.2em}{$-$}}\\tripledash}";case"...":return"{{\\cdot}{\\cdot}{\\cdot}}";case"....":return"{{\\cdot}{\\cdot}{\\cdot}{\\cdot}}";case"->":return"{\\rightarrow}";case"<-":return"{\\leftarrow}";case"<":return"{<}";case">":return"{>}";default:throw["MhchemBugT","mhchem bug T. Please report."]}},_getOperator:function(a){switch(a){case"+":return" {}+{} ";case"-":return" {}-{} ";case"=":return" {}={} ";case"<":return" {}<{} ";case">":return" {}>{} ";case"<<":return" {}\\ll{} ";case">>":return" {}\\gg{} ";case"\\pm":return" {}\\pm{} ";case"\\approx":case"$\\approx$":return" {}\\approx{} ";case"v":case"(v)":return" \\downarrow{} ";case"^":case"(^)":return" \\uparrow{} ";default:throw["MhchemBugT","mhchem bug T. Please report."]}}};a.s([])},860147,a=>{"use strict";a.i(471496),a.s([])},475077,a=>{"use strict";var b=a.i(471496);a.s(["Streamdown",()=>b.i])},15019,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/core");a.n(b),c()}catch(a){c(a)}},!0),696015,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/bash.mjs");a.n(b),c()}catch(a){c(a)}},!0),262306,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/css.mjs");a.n(b),c()}catch(a){c(a)}},!0),389883,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/go.mjs");a.n(b),c()}catch(a){c(a)}},!0),390515,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/html.mjs");a.n(b),c()}catch(a){c(a)}},!0),968490,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/java.mjs");a.n(b),c()}catch(a){c(a)}},!0),746093,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/javascript.mjs");a.n(b),c()}catch(a){c(a)}},!0),385265,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/json.mjs");a.n(b),c()}catch(a){c(a)}},!0),302887,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/jsx.mjs");a.n(b),c()}catch(a){c(a)}},!0),920541,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/markdown.mjs");a.n(b),c()}catch(a){c(a)}},!0),729663,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/python.mjs");a.n(b),c()}catch(a){c(a)}},!0),945465,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/rust.mjs");a.n(b),c()}catch(a){c(a)}},!0),942292,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/shell.mjs");a.n(b),c()}catch(a){c(a)}},!0),364204,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/tsx.mjs");a.n(b),c()}catch(a){c(a)}},!0),657914,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/typescript.mjs");a.n(b),c()}catch(a){c(a)}},!0),90627,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/langs/yaml.mjs");a.n(b),c()}catch(a){c(a)}},!0),144514,a=>a.a(async(b,c)=>{try{let b=await a.y("shiki-804f1506437b366c/themes/github-dark.mjs");a.n(b),c()}catch(a){c(a)}},!0),238514,a=>a.a(async(b,c)=>{try{var d=a.i(15019),e=a.i(755991),f=a.i(696015),g=a.i(262306),h=a.i(389883),i=a.i(390515),j=a.i(968490),k=a.i(746093),l=a.i(385265),m=a.i(302887),n=a.i(920541),o=a.i(729663),p=a.i(945465),q=a.i(942292),r=a.i(364204),s=a.i(657914),t=a.i(90627),u=a.i(144514),v=b([d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u]);[d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u]=v.then?(await v)():v;let z=null,A=new Set(["typescript","javascript","tsx","jsx","python","rust","go","java","html","css","json","markdown","yaml","bash","shell","ts","js","py","md","yml","sh"]),B={ts:"typescript",js:"javascript",py:"python",md:"markdown",yml:"yaml",sh:"bash",zsh:"bash",fish:"bash"};function w(a){let b=a.toLowerCase().trim();return B[b]||b}function x(a){return`<pre class="shiki" style="background-color:#24292e;color:#e1e4e8"><code>${a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</code></pre>`}function y(a,b){let c=w(b);if(!A.has(w(c)))return{html:x(a),error:`Language "${b}" is not supported, showing as plain text`};try{return{html:(!z&&(z=(0,d.createHighlighterCoreSync)({themes:[u.default],langs:[s.default,k.default,r.default,m.default,o.default,p.default,h.default,j.default,i.default,g.default,l.default,n.default,t.default,f.default,q.default],engine:(0,e.createJavaScriptRegexEngine)()})),z).codeToHtml(a,{lang:c,theme:"github-dark"})}}catch(c){return console.warn(`[Shiki] Failed to highlight code with language "${b}":`,c),{html:x(a),error:c instanceof Error?c.message:"Unknown error during syntax highlighting"}}}a.s(["highlightCode",()=>y]),c()}catch(a){c(a)}},!1),272394,a=>{"use strict";var b=a.i(367146),c=a.i(730843),d=a.i(54797),e=a.i(366705);let f=(0,e.default)("unfold-horizontal",[["path",{d:"M16 12h6",key:"15xry1"}],["path",{d:"M8 12H2",key:"1jqql6"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 8v2",key:"1woqiv"}],["path",{d:"M12 14v2",key:"8jcxud"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m19 15 3-3-3-3",key:"wjy7rq"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}]]),g=(0,e.default)("text-wrap",[["path",{d:"m16 16-3 3 3 3",key:"117b85"}],["path",{d:"M3 12h14.5a1 1 0 0 1 0 7H13",key:"18xa6z"}],["path",{d:"M3 19h6",key:"1ygdsz"}],["path",{d:"M3 5h18",key:"1u36vt"}]]);var h=a.i(537500),i=a.i(539524);function j({code:a}){let[e,j]=(0,h.useState)(!1),[k,l]=(0,h.useState)(!1),m=async()=>{await navigator.clipboard.writeText(a),j(!0),setTimeout(()=>j(!1),2e3)};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-all duration-200",onClick:()=>l(!k),"aria-label":k?"Disable line wrapping":"Enable line wrapping",children:k?(0,b.jsx)(g,{className:"w-3 h-3"}):(0,b.jsx)(f,{className:"w-3 h-3"})}),(0,b.jsx)(i.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-all duration-200",onClick:m,"aria-label":"Copy code",children:e?(0,b.jsx)(c.Check,{className:"w-3 h-3 text-primary"}):(0,b.jsx)(d.Copy,{className:"w-3 h-3"})})]})}a.s(["ClientCodeControls",()=>j],272394)},529277,a=>a.a(async(b,c)=>{try{var d=a.i(367146),e=a.i(537500),f=a.i(238514),g=a.i(700760),h=a.i(272394),i=b([f]);function j({code:a,language:b,inline:c}){var i;let[j,k]=(0,e.useState)(null),l=(0,e.useRef)(a),m=(0,e.useRef)(b);if(c)return(0,d.jsx)("code",{className:(0,g.cn)("px-1.5 py-0.5 rounded text-sm font-mono","bg-muted/80 text-foreground","border border-border/20","dark:bg-gradient-to-br dark:from-[oklch(28%_0.03_260)] dark:to-[oklch(25%_0.02_260)]","dark:text-[oklch(88%_0.02_260)]","dark:border-[oklch(35%_0.04_260)]","dark:shadow-[inset_0_1px_0_oklch(40%_0.02_260_/_0.15),_0_1px_2px_oklch(0%_0_0_/_0.2)]","hover:bg-muted dark:hover:from-[oklch(30%_0.03_260)] dark:hover:to-[oklch(27%_0.02_260)]","transition-colors"),children:a});(0,e.useEffect)(()=>{if(l.current===a&&m.current===b&&j)return;l.current=a,m.current=b;let c=()=>{let c=(0,f.highlightCode)(a,b||"text");k(c)};if("requestIdleCallback"in window){let a=requestIdleCallback(c);return()=>cancelIdleCallback(a)}{let a=setTimeout(c,1);return()=>clearTimeout(a)}},[a,b,j]);let n=j?.html||(i=a,`<pre class="shiki" style="background-color:#24292e;color:#e1e4e8"><code>${i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</code></pre>`);return(0,d.jsxs)("div",{className:"relative group my-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between bg-muted/50 px-4 py-2 rounded-t border-b border-border",children:[(0,d.jsx)("span",{className:"text-xs text-muted-foreground font-mono",children:b||"code"}),(0,d.jsx)("div",{className:"flex gap-2",children:(0,d.jsx)(h.ClientCodeControls,{code:a})})]}),(0,d.jsx)("div",{className:"relative",children:(0,d.jsx)("div",{className:(0,g.cn)("rounded-b overflow-x-auto max-h-[600px] overflow-y-auto w-full","[&>pre]:m-0 [&>pre]:p-4 [&>pre]:w-full [&>pre]:overflow-x-auto"),dangerouslySetInnerHTML:{__html:n}})})]})}[f]=i.then?(await i)():i,a.s(["CodeBlock",()=>j]),c()}catch(a){c(a)}},!1),55161,a=>{"use strict";var b=a.i(367146),c=a.i(537500),d=a.i(638600);class e extends c.Component{constructor(a){super(a),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(a,b){console.warn("[MathBlock] Render error caught by boundary:",a,b),d.analytics.track("math_error",{error:a.message,latexSnippet:this.props.latex?.slice(0,100)||"",isStreaming:!1}),d.analytics.captureException(a,{severity:"warning",context:"math_rendering",componentStack:b.componentStack??void 0,latexSnippet:this.props.latex?.slice(0,100)||""})}render(){return this.state.hasError?(0,b.jsxs)("div",{className:"math-error-fallback rounded-lg border border-destructive/50 bg-destructive/10 p-4 my-2",children:[(0,b.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,b.jsx)("span",{className:"text-sm font-medium text-destructive",children:"Math Rendering Error"})}),this.props.latex&&(0,b.jsx)("pre",{className:"text-xs font-mono bg-background/50 p-2 rounded overflow-x-auto",children:this.props.latex})]}):this.props.children}}a.s(["MathErrorBoundary",()=>e])},933317,a=>{"use strict";var b=a.i(367146),c=a.i(537500),d=a.i(700760);let e=(0,c.forwardRef)(({isDisplay:a=!1,className:c},e)=>a?(0,b.jsx)("div",{ref:e,className:(0,d.cn)("animate-pulse rounded-lg bg-gradient-to-r from-muted/50 to-muted/30","h-20 w-full",c),role:"status","aria-label":"Loading mathematical equation",children:(0,b.jsx)("span",{className:"sr-only",children:"Loading equation..."})}):(0,b.jsx)("span",{ref:e,className:(0,d.cn)("inline-block animate-pulse rounded bg-gradient-to-r from-muted/50 to-muted/30","h-[1.5em] w-16",c),role:"status","aria-label":"Loading mathematical expression",children:(0,b.jsx)("span",{className:"sr-only",children:"Loading expression..."})}));e.displayName="MathSkeleton",a.s(["MathSkeleton",0,e])},282002,a=>{"use strict";var b=a.i(367146),c=a.i(54797),d=a.i(789884),e=a.i(367303);let f=(0,a.i(366705).default)("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]);var g=a.i(489157),h=a.i(537500),i=a.i(700760);let j=null,k=!1;async function l(){return j||(j=await a.A(35278)),j.default}function m({code:a,config:j}){let m=(0,h.useRef)(null),[n,o]=(0,h.useState)(""),[p,q]=(0,h.useState)(null),[r,s]=(0,h.useState)(!0),[t,u]=(0,h.useState)(!1),[v,w]=(0,h.useState)(!1),{theme:x,resolvedTheme:y}=(0,g.useTheme)(),z="dark"===y||"system"===x&&"dark"===y;(0,h.useEffect)(()=>{(async()=>{let a=await l();k||(a.initialize({startOnLoad:!1,theme:j?.theme||"base",themeVariables:j?.themeVariables||{},flowchart:j?.flowchart||{nodeSpacing:50,rankSpacing:50,curve:"basis"},sequence:j?.sequence||{actorMargin:50,boxMargin:10,boxTextMargin:5,diagramMarginX:50,diagramMarginY:10,messageMargin:35},state:j?.state||{titleTopMargin:25}}),k=!0)})()},[j]),(0,h.useEffect)(()=>{let b=async()=>{try{q(null),s(!0);let b=await l();b.initialize({startOnLoad:!1,theme:"base",themeVariables:{...z?{primaryColor:"#d4a574",primaryTextColor:"#e8dfd4",primaryBorderColor:"#e89f5f",lineColor:"#b8b8b8",secondaryColor:"#3d3d3d",tertiaryColor:"#e89f5f",background:"#1a1a1a",mainBkg:"#2d2d2d",secondBkg:"#3d3d3d",textColor:"#e8dfd4",nodeBorder:"#d4a574",clusterBkg:"#2d2d2d",clusterBorder:"#b88a5f",edgeLabelBackground:"#2d2d2d"}:{primaryColor:"#d4a574",primaryTextColor:"#2d2d2d",primaryBorderColor:"#b88a5f",lineColor:"#8b8b8b",secondaryColor:"#e8dfd4",tertiaryColor:"#e89f5f",background:"#f0ebe5",mainBkg:"#fdfcfb",secondBkg:"#e8dfd4",textColor:"#2d2d2d"},...j?.themeVariables},flowchart:j?.flowchart||{nodeSpacing:50,rankSpacing:50,curve:"basis"},sequence:j?.sequence||{actorMargin:50,boxMargin:10,boxTextMargin:5,diagramMarginX:50,diagramMarginY:10,messageMargin:35},state:j?.state||{titleTopMargin:25}});let c=`mermaid-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,{svg:d}=await b.render(c,a);o(d)}catch(a){console.error("[MermaidRenderer] Render error:",a),q(a instanceof Error?a.message:"Failed to render diagram")}finally{s(!1)}};a&&b()},[a,z,j]);let A=async()=>{try{await navigator.clipboard.writeText(a),w(!0),setTimeout(()=>w(!1),2e3)}catch(a){console.error("[MermaidRenderer] Copy failed:",a)}};return((0,h.useEffect)(()=>{let a=()=>{u(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",a),()=>document.removeEventListener("fullscreenchange",a)},[]),p)?(0,b.jsxs)("div",{className:"my-4 rounded border border-destructive/50 bg-destructive/10 p-4",children:[(0,b.jsx)("div",{className:"flex items-center gap-2 text-sm font-medium text-destructive mb-2",children:(0,b.jsx)("span",{children:"Mermaid Diagram Error"})}),(0,b.jsx)("pre",{className:"text-xs text-muted-foreground overflow-x-auto",children:p}),(0,b.jsxs)("details",{className:"mt-2",children:[(0,b.jsx)("summary",{className:"text-xs text-muted-foreground cursor-pointer hover:text-foreground",children:"Show diagram code"}),(0,b.jsx)("pre",{className:"mt-2 text-xs text-muted-foreground overflow-x-auto bg-muted/50 p-2 rounded",children:a})]})]}):(0,b.jsxs)("div",{ref:m,className:(0,i.cn)("relative group my-4 rounded border border-border bg-card",t&&"bg-background p-8"),children:[(0,b.jsxs)("div",{className:(0,i.cn)("absolute top-2 right-2 z-10 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",t&&"opacity-100"),children:[(0,b.jsx)("button",{type:"button",onClick:A,className:"p-1.5 rounded bg-background/90 hover:bg-background border border-border text-muted-foreground hover:text-foreground transition-colors",title:v?"Copied!":"Copy code",children:(0,b.jsx)(c.Copy,{className:"w-4 h-4"})}),(0,b.jsx)("button",{type:"button",onClick:()=>{if(!n)return;let a=new Blob([n],{type:"image/svg+xml"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download=`diagram-${Date.now()}.svg`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(b)},className:"p-1.5 rounded bg-background/90 hover:bg-background border border-border text-muted-foreground hover:text-foreground transition-colors",title:"Download as SVG",children:(0,b.jsx)(d.Download,{className:"w-4 h-4"})}),(0,b.jsx)("button",{type:"button",onClick:()=>{t?(document.exitFullscreen?.(),u(!1)):(m.current?.requestFullscreen?.(),u(!0))},className:"p-1.5 rounded bg-background/90 hover:bg-background border border-border text-muted-foreground hover:text-foreground transition-colors",title:t?"Exit fullscreen":"Fullscreen",children:t?(0,b.jsx)(f,{className:"w-4 h-4"}):(0,b.jsx)(e.Maximize2,{className:"w-4 h-4"})})]}),(0,b.jsx)("div",{className:(0,i.cn)("flex items-center justify-center p-6 overflow-auto min-h-[100px]",t&&"h-full"),children:r?(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[(0,b.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Loading diagram..."]}):(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:n}})})]})}a.s(["MermaidRenderer",()=>m],282002)},165298,a=>a.a(async(b,c)=>{try{var d=a.i(367146),e=a.i(264590),f=a.i(992234),g=a.i(255663),h=a.i(726800),i=a.i(700760);a.i(287544);var j=a.i(537500);a.i(860147);var k=a.i(475077),l=a.i(529277),m=a.i(55161),n=a.i(933317),o=a.i(282002),p=b([l]);[l]=p.then?(await p)():p;class r extends j.Component{constructor(a){super(a),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(a,b){console.warn("[CodeBlock] Render error caught by boundary:",a,b)}render(){return this.state.hasError?(0,d.jsxs)("div",{className:"relative group my-4",children:[(0,d.jsx)("div",{className:"flex items-center justify-between bg-muted/50 px-4 py-2 rounded-t border-b border-border",children:(0,d.jsx)("span",{className:"text-xs text-muted-foreground font-mono",children:this.props.language||"code"})}),(0,d.jsx)("pre",{className:"rounded-b overflow-x-auto max-h-[600px] overflow-y-auto w-full p-4 bg-[#24292e] text-[#e1e4e8]",children:(0,d.jsx)("code",{children:this.props.code})})]}):this.props.children}}function q({content:a,isStreaming:b=!1}){var c;let p=(0,j.useRef)(null),q=(c=!a.includes("\\(")&&!a.includes("\\[")?a:a.split(/(`{3}[\s\S]*?`{3}|`[^`\n]+`)/).map(a=>{if(a.startsWith("`"))return a;let b=a.replace(/\\\(([^)]*?)\\\)/g,"$$$$$1$$$$");return b=b.replace(/\\\[([^\]]*?)\\\]/g,"\n$$$$$1$$\n")}).join("")).includes("[")?c.split(/(`{3}[\s\S]*?`{3}|`[^`\n]+`)/).map(a=>a.startsWith("`")?a:a.replace(/\[(\d+)\]/g,"[$1](#source-$1)")).join(""):c,{displayContent:s,hasBufferedContent:t}=(0,h.useStreamBuffer)(q,b,{charsPerSecond:200,minTokenSize:3,adaptiveThreshold:5e3}),{observeRef:u,isRendered:v,isMobile:w}=(0,e.useLazyMathRenderer)({threshold:.01,rootMargin:"50px 0px",mobileOnly:!0});(0,g.useMathCopyButtons)(p),(0,f.useMathAccessibility)(p,b);let x=b||t,y=s.includes("$$")||s.includes("\\(");return w&&y&&!v?(0,d.jsx)("div",{ref:u,className:"markdown-content prose",children:(0,d.jsx)(n.MathSkeleton,{isDisplay:!0})}):(0,d.jsxs)("div",{ref:p,className:(0,i.cn)("markdown-content prose",x&&"streaming"),children:[(0,d.jsx)(m.MathErrorBoundary,{children:(0,d.jsx)(k.Streamdown,{components:{code:({className:a,children:b,...c})=>{let e=/language-(\w+)/.exec(a||""),f=e?.[1],g=String(b).replace(/\n$/,"");return"mermaid"===f?(0,d.jsx)(o.MermaidRenderer,{code:g,config:{flowchart:{nodeSpacing:50,rankSpacing:50,curve:"basis"},sequence:{actorMargin:50,boxMargin:10,boxTextMargin:5,diagramMarginX:50,diagramMarginY:10,messageMargin:35},state:{titleTopMargin:25}}}):e||a?(0,d.jsx)(r,{code:g,language:f,children:(0,d.jsx)(l.CodeBlock,{code:g,language:f})}):(0,d.jsx)(l.CodeBlock,{code:g,inline:!0})},img:({src:a,alt:b,...c})=>(0,d.jsx)("img",{src:a,alt:b||"Image",className:"rounded-lg max-w-full h-auto my-4 block",style:{maxHeight:"600px",backgroundColor:"#fff"},loading:"lazy",onError:b=>{console.error("[Markdown] Image failed to load:",a),b.target.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='100'%3E%3Crect fill='%23f0f0f0' width='200' height='100'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%23666'%3EImage failed to load%3C/text%3E%3C/svg%3E"},...c}),a:({href:a,children:b,...c})=>a?.startsWith("#source-")?(0,d.jsx)("a",{href:a,className:"citation-link",onClick:b=>{b.preventDefault();let c=document.querySelector(a);c&&c.scrollIntoView({behavior:"smooth",block:"center"})},...c,children:b}):(0,d.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",...c,children:b})},parseIncompleteMarkdown:b,controls:{code:!1,mermaid:!1},children:s})}),x&&(0,d.jsx)("span",{className:"streaming-cursor","aria-hidden":"true"})]})}a.s(["MarkdownContent",()=>q]),c()}catch(a){c(a)}},!1),401517,a=>{"use strict";var b=a.i(367146),c=a.i(130487);a.i(16243);var d=a.i(182234),e=a.i(354420),f=a.i(529395),g=a.i(954439),h=a.i(473479),i=a.i(23944),j=a.i(537500),k=a.i(539524),l=a.i(349977),m=a.i(638600);function n({recommendation:a,conversationId:n,onSwitch:o,onPreview:p}){let q=(0,d.useMutation)(c.api.conversations.dismissModelRecommendation),r=(0,d.useMutation)(c.api.users.updatePreferences);if((0,j.useEffect)(()=>{m.analytics.track("recommendation_shown",{conversationId:n,currentModel:a.currentModelId,suggestedModel:a.suggestedModelId,percentSaved:a.estimatedSavings.percentSaved,timestamp:Date.now()})},[n,a]),a.dismissed)return null;let s=l.MODEL_CONFIG[a.suggestedModelId];if(!s)return null;let t=async()=>{m.analytics.track("recommendation_accepted",{conversationId:n,from:a.currentModelId,to:a.suggestedModelId,savings:a.estimatedSavings.percentSaved,viaPreview:!1,timestamp:Date.now()}),o(a.suggestedModelId),q({conversationId:n});try{await r({preferences:{newChatModelSelection:"fixed",defaultModel:a.suggestedModelId}})}catch(a){console.error("[ModelRecommendationBanner] Failed to update global preference:",a)}window.dispatchEvent(new CustomEvent("focus-chat-input"))};return(0,b.jsx)(e.AnimatePresence,{children:(0,b.jsx)(f.motion.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3,ease:"easeOut"},className:"mx-auto mb-4 max-w-3xl rounded-xl border border-border bg-card p-6 shadow-sm",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"rounded-full bg-blue-500/10 p-2",children:(0,b.jsx)(h.Lightbulb,{className:"h-5 w-5 text-blue-500"})}),(0,b.jsx)("h3",{className:"font-semibold",children:"Model Recommendation"})]}),(0,b.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:()=>{m.analytics.track("recommendation_dismissed",{conversationId:n,currentModel:a.currentModelId,suggestedModel:a.suggestedModelId,secondsVisible:(Date.now()-a.createdAt)/1e3,timestamp:Date.now()}),q({conversationId:n})},className:"h-8 w-8",children:(0,b.jsx)(i.X,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-base leading-relaxed",children:a.reasoning}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.estimatedSavings.costReduction}),(0,b.jsxs)("span",{className:"text-xs font-semibold text-green-500",children:[a.estimatedSavings.percentSaved,"% less"]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,b.jsxs)(k.Button,{variant:"outline",onClick:()=>{m.analytics.track("recommendation_preview_clicked",{conversationId:n,currentModel:a.currentModelId,suggestedModel:a.suggestedModelId,timestamp:Date.now()}),p(a.suggestedModelId)},className:"flex-1 justify-center border-border/60 hover:border-border",children:[(0,b.jsx)(g.Eye,{className:"h-4 w-4 mr-2"}),"Preview Comparison"]}),(0,b.jsxs)(k.Button,{onClick:t,className:"flex-1 justify-center bg-primary/90 hover:bg-primary text-primary-foreground",children:["Switch to ",s.name]})]})]})})})}a.s(["ModelRecommendationBanner",()=>n])},133231,a=>{"use strict";var b=a.i(367146),c=a.i(537500),d=a.i(753884);function e(a,b,c){return Math.min(Math.max(a,b),c)}var f=a.i(638600),g=a.i(737888);let h=(0,c.createContext)(null);function i({children:a,defaultSpeed:i=1}){let[j,k]=(0,c.useState)({isVisible:!1,isLoading:!1,isPlaying:!1,duration:0,currentTime:0,speed:e(i??1,.5,2),sourceMessageId:void 0,previewText:"",totalChunks:0,currentChunk:0,isStreaming:!1}),l=function(a={}){let{defaultSpeed:b=1,onTimeUpdate:d,onEnded:f,onError:g}=a,h=(0,c.useRef)(null),i=(0,c.useRef)(null),j=(0,c.useRef)(null),k=(0,c.useRef)([]),l=(0,c.useRef)(!1),m=(0,c.useRef)(null),n=(0,c.useRef)(e(b,.5,2)),o=(0,c.useRef)(null),p=(0,c.useCallback)(()=>{if(!j.current||j.current.updating||0===k.current.length)return;let a=k.current.shift();if(a)try{j.current.appendBuffer(a)}catch(a){console.error("MSE appendBuffer failed",a)}},[]),q=(0,c.useCallback)(()=>{if(h.current&&(h.current.pause(),h.current.removeAttribute("src"),h.current.load()),m.current&&(URL.revokeObjectURL(m.current),m.current=null),i.current){try{"open"===i.current.readyState&&i.current.endOfStream()}catch(a){}i.current=null}j.current=null,k.current=[],l.current=!1,o.current&&(o.current.abort(),o.current=null)},[]),r=(0,c.useCallback)(async()=>{q(),o.current=new AbortController;let a=new MediaSource;i.current=a;let b=URL.createObjectURL(a);m.current=b;let c=new Audio;return c.src=b,h.current=c,c.playbackRate=n.current,"preservesPitch"in c&&(c.preservesPitch=!0),c.ontimeupdate=()=>{d?.(c.currentTime,c.duration)},c.onended=()=>{f?.()},c.onerror=a=>{console.error("Audio error",a),"string"!=typeof a&&a instanceof Event&&g?.(a)},await new Promise(b=>{a.addEventListener("sourceopen",()=>{try{let c=a.addSourceBuffer("audio/mpeg");j.current=c,c.addEventListener("updateend",()=>{p()}),b()}catch(a){console.error("MSE addSourceBuffer failed",a),b()}},{once:!0})}),j.current?c:null},[q,p,d,f,g]),s=(0,c.useCallback)(a=>{k.current.push(a),p()},[p]),t=(0,c.useCallback)(()=>{let a=setInterval(()=>{if(o.current?.signal.aborted)return void clearInterval(a);if(0===k.current.length&&j.current&&!j.current.updating){if(i.current&&"open"===i.current.readyState)try{i.current.endOfStream()}catch(a){}clearInterval(a)}},500)},[]),u=(0,c.useCallback)(async()=>{h.current&&await h.current.play()},[]),v=(0,c.useCallback)(()=>{h.current&&h.current.pause()},[]),w=(0,c.useCallback)(async()=>{h.current&&await h.current.play()},[]),x=(0,c.useCallback)(()=>{q()},[q]),y=(0,c.useCallback)(a=>{if(!h.current)return;let b=e((h.current.currentTime||0)+a,0,h.current.duration||1/0);Number.isFinite(b)&&(h.current.currentTime=b)},[]),z=(0,c.useCallback)(a=>{if(!h.current)return;let b=e(a,0,h.current.duration||1/0);Number.isFinite(b)&&(h.current.currentTime=b)},[]),A=(0,c.useCallback)(a=>{let b=e(a,.5,2);return n.current=b,h.current&&(h.current.playbackRate=b,"preservesPitch"in h.current&&(h.current.preservesPitch=!0)),b},[]);return{initializeAudio:r,appendBuffer:s,endStream:t,play:u,pause:v,resume:w,stop:x,seekBy:y,seekTo:z,setSpeed:A,cleanupAudio:q,getAbortSignal:(0,c.useCallback)(()=>o.current?.signal,[]),isAborted:(0,c.useCallback)(()=>o.current?.signal.aborted??!1,[]),speedRef:n}}({defaultSpeed:i,onTimeUpdate:(a,b)=>{k(c=>({...c,currentTime:a,duration:b}))},onEnded:()=>{k(a=>({...a,isPlaying:!1,isStreaming:!1})),f.analytics.track("tts_playback_completed",{playbackDurationMs:1e3*j.duration})},onError:a=>{console.error("Audio error",a)}});(0,c.useEffect)(()=>{let a=e(i??1,.5,2);l.setSpeed(a),k(b=>({...b,speed:a}))},[i,l.setSpeed]),(0,c.useEffect)(()=>()=>{l.cleanupAudio()},[l.cleanupAudio]);let m=(0,c.useCallback)(()=>{l.cleanupAudio(),k(a=>({...a,isVisible:!1,isPlaying:!1,isLoading:!1,currentTime:0,duration:0,sourceMessageId:void 0,previewText:"",totalChunks:0,currentChunk:0,isStreaming:!1}))},[l]),n=(0,c.useCallback)(async({text:a,messageId:b})=>{let c=function(a){let b=a??"";if(!b.trim())return"";try{let a=g.marked.parse(b),c="undefined"!=typeof document?document.createElement("div"):null;if(c)return c.innerHTML="string"==typeof a?a:String(a),(c.textContent||c.innerText||c.innerHTML).replace(/\s+/g," ").trim()}catch(a){console.error("Failed to strip markdown for TTS:",a)}return b.replace(/[`*_>#[\]()-]/g," ").replace(/\s+/g," ").trim()}(a);if(!c)return void d.toast.error("This message is empty after removing formatting.");let e=function(a,b=200){if(a.length<=b)return[a];let c=[],d=a;for(;d.length>0;){if(d.length<=b){c.push(d);break}let a=b,e=d.slice(0,b),f=Math.max(e.lastIndexOf(". "),e.lastIndexOf("! "),e.lastIndexOf("? "),e.lastIndexOf(".\n"),e.lastIndexOf("!\n"),e.lastIndexOf("?\n"));if(f>.3*b)a=f+1;else{let c=e.lastIndexOf(", ");if(c>.3*b)a=c+1;else{let c=e.lastIndexOf(" ");c>.3*b&&(a=c)}}c.push(d.slice(0,a).trim()),d=d.slice(a).trim()}return c.filter(a=>a.length>0)}(c),h=e.length;if(k(a=>({...a,isVisible:!0,isLoading:!0,isPlaying:!1,sourceMessageId:b,previewText:c.slice(0,220),currentTime:0,duration:0,totalChunks:h,currentChunk:0,isStreaming:h>1})),!await l.initializeAudio())return void d.toast.error("Browser does not support streaming audio playback.");try{await l.play(),k(a=>({...a,isPlaying:!0})),f.analytics.track("tts_initiated",{messageLength:c.length,voiceUsed:"default"});for(let a=0;a<e.length&&!l.isAborted();a++){k(b=>({...b,currentChunk:a+1}));let b=e[a],c=function(a,b,c){let d="https://intent-coyote-706.convex.cloud",e="",f=(e=d.includes(".convex.cloud")?d.replace(".convex.cloud",".convex.site"):d)?`${e}/tts`:"/tts",g=new URL(f,"http://localhost");return g.searchParams.set("text",a),b&&g.searchParams.set("voice",b),c&&g.searchParams.set("speed",c.toString()),g.toString()}(b,void 0,l.speedRef.current),d=await fetch(c,{signal:l.getAbortSignal()});if(!d.ok){console.error("TTS Fetch failed",d.status,d.statusText);continue}let f=await d.arrayBuffer();if(l.isAborted())break;l.appendBuffer(f),0===a&&k(a=>({...a,isLoading:!1}))}l.endStream(),k(a=>({...a,isLoading:!1}))}catch(a){if(l.isAborted())return;console.error("TTS error:",a),d.toast.error("Failed to stream audio"),l.cleanupAudio()}},[l]),o=(0,c.useCallback)(()=>{l.pause(),k(a=>({...a,isPlaying:!1}))},[l]),p=(0,c.useCallback)(async()=>{await l.resume(),k(a=>({...a,isPlaying:!0}))},[l]),q=(0,c.useCallback)(()=>{l.stop(),k(a=>({...a,isPlaying:!1,currentTime:0,currentChunk:0,isStreaming:!1}))},[l]),r=(0,c.useCallback)(a=>{l.seekBy(a)},[l]),s=(0,c.useCallback)(a=>{l.seekTo(a)},[l]),t=(0,c.useCallback)(a=>{let b=l.setSpeed(a);k(a=>({...a,speed:b}))},[l]);return(0,b.jsx)(h.Provider,{value:{state:j,playFromText:n,pause:o,resume:p,stop:q,seekBy:r,seekTo:s,setSpeed:t,close:m},children:a})}function j(){let a=(0,c.useContext)(h);if(!a)throw Error("useTTSPlayer must be used within TTSProvider");return a}a.s(["TTSProvider",()=>i,"useTTSPlayer",()=>j],133231)},899199,a=>{"use strict";var b=a.i(130487);a.i(16243);var c=a.i(182234),d=a.i(537500),e=a.i(753884);function f({messageId:a,conversationId:f,content:g,isFocused:h,isUser:i,isGenerating:j,readOnly:k,messageRef:l}){let m=(0,c.useMutation)(b.api.chat.deleteMessage),n=(0,c.useMutation)(b.api.bookmarks.create);(0,d.useEffect)(()=>{if(!h||k)return;let b=async b=>{let c=b.target;if("INPUT"===c.tagName||"TEXTAREA"===c.tagName||"true"===c.getAttribute("contenteditable"))return;let d=b.metaKey||b.ctrlKey;switch(b.key.toLowerCase()){case"r":if(!i&&!j&&!d){b.preventDefault();let c=new CustomEvent("open-regenerate-model-selector",{detail:{messageId:a}});window.dispatchEvent(c)}break;case"b":if(!d){b.preventDefault();try{await n({conversationId:f,messageId:a}),e.toast.success("Message bookmarked")}catch(a){e.toast.error("Failed to bookmark")}}break;case"c":d||(b.preventDefault(),await navigator.clipboard.writeText(g),e.toast.success("Copied to clipboard"));break;case"n":if(!d){b.preventDefault();let c=new CustomEvent("save-message-as-note",{detail:{messageId:a}});window.dispatchEvent(c)}break;case"delete":case"backspace":if(!d){b.preventDefault();try{await m({messageId:a});let b=l.current?.parentElement?.nextElementSibling?.querySelector('[tabindex="0"]');b?.focus(),e.toast.success("Message deleted")}catch(a){e.toast.error("Failed to delete")}}}};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[h,k,i,j,a,f,g,n,m,l])}a.s(["useMessageKeyboardShortcuts",()=>f])},126141,a=>{"use strict";function b(a){return a<100?`${Math.round(a)}ms`:a<1e3?`${(a/1e3).toFixed(2)}s`:a<1e4?`${(a/1e3).toFixed(1)}s`:`${Math.round(a/1e3)}s`}function c(a){if(a<1)return"<1ms";if(a<1e3)return`${Math.round(a)}ms`;let b=a/1e3;if(b<10)return`${b.toFixed(1)}s`;if(b<60)return`${Math.round(b)}s`;let c=Math.floor(b/60),d=Math.round(b%60);return 0===d?`${c}m`:`${c}m ${d}s`}function d(a){return a<50}a.s(["formatDuration",()=>c,"formatTTFT",()=>b,"isCachedResponse",()=>d])},227885,a=>{"use strict";let b=(0,a.i(366705).default)("file-code",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]]);a.s(["FileCode",()=>b],227885)},824477,a=>{"use strict";var b=a.i(367146),c=a.i(130487);a.i(16243);var d=a.i(182234),e=a.i(537500),f=a.i(700760),g=a.i(358176),h=a.i(227885),i=a.i(116245),j=a.i(609448);function k({documentId:a,title:c,documentType:d,language:e,version:k,lineCount:l,className:m}){let{documentId:n,setDocumentId:o}=(0,j.useCanvasContext)(),p=n===a,q="code"===d?h.FileCode:i.FileText;return(0,b.jsxs)("button",{type:"button",onClick:()=>{p?o(null):o(a)},className:(0,f.cn)("flex items-center gap-3 p-3 rounded-lg border bg-card","hover:bg-accent/50 transition-colors w-full max-w-sm text-left",p&&"ring-2 ring-primary/50 border-primary/50",m),children:[(0,b.jsx)("div",{className:(0,f.cn)("p-2 rounded-md","code"===d?"bg-blue-500/10":"bg-amber-500/10"),children:(0,b.jsx)(q,{className:(0,f.cn)("h-4 w-4","code"===d?"text-blue-500":"text-amber-500")})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"font-medium text-sm truncate",children:c}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-1.5",children:[(0,b.jsx)("span",{children:e??("code"===d?"Code":"Document")}),k&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-muted-foreground/50",children:"·"}),(0,b.jsxs)("span",{children:["v",k]})]}),l&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-muted-foreground/50",children:"·"}),(0,b.jsxs)("span",{children:[l," lines"]})]})]})]}),(0,b.jsx)(g.ChevronRight,{className:(0,f.cn)("h-4 w-4 text-muted-foreground transition-transform shrink-0",p&&"rotate-90")})]})}function l({messageId:a,className:g}){let h="string"==typeof a&&a.startsWith("temp-"),i=(0,d.useQuery)(c.api.messages.toolCalls.getToolCalls,h?"skip":{messageId:a}),j=(0,e.useMemo)(()=>i?i.filter(a=>{if(!["createDocument","updateDocument"].includes(a.name))return!1;try{let b=a.result?JSON.parse(a.result):null;return b?.success&&b?.documentId}catch{return!1}}).map(a=>{let b=a.arguments?JSON.parse(a.arguments):{},c=a.result?JSON.parse(a.result):{};return{id:a.id,toolName:a.name,documentId:c.documentId,title:b.title??"Document",documentType:b.documentType??"prose",language:b.language,version:c.newVersion??1,lineCount:c.lineCount}}):[],[i]);return 0===j.length?null:(0,b.jsx)("div",{className:(0,f.cn)("mt-3 flex flex-wrap gap-2",g),children:j.map(a=>(0,b.jsx)(k,{documentId:a.documentId,title:a.title,documentType:a.documentType,language:a.language,version:a.version,lineCount:a.lineCount},a.id))})}a.s(["ArtifactList",()=>l],824477)},833424,a=>{"use strict";var b=a.i(367146),c=a.i(537500),d=a.i(626283),e=a.i(931282),f=a.i(968177);function g({attachments:a}){return a&&0!==a.length?(0,b.jsx)("div",{className:"flex gap-2 mt-2 flex-wrap",children:a.map((a,c)=>(0,b.jsxs)(f.Badge,{variant:"secondary",className:"flex items-center gap-1.5 py-1 px-2",children:["image"===a.type?(0,b.jsx)(e.ImageIcon,{className:"w-3 h-3"}):(0,b.jsx)(d.FileIcon,{className:"w-3 h-3"}),(0,b.jsx)("span",{className:"text-xs truncate max-w-[120px]",children:a.name}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",(a.size/1024).toFixed(0),"KB)"]})]},c))}):null}var h=a.i(529395),i=a.i(539524),j=a.i(700760);function k({url:a,alt:d,onClick:e}){let[f,g]=(0,c.useState)(!1);return(0,b.jsxs)("button",{type:"button",onClick:e,className:(0,j.cn)("relative overflow-hidden rounded-md","w-48 h-48 aspect-square","bg-surface-glass border border-border/20","hover:border-border/40 hover:scale-105","transition-all duration-200","cursor-pointer","focus:outline-none focus:ring-2 focus:ring-primary/50"),"aria-label":`View ${d}`,children:[!f&&(0,b.jsx)("div",{className:"absolute inset-0 bg-surface-glass animate-pulse"}),(0,b.jsx)("img",{src:a,alt:d,loading:"lazy",className:(0,j.cn)("w-full h-full object-cover","transition-opacity duration-200",f?"opacity-100":"opacity-0"),onLoad:()=>g(!0)})]})}function l({images:a,onImageClick:d}){let[e,f]=(0,c.useState)(!1),g=e?a:a.slice(0,4),j=a.length-4;return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.motion.div,{className:`grid gap-2 ${a.length>=3?"grid-cols-1 sm:grid-cols-2":"grid-cols-1"}`,variants:{container:{transition:{staggerChildren:.05}}},initial:"container",animate:"container",children:g.map((a,c)=>(0,b.jsx)(h.motion.div,{variants:{container:{opacity:0,scale:.8},item:{opacity:1,scale:1}},initial:"container",animate:"item",transition:{duration:.2},children:(0,b.jsx)(k,{url:a.url,alt:a.name,onClick:()=>d(c)})},a.storageId))}),!e&&j>0&&(0,b.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:()=>f(!0),className:"w-full text-xs",children:["Show ",j," more ",1===j?"image":"images"]})]})}var m=a.i(354420),n=a.i(215179),o=a.i(358176),p=a.i(789884);let q=(0,a.i(366705).default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var r=a.i(158540),s=a.i(23944),t=a.i(227759);let u=[100,150,200];function v({images:a,initialIndex:d,open:e,onClose:f}){let[g,k]=(0,c.useState)(d),[l,v]=(0,c.useState)(0),[w,x]=(0,c.useState)(0),y=a[g],z=a.length>1,A=()=>{x(1),k(b=>(b+1)%a.length)},B=()=>{x(-1),k(b=>(b-1+a.length)%a.length)},C=()=>{v(a=>Math.min(a+1,u.length-1))},D=()=>{v(a=>Math.max(a-1,0))};(0,c.useEffect)(()=>{v(0)},[]),(0,c.useEffect)(()=>{k(d)},[d]),(0,c.useEffect)(()=>{if(!e)return;let a=a=>{"Escape"===a.key?f():"ArrowLeft"===a.key&&z?B():"ArrowRight"===a.key&&z?A():"+"===a.key||"="===a.key?C():("-"===a.key||"_"===a.key)&&D()};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[e,z,A,B,f,C,D]);let E=async()=>{try{let a=await fetch(y.url),b=await a.blob(),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=y.name,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c)}catch(a){console.error("Download failed:",a)}};return(0,b.jsx)(t.Dialog,{open:e,onOpenChange:f,children:(0,b.jsxs)(t.DialogContent,{className:(0,j.cn)("!max-w-none w-screen h-screen max-h-screen","p-0 border-0 rounded-none","bg-black/95 backdrop-blur-md"),showCloseButton:!1,children:[(0,b.jsx)(t.DialogTitle,{className:"sr-only",children:"Image Viewer"}),(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:f,className:"absolute top-4 right-4 z-50 text-white hover:bg-white/10","aria-label":"Close",children:(0,b.jsx)(s.X,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{className:"absolute top-4 right-16 z-50 flex gap-2",children:[(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:D,disabled:0===l,className:"text-white hover:bg-white/10 disabled:opacity-30","aria-label":"Zoom out",children:(0,b.jsx)(q,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{className:"flex items-center px-3 text-white text-sm bg-white/10 rounded-md",children:[u[l],"%"]}),(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:C,disabled:l===u.length-1,className:"text-white hover:bg-white/10 disabled:opacity-30","aria-label":"Zoom in",children:(0,b.jsx)(r.Plus,{className:"w-5 h-5"})}),(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:E,className:"text-white hover:bg-white/10","aria-label":"Download",children:(0,b.jsx)(p.Download,{className:"w-5 h-5"})})]}),(0,b.jsx)("div",{className:"flex items-center justify-center w-full h-full overflow-auto p-4",children:(0,b.jsx)(m.AnimatePresence,{mode:"wait",custom:w,children:(0,b.jsx)(h.motion.div,{className:"flex items-center justify-center min-w-full min-h-full",custom:w,initial:{opacity:0,x:100*w},animate:{opacity:1,x:0},exit:{opacity:0,x:-100*w},transition:{duration:.2},children:(0,b.jsx)("img",{src:y.url,alt:y.name,className:"object-contain",style:{maxWidth:0===l?"100%":"none",maxHeight:0===l?"100%":"none",width:l>0?`${u[l]}%`:"auto",height:"auto",transition:"all 0.2s ease-out"}})},g)})}),z&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:B,className:"absolute left-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/10 w-12 h-12","aria-label":"Previous image",children:(0,b.jsx)(n.ChevronLeft,{className:"w-8 h-8"})}),(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",onClick:A,className:"absolute right-4 top-1/2 -translate-y-1/2 text-white hover:bg-white/10 w-12 h-12","aria-label":"Next image",children:(0,b.jsx)(o.ChevronRight,{className:"w-8 h-8"})})]}),z&&(0,b.jsxs)("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm",children:[g+1," / ",a.length]})]})})}function w({attachments:a,urls:d}){let[e,f]=(0,c.useState)(!1),[h,i]=(0,c.useState)(0),j=a.filter(a=>"image"===a.type),k=a.filter(a=>"image"!==a.type),m=j.map(a=>({storageId:a.storageId,url:d.get(a.storageId)||"",name:a.name})).filter(a=>a.url);return(0,b.jsxs)(b.Fragment,{children:[m.length>0&&(0,b.jsx)(l,{images:m,onImageClick:a=>{i(a),f(!0)}}),k.length>0&&(0,b.jsx)(g,{attachments:k}),m.length>0&&(0,b.jsx)(v,{images:m,initialIndex:h,open:e,onClose:()=>f(!1)})]})}a.s(["AttachmentRenderer",()=>w],833424)},257999,a=>{"use strict";var b=a.i(367146),c=a.i(354420),d=a.i(529395),e=a.i(698734),f=a.i(366705);let g=(0,f.default)("bookmark-plus",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}],["line",{x1:"12",x2:"12",y1:"7",y2:"13",key:"1cppfj"}],["line",{x1:"15",x2:"9",y1:"10",y2:"10",key:"1gty7f"}]]),h=(0,f.default)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var i=a.i(359275),j=a.i(885737),k=a.i(332747),l=a.i(351244),m=a.i(358176);let n=(0,f.default)("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);var o=a.i(39979),p=a.i(876402),q=a.i(954439),r=a.i(236695),s=a.i(116245);let t=(0,f.default)("folder-tree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);var u=a.i(957544),v=a.i(452549),w=a.i(687336),x=a.i(36565),y=a.i(286028),z=a.i(537500);function A(a){if(!a.result)return Date.now()-a.timestamp>3e4?"error":"executing";try{let b=JSON.parse(a.result);if(b.error||!1===b.success)return"error"}catch{}return"complete"}var B=a.i(730843),C=a.i(227885),D=a.i(968177);function E({call:a,parsedArgs:c,parsedResult:d,state:e,ToolIcon:f}){return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium text-muted-foreground",children:a.name||"Unknown tool"})]}),c&&(0,b.jsxs)("div",{className:"text-muted-foreground",children:[(0,b.jsx)("div",{className:"text-[11px] font-medium mb-1",children:"Arguments:"}),(0,b.jsx)("pre",{className:"text-[10px] bg-muted p-2 rounded overflow-x-auto whitespace-pre-wrap",children:JSON.stringify(c,null,2)})]}),d&&"executing"!==e&&(0,b.jsxs)("div",{className:"text-muted-foreground",children:[(0,b.jsx)("div",{className:"text-[11px] font-medium mb-1",children:"Result:"}),(0,b.jsx)("pre",{className:"text-[10px] bg-muted p-2 rounded max-h-48 overflow-y-auto whitespace-pre-wrap",children:JSON.stringify(d,null,2)})]})]})}var F=a.i(114589),G=a.i(618493);function H({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=c?.results||[],g=c?.answer;return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsxs)("span",{className:"font-mono text-muted-foreground",children:['"',a?.query,'"']})]}),c&&"executing"!==d&&(0,b.jsxs)("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:[g&&(0,b.jsx)("div",{className:"py-1.5 px-2 bg-muted/50 rounded-md border border-border/50",children:(0,b.jsx)("p",{className:"text-muted-foreground text-[11px] leading-relaxed",children:g})}),f.slice(0,5).map((a,c)=>(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-primary hover:underline",children:a.title}),(0,b.jsxs)("p",{className:"text-muted-foreground text-[11px] line-clamp-2",children:[a.content?.substring(0,150),a.content&&a.content.length>150?"...":""]})]},c)),0===f.length&&!g&&(0,b.jsx)("div",{className:"text-muted-foreground",children:"No results found"})]})]})}let I={saveMemory:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium text-muted-foreground",children:"executing"===d?"Saving...":c?.success?"Saved":c?.duplicate?"Already exists":"Failed"})]}),(0,b.jsx)("div",{className:"text-muted-foreground",children:a?.content&&(0,b.jsxs)("span",{className:"italic",children:['"',a.content,'"']})}),c?.message&&"executing"!==d&&(0,b.jsx)("div",{className:c.success?"text-green-500":"text-amber-500",children:c.message})]})},searchMemories:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-mono text-muted-foreground",children:a?.query})]}),c&&(0,b.jsxs)("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:[c.memories?.map((a,c)=>(0,b.jsxs)("div",{className:"py-0.5",children:[(0,b.jsxs)("span",{className:"font-medium text-primary",children:["[",a.category,"]"]})," ",(0,b.jsx)("span",{className:"text-muted-foreground",children:a.content})]},c)),0===c.found&&(0,b.jsx)("div",{className:"text-muted-foreground",children:"No memories found"}),"error"===d&&(0,b.jsx)("div",{className:"text-red-500",children:c.error||"Tool execution failed"})]})]})},webSearch:H,tavilySearch:H,tavilyAdvancedSearch:H,calculator:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-mono text-muted-foreground",children:a?.expression})]}),c&&"executing"!==d&&(0,b.jsxs)("div",{className:"font-semibold text-primary",children:["= ",c.result]})]})},datetime:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:[a?.operation,a?.timezone&&` (${a.timezone})`]})]}),c&&"executing"!==d&&(0,b.jsx)("div",{className:"font-medium",children:c.formatted||c.readable})]})},urlReader:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=c?.content||"",g=f.substring(0,500);return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("a",{href:a?.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline truncate",children:a?.url})]}),c&&"executing"!==d&&(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"text-muted-foreground text-[11px]",children:[c.wordCount," words"]}),(0,b.jsx)("div",{className:"max-h-48 overflow-y-auto text-muted-foreground",children:(0,b.jsx)("pre",{className:"whitespace-pre-wrap font-sans text-[11px]",children:f.length>500?`${g}...`:f})})]})]})},codeExecution:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=c?.success===!1,g=c?.images;return(0,b.jsxs)("div",{className:"text-xs space-y-2 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:a?.language||"Code"}),f&&(0,b.jsx)("span",{className:"text-red-500 text-[10px]",children:"Failed"})]}),a?.code&&(0,b.jsx)("pre",{className:"bg-muted p-2 rounded text-[11px] overflow-x-auto max-h-32 overflow-y-auto",children:(0,b.jsx)("code",{children:a.code})}),c&&"executing"!==d&&(0,b.jsxs)("div",{className:"space-y-2",children:[g&&g.length>0&&(0,b.jsx)("div",{className:"space-y-2",children:g.map((a,c)=>(console.log("[CodeExecution] Rendering image:",a),a.url)?(0,b.jsx)("div",{className:"rounded overflow-hidden border border-border/40 bg-white",children:(0,b.jsx)("img",{src:a.url,alt:`Code execution output ${c+1}`,className:"w-full h-auto block",loading:"lazy",onError:b=>{console.error("[CodeExecution] Image failed to load:",a.url),b.target.style.display="none"}})},a.storageId||c):(0,b.jsxs)("div",{className:"p-2 bg-yellow-500/10 text-yellow-600 rounded text-[11px]",children:["Image ",c+1,": URL not available"]},c))}),(0,b.jsx)("div",{className:"text-muted-foreground",children:f?"Error:":"Output:"}),(0,b.jsx)("pre",{className:`p-2 rounded text-[11px] max-h-48 overflow-y-auto ${f?"bg-red-500/10 text-red-500":"bg-muted"}`,children:(0,b.jsx)("code",{children:(()=>{if(!c)return null;if(!1===c.success&&c.error)return c.error;let a=[];if(c.stdout&&a.push(c.stdout),c.stderr&&a.push(c.stderr),c.result){let b="string"==typeof c.result?c.result:JSON.stringify(c.result,null,2);b&&b!==a.join("\n")&&a.push(`Result: ${b}`)}return a.join("\n")||"(no output)"})()})}),c.executionTime&&!f&&(0,b.jsxs)("div",{className:"text-muted-foreground text-[11px]",children:["Executed in ",c.executionTime,"ms"]})]})]})},weather:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=c?.current,g=c?.units==="fahrenheit"?"°F":"°C";return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:a?.location})]}),f&&"executing"!==d&&(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"font-semibold",children:[f.temperature,g," • ",f.condition]}),f.feelsLike&&(0,b.jsxs)("div",{className:"text-muted-foreground",children:["Feels like ",f.feelsLike,g]}),c.forecast&&(0,b.jsx)("div",{className:"text-muted-foreground text-[11px]",children:c.forecast})]})]})},fileDocument:function({parsedResult:a,state:c,ToolIcon:d}){return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-medium",children:a?.fileName||"Document"})]}),a&&"executing"!==c&&(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"text-muted-foreground text-[11px]",children:[a.wordCount," words"]}),a.content&&(0,b.jsx)("div",{className:"max-h-48 overflow-y-auto bg-muted p-2 rounded",children:(0,b.jsx)("pre",{className:"whitespace-pre-wrap font-sans text-[11px]",children:a.content})})]})]})},projectContext:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=a?.section||"context",g=c?.items||[];return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:[c?.project?.name," • ",f]})]}),g.length>0&&"executing"!==d&&(0,b.jsx)("div",{className:"max-h-48 overflow-y-auto space-y-1",children:g.map((a,c)=>(0,b.jsxs)("div",{className:"text-muted-foreground",children:["• ",a.title||a.name||a.content?.substring(0,50)]},c))})]})},deleteMemory:function({parsedResult:a,state:c,ToolIcon:d}){return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:a?.success?"text-green-500":"text-red-500",children:a?.success?"Deleted":"Failed to delete"})]}),a?.message&&"executing"!==c&&(0,b.jsx)("div",{className:"text-muted-foreground",children:a.message})]})},searchNotes:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=c?.results||[];return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsxs)("span",{className:"font-mono text-muted-foreground",children:['"',a?.query,'"']}),c?.totalResults!==void 0&&"executing"!==d&&(0,b.jsxs)("span",{className:"text-muted-foreground text-[10px]",children:["(",c.totalResults," found)"]})]}),c&&"executing"!==d&&(0,b.jsxs)("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:[f.slice(0,5).map((a,c)=>(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsx)("a",{href:a.url,className:"font-medium text-primary hover:underline",children:a.title||"Untitled"}),a.tags?.length>0&&(0,b.jsx)("span",{className:"ml-2 text-[10px] text-muted-foreground",children:a.tags.slice(0,3).map(a=>`#${a}`).join(" ")}),(0,b.jsxs)("p",{className:"text-muted-foreground text-[11px] line-clamp-2",children:[a.preview?.substring(0,150),a.preview&&a.preview.length>150?"...":""]})]},c)),0===f.length&&(0,b.jsx)("div",{className:"text-muted-foreground",children:"No notes found"})]})]})},searchTasks:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=c?.results||[];return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsxs)("span",{className:"font-mono text-muted-foreground",children:['"',a?.query,'"']}),c?.totalResults!==void 0&&"executing"!==d&&(0,b.jsxs)("span",{className:"text-muted-foreground text-[10px]",children:["(",c.totalResults," found)"]})]}),c&&"executing"!==d&&(0,b.jsxs)("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:[f.slice(0,5).map((a,c)=>(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("a",{href:a.url,className:"font-medium text-primary hover:underline",children:a.title}),(0,b.jsx)("span",{className:`text-[10px] ${(a=>{switch(a){case"completed":return"text-green-500";case"in_progress":return"text-blue-500";case"blocked":return"text-red-500";default:return"text-muted-foreground"}})(a.status)}`,children:a.status?.replace("_"," ")}),a.urgency&&"medium"!==a.urgency&&(0,b.jsx)("span",{className:`text-[9px] px-1 rounded ${(a=>{switch(a){case"urgent":return"bg-red-500/20 text-red-500";case"high":return"bg-orange-500/20 text-orange-500";case"medium":return"bg-yellow-500/20 text-yellow-500";default:return"bg-muted text-muted-foreground"}})(a.urgency)}`,children:a.urgency})]}),a.deadline&&(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:["Due: ",new Date(a.deadline).toLocaleDateString()]}),a.description&&(0,b.jsx)("p",{className:"text-muted-foreground text-[11px] line-clamp-1",children:a.description})]},c)),0===f.length&&(0,b.jsx)("div",{className:"text-muted-foreground",children:"No tasks found"})]})]})},searchFiles:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=c?.results||[];return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsxs)("span",{className:"font-mono text-muted-foreground",children:['"',a?.query,'"']}),c?.totalResults!==void 0&&"executing"!==d&&(0,b.jsxs)("span",{className:"text-muted-foreground text-[10px]",children:["(",c.totalResults," found)"]})]}),c&&"executing"!==d&&(0,b.jsxs)("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:[f.slice(0,5).map((a,c)=>(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.url?(0,b.jsx)("a",{href:a.url,className:"font-medium text-primary hover:underline",children:a.filename}):(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.filename}),void 0!==a.page&&(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground bg-muted px-1 rounded",children:["p.",a.page]}),a.score&&(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:[(100*parseFloat(a.score)).toFixed(0),"%"]})]}),(0,b.jsxs)("p",{className:"text-muted-foreground text-[11px] line-clamp-2 font-mono bg-muted/50 p-1 rounded mt-0.5",children:[a.content?.substring(0,200),a.content&&a.content.length>200?"...":""]})]},c)),0===f.length&&(0,b.jsx)("div",{className:"text-muted-foreground",children:"No files found"})]})]})},queryHistory:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=c?.results||[];return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsxs)("span",{className:"font-mono text-muted-foreground",children:['"',a?.query,'"']}),c?.totalResults!==void 0&&"executing"!==d&&(0,b.jsxs)("span",{className:"text-muted-foreground text-[10px]",children:["(",c.totalResults," found)"]})]}),c&&"executing"!==d&&(0,b.jsxs)("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:[f.slice(0,5).map((a,c)=>(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("a",{href:a.url,className:"font-medium text-primary hover:underline truncate max-w-[200px]",children:a.conversationTitle||"Untitled conversation"}),(0,b.jsx)("span",{className:`text-[10px] ${(a=>{switch(a){case"user":return"text-blue-500";case"assistant":return"text-green-500";default:return"text-muted-foreground"}})(a.role)}`,children:(a=>{switch(a){case"user":return"You";case"assistant":return"Assistant";case"system":return"System";default:return a}})(a.role)}),a.timestamp&&(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground",children:new Date(a.timestamp).toLocaleDateString()})]}),(0,b.jsxs)("p",{className:"text-muted-foreground text-[11px] line-clamp-2",children:[a.content?.substring(0,150),a.content&&a.content.length>150?"...":""]})]},c)),0===f.length&&(0,b.jsx)("div",{className:"text-muted-foreground",children:"No conversations found"})]})]})},searchAll:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f=[];c?.notes?.results&&c.notes.results.forEach(a=>{f.push({type:"notes",item:a})}),c?.tasks?.results&&c.tasks.results.forEach(a=>{f.push({type:"tasks",item:a})}),c?.files?.results&&c.files.results.forEach(a=>{f.push({type:"files",item:a})}),c?.conversations?.results&&c.conversations.results.forEach(a=>{f.push({type:"conversations",item:a})});let g={notes:c?.notes?.totalResults||0,tasks:c?.tasks?.totalResults||0,files:c?.files?.totalResults||0,conversations:c?.conversations?.totalResults||0},h=g.notes+g.tasks+g.files+g.conversations;return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsxs)("span",{className:"font-mono text-muted-foreground",children:['"',a?.query,'"']}),"executing"!==d&&h>0&&(0,b.jsxs)("span",{className:"text-muted-foreground text-[10px]",children:["(",h," total)"]})]}),c&&"executing"!==d&&(0,b.jsxs)("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:[f.slice(0,8).map(({type:a,item:c},d)=>(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`text-[9px] px-1.5 py-0.5 rounded ${(a=>{switch(a){case"notes":return"bg-purple-500/20 text-purple-500";case"tasks":return"bg-blue-500/20 text-blue-500";case"files":return"bg-green-500/20 text-green-500";case"conversations":return"bg-orange-500/20 text-orange-500";default:return"bg-muted text-muted-foreground"}})(a)}`,children:(a=>{switch(a){case"notes":return"Note";case"tasks":return"Task";case"files":return"File";case"conversations":return"Chat";default:return a}})(a)}),c.url?(0,b.jsx)("a",{href:c.url,className:"font-medium text-primary hover:underline truncate max-w-[200px]",children:c.title||c.filename||c.conversationTitle||"Untitled"}):(0,b.jsx)("span",{className:"font-medium text-foreground truncate max-w-[200px]",children:c.title||c.filename||c.conversationTitle||"Untitled"})]}),(0,b.jsx)("p",{className:"text-muted-foreground text-[11px] line-clamp-1 pl-10",children:(c.preview||c.content||c.description||"")?.substring(0,100)})]},d)),0===f.length&&(0,b.jsx)("div",{className:"text-muted-foreground",children:"No results found"}),f.length>8&&(0,b.jsxs)("div",{className:"text-muted-foreground text-[10px] pt-1",children:["+",f.length-8," more results"]})]})]})},manageTasks:function({parsedArgs:a,parsedResult:c,state:d,ToolIcon:e}){let f,g,h=a?.operation||"unknown",i=(a,c=!0)=>(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[c&&a.url?(0,b.jsx)("a",{href:a.url,className:`font-medium ${"completed"===a.status?"line-through text-muted-foreground":"text-primary hover:underline"}`,children:a.title}):(0,b.jsx)("span",{className:`font-medium ${"completed"===a.status?"line-through text-muted-foreground":""}`,children:a.title}),(0,b.jsx)("span",{className:`text-[10px] ${(a=>{switch(a){case"completed":return"text-green-500";case"in_progress":return"text-blue-500";case"cancelled":return"text-red-500";default:return"text-muted-foreground"}})(a.status)}`,children:a.status?.replace("_"," ")}),a.urgency&&"medium"!==a.urgency&&(0,b.jsx)("span",{className:`text-[9px] px-1 rounded ${(a=>{switch(a){case"urgent":return"bg-red-500/20 text-red-500";case"high":return"bg-orange-500/20 text-orange-500";case"medium":return"bg-yellow-500/20 text-yellow-500";default:return"bg-muted text-muted-foreground"}})(a.urgency)}`,children:a.urgency})]}),a.deadline&&(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:["Due: ",new Date(a.deadline).toLocaleDateString()]})]});return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:`font-medium ${"executing"===d?"text-muted-foreground":c?.success?"complete"===h||"delete"===h?"text-green-500":"text-muted-foreground":"text-amber-500"}`,children:(()=>{if("executing"===d)switch(h){case"create":return"Creating task...";case"update":return"Updating task...";case"complete":return"Completing task...";case"delete":return a?.confirmDelete?"Deleting task...":"Finding task...";case"list":return"Loading tasks...";default:return"Processing..."}if(!c?.success)return c?.ambiguous?"Multiple matches found":c?.message||"Failed";switch(h){case"create":return"Created task";case"update":return"Updated task";case"complete":return"Completed";case"delete":return c?.deleted?"Deleted":"Found (confirm to delete)";case"list":return`${c?.totalCount||0} tasks`;default:return"Done"}})()})]}),"executing"!==d&&(0,b.jsxs)(b.Fragment,{children:[("create"===h||"update"===h||"complete"===h||"delete"===h&&!c?.ambiguous)&&c?.task&&(0,b.jsx)("div",{className:"mt-1",children:i(c.task)}),"delete"===h&&c?.pendingDelete&&(0,b.jsx)("div",{className:"text-[10px] text-amber-500 mt-1",children:"Awaiting confirmation..."}),c?.ambiguous&&(0===(f=c?.candidates||[]).length?null:(0,b.jsxs)("div",{className:"space-y-1 mt-1",children:[(0,b.jsx)("div",{className:"text-[10px] text-muted-foreground",children:"Please specify which task:"}),f.slice(0,5).map((a,c)=>(0,b.jsx)("div",{children:i(a)},c))]})),"list"===h&&(0===(g=c?.tasks||[]).length?(0,b.jsx)("div",{className:"text-muted-foreground text-[11px] mt-1",children:c?.message||"No tasks found"}):(0,b.jsx)("div",{className:"space-y-1.5 max-h-48 overflow-y-auto mt-1",children:g.slice(0,10).map((a,c)=>(0,b.jsx)("div",{children:i(a)},c))})),!c?.success&&c?.error&&(0,b.jsx)("div",{className:"text-amber-500 text-[11px]",children:c.message})]})]})},createDocument:function({parsedArgs:a,parsedResult:c,state:d}){let e=a?.documentType==="code"?C.FileCode:s.FileText;return"executing"===d?(0,b.jsxs)("div",{className:"text-xs flex items-center gap-2 text-muted-foreground py-1",children:[(0,b.jsx)(v.Loader2,{className:"h-3 w-3 animate-spin"}),(0,b.jsxs)("span",{children:['Creating "',a?.title,'"...']})]}):c&&!c.success?(0,b.jsxs)("div",{className:"text-xs text-destructive py-1",children:["Failed: ",c.error]}):c?.success?(0,b.jsxs)("div",{className:"text-xs flex items-center gap-2 py-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-green-500",children:[(0,b.jsx)(B.Check,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:"Created"})]}),(0,b.jsx)("span",{className:"text-muted-foreground/50",children:"·"}),(0,b.jsx)(e,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground truncate max-w-[200px]",children:a?.title??"Document"}),a?.language&&(0,b.jsx)(D.Badge,{variant:"secondary",className:"h-4 text-[10px] px-1",children:a.language}),c.lineCount&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-muted-foreground/50",children:"·"}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:[c.lineCount," lines"]})]})]}):null},updateDocument:function({parsedArgs:a,parsedResult:c,state:d}){return"executing"===d?(0,b.jsxs)("div",{className:"text-xs flex items-center gap-2 text-muted-foreground py-1",children:[(0,b.jsx)(v.Loader2,{className:"h-3 w-3 animate-spin"}),(0,b.jsx)("span",{children:a?.changeDescription||"Updating document..."})]}):c&&!c.success?(0,b.jsxs)("div",{className:"text-xs text-destructive py-1",children:["Failed: ",c.error]}):c?.success?(0,b.jsxs)("div",{className:"text-xs flex items-center gap-2 py-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-green-500",children:[(0,b.jsx)(B.Check,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:["Updated to v",c.newVersion]})]}),a?.changeDescription&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-muted-foreground/50",children:"·"}),(0,b.jsx)(x.RefreshCw,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground truncate max-w-[200px]",children:a.changeDescription})]})]}):null},readDocument:function({parsedResult:a,state:c}){return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsx)("div",{className:"text-[10px] font-medium text-muted-foreground/70 uppercase tracking-wide mb-0.5",children:"Read Document"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(q.Eye,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"font-mono text-muted-foreground",children:"Reading document..."})]}),a&&"executing"!==c&&(0,b.jsx)("div",{className:"text-muted-foreground",children:a.hasDocument?(0,b.jsxs)("span",{children:[a.title||"Document"," • ",a.lineCount," ","lines"]}):(0,b.jsx)("span",{children:"No document open"})})]})},enterDocumentMode:function({parsedArgs:a,state:c,ToolIcon:d}){return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"executing"===c?"Entering document mode...":"Document mode active"})]}),a?.reason&&"executing"!==c&&(0,b.jsx)("div",{className:"text-muted-foreground/80 text-[10px]",children:a.reason})]})},exitDocumentMode:function({state:a,ToolIcon:c}){return(0,b.jsx)("div",{className:"text-xs space-y-1 border-l-2 border-border/40 pl-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(c,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"executing"===a?"Exiting...":"Returned to chat"})]})})},resolveConflict:function({parsedArgs:a,parsedResult:c,state:d}){let f=a?.strategy;return(0,b.jsxs)("div",{className:"text-xs space-y-1 border-l-2 border-yellow-500/40 pl-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(()=>{switch(f){case"retry_with_read":return(0,b.jsx)(x.RefreshCw,{className:"h-3 w-3 text-blue-500"});case"force_replace":return(0,b.jsx)(e.AlertCircle,{className:"h-3 w-3 text-orange-500"});case"ask_user":return(0,b.jsx)(G.HelpCircle,{className:"h-3 w-3 text-purple-500"});default:return(0,b.jsx)(F.AlertTriangle,{className:"h-3 w-3 text-yellow-500"})}})(),(0,b.jsx)("span",{className:"font-mono text-muted-foreground",children:(()=>{switch(f){case"retry_with_read":return"Retrying with fresh read";case"force_replace":return"Force replacing";case"ask_user":return"Asking for user input";default:return"Resolving conflict"}})()})]}),a?.conflictDescription&&(0,b.jsx)("div",{className:"text-muted-foreground/80 text-[10px]",children:a.conflictDescription}),c&&"executing"!==d&&(0,b.jsx)("div",{className:"text-muted-foreground",children:c.success?(0,b.jsx)("span",{className:"text-[10px]",children:c.message}):(0,b.jsx)("span",{className:"text-destructive",children:c.error})})]})}};function J({toolCalls:a,partialToolCalls:f}){let[B,C]=(0,z.useState)({}),D=(0,z.useMemo)(()=>{let b=[...a||[]];if(f)for(let a of f)b.some(b=>b.id===a.id)||b.push(a);return b},[a,f]);if(0===D.length)return null;let F=D.some(a=>"executing"===A(a)),G=D.some(a=>"error"===A(a)),H=Object.values(B).some(Boolean),J=()=>{let a=!H,b={};for(let c of D)b[c.id]=a;C(b)};return(0,b.jsxs)("div",{className:"my-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer group",onClick:J,role:"button",tabIndex:0,onKeyDown:a=>{("Enter"===a.key||" "===a.key)&&(a.preventDefault(),J())},"aria-expanded":H,"aria-label":`${D.length} tool call${1===D.length?"":"s"}`,children:[F?(0,b.jsx)(v.Loader2,{className:"h-3 w-3 text-blue-500 animate-spin"}):G?(0,b.jsx)(e.AlertCircle,{className:"h-3 w-3 text-red-500"}):(0,b.jsx)(j.CheckCircle2,{className:"h-3 w-3 text-green-500"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground group-hover:text-foreground transition-colors",children:(()=>{let a=D.filter(a=>"searchMemories"===a.name),b=D.filter(a=>"saveMemory"===a.name),c=a.reduce((a,b)=>{if(b.result)try{let c=JSON.parse(b.result);return a+(c.found||0)}catch{}return a},0),d=b.filter(a=>{try{let b=JSON.parse(a.result||"{}");return!0===b.success}catch{return!1}}).length;if(F){let a=D.find(a=>"executing"===A(a));return function(a,b,c){switch(a){case"saveMemory":if(b)return"Saving to memory...";return"Saved to memory";case"searchMemories":if(b)return"Searching memories...";return"Memory search (0 results)";case"calculator":if(b)return"Calculating...";return"= undefined";case"datetime":if(b)return"Getting date/time...";return"Date/time";case"webSearch":case"tavilySearch":case"tavilyAdvancedSearch":if(b)return"Searching the web...";return"Web search (0 results)";case"urlReader":if(b)return"Reading URL...";return"Read URL (0 words)";case"fileDocument":if(b)return"Processing document...";return"Document (0 words)";case"codeExecution":if(b)return"Executing code...";return"Code executed (0ms)";case"weather":if(b)return"Fetching weather...";return"Weather Forecast";case"projectContext":if(b)return"Loading project context...";!0;return"Project: Unknown";case"manageTasks":{let a;if(b)return"Managing tasks...";if("create"===a)return"Created: task";if("complete"===a)return"Completed: task";if("delete"===a)return"Ready to delete";if("update"===a)return"Updated: task";if("list"===a)return"0 tasks";return"Task manager"}case"createDocument":if(b)return"Creating document...";return'Created "document"';case"updateDocument":if(b)return"Updating document...";return"Updated to vundefined";case"readDocument":if(b)return"Reading document...";return"No document";case"enterDocumentMode":if(b)return"Entering document mode...";return"Document mode";case"exitDocumentMode":if(b)return"Exiting...";return"Back to chat";default:if(b)return"Processing...";return"Done"}}(a?.name||"",!0,0)}let e=[];return a.length>0&&e.push(`${c} memor${1!==c?"ies":"y"} found`),b.length>0&&e.push(`${d} saved`),e.join(", ")||"Tool calls"})()}),(0,b.jsx)("div",{className:"flex-1 border-t border-dashed border-border/40 group-hover:border-border/60 transition-colors"}),H?(0,b.jsx)(l.ChevronDown,{className:"h-3 w-3 text-muted-foreground group-hover:text-foreground transition-colors"}):(0,b.jsx)(m.ChevronRight,{className:"h-3 w-3 text-muted-foreground group-hover:text-foreground transition-colors"})]}),(0,b.jsx)(c.AnimatePresence,{children:H&&(0,b.jsx)(d.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2,ease:[.2,0,0,1]},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"mt-2 space-y-2 pl-2",children:D.map(a=>{let c,d,e=A(a),f=function(a){switch(a){case"saveMemory":return g;case"searchMemories":default:return y.Search;case"calculator":return h;case"datetime":return i.Calendar;case"webSearch":case"tavilySearch":case"tavilyAdvancedSearch":return u.Globe;case"urlReader":return p.ExternalLink;case"fileDocument":case"createDocument":return s.FileText;case"codeExecution":return o.Code;case"weather":return n;case"projectContext":return t;case"manageTasks":return k.CheckSquare;case"updateDocument":return x.RefreshCw;case"readDocument":return q.Eye;case"enterDocumentMode":return r.FileEdit;case"exitDocumentMode":return w.MessageSquare}}(a.name);try{c=JSON.parse(a.arguments),d=a.result?JSON.parse(a.result):null}catch{c=a.arguments,d=a.result}let j=I[a.name]||E;return(0,b.jsx)(j,{call:a,parsedArgs:c,parsedResult:d,state:e,ToolIcon:f},a.id)})})})})]})}a.s(["ToolCallDisplay",()=>J],257999)},207480,a=>a.a(async(b,c)=>{try{var d=a.i(367146),e=a.i(537500),f=a.i(165298),g=a.i(257999),h=b([f]);function i({content:a,toolCalls:b,partialToolCalls:c,isStreaming:h=!1}){let i=(0,e.useMemo)(()=>{let a=[...b||[]];if(c)for(let b of c)a.some(a=>a.id===b.id)||a.push(b);return a},[b,c]),j=(0,e.useMemo)(()=>{if(0===i.length)return a?[{type:"text",content:a}]:[];let b=[...i].sort((a,b)=>{let c=a.textPosition??1/0,d=b.textPosition??1/0;return c!==d?c-d:a.timestamp-b.timestamp});if(!b.some(a=>void 0!==a.textPosition&&null!==a.textPosition))return[{type:"tool",toolCalls:b},...a?[{type:"text",content:a}]:[]];let c=[],d=0,e=new Map;for(let c of b){let b=c.textPosition??a.length,d=e.get(b)||[];d.push(c),e.set(b,d)}for(let b of Array.from(e.keys()).sort((a,b)=>a-b)){if(b>d){let e=a.slice(d,b);e.trim()&&c.push({type:"text",content:e})}let f=e.get(b);c.push({type:"tool",toolCalls:f}),d=b}if(d<a.length){let b=a.slice(d);b.trim()&&c.push({type:"text",content:b})}return c},[a,i]);return 0===j.length?null:(0,d.jsx)("div",{className:"inline-tool-content space-y-2",children:j.map((a,b)=>"text"===a.type&&a.content?(0,d.jsx)(f.MarkdownContent,{content:a.content,isStreaming:h&&b===j.length-1},`text-${b}`):"tool"===a.type&&a.toolCalls?(0,d.jsx)(g.ToolCallDisplay,{toolCalls:a.toolCalls,partialToolCalls:[]},`tool-${b}`):null)})}[f]=h.then?(await h)():h,a.s(["InlineToolCallContent",()=>i]),c()}catch(a){c(a)}},!1),150903,a=>{"use strict";var b=a.i(367146),c=a.i(130487);a.i(16243);var d=a.i(182234),e=a.i(730843),f=a.i(54797),g=a.i(116245),h=a.i(429649),i=a.i(921690),j=a.i(674779),k=a.i(397079),l=a.i(105530),m=a.i(502311),n=a.i(537500),o=a.i(167831),p=a.i(539524),q=a.i(477430),r=a.i(375523),s=a.i(63263),t=a.i(772949),u=a.i(700760),v=a.i(127718),w=a.i(366705);let x=(0,w.default)("bookmark-check",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]]);var y=a.i(753884),z=a.i(227759),A=a.i(928503),B=a.i(658547),C=a.i(197463),D=a.i(638600);function E({messageId:a,conversationId:e}){let[f,g]=(0,n.useState)(!1),[h,i]=(0,n.useState)(""),[j,k]=(0,n.useState)(""),l="string"==typeof a&&a.startsWith("temp-"),m=(0,d.useQuery)(c.api.bookmarks.getByMessage,l?"skip":{messageId:a}),o=(0,d.useMutation)(c.api.bookmarks.create),r=(0,d.useMutation)(c.api.bookmarks.remove),s=(0,d.useMutation)(c.api.bookmarks.update),t=(0,d.useMutation)(c.api.usage.mutations.recordAction),u=!!m,w=async()=>{if(u&&m)try{await r({bookmarkId:m._id}),y.toast.success("Bookmark removed"),D.analytics.track("bookmark_deleted",{source:"message"})}catch(a){y.toast.error("Failed to remove bookmark")}else g(!0)},E=async()=>{try{let b=j?j.split(",").map(a=>a.trim()):void 0;u&&m?(await s({bookmarkId:m._id,note:h||void 0,tags:b}),y.toast.success("Bookmark updated"),D.analytics.track("bookmark_updated",{hasNote:!!h,tagCount:b?.length||0})):(await o({messageId:a,conversationId:e,note:h||void 0,tags:b}),y.toast.success("Bookmark created"),D.analytics.track("bookmark_created",{source:"message",hasNote:!!h,tagCount:b?.length||0}),t({actionType:"bookmark_message",resourceId:a})),g(!1),i(""),k("")}catch(a){y.toast.error("Failed to save bookmark")}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",onClick:w,children:[u?(0,b.jsx)(x,{className:"h-4 w-4 text-primary"}):(0,b.jsx)(v.Bookmark,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:u?"Remove bookmark":"Bookmark message"})]})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:u?"Remove bookmark (B)":"Bookmark message (B)"})})]}),(0,b.jsx)(z.Dialog,{open:f,onOpenChange:g,children:(0,b.jsxs)(z.DialogContent,{children:[(0,b.jsx)(z.DialogHeader,{children:(0,b.jsx)(z.DialogTitle,{children:u?"Edit Bookmark":"Add Bookmark"})}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(B.Label,{htmlFor:"note",children:"Note (optional)"}),(0,b.jsx)(C.Textarea,{id:"note",placeholder:"Add a note about why you bookmarked this...",value:h,onChange:a=>i(a.target.value),rows:3})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(B.Label,{htmlFor:"tags",children:"Tags (optional)"}),(0,b.jsx)(A.Input,{id:"tags",placeholder:"important, code, reference (comma-separated)",value:j,onChange:a=>k(a.target.value)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Separate tags with commas"})]})]}),(0,b.jsxs)(z.DialogFooter,{children:[(0,b.jsx)(p.Button,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),(0,b.jsxs)(p.Button,{onClick:E,children:[u?"Update":"Save"," Bookmark"]})]})]})})]})}var F=a.i(105698),G=a.i(971310),H=a.i(723979);function I({message:a}){let e=(0,d.useMutation)(c.api.chat.deleteMessage),f=async()=>{try{await e({messageId:a._id}),D.analytics.track("message_deleted",{messageId:a._id,conversationId:a.conversationId})}catch(a){console.error("Failed to delete:",a)}};return(0,b.jsxs)(H.DropdownMenu,{children:[(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(H.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",children:[(0,b.jsx)(F.MoreHorizontal,{className:"h-3.5 w-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:"More actions"})]})})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"More actions"})})]}),(0,b.jsx)(H.DropdownMenuContent,{align:"end",className:"w-48",children:(0,b.jsxs)(H.DropdownMenuItem,{onClick:f,className:"text-destructive focus:text-destructive",children:[(0,b.jsx)(G.Trash2,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Delete"})]})})]})}var J=a.i(494110);function K({message:a,isGenerating:e,isUser:i,onCopy:l,onSaveAsNote:o,onBookmark:r,onCreatePresentation:s}){let[t,u]=(0,n.useState)(!1),w=(0,m.useRouter)(),x=(0,d.useMutation)(c.api.chat.regenerate),y=(0,d.useMutation)(c.api.chat.deleteMessage),z=(0,d.useMutation)(c.api.chat.branchFromMessage),A=async b=>{try{await x({messageId:a._id,modelId:b})}catch(a){console.error("Failed to regenerate:",a)}},B=async()=>{try{let b=await z({messageId:a._id});w.push(`/chat/${b}`)}catch(a){console.error("Failed to branch:",a)}},C=async()=>{try{await y({messageId:a._id})}catch(a){console.error("Failed to delete:",a)}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(H.DropdownMenu,{children:[(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(H.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",children:[(0,b.jsx)(F.MoreHorizontal,{className:"h-3.5 w-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:"Actions"})]})})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"Actions"})})]}),(0,b.jsxs)(H.DropdownMenuContent,{align:"end",className:"w-48",children:[(0,b.jsxs)(H.DropdownMenuItem,{onClick:l,children:[(0,b.jsx)(f.Copy,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Copy"})]}),r&&(0,b.jsxs)(H.DropdownMenuItem,{onClick:r,children:[(0,b.jsx)(v.Bookmark,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Bookmark"})]}),o&&(0,b.jsxs)(H.DropdownMenuItem,{onClick:o,children:[(0,b.jsx)(g.FileText,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Save as Note"})]}),s&&(0,b.jsxs)(H.DropdownMenuItem,{onClick:s,children:[(0,b.jsx)(j.Presentation,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Create Presentation"})]}),(r||o||s)&&(0,b.jsx)(H.DropdownMenuSeparator,{}),!i&&!e&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(H.DropdownMenuItem,{onClick:()=>u(!0),children:[(0,b.jsx)(k.RotateCcw,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Regenerate"})]}),(0,b.jsx)(H.DropdownMenuSeparator,{})]}),(0,b.jsxs)(H.DropdownMenuItem,{onClick:B,children:[(0,b.jsx)(h.GitBranch,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Branch conversation"})]}),(0,b.jsx)(H.DropdownMenuSeparator,{}),(0,b.jsxs)(H.DropdownMenuItem,{onClick:C,className:"text-destructive focus:text-destructive",children:[(0,b.jsx)(G.Trash2,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:"Delete"})]})]})]}),(0,b.jsx)(J.QuickModelSwitcher,{open:t,onOpenChange:u,currentModel:a.model||"",onSelectModel:a=>{A(a)},mode:"single",showTrigger:!1})]})}var L=a.i(452549);let M=(0,w.default)("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),N=(0,w.default)("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);var O=a.i(133231);function P({text:a,messageId:c,className:d}){let{state:e,playFromText:f,pause:g,resume:h,seekTo:i}=(0,O.useTTSPlayer)(),j=e.sourceMessageId===c,k=e.isLoading&&j,l=e.isPlaying&&j,m=async()=>{if(a.trim()){if(j&&!e.isLoading)return l?void g():(e.duration&&e.currentTime>=e.duration-.25&&i(0),void await h());await f({text:a,messageId:c})}};return(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",onClick:m,disabled:k||!a.trim(),className:(0,u.cn)("h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",d),title:l?"Pause text-to-speech":"Play with text-to-speech",children:[k?(0,b.jsx)(L.Loader2,{className:"w-3.5 h-3.5 animate-spin"}):l?(0,b.jsx)(N,{className:"w-3.5 h-3.5"}):(0,b.jsx)(M,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:k?"Generating...":l?"Stop":"Play"})]})}function Q({message:a,nextMessage:v,readOnly:w,onEdit:x}){let[y,z]=(0,n.useState)(!1),[A,B]=(0,n.useState)(!1),[C,D]=(0,n.useState)(!1),F=(0,m.useRouter)();(0,d.useQuery)(c.api.users.getCurrentUser);let G=(0,d.useMutation)(c.api.chat.retryMessage),H=(0,d.useMutation)(c.api.chat.stopGeneration),L=(0,d.useMutation)(c.api.chat.regenerate),M=(0,d.useMutation)(c.api.chat.branchFromMessage),N=(0,d.useMutation)(c.api.usage.mutations.recordAction),O=(0,d.useQuery)(c.api.sources.operations.getSources,"assistant"!==a.role||a._id.startsWith("temp_")?"skip":{messageId:a._id}),{isMobile:Q}=(0,s.useMobileDetect)(),R=(0,r.useFeatureToggles)();(0,t.useUserPreference)("alwaysShowMessageActions");let S=(0,t.useUserPreference)("ttsEnabled"),T="user"===a.role,U=["pending","generating"].includes(a.status),V=T&&v?.status==="error"&&!U;(0,n.useEffect)(()=>{let b=b=>{b.detail.messageId===a._id&&B(!0)};return window.addEventListener("save-message-as-note",b),()=>{window.removeEventListener("save-message-as-note",b)}},[a._id]),(0,n.useEffect)(()=>{let b=b=>{b.detail.messageId!==a._id||T||U||D(!0)};return window.addEventListener("open-regenerate-model-selector",b),()=>{window.removeEventListener("open-regenerate-model-selector",b)}},[a._id,T,U]);let W=async()=>{let b=a.content||a.partialContent||"";if("assistant"===a.role&&O?.length)for(let a of(b+="\n\n**Sources:**\n",O))b+=`- [${a.position}] [${a.title||a.url}](${a.url})
`;await navigator.clipboard.writeText(b),z(!0),setTimeout(()=>z(!1),2e3),N({actionType:"copy_message",resourceId:a._id})},X=async()=>{try{let b=await M({messageId:a._id});N({actionType:"branch_message",resourceId:a._id}),F.push(`/chat/${b}`)}catch(a){console.error("Failed to branch:",a)}},Y=async b=>{try{await L({messageId:a._id,modelId:b}),N({actionType:"regenerate_message",resourceId:a._id})}catch(a){console.error("Failed to regenerate:",a)}},Z=()=>{N({actionType:"create_presentation",resourceId:a._id}),F.push(`/slides/new?conversationId=${a.conversationId}&messageId=${a._id}`)},[$,_]=(0,n.useState)(!1),aa=()=>{N({actionType:"save_as_note",resourceId:a._id}),B(!0)};return Q&&!w?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(K,{message:a,isGenerating:U,isUser:T,onCopy:W,onSaveAsNote:R.showNotes?aa:void 0,onBookmark:R.showBookmarks?()=>{_(!0)}:void 0,onCreatePresentation:R.showSlides&&!T&&(a.content||a.partialContent)?Z:void 0})}),(0,b.jsx)(o.CreateNoteDialog,{open:A,onOpenChange:B,initialContent:a.content||a.partialContent||"",sourceMessageId:a._id,sourceConversationId:a.conversationId}),R.showBookmarks&&(0,b.jsx)(E,{messageId:a._id,conversationId:a.conversationId})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:(0,u.cn)("flex items-center gap-2","transition-all duration-200"),children:[(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",onClick:W,children:[y?(0,b.jsx)(e.Check,{className:"w-3.5 h-3.5"}):(0,b.jsx)(f.Copy,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:y?"Copied":"Copy"})]})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:y?"Copied!":"Copy message (C)"})})]}),!w&&(0,b.jsxs)(b.Fragment,{children:[T&&x&&(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",onClick:x,children:[(0,b.jsx)(i.Pencil,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:"Edit"})]})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"Edit message (E)"})})]}),V&&(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",onClick:()=>G({messageId:a._id}),children:[(0,b.jsx)(k.RotateCcw,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:"Retry"})]})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"Retry message"})})]}),U&&(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",onClick:()=>H({conversationId:a.conversationId}),children:[(0,b.jsx)(l.Square,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:"Stop"})]})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"Stop generation"})})]}),R.showBookmarks&&(0,b.jsx)(E,{messageId:a._id,conversationId:a.conversationId}),R.showNotes&&(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",onClick:aa,children:[(0,b.jsx)(g.FileText,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:"Save as Note"})]})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"Save as note (N)"})})]}),R.showSlides&&!T&&(a.content||a.partialContent)&&(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",onClick:Z,children:[(0,b.jsx)(j.Presentation,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:"Create Presentation"})]})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"Create presentation"})})]}),(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",onClick:X,children:[(0,b.jsx)(h.GitBranch,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:"Branch"})]})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"Branch conversation (B)"})})]}),!T&&!U&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-muted-foreground/70 hover:bg-background/20 hover:text-foreground",onClick:()=>D(!0),children:[(0,b.jsx)(k.RotateCcw,{className:"w-3.5 h-3.5"}),(0,b.jsx)("span",{className:"sr-only",children:"Regenerate"})]})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"Regenerate response (R)"})})]}),(0,b.jsx)(J.QuickModelSwitcher,{open:C,onOpenChange:D,currentModel:a.model||"",onSelectModel:a=>{Y(a)},mode:"single",showTrigger:!1})]}),!T&&"complete"===a.status&&S&&(a.content||a.partialContent)&&(0,b.jsxs)(q.Tooltip,{children:[(0,b.jsx)(q.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(P,{text:a.content||a.partialContent||"",messageId:a._id})}),(0,b.jsx)(q.TooltipContent,{children:(0,b.jsx)("p",{children:"Play with text-to-speech"})})]}),(0,b.jsx)(I,{message:a,isGenerating:U,isUser:T})]})]}),(0,b.jsx)(o.CreateNoteDialog,{open:A,onOpenChange:B,initialContent:a.content||a.partialContent||"",sourceMessageId:a._id,sourceConversationId:a.conversationId})]})}a.s(["MessageActions",()=>Q],150903)},497078,a=>{"use strict";var b=a.i(367146),c=a.i(130487);a.i(16243);var d=a.i(182234),e=a.i(354420),f=a.i(529395),g=a.i(351244),h=a.i(358176),i=a.i(429649),j=a.i(502311),k=a.i(537500),l=a.i(539524);function m({messageId:a}){let m=(0,j.useRouter)(),[n,o]=(0,k.useState)(!1),p="string"==typeof a&&a.startsWith("temp-"),q=(0,d.useQuery)(c.api.conversations.getChildBranchesFromMessage,p?"skip":{messageId:a});return q&&0!==q.length?(0,b.jsxs)("div",{className:"my-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer group",onClick:()=>o(!n),role:"button",tabIndex:0,onKeyDown:a=>{("Enter"===a.key||" "===a.key)&&(a.preventDefault(),o(!n))},"aria-expanded":n,"aria-label":`${q.length} branch${1===q.length?"":"es"} from this message`,children:[(0,b.jsxs)("span",{className:"text-xs text-muted-foreground group-hover:text-foreground transition-colors",children:["Branches (",q.length,")"]}),(0,b.jsx)("div",{className:"flex-1 border-t border-dashed border-border/40 group-hover:border-border/60 transition-colors"}),n?(0,b.jsx)(g.ChevronDown,{className:"h-3 w-3 text-muted-foreground group-hover:text-foreground transition-colors"}):(0,b.jsx)(h.ChevronRight,{className:"h-3 w-3 text-muted-foreground group-hover:text-foreground transition-colors"})]}),(0,b.jsx)(e.AnimatePresence,{children:n&&(0,b.jsx)(f.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2,ease:[.2,0,0,1]},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"mt-2 space-y-1 pl-2",children:q.map(a=>(0,b.jsx)(l.Button,{variant:"ghost",size:"sm",className:"w-full justify-start h-auto py-2 px-2 text-left font-normal hover:bg-accent/50",onClick:b=>{b.stopPropagation(),m.push(`/chat/${a._id}`)},children:(0,b.jsxs)("div",{className:"flex items-start gap-2 w-full min-w-0",children:[(0,b.jsx)(i.GitBranch,{className:"h-3.5 w-3.5 mt-0.5 flex-shrink-0 text-muted-foreground"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm truncate",children:a.title}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(a.createdAt).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})},a._id))})})})]}):null}a.s(["MessageBranchIndicator",()=>m])},958833,a=>{"use strict";var b=a.i(537500);function c(a=!0){let d=(0,b.useRef)(new Set),e=(0,b.useRef)(!1);return{register:(0,b.useCallback)(b=>{if(!b)return;d.current.add(b);let c=()=>{if(!a||e.current)return;e.current=!0;let c=b.scrollTop/(b.scrollHeight-b.clientHeight);requestAnimationFrame(()=>{for(let a of d.current)a!==b&&(a.scrollTop=c*(a.scrollHeight-a.clientHeight));e.current=!1})};return b.addEventListener("scroll",c,{passive:!0}),()=>{b.removeEventListener("scroll",c),d.current.delete(b)}},[a])}}a.s(["useSyncedScroll",()=>c])},532411,a=>{"use strict";var b=a.i(367146),c=a.i(730843),d=a.i(539524);function e({onVote:a,isVoted:e,hasVoted:f,label:g}){return(0,b.jsx)("div",{className:"flex gap-2",children:f?e?(0,b.jsxs)("div",{className:"flex-1 flex items-center justify-center gap-2 text-sm font-medium text-primary py-2 border rounded-md bg-primary/10 border-primary/20",children:[(0,b.jsx)(c.Check,{className:"w-4 h-4"}),"Voted"]}):null:(0,b.jsx)(d.Button,{size:"sm",variant:"outline",onClick:a,className:"flex-1 hover:bg-primary hover:text-primary-foreground transition-all duration-200",children:g})})}a.s(["VotingControls",()=>e])},377141,a=>a.a(async(b,c)=>{try{var d=a.i(367146),e=a.i(537500),f=a.i(968177),g=a.i(165298),h=a.i(532411),i=b([g]);[g]=i.then?(await i)():i;let j=(0,e.forwardRef)(({message:a,index:b,showModelName:c,showStats:e,onVote:i,isVoted:j,hasVoted:k,duration:l},m)=>{let n=["pending","generating"].includes(a.status),o=a.partialContent||a.content||"",p=a.model?.split(":")[1]||a.model;return(0,d.jsxs)("div",{ref:m,className:"flex flex-col h-full border rounded-lg overflow-hidden",children:[(0,d.jsxs)("div",{className:"flex flex-col items-start gap-2 p-3 border-b bg-muted/30",children:[(0,d.jsx)("div",{children:c?(0,d.jsx)(f.Badge,{variant:"secondary",children:p}):(0,d.jsxs)(f.Badge,{variant:"outline",children:["Model ",b+1]})}),e&&(0,d.jsxs)("div",{className:"text-xs text-muted-foreground flex gap-2 w-full overflow-hidden text-ellipsis whitespace-nowrap pl-2",children:[(0,d.jsxs)("span",{children:[a.inputTokens?.toLocaleString()||0," in"]}),(0,d.jsx)("span",{children:"•"}),(0,d.jsxs)("span",{children:[a.outputTokens?.toLocaleString()||0," out"]}),(0,d.jsx)("span",{children:"•"}),(0,d.jsxs)("span",{className:"font-mono",children:["$",a.cost?.toFixed(4)||"0.0000"]}),void 0!==l&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{children:"•"}),(0,d.jsx)("span",{className:"font-mono",children:null===l?"—":l<1e3?`${l}ms`:`${(l/1e3).toFixed(1)}s`})]})]})]}),(0,d.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:o?(0,d.jsx)(g.MarkdownContent,{content:o,isStreaming:n}):(0,d.jsxs)("div",{className:"flex gap-1 items-center h-6",children:[(0,d.jsx)("span",{className:"w-2 h-2 bg-primary/40 rounded-full animate-bounce"}),(0,d.jsx)("span",{className:"w-2 h-2 bg-primary/40 rounded-full animate-bounce delay-150"}),(0,d.jsx)("span",{className:"w-2 h-2 bg-primary/40 rounded-full animate-bounce delay-300"})]})}),"complete"===a.status&&(0,d.jsx)("div",{className:"p-3 border-t",children:(0,d.jsx)(h.VotingControls,{onVote:i,isVoted:j,hasVoted:k,label:"This is better"})})]})});j.displayName="ComparisonPanel",a.s(["ComparisonPanel",0,j]),c()}catch(a){c(a)}},!1),874735,a=>{"use strict";var b=a.i(367146),c=a.i(537500),d=a.i(539524),e=a.i(227759),f=a.i(658547),g=a.i(812911),h=a.i(547885),i=a.i(349977);function j({open:a,messages:j,onConfirm:k,onClose:l}){let m=Object.values(i.MODEL_CONFIG).filter(a=>!a.isLocal),[n,o]=(0,c.useState)(m[0]?.id||""),[p,q]=(0,c.useState)("same-chat"),r=(0,c.useMemo)(()=>Math.ceil(j.map(a=>a.content).join("\n\n").length/4),[j]),s=r/1e3*.003;return(0,b.jsx)(e.Dialog,{open:a,onOpenChange:l,children:(0,b.jsxs)(e.DialogContent,{children:[(0,b.jsxs)(e.DialogHeader,{children:[(0,b.jsx)(e.DialogTitle,{children:"Consolidate Responses"}),(0,b.jsxs)(e.DialogDescription,{children:["Synthesize all ",j.length," responses into one comprehensive answer."]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("label",{className:"text-sm font-medium",children:"Consolidation mode"}),(0,b.jsxs)(g.RadioGroup,{value:p,onValueChange:a=>q(a),children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(g.RadioGroupItem,{value:"same-chat",id:"same-chat"}),(0,b.jsxs)(f.Label,{htmlFor:"same-chat",className:"cursor-pointer",children:[(0,b.jsx)("div",{className:"font-medium",children:"Same chat"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Replace comparison with consolidated response"})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(g.RadioGroupItem,{value:"new-chat",id:"new-chat"}),(0,b.jsxs)(f.Label,{htmlFor:"new-chat",className:"cursor-pointer",children:[(0,b.jsx)("div",{className:"font-medium",children:"New chat"}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Create separate conversation with consolidated response"})]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Which model should consolidate?"}),(0,b.jsxs)(h.Select,{value:n,onValueChange:o,children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsx)(h.SelectContent,{children:m.map(a=>(0,b.jsx)(h.SelectItem,{value:a.id,children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"bg-muted p-3 rounded space-y-1 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Estimated input tokens:"}),(0,b.jsx)("span",{className:"font-mono",children:r.toLocaleString()})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Estimated cost:"}),(0,b.jsxs)("span",{className:"font-mono",children:["$",s.toFixed(4)]})]})]})]}),(0,b.jsxs)(e.DialogFooter,{children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:l,children:"Cancel"}),(0,b.jsxs)(d.Button,{onClick:()=>{k(n,p)},children:["Consolidate with"," ",m.find(a=>a.id===n)?.name]})]})]})})}a.s(["ConsolidateDialog",()=>j])},180100,a=>a.a(async(b,c)=>{try{var d=a.i(367146),e=a.i(130487);a.i(16243);var f=a.i(182234),g=a.i(954439),h=a.i(554690),i=a.i(651386),j=a.i(23944),k=a.i(537500),l=a.i(247028),m=a.i(968177),n=a.i(539524),o=a.i(183104),p=a.i(477430),q=a.i(958833),r=a.i(772949),s=a.i(638600),t=a.i(700760),u=a.i(377141),v=a.i(874735),w=b([u]);function x({assistantMessages:a,comparisonGroupId:b,showModelNames:c,onVote:w,onConsolidate:x,onToggleModelNames:y,onExit:z,hideConsolidateButton:A=!1}){let[B,C]=(0,k.useState)(!0),[D,E]=(0,k.useState)(!1),[F,G]=(0,k.useState)();(0,f.useQuery)(e.api.users.getCurrentUser);let H=(0,r.useUserPreference)("showComparisonStatistics"),{register:I}=(0,q.useSyncedScroll)(B),J=(0,l.useMediaQuery)("(max-width: 1024px)"),K=(0,k.useMemo)(()=>[...a].sort((a,b)=>a.createdAt-b.createdAt),[a]),L=(0,k.useMemo)(()=>a.reduce((a,b)=>a+(b.cost||0),0),[a]),M=(0,k.useMemo)(()=>a.reduce((a,b)=>a+(b.inputTokens||0),0),[a]),N=(0,k.useMemo)(()=>a.reduce((a,b)=>a+(b.outputTokens||0),0),[a]),O=(0,k.useMemo)(()=>K.map(a=>a.generationCompletedAt?a.generationCompletedAt-a.createdAt:null),[K]),P=a=>null===a?"—":a<1e3?`${a}ms`:`${(a/1e3).toFixed(1)}s`,Q=a.every(a=>"complete"===a.status),R=(a,c)=>{let d;G(a),d=2===K.length?0===c?"left_better":"right_better":"left_better",w(a,d);let e=K.find(b=>b._id===a);s.analytics.track("comparison_voted",{rating:d,winnerModel:e?.model,modelCount:K.length,comparisonGroupId:b})},S=(a,b)=>{E(!1),x(a,b),s.analytics.track("consolidation_created",{mode:b,model:a,modelCount:K.length})};return J?(0,d.jsxs)("div",{className:"flex flex-col h-full",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 border-b",children:[!A&&(0,d.jsxs)("h3",{className:"font-medium",children:["Comparing ",a.length," models"]}),(0,d.jsxs)("div",{className:"flex items-center gap-1 ml-auto",children:[!A&&(0,d.jsxs)(p.Tooltip,{children:[(0,d.jsx)(p.TooltipTrigger,{asChild:!0,children:(0,d.jsx)(n.Button,{size:"icon",variant:"ghost",onClick:y,className:"h-8 w-8",children:c?(0,d.jsx)(h.EyeOff,{className:"w-4 h-4"}):(0,d.jsx)(g.Eye,{className:"w-4 h-4"})})}),(0,d.jsx)(p.TooltipContent,{children:(0,d.jsxs)("p",{children:[c?"Hide":"Show"," model names"]})})]}),z&&(0,d.jsxs)(p.Tooltip,{children:[(0,d.jsx)(p.TooltipTrigger,{asChild:!0,children:(0,d.jsx)(n.Button,{size:"icon",variant:"ghost",onClick:z,children:(0,d.jsx)(j.X,{className:"w-4 h-4"})})}),(0,d.jsx)(p.TooltipContent,{children:(0,d.jsx)("p",{children:"Exit comparison (Esc)"})})]})]})]}),(0,d.jsxs)(o.Tabs,{defaultValue:K[0]._id,className:"flex-1",children:[(0,d.jsx)(o.TabsList,{className:"w-full justify-start overflow-x-auto sticky top-0 z-10 no-scrollbar px-1",children:K.map((a,b)=>(0,d.jsx)(o.TabsTrigger,{value:a._id,className:"flex-shrink-0 min-w-[100px]",children:c?a.model?.split(":")[1]||a.model:`Model ${b+1}`},a._id))}),K.map((a,b)=>(0,d.jsx)(o.TabsContent,{value:a._id,className:"flex-1",children:(0,d.jsx)(u.ComparisonPanel,{message:a,index:b,showModelName:c,showStats:H,onVote:()=>R(a._id,b),isVoted:F===a._id,hasVoted:void 0!==F,duration:O[b]})},a._id))]}),(0,d.jsxs)("div",{className:"p-3 border-t space-y-2",children:[H&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,d.jsx)("span",{className:"font-medium",children:"Total Cost"}),(0,d.jsxs)("span",{className:"font-mono",children:["$",L.toFixed(4)]})]}),(0,d.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,d.jsx)("span",{className:"font-medium",children:"Avg Response Time"}),(0,d.jsx)("span",{className:"font-mono",children:P(O.filter(a=>null!==a).length>0?O.filter(a=>null!==a).reduce((a,b)=>a+b,0)/O.filter(a=>null!==a).length:null)})]})]}),Q&&!A&&(0,d.jsxs)(n.Button,{onClick:()=>E(!0),className:"w-full",variant:"secondary",children:[(0,d.jsx)(i.Sparkles,{className:"w-4 h-4 mr-2"}),"Consolidate Responses"]})]}),(0,d.jsx)(v.ConsolidateDialog,{open:D,comparisonGroupId:b,messages:K,onConfirm:S,onClose:()=>E(!1)})]}):(0,d.jsxs)("div",{className:"flex flex-col h-full",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 border-b",children:[(0,d.jsx)("div",{className:"flex items-center gap-3",children:!A&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("h3",{className:"font-medium",children:["Comparing ",a.length," models"]}),(0,d.jsx)(m.Badge,{variant:"outline",children:B?"Sync On":"Sync Off"})]})}),(0,d.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[!A&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:()=>C(!B),children:"Toggle Sync"}),(0,d.jsx)(n.Button,{size:"sm",variant:"ghost",onClick:y,className:"gap-2",children:c?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h.EyeOff,{className:"w-4 h-4"}),"Hide Names"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.Eye,{className:"w-4 h-4"}),"Show Names"]})})]}),z&&(0,d.jsx)(n.Button,{size:"icon",variant:"ghost",onClick:z,children:(0,d.jsx)(j.X,{className:"w-4 h-4"})})]})]}),(0,d.jsx)("div",{className:(0,t.cn)("flex-1 grid gap-4 p-4 overflow-hidden",2===a.length&&"grid-cols-2",3===a.length&&"grid-cols-3",4===a.length&&"grid-cols-2 lg:grid-cols-4"),children:K.map((a,b)=>(0,d.jsx)(u.ComparisonPanel,{ref:I,message:a,index:b,showModelName:c,showStats:H,onVote:()=>R(a._id,b),isVoted:F===a._id,hasVoted:void 0!==F,duration:O[b]},a._id))}),(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 border-t",children:[H&&(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Total Cost:"}),(0,d.jsxs)("span",{className:"font-mono text-lg",children:["$",L.toFixed(4)]})]}),(0,d.jsxs)("div",{className:"text-xs text-muted-foreground",children:[M.toLocaleString()," input +"," ",N.toLocaleString()," output tokens"]}),(0,d.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Avg response:"," ",P(O.filter(a=>null!==a).length>0?O.filter(a=>null!==a).reduce((a,b)=>a+b,0)/O.filter(a=>null!==a).length:null)]})]}),Q&&!A&&(0,d.jsxs)(n.Button,{onClick:()=>E(!0),variant:"secondary",className:H?"":"ml-auto",children:[(0,d.jsx)(i.Sparkles,{className:"w-4 h-4 mr-2"}),"Consolidate Responses"]})]}),(0,d.jsx)(v.ConsolidateDialog,{open:D,comparisonGroupId:b,messages:K,onConfirm:S,onClose:()=>E(!1)})]})}[u]=w.then?(await w)():w,a.s(["ComparisonView",()=>x]),c()}catch(a){c(a)}},!1),463351,a=>a.a(async(b,c)=>{try{var d=a.i(367146),e=a.i(351244),f=a.i(539524),g=a.i(700760),h=a.i(180100),i=b([h]);function j({originalResponses:a,showOriginals:b,onToggle:c}){return 0===a.length?null:(0,d.jsxs)("div",{className:"mt-4 border-t border-border/10 pt-4",children:[(0,d.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:c,className:"gap-2 text-xs",children:[(0,d.jsx)(e.ChevronDown,{className:(0,g.cn)("w-3 h-3 transition-transform",b&&"rotate-180")}),b?"Hide":"Show"," original ",a.length," ","response",1!==a.length?"s":""]}),b&&(0,d.jsx)("div",{className:"mt-4",children:(0,d.jsx)(h.ComparisonView,{assistantMessages:a,comparisonGroupId:a[0]?.comparisonGroupId||"",showModelNames:!0,onVote:()=>{},onConsolidate:()=>{},onToggleModelNames:()=>{},hideConsolidateButton:!0})})]})}[h]=i.then?(await i)():i,a.s(["MessageConsolidationToggle",()=>j]),c()}catch(a){c(a)}},!1),676284,a=>{"use strict";var b=a.i(367146),c=a.i(730843),d=a.i(23944),e=a.i(539524),f=a.i(197463);function g({editedContent:a,onContentChange:g,onSave:h,onCancel:i}){return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(f.Textarea,{value:a,onChange:a=>g(a.target.value),className:"min-h-[100px] resize-none font-normal",autoFocus:!0}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(e.Button,{size:"sm",onClick:h,className:"h-8",disabled:!a.trim(),children:[(0,b.jsx)(c.Check,{className:"w-3.5 h-3.5 mr-1.5"}),"Save"]}),(0,b.jsxs)(e.Button,{size:"sm",variant:"outline",onClick:i,className:"h-8",children:[(0,b.jsx)(d.X,{className:"w-3.5 h-3.5 mr-1.5"}),"Cancel"]})]})]})}a.s(["MessageEditMode",()=>g])},911116,a=>{"use strict";var b=a.i(367146),c=a.i(452549);function d({isThinkingModel:a}){return a?(0,b.jsxs)("div",{className:"flex items-center gap-2 h-6 text-xs font-medium text-muted-foreground uppercase tracking-widest",children:[(0,b.jsx)(c.Loader2,{className:"w-3 h-3 animate-spin text-primary"}),(0,b.jsx)("span",{children:"Thinking..."})]}):(0,b.jsxs)("div",{className:"flex gap-1 items-center h-6",children:[(0,b.jsx)("span",{className:"w-2 h-2 bg-primary/40 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,b.jsx)("span",{className:"w-2 h-2 bg-primary/40 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,b.jsx)("span",{className:"w-2 h-2 bg-primary/40 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}a.s(["MessageLoadingState",()=>d])},755648,a=>{"use strict";var b=a.i(367146),c=a.i(130487);a.i(16243);var d=a.i(182234),e=a.i(354420),f=a.i(529395),g=a.i(351244),h=a.i(358176),i=a.i(116245),j=a.i(502311),k=a.i(537500),l=a.i(539524);function m({messageId:a}){let m=(0,j.useRouter)(),[n,o]=(0,k.useState)(!1),p="string"==typeof a&&a.startsWith("temp-"),q=(0,d.useQuery)(c.api.notes.getNotesFromMessage,p?"skip":{messageId:a});return q&&0!==q.length?(0,b.jsxs)("div",{className:"my-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer group",onClick:()=>o(!n),role:"button",tabIndex:0,onKeyDown:a=>{("Enter"===a.key||" "===a.key)&&(a.preventDefault(),o(!n))},"aria-expanded":n,"aria-label":`${q.length} note${1===q.length?"":"s"} from this message`,children:[(0,b.jsxs)("span",{className:"text-xs text-muted-foreground group-hover:text-foreground transition-colors",children:["Notes (",q.length,")"]}),(0,b.jsx)("div",{className:"flex-1 border-t border-dashed border-border/40 group-hover:border-border/60 transition-colors"}),n?(0,b.jsx)(g.ChevronDown,{className:"h-3 w-3 text-muted-foreground group-hover:text-foreground transition-colors"}):(0,b.jsx)(h.ChevronRight,{className:"h-3 w-3 text-muted-foreground group-hover:text-foreground transition-colors"})]}),(0,b.jsx)(e.AnimatePresence,{children:n&&(0,b.jsx)(f.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2,ease:[.2,0,0,1]},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"mt-2 space-y-1 pl-2",children:q.map(a=>(0,b.jsx)(l.Button,{variant:"ghost",size:"sm",className:"w-full justify-start h-auto py-2 px-2 text-left font-normal hover:bg-accent/50",onClick:b=>{b.stopPropagation(),m.push(`/notes?note=${a._id}`)},children:(0,b.jsxs)("div",{className:"flex items-start gap-2 w-full min-w-0",children:[(0,b.jsx)(i.FileText,{className:"h-3.5 w-3.5 mt-0.5 flex-shrink-0 text-muted-foreground"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm truncate",children:a.title}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(a.createdAt).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})},a._id))})})})]}):null}a.s(["MessageNotesIndicator",()=>m])},79734,a=>{"use strict";var b=a.i(367146),c=a.i(105530),d=a.i(469110),e=a.i(968177),f=a.i(477430),g=a.i(700760),h=a.i(126141);function i({modelName:a,ttft:i,isCached:j,tokensPerSecond:k,inputTokens:l,outputTokens:m,status:n,showStats:o}){return(0,b.jsxs)("div",{className:"mt-3 pt-3 border-t border-border/10 flex flex-wrap items-center gap-2 transition-opacity duration-300",children:[(0,b.jsx)(e.Badge,{variant:"outline",className:"text-[10px] h-5 bg-background/50 backdrop-blur border-border/50 text-muted-foreground",children:a}),"stopped"===n&&(0,b.jsx)(f.TooltipProvider,{children:(0,b.jsxs)(f.Tooltip,{children:[(0,b.jsx)(f.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(e.Badge,{variant:"outline",className:"text-[10px] h-5 bg-amber-500/10 backdrop-blur border-amber-500/30 text-amber-600 dark:text-amber-400",children:[(0,b.jsx)(c.Square,{className:"w-2.5 h-2.5 mr-1 fill-current"}),"Stopped"]})}),(0,b.jsx)(f.TooltipContent,{children:(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsx)("div",{className:"font-semibold",children:"Generation Stopped"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:"You stopped this response"})]})})]})}),o&&(0,b.jsxs)(b.Fragment,{children:[null!==i&&(0,b.jsx)(f.TooltipProvider,{children:j?(0,b.jsxs)(f.Tooltip,{children:[(0,b.jsx)(f.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(e.Badge,{variant:"outline",className:"text-[10px] h-5 bg-background/50 backdrop-blur border-border/50 text-muted-foreground",children:[(0,b.jsx)(d.Zap,{className:"w-3 h-3 mr-1"}),"cached"]})}),(0,b.jsx)(f.TooltipContent,{children:(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsx)("div",{className:"font-semibold",children:"Cached Response"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:"Served instantly from cache"})]})})]}):(0,b.jsxs)(f.Tooltip,{children:[(0,b.jsx)(f.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(e.Badge,{variant:"outline",className:(0,g.cn)("text-[10px] h-5 font-mono tabular-nums cursor-help bg-background/50 backdrop-blur border-border/50 text-muted-foreground","generating"===n&&"animate-pulse"),children:["TTFT: ",(0,h.formatTTFT)(i)]})}),(0,b.jsx)(f.TooltipContent,{children:(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsx)("div",{className:"font-semibold",children:"Time to First Token"}),(0,b.jsx)("div",{className:"text-muted-foreground",children:"generating"===n?"AI started responding":"How long until AI started responding"})]})})]})}),k&&"complete"===n&&(0,b.jsx)(f.TooltipProvider,{children:(0,b.jsxs)(f.Tooltip,{children:[(0,b.jsx)(f.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(e.Badge,{variant:"outline",className:"text-[10px] h-5 font-mono tabular-nums cursor-help bg-background/50 backdrop-blur border-border/50 text-muted-foreground",children:["TPS: ",Math.round(k)," t/s"]})}),(0,b.jsx)(f.TooltipContent,{children:(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsx)("div",{className:"font-semibold",children:"Tokens Per Second"}),(0,b.jsxs)("div",{className:"text-muted-foreground",children:["Generation speed: ",Math.round(k)," tokens/sec"]})]})})]})}),(void 0!==l||void 0!==m)&&(0,b.jsx)(f.TooltipProvider,{children:(0,b.jsxs)(f.Tooltip,{children:[(0,b.jsx)(f.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(e.Badge,{variant:"outline",className:"text-[10px] h-5 font-mono tabular-nums cursor-help bg-background/50 backdrop-blur border-border/50 text-muted-foreground",children:[l||0,"/",m||0]})}),(0,b.jsx)(f.TooltipContent,{children:(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsx)("div",{className:"font-semibold",children:"Token Count"}),(0,b.jsxs)("div",{className:"text-muted-foreground",children:["Input: ",l?.toLocaleString()||0]}),(0,b.jsxs)("div",{className:"text-muted-foreground",children:["Output: ",m?.toLocaleString()||0]}),(0,b.jsxs)("div",{className:"text-muted-foreground font-semibold mt-1",children:["Total:"," ",((l||0)+(m||0)).toLocaleString()]})]})})]})})]})]})}a.s(["MessageStatsBadges",()=>i])},155022,a=>{"use strict";var b=a.i(367146),c=a.i(130487);a.i(16243);var d=a.i(182234),e=a.i(354420),f=a.i(529395),g=a.i(525662),h=a.i(351244),i=a.i(452549),j=a.i(537500),k=a.i(772949),l=a.i(700760),m=a.i(126141);function n({reasoning:a,partialReasoning:n,thinkingStartedAt:o,thinkingCompletedAt:p,reasoningTokens:q,isThinking:r=!1}){(0,d.useQuery)(c.api.users.getCurrentUser);let s=(0,k.useUserPreference)("reasoning"),[t,u]=(0,j.useState)(s.autoExpand);(0,j.useEffect)(()=>{u(s.autoExpand)},[s.autoExpand]);let v=a||n,w=p&&o;if(!s.showByDefault||r&&!s.showDuringStreaming||!v&&!w&&!r)return null;let x=p&&o?p-o:null;return(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("button",{onClick:()=>u(!t),className:(0,l.cn)("w-full flex items-center gap-2 px-4 py-2.5","bg-muted/20 hover:bg-muted/30","backdrop-blur-xl rounded-xl","transition-colors duration-200","text-sm text-muted-foreground",r&&"animate-pulse"),children:[r?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Loader2,{className:"w-4 h-4 animate-spin"}),(0,b.jsx)("span",{children:"Thinking..."})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Brain,{className:"w-4 h-4"}),(0,b.jsxs)("span",{children:[null!==x?(0,b.jsxs)(b.Fragment,{children:["Thought for ",(0,m.formatDuration)(x)]}):"Reasoning",q&&` (${q} tokens)`]})]}),(0,b.jsx)(h.ChevronDown,{className:(0,l.cn)("w-4 h-4 ml-auto transition-transform duration-200",t&&"rotate-180")})]}),(0,b.jsx)(e.AnimatePresence,{children:t&&v&&(0,b.jsx)(f.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,b.jsx)("div",{className:(0,l.cn)("mt-2 p-4 rounded-xl","bg-muted/10 backdrop-blur-xl","border border-border/50","max-h-[400px] overflow-y-auto","font-mono text-sm text-foreground/80","whitespace-pre-wrap break-words"),children:v?(0,b.jsxs)(b.Fragment,{children:[v,r&&(0,b.jsx)("span",{className:"inline-block w-2 h-4 ml-1 bg-primary/50 animate-pulse"})]}):(0,b.jsxs)("p",{className:"text-xs text-muted-foreground italic",children:["Full reasoning hidden by provider. Model used"," ",q||0," reasoning tokens."]})})})})]})}a.s(["ReasoningBlock",()=>n])},929715,a=>{"use strict";var b=a.i(367146),c=a.i(130487);a.i(16243);var d=a.i(182234),e=a.i(351244),f=a.i(176013),g=a.i(876402),h=a.i(537500),i=a.i(968177),j=a.i(539524),k=a.i(592552),l=a.i(23480),m=a.i(700760);function n({messageId:a,className:g}){let[i,k]=(0,h.useState)(!1),l="string"==typeof a&&a.startsWith("temp-"),n=(0,d.useQuery)(c.api.sources.operations.getSources,l?"skip":{messageId:a});if(!n||0===n.length)return null;let p=n.length;return(0,b.jsxs)("div",{className:(0,m.cn)("mt-4 space-y-2",g),children:[(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",onClick:()=>k(!i),className:"gap-2 text-muted-foreground hover:text-foreground",children:[i?(0,b.jsx)(f.ChevronUp,{className:"h-4 w-4"}):(0,b.jsx)(e.ChevronDown,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:["Used ",p," ",1===p?"source":"sources"]})]}),i&&(0,b.jsx)("div",{className:"grid gap-2 sm:grid-cols-2",children:n.map((a,c)=>(0,b.jsx)(o,{source:a,position:a.position||c+1},a.position||c))})]})}function o({source:a,position:c}){let d,e=a.metadata?.title||a.title||a.url,f=a.snippet||a.metadata?.description||"",h=a.metadata?.favicon;try{d=new URL(a.url).hostname.replace("www.","")}catch{d=a.url}let m=(0,b.jsx)(k.Card,{className:"group relative overflow-hidden p-3 transition-all hover:border-primary/50 hover:shadow-md cursor-pointer",children:(0,b.jsxs)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"flex gap-3",onClick:a=>{if(window.innerWidth<640)return},children:[(0,b.jsx)(i.Badge,{variant:"secondary",className:"h-6 w-6 shrink-0 items-center justify-center rounded-full p-0 text-xs font-semibold",children:c}),(0,b.jsxs)("div",{className:"min-w-0 flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[h&&(0,b.jsx)("img",{src:h,alt:"",className:"h-4 w-4 rounded",onError:a=>{a.currentTarget.style.display="none"}}),(0,b.jsx)("span",{className:"truncate",children:d})]}),(0,b.jsx)("h4",{className:"line-clamp-2 text-sm font-medium leading-tight group-hover:underline",children:e}),f&&(0,b.jsxs)("p",{className:"line-clamp-2 text-xs text-muted-foreground",children:[f.slice(0,120),f.length>120?"...":""]})]}),(0,b.jsx)("div",{className:"shrink-0 text-muted-foreground opacity-0 transition-opacity group-hover:opacity-100",children:(0,b.jsx)(g.ExternalLink,{className:"h-4 w-4"})})]})});return(0,b.jsxs)(l.HoverCard,{openDelay:300,children:[(0,b.jsx)(l.HoverCardTrigger,{asChild:!0,children:m}),(0,b.jsx)(l.HoverCardContent,{side:"top",className:"w-80",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:d}),(0,b.jsx)("h4",{className:"font-semibold",children:e}),f&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:f}),(0,b.jsx)(j.Button,{asChild:!0,size:"sm",variant:"outline",className:"w-full gap-2",children:(0,b.jsxs)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",children:["Open source",(0,b.jsx)(g.ExternalLink,{className:"h-3 w-3"})]})})]})})]})}a.s(["SourceList",()=>n])},460241,a=>a.a(async(b,c)=>{try{var d=a.i(367146),e=a.i(130487);a.i(16243);var f=a.i(182234),g=a.i(698734),h=a.i(537500),i=a.i(753884),j=a.i(448645),k=a.i(375523),l=a.i(899199),m=a.i(772949),n=a.i(349977),o=a.i(711106),p=a.i(700760),q=a.i(126141),r=a.i(147118),s=a.i(824477),t=a.i(833424),u=a.i(207480),v=a.i(150903),w=a.i(497078),x=a.i(463351),y=a.i(676284),z=a.i(911116),A=a.i(755648),B=a.i(79734),C=a.i(401517),D=a.i(155022),E=a.i(929715),F=b([u,x]);function G({error:a}){let[b,c]=(0,h.useState)(!1);return(0,d.jsxs)("div",{className:"flex flex-col gap-3 p-1",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 text-amber-500/90 dark:text-amber-400/90",children:[(0,d.jsx)(g.AlertCircle,{className:"w-4 h-4"}),(0,d.jsx)("span",{className:"font-medium text-sm",children:"Unable to generate response"})]}),(0,d.jsx)("div",{className:"bg-muted/30 rounded-md p-3 border border-border/50",children:(0,d.jsx)("p",{className:"text-sm leading-relaxed opacity-90 break-words",children:a})}),(0,d.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,d.jsx)("span",{children:"Try a different model or"}),(0,d.jsx)("button",{type:"button",onClick:()=>c(!0),className:"underline hover:text-foreground transition-colors cursor-pointer",children:"contact support"})]}),(0,d.jsx)(r.FeedbackModal,{open:b,onOpenChange:c})]})}[u,x]=F.then?(await F)():F;let H=(0,h.memo)(function({message:a,nextMessage:b,readOnly:c,isCollaborative:g,senderUser:r}){let[F,H]=(0,h.useState)(!1),[I,J]=(0,h.useState)(!1),[K,L]=(0,h.useState)(!1),[M,N]=(0,h.useState)(""),O=(0,h.useRef)(null),P="user"===a.role,Q=["pending","generating"].includes(a.status),R="error"===a.status;a.status;let S="string"==typeof a._id&&a._id.startsWith("temp-"),T=(0,f.useMutation)(e.api.chat.editMessage),U=(0,f.useMutation)(e.api.conversations.updateModel),V=(0,m.useUserPreference)("alwaysShowMessageActions"),W=(0,m.useUserPreference)("showMessageStatistics"),X=(0,k.useFeatureToggles)(),Y=(0,f.useQuery)(e.api.messages.getOriginalResponses,a.isConsolidation&&!S?{consolidatedMessageId:a._id}:"skip"),Z=(0,f.useQuery)(e.api.conversations.get,{conversationId:a.conversationId}),$=a.partialContent||a.content||"",_=a.model?(0,o.getModelConfig)(a.model):null,aa=_?.name||a.model?.split(":")[1]||a.model,ab=!!_?.reasoning||_?.capabilities?.includes("extended-thinking")||_?.capabilities?.includes("thinking")||!1,ac=a.firstTokenAt&&a.generationStartedAt?a.firstTokenAt-a.generationStartedAt:null,ad=null!==ac&&(0,q.isCachedResponse)(ac),ae=(0,f.useQuery)(e.api.messages.getAttachments,S?"skip":{messageId:a._id}),af=ae?.map(a=>a.storageId)||[],ag=(0,f.useQuery)(e.api.files.getAttachmentUrls,af.length>0?{storageIds:af}:"skip"),ah=new Map(ag?.map(a=>[a.storageId,a.url]).filter(a=>null!==a[1])||[]),ai=(0,f.useQuery)(e.api.messages.getToolCalls,S?"skip":{messageId:a._id,includePartial:!0}),aj=ai?.filter(a=>!a.isPartial),ak=ai?.filter(a=>a.isPartial),al=async b=>{try{await U({conversationId:a.conversationId,model:b}),i.toast.success(`Switched to ${n.MODEL_CONFIG[b]?.name||b}`)}catch(a){i.toast.error("Failed to switch model"),console.error("[ChatMessage] Model switch error:",a)}},am=async()=>{try{await T({messageId:a._id,content:M}),L(!1),i.toast.success("Message updated")}catch(a){i.toast.error("Failed to update message"),console.error("[ChatMessage] Edit error:",a)}};(0,l.useMessageKeyboardShortcuts)({messageId:a._id,conversationId:a.conversationId,content:$,isFocused:I,isUser:P,isGenerating:Q,readOnly:c,messageRef:O});let an=(0,p.cn)("relative rounded-[2rem] rounded-tr-sm","px-5 py-3 sm:px-6 sm:py-4 text-sm sm:text-base leading-relaxed","bg-primary/10 text-foreground backdrop-blur-sm","border border-primary/20","shadow-sm hover:shadow-md","transition-all duration-300","[&_.prose]:text-foreground","font-medium tracking-wide"),ao=(0,p.cn)("relative rounded-[2rem] rounded-tl-sm","px-5 py-3 sm:px-6 sm:py-4 text-sm sm:text-base leading-relaxed","bg-surface-glass border border-surface-glass-border backdrop-blur-xl","shadow-sm hover:shadow-md hover:border-primary/20","transition-all duration-300","[&_.prose]:text-foreground"),ap=(0,p.cn)("relative group",P?"ml-auto mr-4 max-w-[90%] sm:max-w-[75%]":"mr-auto ml-4 max-w-[95%] sm:max-w-[85%]");return(0,d.jsx)("div",{className:(0,p.cn)("flex w-full mb-10",P?"justify-end":"justify-start"),children:(0,d.jsxs)("div",{className:ap,children:[(0,d.jsx)("div",{ref:O,id:`message-${a._id}`,onFocus:()=>J(!0),onBlur:()=>J(!1),className:(0,p.cn)("chat-message",P?an:ao,I&&"ring-2 ring-primary/50"),"data-testid":"message","data-message-id":a._id,"data-message-role":a.role,"data-status":a.status,"aria-label":`${P?"Your":"Assistant"} message`,"aria-keyshortcuts":"r b c delete",children:R?(0,d.jsx)(G,{error:a.error}):(0,d.jsxs)(d.Fragment,{children:[g&&r&&(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-border/20",children:[(0,d.jsxs)(j.Avatar,{className:"h-5 w-5",children:[(0,d.jsx)(j.AvatarImage,{src:r.imageUrl}),(0,d.jsx)(j.AvatarFallback,{className:"text-[10px]",children:r.name?.[0]?.toUpperCase()||"?"})]}),(0,d.jsx)("span",{className:"text-xs text-muted-foreground font-medium",children:P?r.name||"User":`Triggered by ${r.name||"User"}`})]}),"assistant"===a.role&&(a.reasoning||a.partialReasoning||a.thinkingStartedAt)&&(0,d.jsx)(D.ReasoningBlock,{reasoning:a.reasoning,partialReasoning:a.partialReasoning,thinkingStartedAt:a.thinkingStartedAt,thinkingCompletedAt:a.thinkingCompletedAt,reasoningTokens:a.reasoningTokens,isThinking:Q&&!!a.partialReasoning}),K?(0,d.jsx)(y.MessageEditMode,{editedContent:M,onContentChange:N,onSave:am,onCancel:()=>{L(!1),N("")}}):(0,d.jsx)(d.Fragment,{children:$||aj?.length||ak?.length?(0,d.jsx)("div",{"data-testid":"message-content",children:(0,d.jsx)(u.InlineToolCallContent,{content:$||"",toolCalls:aj,partialToolCalls:ak,isStreaming:Q})}):Q?(0,d.jsx)(z.MessageLoadingState,{isThinkingModel:ab&&!!a.thinkingStartedAt}):null}),(0,d.jsx)(s.ArtifactList,{messageId:a._id}),(0,d.jsx)(E.SourceList,{messageId:a._id}),ae&&ae.length>0&&ah.size>0&&(0,d.jsx)("div",{className:"mt-3 pt-3 border-t border-border/10",children:(0,d.jsx)(t.AttachmentRenderer,{attachments:ae,urls:ah})}),a.isConsolidation&&Y&&(0,d.jsx)(x.MessageConsolidationToggle,{originalResponses:Y,showOriginals:F,onToggle:()=>H(!F)}),!P&&(0,d.jsxs)(d.Fragment,{children:["generating"===a.status&&(0,d.jsx)("div",{role:"status","aria-live":"polite",className:"sr-only",children:ab&&a.thinkingStartedAt?"AI is thinking about your question":"AI is generating a response"}),"complete"===a.status&&(0,d.jsxs)("div",{role:"status","aria-live":"polite",className:"sr-only",children:[ac&&`Response generated in ${(0,q.formatTTFT)(ac)}`,a.tokensPerSecond&&` at ${Math.round(a.tokensPerSecond)} tokens per second`]}),"error"===a.status&&(0,d.jsxs)("div",{role:"alert","aria-live":"assertive",className:"sr-only",children:["Error generating response: ",a.error]}),"stopped"===a.status&&(0,d.jsx)("div",{role:"status","aria-live":"polite",className:"sr-only",children:"Generation was stopped by user"})]}),!c&&(0,d.jsx)(w.MessageBranchIndicator,{messageId:a._id}),!c&&X.showNotes&&(0,d.jsx)(A.MessageNotesIndicator,{messageId:a._id}),!P&&("complete"===a.status||"generating"===a.status||"stopped"===a.status)&&aa&&(0,d.jsx)(B.MessageStatsBadges,{modelName:aa,ttft:ac,isCached:ad,tokensPerSecond:a.tokensPerSecond,inputTokens:a.inputTokens,outputTokens:a.outputTokens,status:a.status,showStats:W})]})}),!c&&!P&&"complete"===a.status&&Z?.modelRecommendation&&!Z.modelRecommendation.dismissed&&(0,d.jsx)("div",{className:"mt-4",children:(0,d.jsx)(C.ModelRecommendationBanner,{recommendation:Z.modelRecommendation,conversationId:a.conversationId,onSwitch:al,onPreview:a=>{let b=new CustomEvent("open-model-preview",{detail:{modelId:a}});window.dispatchEvent(b)}})}),!Q&&(0,d.jsx)("div",{className:(0,p.cn)("absolute z-10",P?"right-5 sm:right-6":"left-5 sm:left-6","-bottom-8","flex justify-end","transition-opacity duration-200 ease-out",V?"opacity-100":"opacity-0 group-hover:opacity-100",!V&&"pointer-events-none group-hover:pointer-events-auto"),children:(0,d.jsx)(v.MessageActions,{message:a,nextMessage:b,readOnly:c,onEdit:P?()=>{N(a.content||""),L(!0)}:void 0})})]})})},(a,b)=>a.message._id===b.message._id&&a.message.partialContent===b.message.partialContent&&a.message.status===b.message.status&&a.nextMessage?.status===b.nextMessage?.status&&a.isCollaborative===b.isCollaborative&&a.senderUser?.name===b.senderUser?.name);a.s(["ChatMessage",0,H]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__d37e30f9._.js.map