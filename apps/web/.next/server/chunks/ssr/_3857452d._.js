module.exports=[455273,a=>{"use strict";let b=(0,a.i(366705).default)("ghost",[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]]);a.s(["Ghost",()=>b],455273)},726260,a=>{"use strict";let b=(0,a.i(366705).default)("keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);a.s(["Keyboard",()=>b],726260)},18124,a=>{"use strict";var b=a.i(129239);class c extends Error{status;code;constructor(a,b,c){super(c||`API Error: ${a}`),this.status=a,this.code=b,this.name="ApiClientError"}}async function d(a,b,d){let e=await d();if(!e)throw new c(401,"UNAUTHORIZED","Auth required");let f=await fetch(a,{...b,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,...b.headers}}),g=await f.json();if(!f.ok||"error"===g.status){let a="string"==typeof g.error?g.error:g.error?.message,b="object"==typeof g.error?g.error?.code:void 0;throw new c(f.status,b,a)}return g.data}function e(){let{getToken:a}=(0,b.useAuth)();return{get:b=>d(b,{method:"GET"},a),post:(b,c)=>d(b,{method:"POST",body:JSON.stringify(c)},a),patch:(b,c)=>d(b,{method:"PATCH",body:JSON.stringify(c)},a),delete:b=>d(b,{method:"DELETE"},a)}}a.s(["useApiClient",()=>e])},259296,701248,224538,341322,680486,983582,246413,a=>{"use strict";var b=a.i(537500),c=a.i(775326),d=a.i(300601),e=a.i(8206),f=a.i(808334),g=class extends e.Subscribable{#a;#b=void 0;#c;#d;constructor(a,b){super(),this.#a=a,this.setOptions(b),this.bindMethods(),this.#e()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(a){let b=this.options;this.options=this.#a.defaultMutationOptions(a),(0,f.shallowEqualObjects)(this.options,b)||this.#a.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#c,observer:this}),b?.mutationKey&&this.options.mutationKey&&(0,f.hashKey)(b.mutationKey)!==(0,f.hashKey)(this.options.mutationKey)?this.reset():this.#c?.state.status==="pending"&&this.#c.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#c?.removeObserver(this)}onMutationUpdate(a){this.#e(),this.#f(a)}getCurrentResult(){return this.#b}reset(){this.#c?.removeObserver(this),this.#c=void 0,this.#e(),this.#f()}mutate(a,b){return this.#d=b,this.#c?.removeObserver(this),this.#c=this.#a.getMutationCache().build(this.#a,this.options),this.#c.addObserver(this),this.#c.execute(a)}#e(){let a=this.#c?.state??(0,c.getDefaultState)();this.#b={...a,isPending:"pending"===a.status,isSuccess:"success"===a.status,isError:"error"===a.status,isIdle:"idle"===a.status,mutate:this.mutate,reset:this.reset}}#f(a){d.notifyManager.batch(()=>{if(this.#d&&this.hasListeners()){let b=this.#b.variables,c=this.#b.context,d={client:this.#a,meta:this.options.meta,mutationKey:this.options.mutationKey};a?.type==="success"?(this.#d.onSuccess?.(a.data,b,c,d),this.#d.onSettled?.(a.data,null,b,c,d)):a?.type==="error"&&(this.#d.onError?.(a.error,b,c,d),this.#d.onSettled?.(void 0,a.error,b,c,d))}this.listeners.forEach(a=>{a(this.#b)})})}},h=a.i(965265);function i(a,c){let e=(0,h.useQueryClient)(c),[i]=b.useState(()=>new g(e,a));b.useEffect(()=>{i.setOptions(a)},[i,a]);let j=b.useSyncExternalStore(b.useCallback(a=>i.subscribe(d.notifyManager.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),k=b.useCallback((a,b)=>{i.mutate(a,b).catch(f.noop)},[i]);if(j.error&&(0,f.shouldThrowError)(i.options.throwOnError,[j.error]))throw j.error;return{...j,mutate:k,mutateAsync:j.mutate}}var j=a.i(753884),k=a.i(18124);let l={conversations:{all:["conversations"],lists:()=>[...l.conversations.all,"list"],detail:a=>[...l.conversations.all,a]},messages:{all:["messages"],list:a=>[...l.messages.all,a]},preferences:{all:["preferences"]}};function m(){let a=(0,k.useApiClient)(),b=(0,h.useQueryClient)();return i({mutationFn:async({conversationId:b})=>a.patch(`/api/v1/conversations/${b}/archive`),onSuccess:(a,c)=>{b.invalidateQueries({queryKey:l.conversations.lists()}),j.toast.success("Conversation archived")},onError:a=>{let b=a instanceof Error?a.message:"Failed to archive conversation";j.toast.error(b)}})}function n(){let a=(0,k.useApiClient)(),b=(0,h.useQueryClient)();return i({mutationFn:async({conversationId:b})=>a.delete(`/api/v1/conversations/${b}`),onSuccess:(a,c)=>{b.invalidateQueries({queryKey:l.conversations.lists()}),b.removeQueries({queryKey:l.conversations.detail(c.conversationId)}),j.toast.success("Conversation deleted")},onError:a=>{let b=a instanceof Error?a.message:"Failed to delete conversation";j.toast.error(b)}})}a.s(["useArchiveConversation",()=>m],701248),a.s(["useDeleteConversation",()=>n],224538);var o=a.i(130487);a.i(16243);var p=a.i(182234),q=a.i(638600);let r=new class{STORAGE_KEY="blah-chat-offline-queue";MAX_RETRIES=3;enqueue(a){let b=this.getQueue(),c={...a,id:crypto.randomUUID(),timestamp:Date.now(),retries:0};b.push(c),this.persist(b),this.dispatchQueueUpdate()}async processQueue(a){for(let b of this.getQueue())try{await a(b),this.remove(b.id)}catch(a){if(b.retries>=this.MAX_RETRIES)this.remove(b.id),console.error(`[MessageQueue] Permanently failed after ${this.MAX_RETRIES} retries:`,b.content.slice(0,50));else{this.incrementRetry(b.id);let a=2e3*2**b.retries;await new Promise(b=>setTimeout(b,a))}}}getQueue(){try{let a=localStorage.getItem(this.STORAGE_KEY);return a?JSON.parse(a):[]}catch(a){return console.error("[MessageQueue] Failed to read queue:",a),[]}}getCount(){return this.getQueue().length}clear(){localStorage.removeItem(this.STORAGE_KEY),this.dispatchQueueUpdate()}persist(a){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(a))}catch(a){console.error("[MessageQueue] Failed to persist queue:",a)}}remove(a){let b=this.getQueue().filter(b=>b.id!==a);this.persist(b),this.dispatchQueueUpdate()}incrementRetry(a){let b=this.getQueue(),c=b.find(b=>b.id===a);c&&(c.retries++,this.persist(b))}dispatchQueueUpdate(){window.dispatchEvent(new CustomEvent("queue-updated",{detail:{count:this.getCount()}}))}};function s(a){let c=(0,k.useApiClient)(),d=(0,h.useQueryClient)(),e=(0,p.useQuery)(o.api.users.getCurrentUser);return(0,b.useEffect)(()=>{let a=async()=>{let a=r.getCount();0!==a&&(j.toast.info(`Processing ${a} queued message${a>1?"s":""}...`),await r.processQueue(async a=>{await c.post(`/api/v1/conversations/${a.conversationId}/messages`,{conversationId:a.conversationId,content:a.content,modelId:a.modelId,models:a.models,attachments:a.attachments})}),j.toast.success("All queued messages sent"))};return window.addEventListener("online",a),()=>window.removeEventListener("online",a)},[c]),i({mutationFn:async a=>c.post(`/api/v1/conversations/${a.conversationId}/messages`,a),onMutate:b=>{let c={_id:`temp-user-${Date.now()}`,conversationId:b.conversationId,userId:e?._id,role:"user",content:b.content,status:"optimistic",attachments:b.attachments?.map(a=>({id:a.storageId,storageId:a.storageId,_optimistic:!0})),createdAt:Date.now(),updatedAt:Date.now(),_creationTime:Date.now(),_optimistic:!0},d=b.models||[b.modelId],f=d.filter(a=>!!a).map((a,c)=>({_id:`temp-assistant-${Date.now()}-${c}`,conversationId:b.conversationId,userId:e?._id,role:"assistant",content:"",status:"pending",model:a,comparisonGroupId:d.length>1?`temp-comparison-${Date.now()}`:void 0,createdAt:Date.now()+c+1,updatedAt:Date.now()+c+1,_creationTime:Date.now()+c+1,_optimistic:!0}));return a?.([c,...f]),{optimisticIds:[c._id,...f.map(a=>a._id)]}},onSuccess:(a,b)=>{d.invalidateQueries({queryKey:l.messages.list(b.conversationId)}),q.analytics.track("message_sent",{model:b.models?b.models.join(","):b.modelId??"unknown",hasAttachments:!!b.attachments?.length})},onError:(a,b,c)=>{let d=a instanceof Error?a.message:"Failed to send message";navigator.onLine?j.toast.error(d):(r.enqueue({conversationId:b.conversationId,content:b.content,modelId:b.modelId,models:b.models,attachments:b.attachments}),j.toast.info("You're offline. Message queued and will send when reconnected."))}})}function t(){let a=(0,k.useApiClient)(),b=(0,h.useQueryClient)();return i({mutationFn:async({conversationId:b})=>a.patch(`/api/v1/conversations/${b}/pin`),onMutate:async({conversationId:a})=>{await b.cancelQueries({queryKey:l.conversations.lists()});let c=b.getQueryData(l.conversations.lists());return b.setQueriesData({queryKey:l.conversations.lists()},b=>b?b.map(b=>b._id===a?{...b,pinned:!b.pinned}:b):b),{previous:c}},onError:(a,c,d)=>{d?.previous&&b.setQueryData(l.conversations.lists(),d.previous),j.toast.error("Failed to toggle pin")},onSettled:()=>{b.invalidateQueries({queryKey:l.conversations.lists()})}})}function u(){let a=(0,k.useApiClient)(),b=(0,h.useQueryClient)();return i({mutationFn:async({conversationId:b})=>a.patch(`/api/v1/conversations/${b}/star`),onMutate:async({conversationId:a})=>{await b.cancelQueries({queryKey:l.conversations.lists()});let c=b.getQueryData(l.conversations.lists());return b.setQueriesData({queryKey:l.conversations.lists()},b=>b?b.map(b=>b._id===a?{...b,starred:!b.starred}:b):b),{previous:c}},onError:(a,c,d)=>{d?.previous&&b.setQueryData(l.conversations.lists(),d.previous),j.toast.error("Failed to toggle star")},onSettled:()=>{b.invalidateQueries({queryKey:l.conversations.lists()})}})}a.s(["messageQueue",0,r],341322),a.s(["useSendMessage",()=>s],680486),a.s(["useTogglePin",()=>t],983582),a.s(["useToggleStar",()=>u],246413),a.s([],259296)},712109,502101,284990,a=>{"use strict";var b=a.i(130487);a.i(16243);var c=a.i(182234),d=a.i(502311),e=a.i(537500),f=a.i(753884),g=a.i(638600);a.i(259296);var h=a.i(701248),i=a.i(224538),j=a.i(983582),k=a.i(246413);function l(a,l){let m=(0,d.useRouter)(),[n,o]=(0,e.useState)(!1),{mutate:p,isPending:q}=(0,i.useDeleteConversation)(),{mutate:r,isPending:s}=(0,h.useArchiveConversation)(),{mutate:t,isPending:u}=(0,j.useTogglePin)(),{mutate:v,isPending:w}=(0,k.useToggleStar)(),x=(0,c.useAction)(b.api.conversations.actions.bulkAutoRename);return{handleDelete:()=>{a&&p({conversationId:a},{onSuccess:()=>{g.analytics.track("conversation_action",{action:"delete",source:l,conversationId:a}),m.push("/")}})},handleArchive:()=>{a&&r({conversationId:a},{onSuccess:()=>{g.analytics.track("conversation_action",{action:"archive",source:l,conversationId:a}),m.push("/")}})},handleTogglePin:b=>{a&&t({conversationId:a},{onSuccess:()=>{f.toast.success(b?"Conversation unpinned":"Conversation pinned"),g.analytics.track("conversation_action",{action:b?"unpin":"pin",source:l,conversationId:a})}})},handleToggleStar:b=>{a&&v({conversationId:a},{onSuccess:()=>{f.toast.success(b?"Conversation unstarred":"Conversation starred"),g.analytics.track("conversation_action",{action:b?"unstar":"star",source:l,conversationId:a})}})},handleAutoRename:async()=>{if(a)try{o(!0),f.toast.loading("Generating title...",{id:"auto-rename"});let b=await x({conversationIds:[a]});if(b[0]?.success)f.toast.success("Conversation renamed",{id:"auto-rename"}),g.analytics.track("conversation_action",{action:"auto_rename",source:l,conversationId:a});else throw Error(b[0]?.error||"Failed to generate title")}catch(b){let a=b instanceof Error?b.message:"Failed to auto-rename";f.toast.error(a,{id:"auto-rename"})}finally{o(!1)}},isLoading:q||s||u||w||n}}a.s(["useConversationActions",()=>l],712109);var m=a.i(367146),n=a.i(828288);function o({open:a,onOpenChange:b,onConfirm:c,conversationTitle:d}){return(0,m.jsx)(n.AlertDialog,{open:a,onOpenChange:b,children:(0,m.jsxs)(n.AlertDialogContent,{children:[(0,m.jsxs)(n.AlertDialogHeader,{children:[(0,m.jsx)(n.AlertDialogTitle,{children:"Delete conversation?"}),(0,m.jsxs)(n.AlertDialogDescription,{children:["This will permanently delete"," ",(0,m.jsxs)("span",{className:"font-medium text-foreground",children:['"',d||"this conversation",'"']})," ","and all its messages. This action cannot be undone."]})]}),(0,m.jsxs)(n.AlertDialogFooter,{children:[(0,m.jsx)(n.AlertDialogCancel,{children:"Cancel"}),(0,m.jsx)(n.AlertDialogAction,{onClick:c,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})}a.s(["DeleteConversationDialog",()=>o],502101);var p=a.i(539524),q=a.i(227759),r=a.i(928503);function s({conversation:a,open:d,onOpenChange:f}){let[g,h]=(0,e.useState)(a.title||""),i=(0,c.useMutation)(b.api.conversations.rename),j=async()=>{await i({conversationId:a._id,title:g}),f(!1)};return(0,m.jsx)(q.Dialog,{open:d,onOpenChange:f,children:(0,m.jsxs)(q.DialogContent,{children:[(0,m.jsx)(q.DialogHeader,{children:(0,m.jsx)(q.DialogTitle,{children:"Rename conversation"})}),(0,m.jsx)(r.Input,{value:g,onChange:a=>h(a.target.value),placeholder:"Enter title...",onKeyDown:a=>{"Enter"===a.key&&j()}}),(0,m.jsxs)(q.DialogFooter,{children:[(0,m.jsx)(p.Button,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),(0,m.jsx)(p.Button,{onClick:j,children:"Save"})]})]})})}a.s(["RenameDialog",()=>s],284990)},868990,a=>{"use strict";let b=(0,a.i(366705).default)("quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);a.s(["Quote",()=>b],868990)},726481,a=>{"use strict";var b=a.i(367146),c=a.i(134186);function d({keys:a}){let d=a.map(a=>"mod"===a?(0,c.getModifierKey)():a);return(0,b.jsx)("kbd",{className:"inline-flex h-5 select-none items-center gap-1 rounded border bg-background/50 px-1.5 font-mono text-[10px] font-medium text-muted-foreground",children:d.map((a,c)=>(0,b.jsxs)("span",{children:[c>0&&(0,b.jsx)("span",{className:"mx-0.5",children:"+"}),a]},c))})}a.s(["ShortcutBadge",()=>d])}];

//# sourceMappingURL=_3857452d._.js.map