{"version":3,"sources":["../../../../../../apps/web/src/components/canvas/CanvasPanel.tsx","../../../../../../apps/web/src/components/canvas/CanvasErrorBoundary.tsx","../../../../../../apps/web/src/components/canvas/CanvasToolbar.tsx","../../../../../../apps/web/src/components/canvas/CanvasEditor.tsx","../../../../../../apps/web/src/components/canvas/ConflictDialog.tsx","../../../../../../apps/web/src/components/canvas/VersionHistoryPanel.tsx","../../../../../../node_modules/.bun/lucide-react%400.555.0%2B83d5fd7b249dbeef/node_modules/lucide-react/src/icons/history.ts","../../../../../../node_modules/.bun/lucide-react%400.555.0%2B83d5fd7b249dbeef/node_modules/lucide-react/src/icons/redo-2.ts","../../../../../../apps/web/src/hooks/useCanvasHistory.ts","../../../../../../apps/web/src/components/chat/ChatHeader.tsx","../../../../../../apps/web/src/components/chat/BranchBadge.tsx","../../../../../../apps/web/src/components/chat/ContextWindowIndicator.tsx","../../../../../../apps/web/src/components/chat/ConversationHeaderMenu.tsx","../../../../../../apps/web/src/lib/export/markdown.ts","../../../../../../apps/web/src/components/chat/FireButton.tsx","../../../../../../apps/web/src/components/chat/IncognitoBadge.tsx","../../../../../../apps/web/src/components/chat/ModelBadge.tsx","../../../../../../apps/web/src/components/chat/ShareDialog.tsx","../../../../../../apps/web/src/components/projects/ProjectSelector.tsx","../../../../../../apps/web/src/components/chat/ChatInput.tsx","../../../../../../apps/web/src/components/chat/VoiceInput.tsx","../../../../../../apps/web/src/components/chat/AttachmentPreview.tsx","../../../../../../apps/web/src/components/chat/AudioWaveform.tsx","../../../../../../apps/web/src/components/chat/FileUpload.tsx","../../../../../../apps/web/src/components/chat/ComparisonTrigger.tsx","../../../../../../apps/web/src/hooks/useModifierKey.ts","../../../../../../apps/web/src/components/chat/KeyboardHints.tsx","../../../../../../apps/web/src/components/chat/ThinkingEffortSelector.tsx","../../../../../../apps/web/src/components/chat/InputBottomBar.tsx","../../../../../../apps/web/src/components/chat/QuotePreview.tsx","../../../../../../apps/web/src/components/chat/RateLimitDialog.tsx","../../../../../../apps/web/src/components/chat/ExpandedInputDialog.tsx","../../../../../../apps/web/src/lib/utils/chatWidth.ts","../../../../../../apps/web/src/hooks/useBrowserFeature.ts","../../../../../../node_modules/.bun/lucide-react%400.555.0%2B83d5fd7b249dbeef/node_modules/lucide-react/src/icons/arrow-left-right.ts","../../../../../../node_modules/.bun/lucide-react%400.555.0%2B83d5fd7b249dbeef/node_modules/lucide-react/src/icons/expand.ts","../../../../../../apps/web/src/components/chat/HydrationSafeShortcutBadge.tsx","../../../../../../node_modules/.bun/lucide-react%400.555.0%2B83d5fd7b249dbeef/node_modules/lucide-react/src/icons/file-spreadsheet.ts","../../../../../../node_modules/.bun/lucide-react%400.555.0%2B83d5fd7b249dbeef/node_modules/lucide-react/src/icons/send.ts","../../../../../../apps/web/src/hooks/useChatInputKeyboard.ts","../../../../../../apps/web/src/hooks/useChatInputEvents.ts","../../../../../../node_modules/.bun/lucide-react%400.555.0%2B83d5fd7b249dbeef/node_modules/lucide-react/src/icons/arrow-right-left.ts","../../../../../../apps/web/src/components/chat/ModelPreviewModal.tsx","../../../../../../apps/web/src/components/chat/SetDefaultModelPrompt.tsx","../../../../../../apps/web/src/components/chat/TTSPlayerBar.tsx","../../../../../../apps/web/src/hooks/useAutoScroll.ts","../../../../../../apps/web/src/hooks/useConversationScroll.ts","../../../../../../apps/web/src/hooks/useHighlightScroll.ts","../../../../../../apps/web/src/hooks/useMessageGrouping.ts","../../../../../../node_modules/.bun/%40tanstack%2Bquery-core%405.90.12/node_modules/%40tanstack/query-core/build/modern/queryObserver.js","../../../../../../apps/web/src/lib/hooks/queries/useConversations.ts","../../../../../../node_modules/.bun/%40tanstack%2Breact-query%405.90.12%2B83d5fd7b249dbeef/node_modules/%40tanstack/react-query/build/modern/QueryErrorResetBoundary.js","../../../../../../node_modules/.bun/%40tanstack%2Breact-query%405.90.12%2B83d5fd7b249dbeef/node_modules/%40tanstack/react-query/build/modern/errorBoundaryUtils.js","../../../../../../node_modules/.bun/%40tanstack%2Breact-query%405.90.12%2B83d5fd7b249dbeef/node_modules/%40tanstack/react-query/build/modern/IsRestoringProvider.js","../../../../../../node_modules/.bun/%40tanstack%2Breact-query%405.90.12%2B83d5fd7b249dbeef/node_modules/%40tanstack/react-query/build/modern/suspense.js","../../../../../../node_modules/.bun/%40tanstack%2Breact-query%405.90.12%2B83d5fd7b249dbeef/node_modules/%40tanstack/react-query/build/modern/useBaseQuery.js","../../../../../../node_modules/.bun/%40tanstack%2Breact-query%405.90.12%2B83d5fd7b249dbeef/node_modules/%40tanstack/react-query/build/modern/useQuery.js","../../../../../../apps/web/src/lib/prompts/examplePrompts.ts","../../../../../../apps/web/src/components/chat/EmptyScreen.tsx","../../../../../../apps/web/src/components/chat/VirtualizedMessageList.tsx","../../../../../../apps/web/src/components/templates/QuickTemplateSwitcher.tsx","../../../../../../apps/web/src/components/ui/resizable.tsx","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/utils/assert.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/dom/calculateAvailableGroupSize.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/sortByElementOffset.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/utils/isHTMLElement.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/getDistanceBetweenPointAndRect.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/findClosestRect.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/dom/calculateHitRegions.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/styles/convertEmToPixels.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/styles/convertRemToPixels.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/styles/convertVhToPixels.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/styles/convertVwToPixels.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/styles/parseSizeAndUnit.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/styles/sizeStyleToPixels.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/formatLayoutNumber.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/dom/calculatePanelConstraints.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/utils/EventEmitter.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/layoutNumbersEqual.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/mutableState.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/utils/isArrayEqual.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/compareLayoutNumbers.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/validatePanelSize.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/adjustLayoutByDelta.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/findSeparatorGroup.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/layoutsEqual.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/validatePanelGroupLayout.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/getImperativeGroupMethods.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/getMountedGroup.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/adjustLayoutForSeparator.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/event-handlers/onDocumentKeyDown.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/constants.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/findClosetHitRegion.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/isCoarsePointer.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/utils/isShadowRoot.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/vendor/stacking-order.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/doRectsIntersect.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/isViableHitTarget.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/findMatchingHitRegions.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/event-handlers/onDocumentPointerDown.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/cursor/getCursorStyle.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/cursor/updateCursorStyle.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/updateActiveHitRegion.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/event-handlers/onDocumentPointerLeave.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/event-handlers/onDocumentPointerMove.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/event-handlers/onDocumentPointerUp.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/calculateDefaultLayout.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/notifyPanelOnResize.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/objectsEqual.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/validateLayoutKeys.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/mountGroup.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/hooks/useId.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/hooks/useIsomorphicLayoutEffect.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/hooks/useStableCallback.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/hooks/useMergedRefs.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/hooks/useStableObject.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/panel/constants.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/getPanelSizeCssPropertyName.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/GroupContext.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/useGroupImperativeHandle.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/Group.tsx","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/utils/debounce.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/auto-save/getStorageKey.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/useDefaultLayout.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/useGroupCallbackRef.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/useGroupRef.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/group/useGroupContext.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/getImperativePanelMethods.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/panel/usePanelImperativeHandle.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/panel/Panel.tsx","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/panel/usePanelCallbackRef.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/panel/usePanelRef.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/global/utils/calculateSeparatorAriaValues.ts","../../../../../../node_modules/.bun/react-resizable-panels%404.0.15%2B67f6792bdf102c28/node_modules/react-resizable-panels/lib/components/separator/Separator.tsx","../../../../../../apps/web/src/hooks/useCanvasAutoSync.ts","../../../../../../apps/web/src/hooks/useChatKeyboardShortcuts.ts","../../../../../../apps/web/src/hooks/useChatModelSelection.ts","../../../../../../apps/web/src/hooks/useComparisonHandlers.ts","../../../../../../apps/web/src/hooks/useComparisonMode.ts","../../../../../../apps/web/src/hooks/useConversationNavigation.ts","../../../../../../apps/web/src/hooks/useModelRecommendation.ts","../../../../../../apps/web/src/hooks/useOptimisticMessages.ts","../../../../../../apps/web/src/hooks/useTemplateInsertion.ts","../../../../../../apps/web/src/app/%28main%29/chat/%5BconversationId%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation, useQuery } from \"convex/react\";\nimport { X } from \"lucide-react\";\nimport type { editor } from \"monaco-editor\";\nimport { useCallback, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useCanvasContext } from \"@/contexts/CanvasContext\";\nimport { CanvasEditor } from \"./CanvasEditor\";\nimport { ConflictDialog, mergeContents } from \"./ConflictDialog\";\nimport { VersionHistoryPanel } from \"./VersionHistoryPanel\";\n\ninterface CanvasPanelProps {\n  documentId: Id<\"canvasDocuments\">;\n  onClose: () => void;\n}\n\nexport function CanvasPanel({ documentId, onClose }: CanvasPanelProps) {\n  const editorRef = useRef<editor.IStandaloneCodeEditor | null>(null);\n  const { pendingConflict, setPendingConflict, showHistoryPanel } =\n    useCanvasContext();\n\n  // @ts-ignore - Type depth exceeded\n  const document = useQuery(api.canvas.documents.get, { documentId });\n  // @ts-ignore - Type depth exceeded\n  const updateContent = useMutation(api.canvas.documents.updateContent);\n\n  const handleConflictResolve = useCallback(\n    async (choice: \"user\" | \"ai\" | \"merge\") => {\n      if (!pendingConflict || !document) return;\n\n      let resolvedContent: string;\n\n      switch (choice) {\n        case \"user\":\n          // Keep user's version - no changes needed\n          resolvedContent = pendingConflict.userContent;\n          break;\n        case \"ai\":\n          // Use AI's version\n          resolvedContent = pendingConflict.aiContent;\n          break;\n        case \"merge\":\n          // Merge both with separator\n          resolvedContent = mergeContents(\n            pendingConflict.userContent,\n            pendingConflict.aiContent,\n          );\n          break;\n      }\n\n      await updateContent({\n        documentId: pendingConflict.documentId,\n        content: resolvedContent,\n        source: \"user_edit\",\n        diff: `Conflict resolved: ${choice}`,\n      });\n\n      setPendingConflict(null);\n    },\n    [pendingConflict, document, updateContent, setPendingConflict],\n  );\n\n  if (!document) {\n    return (\n      <div className=\"h-full border-l bg-card flex items-center justify-center\">\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full border-l bg-card flex\">\n      {/* Main Editor Panel */}\n      <div className=\"flex-1 flex flex-col min-w-0\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-4 border-b\">\n          <div className=\"flex items-center gap-2 min-w-0\">\n            <h3 className=\"font-semibold text-sm truncate\">{document.title}</h3>\n            {document.language && (\n              <span className=\"text-xs px-2 py-0.5 rounded bg-muted text-muted-foreground shrink-0\">\n                {document.language}\n              </span>\n            )}\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={onClose}\n            className=\"h-8 w-8 shrink-0\"\n          >\n            <X className=\"h-4 w-4\" />\n          </Button>\n        </div>\n\n        {/* Monaco Editor */}\n        <div className=\"flex-1 overflow-hidden\">\n          <CanvasEditor\n            document={document}\n            onEditorReady={(ed) => {\n              editorRef.current = ed;\n            }}\n          />\n        </div>\n\n        {/* Footer with version info */}\n        <div className=\"p-4 border-t text-xs text-muted-foreground\">\n          Version {document.version} â€¢ {document.documentType}\n        </div>\n      </div>\n\n      {/* Version History Panel (conditional) */}\n      {showHistoryPanel && (\n        <div className=\"w-64 shrink-0\">\n          <VersionHistoryPanel documentId={documentId} />\n        </div>\n      )}\n\n      {/* Conflict Resolution Dialog */}\n      {pendingConflict && (\n        <ConflictDialog\n          open={!!pendingConflict}\n          onClose={() => setPendingConflict(null)}\n          conflict={{\n            description: pendingConflict.description,\n            userContent: pendingConflict.userContent,\n            aiContent: pendingConflict.aiContent,\n            lineRange: pendingConflict.lineRange,\n          }}\n          onResolve={handleConflictResolve}\n        />\n      )}\n    </div>\n  );\n}\n","\"use client\";\n\nimport { AlertTriangle, RefreshCw } from \"lucide-react\";\nimport { Component, type ReactNode } from \"react\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n}\n\nexport class CanvasErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    console.error(\"Canvas error:\", error, errorInfo);\n  }\n\n  handleRetry = () => {\n    this.setState({ hasError: false, error: undefined });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        this.props.fallback ?? (\n          <div className=\"h-full flex flex-col items-center justify-center gap-4 p-8 text-center\">\n            <AlertTriangle className=\"w-12 h-12 text-destructive\" />\n            <div>\n              <h3 className=\"font-semibold mb-1\">Something went wrong</h3>\n              <p className=\"text-sm text-muted-foreground mb-4\">\n                The Canvas editor encountered an error.\n              </p>\n              <p className=\"text-xs text-muted-foreground font-mono mb-4 max-w-md break-all\">\n                {this.state.error?.message}\n              </p>\n            </div>\n            <Button onClick={this.handleRetry} variant=\"outline\">\n              <RefreshCw className=\"w-4 h-4 mr-2\" />\n              Try Again\n            </Button>\n          </div>\n        )\n      );\n    }\n\n    return this.props.children;\n  }\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useQuery } from \"convex/react\";\nimport {\n  Check,\n  Copy,\n  Download,\n  History,\n  MoreHorizontal,\n  Redo2,\n  RefreshCw,\n  Trash2,\n  Undo2,\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { useCanvasContext } from \"@/contexts/CanvasContext\";\nimport { useCanvasHistory } from \"@/hooks/useCanvasHistory\";\nimport { cn } from \"@/lib/utils\";\n\ninterface CanvasToolbarProps {\n  documentId: Id<\"canvasDocuments\"> | null;\n  isSaving?: boolean;\n  className?: string;\n  onDelete?: () => void;\n}\n\nexport function CanvasToolbar({\n  documentId,\n  isSaving = false,\n  className,\n  onDelete,\n}: CanvasToolbarProps) {\n  const { setShowHistoryPanel } = useCanvasContext();\n  const [copied, setCopied] = useState(false);\n\n  // @ts-ignore - Type depth exceeded\n  const document = useQuery(\n    api.canvas.documents.get,\n    documentId ? { documentId } : \"skip\",\n  );\n\n  const {\n    canUndo,\n    canRedo,\n    undo,\n    redo,\n    currentVersion,\n    latestVersion,\n    isViewingOldVersion,\n    jumpToVersion,\n  } = useCanvasHistory(documentId ?? undefined);\n\n  const handleCopy = async () => {\n    if (document?.content) {\n      await navigator.clipboard.writeText(document.content);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    }\n  };\n\n  const handleDownload = () => {\n    if (!document) return;\n\n    const extension = getFileExtension(document.language);\n    const blob = new Blob([document.content], { type: \"text/plain\" });\n    const url = URL.createObjectURL(blob);\n    const a = window.document.createElement(\"a\");\n    a.href = url;\n    a.download = `${document.title}${extension}`;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <div\n      className={cn(\n        \"flex items-center gap-1 px-2 py-1 border-b border-border bg-muted/30\",\n        className,\n      )}\n    >\n      {/* Document info */}\n      <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n        <span>\n          {document?.documentType === \"code\"\n            ? (document.language ?? \"plaintext\")\n            : \"Document\"}\n        </span>\n        <span className=\"text-muted-foreground/50\">|</span>\n        <span className={isViewingOldVersion ? \"text-amber-500\" : \"\"}>\n          v{currentVersion}\n          {isViewingOldVersion && ` of ${latestVersion}`}\n        </span>\n      </div>\n\n      {/* Jump to Latest - shown when viewing old version */}\n      {isViewingOldVersion && (\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"h-6 px-2 text-xs ml-2 gap-1\"\n              onClick={() => jumpToVersion(latestVersion)}\n            >\n              <RefreshCw className=\"h-3 w-3\" />\n              Latest\n            </Button>\n          </TooltipTrigger>\n          <TooltipContent>\n            Jump to latest version (v{latestVersion})\n          </TooltipContent>\n        </Tooltip>\n      )}\n\n      {/* Undo/Redo */}\n      <div className=\"flex items-center gap-0.5 ml-2\">\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-6 w-6\"\n              disabled={!canUndo}\n              onClick={undo}\n            >\n              <Undo2 className=\"h-3.5 w-3.5\" />\n            </Button>\n          </TooltipTrigger>\n          <TooltipContent>Undo version</TooltipContent>\n        </Tooltip>\n\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-6 w-6\"\n              disabled={!canRedo}\n              onClick={redo}\n            >\n              <Redo2 className=\"h-3.5 w-3.5\" />\n            </Button>\n          </TooltipTrigger>\n          <TooltipContent>Redo version</TooltipContent>\n        </Tooltip>\n      </div>\n\n      <div className=\"flex-1\" />\n\n      {/* Save status */}\n      <span\n        className={cn(\n          \"text-xs mr-2\",\n          isSaving ? \"text-muted-foreground animate-pulse\" : \"text-green-500\",\n        )}\n      >\n        {isSaving ? \"Saving...\" : \"Saved\"}\n      </span>\n\n      {/* Actions */}\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-6 w-6\"\n            onClick={handleCopy}\n          >\n            {copied ? (\n              <Check className=\"h-3.5 w-3.5 text-green-500\" />\n            ) : (\n              <Copy className=\"h-3.5 w-3.5\" />\n            )}\n          </Button>\n        </TooltipTrigger>\n        <TooltipContent>\n          {copied ? \"Copied!\" : \"Copy to clipboard\"}\n        </TooltipContent>\n      </Tooltip>\n\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-6 w-6\"\n            onClick={handleDownload}\n          >\n            <Download className=\"h-3.5 w-3.5\" />\n          </Button>\n        </TooltipTrigger>\n        <TooltipContent>Download file</TooltipContent>\n      </Tooltip>\n\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-6 w-6\"\n            onClick={() => setShowHistoryPanel(true)}\n          >\n            <History className=\"h-3.5 w-3.5\" />\n          </Button>\n        </TooltipTrigger>\n        <TooltipContent>View history</TooltipContent>\n      </Tooltip>\n\n      <DropdownMenu>\n        <DropdownMenuTrigger asChild>\n          <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6\">\n            <MoreHorizontal className=\"h-3.5 w-3.5\" />\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent align=\"end\">\n          <DropdownMenuItem onClick={() => setShowHistoryPanel(true)}>\n            <History className=\"h-4 w-4 mr-2\" />\n            View history\n          </DropdownMenuItem>\n          <DropdownMenuSeparator />\n          <DropdownMenuItem className=\"text-destructive\" onClick={onDelete}>\n            <Trash2 className=\"h-4 w-4 mr-2\" />\n            Delete document\n          </DropdownMenuItem>\n        </DropdownMenuContent>\n      </DropdownMenu>\n    </div>\n  );\n}\n\nfunction getFileExtension(language?: string): string {\n  const extensions: Record<string, string> = {\n    typescript: \".ts\",\n    javascript: \".js\",\n    python: \".py\",\n    rust: \".rs\",\n    go: \".go\",\n    java: \".java\",\n    csharp: \".cs\",\n    cpp: \".cpp\",\n    c: \".c\",\n    html: \".html\",\n    css: \".css\",\n    json: \".json\",\n    yaml: \".yaml\",\n    markdown: \".md\",\n    sql: \".sql\",\n    shell: \".sh\",\n    bash: \".sh\",\n  };\n  return extensions[language ?? \"\"] ?? \".txt\";\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Doc } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation } from \"convex/react\";\nimport type { editor } from \"monaco-editor\";\nimport dynamic from \"next/dynamic\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { useDebounceValue } from \"usehooks-ts\";\nimport { CanvasErrorBoundary } from \"./CanvasErrorBoundary\";\nimport { CanvasToolbar } from \"./CanvasToolbar\";\n\n// Dynamic import Monaco to reduce initial bundle size (~75MB -> 0 on initial load)\nconst Editor = dynamic(\n  () => import(\"@monaco-editor/react\").then((mod) => mod.default),\n  {\n    ssr: false,\n    loading: () => (\n      <div className=\"h-full flex items-center justify-center text-muted-foreground\">\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin\" />\n          Loading editor...\n        </div>\n      </div>\n    ),\n  },\n);\n\ninterface CanvasEditorProps {\n  document: Doc<\"canvasDocuments\">;\n  onEditorReady?: (editor: editor.IStandaloneCodeEditor) => void;\n  onDelete?: () => void;\n}\n\nexport function CanvasEditor({\n  document,\n  onEditorReady,\n  onDelete,\n}: CanvasEditorProps) {\n  const editorRef = useRef<editor.IStandaloneCodeEditor | null>(null);\n  // @ts-ignore - Type depth exceeded\n  const updateContent = useMutation(api.canvas.documents.updateContent);\n\n  // Local content for immediate UI\n  const [localContent, setLocalContent] = useState(document.content);\n  const [debouncedContent] = useDebounceValue(localContent, 500);\n\n  // Track previous server content to detect server-initiated changes only\n  const prevDocumentContentRef = useRef(document.content);\n\n  // Sync external changes (LLM diffs) to editor - only when SERVER value changes\n  useEffect(() => {\n    if (document.content !== prevDocumentContentRef.current) {\n      // Server value changed (AI edit or external update)\n      if (editorRef.current) {\n        editorRef.current.setValue(document.content);\n      }\n      setLocalContent(document.content);\n      prevDocumentContentRef.current = document.content;\n    }\n  }, [document.content]);\n\n  // Persist debounced changes\n  useEffect(() => {\n    if (debouncedContent !== document.content) {\n      updateContent({\n        documentId: document._id,\n        content: debouncedContent,\n        source: \"user_edit\",\n      }).catch(console.error);\n    }\n  }, [debouncedContent, document._id, document.content, updateContent]);\n\n  const handleMount = useCallback(\n    (editorInstance: editor.IStandaloneCodeEditor) => {\n      editorRef.current = editorInstance;\n      onEditorReady?.(editorInstance);\n    },\n    [onEditorReady],\n  );\n\n  const isSaving = localContent !== document.content;\n\n  return (\n    <CanvasErrorBoundary>\n      <div className=\"h-full flex flex-col\">\n        {/* Enhanced Toolbar */}\n        <CanvasToolbar\n          documentId={document._id}\n          isSaving={isSaving}\n          onDelete={onDelete}\n        />\n\n        {/* Monaco Editor */}\n        <div className=\"flex-1 overflow-hidden\">\n          <Editor\n            height=\"100%\"\n            language={\n              document.language ??\n              (document.documentType === \"prose\" ? \"markdown\" : \"typescript\")\n            }\n            value={localContent}\n            onChange={(value) => setLocalContent(value ?? \"\")}\n            onMount={handleMount}\n            theme=\"vs-dark\"\n            options={{\n              fontSize: 14,\n              lineNumbers: \"on\",\n              minimap: { enabled: document.documentType === \"code\" },\n              wordWrap: document.documentType === \"prose\" ? \"on\" : \"off\",\n              scrollBeyondLastLine: false,\n              automaticLayout: true,\n              codeLens: false,\n              inlayHints: { enabled: \"off\" },\n            }}\n            loading={\n              <div className=\"h-full flex items-center justify-center text-muted-foreground\">\n                Loading editor...\n              </div>\n            }\n          />\n        </div>\n      </div>\n    </CanvasErrorBoundary>\n  );\n}\n","\"use client\";\n\nimport { AlertTriangle, Bot, FileText, GitMerge } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\n\ninterface ConflictDialogProps {\n  open: boolean;\n  onClose: () => void;\n  conflict: {\n    description: string;\n    userContent: string;\n    aiContent: string;\n    lineRange?: { start: number; end: number };\n  };\n  onResolve: (choice: \"user\" | \"ai\" | \"merge\") => void;\n}\n\nexport function ConflictDialog({\n  open,\n  onClose,\n  conflict,\n  onResolve,\n}: ConflictDialogProps) {\n  const [showComparison, setShowComparison] = useState(false);\n\n  const handleResolve = (choice: \"user\" | \"ai\" | \"merge\") => {\n    onResolve(choice);\n    onClose();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={(o) => !o && onClose()}>\n      <DialogContent className=\"max-w-2xl\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <AlertTriangle className=\"w-5 h-5 text-yellow-500\" />\n            Edit Conflict Detected\n          </DialogTitle>\n          <DialogDescription>\n            {conflict.description}\n            {conflict.lineRange && (\n              <span className=\"block mt-1 text-xs\">\n                Lines {conflict.lineRange.start}-{conflict.lineRange.end}\n              </span>\n            )}\n          </DialogDescription>\n        </DialogHeader>\n\n        {showComparison && (\n          <div className=\"grid grid-cols-2 gap-4 my-4\">\n            <div>\n              <div className=\"flex items-center gap-2 mb-2 text-sm font-medium\">\n                <FileText className=\"w-4 h-4\" />\n                Your Version\n              </div>\n              <pre className=\"p-3 rounded bg-muted text-xs overflow-auto max-h-48 whitespace-pre-wrap\">\n                {conflict.userContent || \"(empty)\"}\n              </pre>\n            </div>\n            <div>\n              <div className=\"flex items-center gap-2 mb-2 text-sm font-medium\">\n                <Bot className=\"w-4 h-4\" />\n                AI Version\n              </div>\n              <pre className=\"p-3 rounded bg-muted text-xs overflow-auto max-h-48 whitespace-pre-wrap\">\n                {conflict.aiContent || \"(empty)\"}\n              </pre>\n            </div>\n          </div>\n        )}\n\n        <DialogFooter className=\"flex-col sm:flex-row gap-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setShowComparison(!showComparison)}\n          >\n            {showComparison ? \"Hide\" : \"Show\"} Comparison\n          </Button>\n\n          <div className=\"flex gap-2 ml-auto\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleResolve(\"user\")}\n            >\n              <FileText className=\"w-4 h-4 mr-2\" />\n              Keep Mine\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => handleResolve(\"ai\")}\n            >\n              <Bot className=\"w-4 h-4 mr-2\" />\n              Use AI's\n            </Button>\n            <Button size=\"sm\" onClick={() => handleResolve(\"merge\")}>\n              <GitMerge className=\"w-4 h-4 mr-2\" />\n              Merge Both\n            </Button>\n          </div>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\n/**\n * Merge user and AI content with separator\n */\nexport function mergeContents(userContent: string, aiContent: string): string {\n  return `${userContent}\\n\\n---\\n\\n${aiContent}`;\n}\n","\"use client\";\n\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { Bot, Clock, Undo2, User, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { useCanvasContext } from \"@/contexts/CanvasContext\";\nimport { useCanvasHistory } from \"@/hooks/useCanvasHistory\";\nimport { cn } from \"@/lib/utils\";\n\ninterface VersionHistoryPanelProps {\n  documentId: Id<\"canvasDocuments\">;\n}\n\nexport function VersionHistoryPanel({ documentId }: VersionHistoryPanelProps) {\n  const { setShowHistoryPanel } = useCanvasContext();\n  const { history, currentVersion, jumpToVersion } =\n    useCanvasHistory(documentId);\n\n  if (!history) {\n    return (\n      <div className=\"h-full flex items-center justify-center p-4 text-muted-foreground text-sm\">\n        Loading history...\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full flex flex-col border-l border-border bg-muted/20\">\n      <div className=\"p-3 border-b border-border flex items-center justify-between\">\n        <h3 className=\"font-medium text-sm\">Version History</h3>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"h-6 w-6\"\n          onClick={() => setShowHistoryPanel(false)}\n        >\n          <X className=\"h-4 w-4\" />\n        </Button>\n      </div>\n\n      <ScrollArea className=\"flex-1\">\n        <div className=\"p-2 space-y-1\">\n          {history.map((entry) => (\n            <div\n              key={entry._id}\n              className={cn(\n                \"p-3 rounded-lg border transition-colors\",\n                entry.version === currentVersion\n                  ? \"border-primary bg-primary/5\"\n                  : \"border-transparent hover:bg-muted/50\",\n              )}\n            >\n              <div className=\"flex items-start justify-between gap-2\">\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    {entry.source === \"llm_diff\" ? (\n                      <Bot className=\"w-4 h-4 text-primary shrink-0\" />\n                    ) : (\n                      <User className=\"w-4 h-4 shrink-0\" />\n                    )}\n                    <span className=\"font-medium\">v{entry.version}</span>\n                    {entry.version === currentVersion && (\n                      <span className=\"text-xs text-primary\">(current)</span>\n                    )}\n                  </div>\n                  <div className=\"flex items-center gap-2 mt-1 text-xs text-muted-foreground\">\n                    <Clock className=\"w-3 h-3\" />\n                    {formatDistanceToNow(entry.createdAt, { addSuffix: true })}\n                  </div>\n                  {entry.diff && (\n                    <p className=\"mt-1 text-xs text-muted-foreground truncate\">\n                      {getChangeDescription(entry.diff)}\n                    </p>\n                  )}\n                </div>\n\n                {entry.version !== currentVersion && (\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"h-6 w-6 shrink-0\"\n                    onClick={() => jumpToVersion(entry.version)}\n                    title={`Restore v${entry.version}`}\n                  >\n                    <Undo2 className=\"w-4 h-4\" />\n                  </Button>\n                )}\n              </div>\n            </div>\n          ))}\n\n          {history.length === 0 && (\n            <div className=\"text-center text-sm text-muted-foreground py-8\">\n              No history available\n            </div>\n          )}\n        </div>\n      </ScrollArea>\n    </div>\n  );\n}\n\nfunction getChangeDescription(diff: string): string {\n  try {\n    const parsed = JSON.parse(diff);\n    if (typeof parsed === \"string\") return parsed;\n    if (parsed.changeDescription) return parsed.changeDescription;\n    if (parsed.operations?.length) {\n      return `${parsed.operations.length} change(s)`;\n    }\n    return \"Changes applied\";\n  } catch {\n    return typeof diff === \"string\" ? diff : \"Changes applied\";\n  }\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8', key: '1357e3' }],\n  ['path', { d: 'M3 3v5h5', key: '1xhq8a' }],\n  ['path', { d: 'M12 7v5l4 2', key: '1fdv2h' }],\n];\n\n/**\n * @component @name History\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyAxMmE5IDkgMCAxIDAgOS05IDkuNzUgOS43NSAwIDAgMC02Ljc0IDIuNzRMMyA4IiAvPgogIDxwYXRoIGQ9Ik0zIDN2NWg1IiAvPgogIDxwYXRoIGQ9Ik0xMiA3djVsNCAyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/history\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst History = createLucideIcon('history', __iconNode);\n\nexport default History;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm15 14 5-5-5-5', key: '12vg1m' }],\n  ['path', { d: 'M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13', key: '6uklza' }],\n];\n\n/**\n * @component @name Redo2\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTUgMTQgNS01LTUtNSIgLz4KICA8cGF0aCBkPSJNMjAgOUg5LjVBNS41IDUuNSAwIDAgMCA0IDE0LjVBNS41IDUuNSAwIDAgMCA5LjUgMjBIMTMiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/redo-2\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Redo2 = createLucideIcon('redo-2', __iconNode);\n\nexport default Redo2;\n","import { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation, useQuery } from \"convex/react\";\nimport { useCallback, useMemo } from \"react\";\n\n/**\n * Hook for managing document version history\n * Extracts undo/redo logic from CanvasEditor for reusability\n */\nexport function useCanvasHistory(\n  documentId: Id<\"canvasDocuments\"> | undefined,\n) {\n  // @ts-ignore - Type depth exceeded\n  const document = useQuery(\n    api.canvas.documents.get,\n    documentId ? { documentId } : \"skip\",\n  );\n\n  const history = useQuery(\n    // @ts-ignore - Type depth exceeded with 94+ Convex modules\n    api.canvas.history.getHistory,\n    documentId ? { documentId, limit: 50 } : \"skip\",\n  );\n\n  // @ts-ignore - Type depth exceeded\n  const updateContentMutation = useMutation(api.canvas.documents.updateContent);\n\n  const currentVersion = document?.version ?? 0;\n\n  const latestVersion = useMemo(() => {\n    if (!history?.length) return currentVersion;\n    return Math.max(...history.map((v) => v.version));\n  }, [history, currentVersion]);\n\n  const canUndo = currentVersion > 1;\n  const canRedo = currentVersion < latestVersion;\n  const isViewingOldVersion = currentVersion < latestVersion;\n\n  const undo = useCallback(async () => {\n    if (!documentId || currentVersion <= 1 || !history) return;\n\n    const prevVersion = history.find((h) => h.version === currentVersion - 1);\n    if (!prevVersion) return;\n\n    await updateContentMutation({\n      documentId,\n      content: prevVersion.content,\n      source: \"user_edit\",\n      diff: \"Undo\",\n    });\n  }, [documentId, currentVersion, history, updateContentMutation]);\n\n  const redo = useCallback(async () => {\n    if (!documentId || !history?.length) return;\n\n    const maxVersion = Math.max(...history.map((v) => v.version));\n    if (currentVersion >= maxVersion) return;\n\n    const nextVersion = history.find((h) => h.version === currentVersion + 1);\n    if (!nextVersion) return;\n\n    await updateContentMutation({\n      documentId,\n      content: nextVersion.content,\n      source: \"user_edit\",\n      diff: \"Redo\",\n    });\n  }, [documentId, currentVersion, history, updateContentMutation]);\n\n  const jumpToVersion = useCallback(\n    async (targetVersion: number) => {\n      if (!documentId || !history) return;\n\n      const targetEntry = history.find((h) => h.version === targetVersion);\n      if (!targetEntry) return;\n\n      await updateContentMutation({\n        documentId,\n        content: targetEntry.content,\n        source: \"user_edit\",\n        diff: `Restore v${targetVersion}`,\n      });\n    },\n    [documentId, history, updateContentMutation],\n  );\n\n  return {\n    history,\n    currentVersion,\n    latestVersion,\n    isViewingOldVersion,\n    canUndo,\n    canRedo,\n    undo,\n    redo,\n    jumpToVersion,\n  };\n}\n","\"use client\";\n\nimport type { Doc, Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { BranchBadge } from \"@/components/chat/BranchBadge\";\nimport { ContextWindowIndicator } from \"@/components/chat/ContextWindowIndicator\";\nimport { ConversationHeaderMenu } from \"@/components/chat/ConversationHeaderMenu\";\nimport { FireButton } from \"@/components/chat/FireButton\";\nimport { IncognitoBadge } from \"@/components/chat/IncognitoBadge\";\nimport { ModelBadge } from \"@/components/chat/ModelBadge\";\nimport { ShareDialog } from \"@/components/chat/ShareDialog\";\nimport { ProjectSelector } from \"@/components/projects/ProjectSelector\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface ChatHeaderProps {\n  conversation: Doc<\"conversations\"> | null | undefined;\n  conversationId: Id<\"conversations\">;\n  selectedModel: string;\n  modelLoading: boolean;\n  hasMessages: boolean;\n  isFirst: boolean;\n  isLast: boolean;\n  isComparisonActive: boolean;\n  comparisonModelCount: number;\n  showProjects: boolean;\n  onNavigatePrevious: () => void;\n  onNavigateNext: () => void;\n  onModelBadgeClick: () => void;\n  onComparisonBadgeClick: () => void;\n}\n\nexport function ChatHeader({\n  conversation,\n  conversationId,\n  selectedModel,\n  modelLoading,\n  hasMessages,\n  isFirst,\n  isLast,\n  isComparisonActive,\n  comparisonModelCount,\n  showProjects,\n  onNavigatePrevious,\n  onNavigateNext,\n  onModelBadgeClick,\n  onComparisonBadgeClick,\n}: ChatHeaderProps) {\n  return (\n    <header className=\"flex items-center gap-4 border-b px-4 py-3 shrink-0\">\n      {/* Navigation buttons - left side next to title */}\n      <div className=\"flex items-center gap-1\">\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={onNavigatePrevious}\n          disabled={isFirst}\n          className=\"h-7 w-7 shrink-0 cursor-pointer\"\n          title=\"Previous conversation (âŒ˜[)\"\n        >\n          <ChevronLeft className=\"w-4 h-4\" />\n        </Button>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={onNavigateNext}\n          disabled={isLast}\n          className=\"h-7 w-7 shrink-0 cursor-pointer\"\n          title=\"Next conversation (âŒ˜])\"\n        >\n          <ChevronRight className=\"w-4 h-4\" />\n        </Button>\n      </div>\n\n      <div className=\"flex items-center gap-1 flex-1 min-w-0\">\n        <h1 className=\"text-lg font-semibold truncate\">\n          {conversation?.title || \"New Chat\"}\n        </h1>\n      </div>\n\n      <div className=\"hidden sm:flex items-center gap-2\">\n        {!modelLoading && selectedModel && (\n          <ModelBadge\n            modelId={isComparisonActive ? undefined : selectedModel}\n            isComparison={isComparisonActive}\n            comparisonCount={comparisonModelCount}\n            onClick={\n              isComparisonActive ? onComparisonBadgeClick : onModelBadgeClick\n            }\n          />\n        )}\n        {conversation?.isIncognito && <IncognitoBadge />}\n      </div>\n\n      {showProjects && !conversation?.isIncognito && (\n        <ProjectSelector\n          conversationId={conversationId}\n          currentProjectId={conversation?.projectId ?? undefined}\n        />\n      )}\n\n      <div className=\"flex items-center gap-2\">\n        {hasMessages && conversationId && (\n          <ContextWindowIndicator\n            conversationId={conversationId}\n            modelId={selectedModel}\n          />\n        )}\n        {conversationId && <BranchBadge conversationId={conversationId} />}\n        {/* Hide sharing for incognito - ephemeral by design */}\n        {hasMessages && conversationId && !conversation?.isIncognito && (\n          <ShareDialog conversationId={conversationId} />\n        )}\n        {/* Fire button for incognito conversations */}\n        {conversation?.isIncognito && (\n          <FireButton conversationId={conversationId} />\n        )}\n        {conversation && <ConversationHeaderMenu conversation={conversation} />}\n      </div>\n    </header>\n  );\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useQuery } from \"convex/react\";\nimport { GitBranch } from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\ninterface BranchBadgeProps {\n  conversationId: Id<\"conversations\">;\n}\n\nexport function BranchBadge({ conversationId }: BranchBadgeProps) {\n  const router = useRouter();\n  const childBranches = useQuery(api.conversations.getChildBranches, {\n    conversationId,\n  });\n\n  if (!childBranches || childBranches.length === 0) {\n    return null;\n  }\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"h-7 gap-1.5 text-xs font-medium\"\n        >\n          <GitBranch className=\"h-3 w-3\" />\n          <Badge\n            variant=\"secondary\"\n            className=\"h-4 min-w-4 px-1 text-[10px] rounded-full\"\n          >\n            {childBranches.length}\n          </Badge>\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent align=\"end\" className=\"w-72 p-2\">\n        <div className=\"space-y-1\">\n          <p className=\"text-xs font-medium text-muted-foreground px-2 py-1\">\n            Branched conversations ({childBranches.length})\n          </p>\n          <div className=\"space-y-0.5\">\n            {childBranches.map(\n              (branch: { _id: string; title: string; createdAt: number }) => (\n                <Button\n                  key={branch._id}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"w-full justify-start h-auto py-2 px-2 text-left font-normal\"\n                  onClick={() => {\n                    router.push(`/chat/${branch._id}`);\n                  }}\n                >\n                  <div className=\"flex items-start gap-2 w-full min-w-0\">\n                    <GitBranch className=\"h-3.5 w-3.5 mt-0.5 flex-shrink-0 text-muted-foreground\" />\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"text-sm truncate\">{branch.title}</p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {new Date(branch.createdAt).toLocaleDateString(\n                          undefined,\n                          {\n                            month: \"short\",\n                            day: \"numeric\",\n                            hour: \"2-digit\",\n                            minute: \"2-digit\",\n                          },\n                        )}\n                      </p>\n                    </div>\n                  </div>\n                </Button>\n              ),\n            )}\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n}\n","\"use client\";\n\nimport { useQuery } from \"convex/react\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { getModelConfig } from \"@/lib/ai/utils\";\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\n\ninterface ContextWindowIndicatorProps {\n  conversationId: Id<\"conversations\">;\n  modelId: string; // Currently selected model\n}\n\nexport function ContextWindowIndicator({\n  conversationId,\n  modelId,\n}: ContextWindowIndicatorProps) {\n  // @ts-ignore\n  const tokenUsage = useQuery(api.conversations.getTokenUsage, {\n    conversationId,\n  });\n\n  // Get context limit from currently selected model, not stored value\n  const modelConfig = getModelConfig(modelId);\n  const contextLimit = modelConfig?.contextWindow ?? 128000; // Fallback to 128K\n\n  if (!tokenUsage) {\n    return null;\n  }\n\n  const { systemTokens, messagesTokens, memoriesTokens, totalTokens } =\n    tokenUsage;\n  const percentage = Math.min(\n    100,\n    Math.round((totalTokens / contextLimit) * 100),\n  );\n\n  // Determine warning level\n  const getWarningLevel = () => {\n    if (percentage >= 95) return \"critical\";\n    if (percentage >= 85) return \"warning\";\n    if (percentage >= 70) return \"caution\";\n    return \"safe\";\n  };\n\n  const warningLevel = getWarningLevel();\n\n  const getStrokeColor = () => {\n    switch (warningLevel) {\n      case \"critical\":\n        return \"stroke-destructive\";\n      case \"warning\":\n        return \"stroke-yellow-500\";\n      case \"caution\":\n        return \"stroke-yellow-400\";\n      default:\n        return \"stroke-primary\";\n    }\n  };\n\n  // Circular progress SVG params\n  const size = 20;\n  const strokeWidth = 2.5;\n  const radius = (size - strokeWidth) / 2;\n  const circumference = 2 * Math.PI * radius;\n  const strokeDashoffset = circumference - (percentage / 100) * circumference;\n\n  return (\n    <TooltipProvider>\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <div className=\"flex items-center gap-1.5 cursor-pointer\">\n            <svg\n              width={size}\n              height={size}\n              viewBox={`0 0 ${size} ${size}`}\n              className=\"-rotate-90\"\n            >\n              {/* Background track */}\n              <circle\n                cx={size / 2}\n                cy={size / 2}\n                r={radius}\n                fill=\"none\"\n                strokeWidth={strokeWidth}\n                className=\"stroke-muted-foreground/30\"\n              />\n              {/* Progress arc */}\n              <circle\n                cx={size / 2}\n                cy={size / 2}\n                r={radius}\n                fill=\"none\"\n                strokeWidth={strokeWidth}\n                strokeLinecap=\"round\"\n                strokeDasharray={circumference}\n                strokeDashoffset={strokeDashoffset}\n                className={getStrokeColor()}\n              />\n            </svg>\n            <span className=\"text-xs text-muted-foreground tabular-nums\">\n              {percentage}%\n            </span>\n          </div>\n        </TooltipTrigger>\n        <TooltipContent side=\"bottom\" className=\"max-w-sm\">\n          <div className=\"space-y-2\">\n            <div className=\"font-semibold\">Context Window Usage</div>\n            <div className=\"space-y-1 text-sm\">\n              <div className=\"flex justify-between gap-4\">\n                <span className=\"text-muted-foreground\">System prompts:</span>\n                <span className=\"tabular-nums\">\n                  {systemTokens.toLocaleString()}\n                </span>\n              </div>\n              <div className=\"flex justify-between gap-4\">\n                <span className=\"text-muted-foreground\">Memories:</span>\n                <span className=\"tabular-nums\">\n                  {memoriesTokens.toLocaleString()}\n                </span>\n              </div>\n              <div className=\"flex justify-between gap-4\">\n                <span className=\"text-muted-foreground\">Messages:</span>\n                <span className=\"tabular-nums\">\n                  {messagesTokens.toLocaleString()}\n                </span>\n              </div>\n              <div className=\"flex justify-between gap-4 pt-1 border-t\">\n                <span className=\"font-medium\">Total Usage:</span>\n                <span className=\"tabular-nums font-medium\">\n                  {totalTokens.toLocaleString()} ({percentage}%)\n                </span>\n              </div>\n              <div className=\"flex justify-between gap-4\">\n                <span className=\"text-muted-foreground\">Context Limit:</span>\n                <span className=\"tabular-nums\">\n                  {contextLimit.toLocaleString()}\n                </span>\n              </div>\n            </div>\n            {warningLevel === \"critical\" && (\n              <div className=\"pt-2 text-sm text-destructive\">\n                <strong>Critical:</strong> Context nearly full. Consider\n                starting a new conversation.\n              </div>\n            )}\n            {warningLevel === \"warning\" && (\n              <div className=\"pt-2 text-sm text-yellow-600\">\n                <strong>Warning:</strong> Context filling up. New conversation\n                recommended soon.\n              </div>\n            )}\n          </div>\n        </TooltipContent>\n      </Tooltip>\n    </TooltipProvider>\n  );\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Doc, Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation, useQuery } from \"convex/react\";\nimport {\n  Archive,\n  BarChart3,\n  Brain,\n  Check,\n  Copy,\n  Edit,\n  Loader2,\n  Maximize2,\n  MoreHorizontal,\n  Pin,\n  Presentation,\n  Sparkles,\n  Star,\n  Trash2,\n} from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuCheckboxItem,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuRadioGroup,\n  DropdownMenuRadioItem,\n  DropdownMenuSeparator,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { useConversationActions } from \"@/hooks/useConversationActions\";\nimport { useFeatureToggles } from \"@/hooks/useFeatureToggles\";\nimport { useUserPreference } from \"@/hooks/useUserPreference\";\nimport { analytics } from \"@/lib/analytics\";\nimport { exportConversationToMarkdown } from \"@/lib/export/markdown\";\nimport type { ChatWidth } from \"@/lib/utils/chatWidth\";\nimport { DeleteConversationDialog } from \"../sidebar/DeleteConversationDialog\";\nimport { RenameDialog } from \"../sidebar/RenameDialog\";\n\ninterface ConversationHeaderMenuProps {\n  conversation: Doc<\"conversations\">;\n}\n\nexport function ConversationHeaderMenu({\n  conversation,\n}: ConversationHeaderMenuProps) {\n  const router = useRouter();\n  const [showRename, setShowRename] = useState(false);\n  const [showDelete, setShowDelete] = useState(false);\n  const [isExtracting, setIsExtracting] = useState(false);\n  const [copied, setCopied] = useState(false);\n  const actions = useConversationActions(conversation._id, \"header_menu\");\n  const { showSlides } = useFeatureToggles();\n\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const triggerExtraction = useMutation(api.memories.triggerExtraction);\n  // @ts-ignore - Type depth exceeded with complex Convex query (85+ modules)\n  const messages = useQuery(api.messages.list, {\n    conversationId: conversation._id,\n  });\n  // @ts-ignore - Type depth exceeded with complex Convex query (85+ modules)\n  const sources = useQuery(api.sources.operations.getByConversation, {\n    conversationId: conversation._id,\n  });\n\n  const handleCreatePresentation = () => {\n    router.push(`/slides/new?conversationId=${conversation._id}`);\n  };\n\n  const handleExtractMemories = async () => {\n    setIsExtracting(true);\n    try {\n      await triggerExtraction({ conversationId: conversation._id });\n      toast.success(\"Memory extraction started! This may take a few moments.\");\n      analytics.track(\"memory_extraction_triggered\", {\n        source: \"manual\",\n        conversationId: conversation._id,\n      });\n    } catch (_error) {\n      toast.error(\"Failed to start extraction\");\n    } finally {\n      setTimeout(() => setIsExtracting(false), 3000);\n    }\n  };\n\n  const handleCopyConversation = async () => {\n    if (!messages) return;\n\n    // Group sources by messageId\n    const sourcesByMessage = new Map<\n      Id<\"messages\">,\n      Array<{ position: number; title?: string | null; url: string }>\n    >();\n    if (sources) {\n      for (const src of sources) {\n        const existing = sourcesByMessage.get(src.messageId) || [];\n        existing.push(src);\n        sourcesByMessage.set(src.messageId, existing);\n      }\n    }\n\n    const markdown = exportConversationToMarkdown(\n      conversation,\n      messages,\n      sourcesByMessage,\n    );\n    await navigator.clipboard.writeText(markdown);\n    setCopied(true);\n    toast.success(\"Conversation copied to clipboard\");\n    setTimeout(() => setCopied(false), 2000);\n\n    analytics.track(\"conversation_copied\", {\n      conversationId: conversation._id,\n      messageCount: messages.length,\n    });\n  };\n\n  // @ts-ignore - Type depth exceeded with complex Convex query (85+ modules)\n  const _user = useQuery(api.users.getCurrentUser);\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const updatePreferences = useMutation(api.users.updatePreferences);\n\n  // Phase 4: Use new preference hooks\n  const prefChatWidth = useUserPreference(\"chatWidth\");\n  const prefShowMessageStats = useUserPreference(\"showMessageStatistics\");\n  const prefShowComparisonStats = useUserPreference(\"showComparisonStatistics\");\n\n  const currentWidth = (prefChatWidth as ChatWidth) || \"standard\";\n  const showMessageStats = prefShowMessageStats ?? false;\n  const showComparisonStats = prefShowComparisonStats ?? false;\n\n  const handleWidthChange = async (width: ChatWidth) => {\n    try {\n      await updatePreferences({\n        preferences: { chatWidth: width },\n      });\n      toast.success(\"Chat width updated\");\n    } catch (error) {\n      console.error(\"[ConversationHeaderMenu] Failed to update width:\", error);\n      toast.error(\n        error instanceof Error ? error.message : \"Failed to update width\",\n      );\n    }\n  };\n\n  const handleToggleMessageStats = async (checked: boolean) => {\n    try {\n      await updatePreferences({\n        preferences: { showMessageStatistics: checked },\n      });\n      toast.success(checked ? \"Statistics enabled\" : \"Statistics hidden\");\n      analytics.track(\"ui_preference_changed\", {\n        setting: \"show_message_statistics\",\n        value: checked,\n        source: \"header_menu\",\n      });\n    } catch (error) {\n      console.error(\n        \"[ConversationHeaderMenu] Failed to update message statistics:\",\n        error,\n      );\n      toast.error(\n        error instanceof Error ? error.message : \"Failed to update statistics\",\n      );\n    }\n  };\n\n  const handleToggleComparisonStats = async (checked: boolean) => {\n    try {\n      await updatePreferences({\n        preferences: { showComparisonStatistics: checked },\n      });\n      toast.success(\n        checked ? \"Comparison stats enabled\" : \"Comparison stats hidden\",\n      );\n      analytics.track(\"ui_preference_changed\", {\n        setting: \"show_comparison_statistics\",\n        value: checked,\n        source: \"header_menu\",\n      });\n    } catch (error) {\n      console.error(\n        \"[ConversationHeaderMenu] Failed to update comparison statistics:\",\n        error,\n      );\n      toast.error(\n        error instanceof Error\n          ? error.message\n          : \"Failed to update comparison statistics\",\n      );\n    }\n  };\n\n  return (\n    <>\n      <DropdownMenu>\n        <Tooltip>\n          <TooltipTrigger asChild>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\n                <MoreHorizontal className=\"h-4 w-4\" />\n                <span className=\"sr-only\">Conversation options</span>\n              </Button>\n            </DropdownMenuTrigger>\n          </TooltipTrigger>\n          <TooltipContent>Conversation options</TooltipContent>\n        </Tooltip>\n\n        <DropdownMenuContent align=\"end\" className=\"w-48\">\n          <DropdownMenuItem\n            onClick={(e) => {\n              e.stopPropagation();\n              setShowRename(true);\n            }}\n          >\n            <Edit className=\"mr-2 h-4 w-4\" />\n            Rename\n          </DropdownMenuItem>\n\n          <DropdownMenuSeparator />\n\n          <DropdownMenuItem\n            disabled={!conversation.pinned && conversation.messageCount === 0}\n            onClick={(e) => {\n              e.stopPropagation();\n              actions.handleTogglePin(conversation.pinned);\n            }}\n          >\n            <Pin className=\"mr-2 h-4 w-4\" />\n            {conversation.pinned\n              ? \"Unpin\"\n              : conversation.messageCount === 0\n                ? \"Cannot pin empty\"\n                : \"Pin\"}\n          </DropdownMenuItem>\n\n          <DropdownMenuItem\n            onClick={(e) => {\n              e.stopPropagation();\n              actions.handleToggleStar(conversation.starred);\n            }}\n          >\n            <Star className=\"mr-2 h-4 w-4\" />\n            {conversation.starred ? \"Unstar\" : \"Star\"}\n          </DropdownMenuItem>\n\n          <DropdownMenuItem\n            onClick={(e) => {\n              e.stopPropagation();\n              actions.handleArchive();\n            }}\n          >\n            <Archive className=\"mr-2 h-4 w-4\" />\n            Archive\n          </DropdownMenuItem>\n\n          <DropdownMenuItem\n            onClick={(e) => {\n              e.stopPropagation();\n              handleCopyConversation();\n            }}\n            disabled={!messages?.length}\n          >\n            {copied ? (\n              <Check className=\"mr-2 h-4 w-4\" />\n            ) : (\n              <Copy className=\"mr-2 h-4 w-4\" />\n            )}\n            {copied ? \"Copied!\" : \"Copy conversation\"}\n          </DropdownMenuItem>\n\n          {showSlides && (\n            <DropdownMenuItem\n              onClick={(e) => {\n                e.stopPropagation();\n                handleCreatePresentation();\n              }}\n            >\n              <Presentation className=\"mr-2 h-4 w-4\" />\n              Create Presentation\n            </DropdownMenuItem>\n          )}\n\n          <DropdownMenuItem\n            onClick={(e) => {\n              e.stopPropagation();\n              actions.handleAutoRename();\n            }}\n          >\n            <Sparkles className=\"mr-2 h-4 w-4\" />\n            Auto-rename\n          </DropdownMenuItem>\n\n          {/* Only show for non-incognito conversations with enough messages */}\n          {!conversation.isIncognito &&\n            (conversation.messageCount ?? 0) >= 3 && (\n              <DropdownMenuItem\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleExtractMemories();\n                }}\n                disabled={isExtracting}\n              >\n                {isExtracting ? (\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                ) : (\n                  <Brain className=\"mr-2 h-4 w-4\" />\n                )}\n                {isExtracting ? \"Extracting...\" : \"Extract Memories\"}\n              </DropdownMenuItem>\n            )}\n\n          <DropdownMenuSeparator />\n\n          <DropdownMenuSub>\n            <DropdownMenuSubTrigger>\n              <Maximize2 className=\"mr-2 h-4 w-4\" />\n              Chat Width\n            </DropdownMenuSubTrigger>\n            <DropdownMenuSubContent>\n              <DropdownMenuLabel>Layout Width</DropdownMenuLabel>\n              <DropdownMenuRadioGroup\n                value={currentWidth}\n                onValueChange={(value) => handleWidthChange(value as ChatWidth)}\n              >\n                <DropdownMenuRadioItem value=\"narrow\">\n                  Narrow (672px)\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"standard\">\n                  Standard (896px)\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"wide\">\n                  Wide (1152px)\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"full\">\n                  Full Width (95%)\n                </DropdownMenuRadioItem>\n              </DropdownMenuRadioGroup>\n            </DropdownMenuSubContent>\n          </DropdownMenuSub>\n\n          <DropdownMenuSub>\n            <DropdownMenuSubTrigger>\n              <BarChart3 className=\"mr-2 h-4 w-4\" />\n              Statistics\n            </DropdownMenuSubTrigger>\n            <DropdownMenuSubContent>\n              <DropdownMenuLabel>Display Options</DropdownMenuLabel>\n              <DropdownMenuCheckboxItem\n                checked={showMessageStats}\n                onCheckedChange={handleToggleMessageStats}\n              >\n                Message Statistics\n              </DropdownMenuCheckboxItem>\n              <DropdownMenuCheckboxItem\n                checked={showComparisonStats}\n                onCheckedChange={handleToggleComparisonStats}\n              >\n                Comparison Statistics\n              </DropdownMenuCheckboxItem>\n            </DropdownMenuSubContent>\n          </DropdownMenuSub>\n\n          <DropdownMenuSeparator />\n\n          <DropdownMenuItem\n            onClick={(e) => {\n              e.stopPropagation();\n              setShowDelete(true);\n            }}\n            className=\"text-destructive focus:text-destructive\"\n          >\n            <Trash2 className=\"mr-2 h-4 w-4\" />\n            Delete\n          </DropdownMenuItem>\n        </DropdownMenuContent>\n      </DropdownMenu>\n\n      {/* Dialogs */}\n      <RenameDialog\n        conversation={conversation}\n        open={showRename}\n        onOpenChange={setShowRename}\n      />\n\n      <DeleteConversationDialog\n        open={showDelete}\n        onOpenChange={setShowDelete}\n        onConfirm={actions.handleDelete}\n        conversationTitle={conversation.title}\n      />\n    </>\n  );\n}\n","import type { Doc, Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\n\ninterface SourceInfo {\n  position: number;\n  title?: string | null;\n  url: string;\n}\n\nexport function exportConversationToMarkdown(\n  conversation: Doc<\"conversations\">,\n  messages: Doc<\"messages\">[],\n  sourcesByMessage?: Map<Id<\"messages\">, SourceInfo[]>,\n): string {\n  let md = `# ${conversation.title}\\n\\n`;\n  md += `*Created: ${new Date(conversation.createdAt).toLocaleString()}*\\n\\n`;\n  md += `---\\n\\n`;\n\n  for (const msg of messages) {\n    const role =\n      msg.role === \"user\"\n        ? \"You\"\n        : msg.role === \"assistant\"\n          ? \"Assistant\"\n          : \"System\";\n    md += `**${role}:**\\n\\n`;\n    md += `${msg.content}\\n\\n`;\n\n    // Add sources for this message\n    const sources = sourcesByMessage?.get(msg._id);\n    if (sources?.length) {\n      md += `**Sources:**\\n`;\n      for (const src of sources) {\n        md += `- [${src.position}] [${src.title || src.url}](${src.url})\\n`;\n      }\n      md += `\\n`;\n    }\n  }\n\n  return md;\n}\n\nexport function exportAllToMarkdown(\n  conversations: Array<Doc<\"conversations\"> & { messages: Doc<\"messages\">[] }>,\n): string {\n  let md = `# blah.chat Export\\n\\n`;\n  md += `**Exported**: ${new Date().toLocaleString()}\\n`;\n  md += `**Conversations**: ${conversations.length}\\n\\n`;\n  md += `---\\n\\n`;\n\n  for (const conv of conversations) {\n    md += exportConversationToMarkdown(conv, conv.messages);\n    md += `\\n\\n---\\n\\n`;\n  }\n\n  return md;\n}\n\nexport function generateMarkdownFilename(conversationTitle?: string): string {\n  const timestamp = new Date().toISOString().split(\"T\")[0];\n  if (conversationTitle) {\n    const sanitized = conversationTitle\n      .replace(/[^a-z0-9]/gi, \"-\")\n      .toLowerCase();\n    return `${sanitized}-${timestamp}.md`;\n  }\n  return `blah-chat-export-${timestamp}.md`;\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation } from \"convex/react\";\nimport { Flame } from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { useState } from \"react\";\nimport { toast } from \"sonner\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { cn } from \"@/lib/utils\";\n\ninterface FireButtonProps {\n  conversationId: Id<\"conversations\">;\n  className?: string;\n}\n\nexport function FireButton({ conversationId, className }: FireButtonProps) {\n  const [isDeleting, setIsDeleting] = useState(false);\n  // @ts-ignore - Type depth exceeded with complex Convex mutation\n  const deleteConversation = useMutation(api.conversations.deleteConversation);\n  const router = useRouter();\n\n  const handleFire = async () => {\n    setIsDeleting(true);\n    try {\n      await deleteConversation({ conversationId });\n      toast.success(\"Conversation wiped\");\n      router.push(\"/\");\n    } catch (error) {\n      console.error(\"Failed to wipe conversation:\", error);\n      toast.error(\"Failed to wipe conversation\");\n    } finally {\n      setIsDeleting(false);\n    }\n  };\n\n  return (\n    <AlertDialog>\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <AlertDialogTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              disabled={isDeleting}\n              className={cn(\n                \"h-7 w-7 shrink-0\",\n                \"text-orange-400/60 hover:text-orange-400\",\n                \"hover:bg-orange-500/10\",\n                \"transition-colors duration-200\",\n                className,\n              )}\n            >\n              <Flame className=\"size-4\" />\n            </Button>\n          </AlertDialogTrigger>\n        </TooltipTrigger>\n        <TooltipContent side=\"bottom\">Wipe conversation now</TooltipContent>\n      </Tooltip>\n\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle className=\"flex items-center gap-2\">\n            <Flame className=\"size-5 text-orange-400\" />\n            Wipe Incognito Chat\n          </AlertDialogTitle>\n          <AlertDialogDescription>\n            This will permanently delete this conversation and all its messages.\n            This action cannot be undone.\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel>Cancel</AlertDialogCancel>\n          <AlertDialogAction\n            onClick={handleFire}\n            className=\"bg-orange-500 hover:bg-orange-600 text-white\"\n          >\n            <Flame className=\"size-4 mr-2\" />\n            Wipe Now\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  );\n}\n","\"use client\";\n\nimport { Ghost } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { cn } from \"@/lib/utils\";\n\ninterface IncognitoBadgeProps {\n  className?: string;\n}\n\nexport function IncognitoBadge({ className }: IncognitoBadgeProps) {\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>\n        <Badge\n          variant=\"outline\"\n          className={cn(\n            \"h-7 text-xs px-3 rounded-full cursor-default select-none\",\n            \"border-violet-500/30 bg-violet-500/5\",\n            \"text-violet-400\",\n            \"transition-colors duration-200\",\n            className,\n          )}\n        >\n          <Ghost className=\"size-3 mr-1.5 opacity-80\" />\n          Incognito\n        </Badge>\n      </TooltipTrigger>\n      <TooltipContent side=\"bottom\">\n        <p className=\"text-xs\">Ephemeral chat - no memories saved</p>\n      </TooltipContent>\n    </Tooltip>\n  );\n}\n","\"use client\";\n\nimport { Grid } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { getModelIcon } from \"@/lib/ai/icons\";\nimport { getModelConfig } from \"@/lib/ai/utils\";\nimport { cn } from \"@/lib/utils\";\n\ninterface ModelBadgeProps {\n  modelId?: string;\n  isComparison?: boolean;\n  comparisonCount?: number;\n  onClick?: () => void;\n  className?: string;\n}\n\nexport function ModelBadge({\n  modelId,\n  isComparison = false,\n  comparisonCount = 0,\n  onClick,\n  className,\n}: ModelBadgeProps) {\n  if (isComparison) {\n    return (\n      <Button\n        variant=\"outline\"\n        size=\"sm\"\n        onClick={onClick}\n        title=\"Manage comparison models\"\n        className={cn(\n          \"gap-2 h-7 text-xs border-primary/20 bg-primary/2 hover:bg-primary/10 px-3 rounded-full transition-colors min-w-0 w-auto font-medium text-primary/80 hover:text-primary/80 cursor-pointer\",\n          className,\n        )}\n      >\n        <Grid className=\"w-3 h-3\" />\n        <span className=\"hidden sm:inline\">\n          Comparing {comparisonCount} models\n        </span>\n        <span className=\"sm:hidden\">{comparisonCount}</span>\n      </Button>\n    );\n  }\n\n  if (!modelId) return null;\n\n  const config = getModelConfig(modelId);\n  if (!config) return null;\n\n  const Icon = getModelIcon(modelId as string);\n\n  return (\n    <Button\n      variant=\"outline\"\n      size=\"sm\"\n      onClick={onClick}\n      title=\"Change AI model (âŒ˜J)\"\n      className={cn(\n        \"gap-2 h-7 text-xs border-primary/20 bg-primary/2 hover:bg-primary/10 px-3 rounded-full transition-colors min-w-0 w-auto font-medium text-primary/80 hover:text-primary/80 cursor-pointer\",\n        className,\n      )}\n    >\n      <Icon className=\"w-3 h-3\" />\n      <span className=\"hidden sm:inline truncate max-w-[200px]\">\n        {config.name}\n      </span>\n    </Button>\n  );\n}\n","\"use client\";\n\nimport { useAction, useMutation, useQuery } from \"convex/react\";\nimport { Check, Copy, Share2 } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { analytics } from \"@/lib/analytics\";\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\n\ninterface ShareDialogProps {\n  conversationId: Id<\"conversations\">;\n}\n\nexport function ShareDialog({ conversationId }: ShareDialogProps) {\n  const [open, setOpen] = useState(false);\n  const [password, setPassword] = useState(\"\");\n  const [expiresIn, setExpiresIn] = useState<number | undefined>(7);\n  const [anonymize, setAnonymize] = useState(false);\n  const [shareUrl, setShareUrl] = useState<string | null>(null);\n  const [copied, setCopied] = useState(false);\n\n  // @ts-ignore - Type depth exceeded with complex Convex query (85+ modules)\n  const existingShare = useQuery(api.shares.getByConversation, {\n    conversationId,\n  });\n  const createShare = useAction(api.shares.create);\n  const toggleShare = useMutation(api.shares.toggle);\n\n  // Set share URL if exists\n  useEffect(() => {\n    if (existingShare?.shareId) {\n      setShareUrl(`${window.location.origin}/share/${existingShare.shareId}`);\n    }\n  }, [existingShare]);\n\n  const handleShare = async () => {\n    try {\n      const shareId = await createShare({\n        conversationId,\n        password: password || undefined,\n        expiresIn,\n        anonymizeUsernames: anonymize,\n      });\n\n      const url = `${window.location.origin}/share/${shareId}`;\n      setShareUrl(url);\n\n      analytics.track(\"conversation_shared\", {\n        hasPassword: !!password,\n        hasExpiry: !!expiresIn,\n        expiresIn,\n        anonymizeEnabled: anonymize,\n      });\n    } catch (error) {\n      console.error(\"Failed to create share:\", error);\n    }\n  };\n\n  const copyToClipboard = async () => {\n    if (shareUrl) {\n      await navigator.clipboard.writeText(shareUrl);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    }\n  };\n\n  const handleToggle = async (isActive: boolean) => {\n    try {\n      await toggleShare({ conversationId, isActive });\n    } catch (error) {\n      console.error(\"Failed to toggle share:\", error);\n    }\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n    if (!existingShare) {\n      setShareUrl(null);\n      setPassword(\"\");\n      setExpiresIn(7);\n      setAnonymize(false);\n    }\n    setCopied(false);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button variant=\"ghost\" size=\"sm\">\n          <Share2 className=\"h-4 w-4\" />\n        </Button>\n      </DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>Share Conversation</DialogTitle>\n          <DialogDescription>\n            Create a shareable link to this conversation\n          </DialogDescription>\n        </DialogHeader>\n\n        {shareUrl ? (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <Label htmlFor=\"share-toggle\">Sharing enabled</Label>\n              <Switch\n                id=\"share-toggle\"\n                checked={existingShare?.isActive ?? true}\n                onCheckedChange={handleToggle}\n              />\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Input value={shareUrl} readOnly />\n              <Button onClick={copyToClipboard} size=\"icon\">\n                {copied ? (\n                  <Check className=\"h-4 w-4\" />\n                ) : (\n                  <Copy className=\"h-4 w-4\" />\n                )}\n              </Button>\n            </div>\n\n            {existingShare?.isActive === false ? (\n              <p className=\"text-sm text-destructive\">\n                âš ï¸ Sharing is disabled. Anyone with the link will see a \"revoked\"\n                message.\n              </p>\n            ) : (\n              <p className=\"text-sm text-muted-foreground\">\n                Anyone with this link can view the conversation\n                {existingShare?.password && \" (password required)\"}\n                {existingShare?.expiresAt &&\n                  ` (expires ${new Date(existingShare.expiresAt).toLocaleDateString()})`}\n                .\n              </p>\n            )}\n          </div>\n        ) : (\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Password (optional)</Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                placeholder=\"Leave empty for no password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"expires\">Expires in</Label>\n              <Select\n                value={expiresIn?.toString() || \"never\"}\n                onValueChange={(value) =>\n                  setExpiresIn(value === \"never\" ? undefined : Number(value))\n                }\n              >\n                <SelectTrigger id=\"expires\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"1\">1 day</SelectItem>\n                  <SelectItem value=\"7\">7 days</SelectItem>\n                  <SelectItem value=\"30\">30 days</SelectItem>\n                  <SelectItem value=\"never\">Never</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"flex items-center justify-between\">\n              <Label htmlFor=\"anonymize\">Anonymize usernames</Label>\n              <Switch\n                id=\"anonymize\"\n                checked={anonymize}\n                onCheckedChange={setAnonymize}\n              />\n            </div>\n          </div>\n        )}\n\n        <DialogFooter>\n          {shareUrl ? (\n            <Button onClick={handleClose}>Done</Button>\n          ) : (\n            <Button onClick={handleShare}>Create Share Link</Button>\n          )}\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation, useQuery } from \"convex/react\";\nimport { FolderOpen } from \"lucide-react\";\nimport { useRef } from \"react\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\ninterface ProjectSelectorProps {\n  conversationId: Id<\"conversations\">;\n  currentProjectId?: Id<\"projects\">;\n}\n\nexport function ProjectSelector({\n  conversationId,\n  currentProjectId,\n}: ProjectSelectorProps) {\n  const projects = useQuery(api.projects.list);\n  const assignConversations = useMutation(api.projects.assignConversations);\n  const lastValueRef = useRef(currentProjectId || \"none\");\n\n  const handleChange = async (value: string) => {\n    // Prevent re-firing when prop updates trigger onValueChange\n    if (value === lastValueRef.current) return;\n    lastValueRef.current = value;\n\n    await assignConversations({\n      projectId: value === \"none\" ? null : (value as Id<\"projects\">),\n      conversationIds: [conversationId],\n    });\n  };\n\n  if (!projects || projects.length === 0) {\n    return null;\n  }\n\n  return (\n    <Select value={currentProjectId || \"none\"} onValueChange={handleChange}>\n      <SelectTrigger\n        className=\"w-auto sm:w-[200px] px-2 sm:px-3 max-w-[180px] min-w-0\"\n        aria-label=\"Select Project\"\n      >\n        <div className=\"flex items-center gap-2 min-w-0 flex-1\">\n          <FolderOpen className=\"w-4 h-4 shrink-0\" />\n          <span className=\"hidden sm:block truncate min-w-0 flex-1\">\n            <SelectValue placeholder=\"No project\" />\n          </span>\n        </div>\n      </SelectTrigger>\n      <SelectContent>\n        <SelectItem value=\"none\">No project</SelectItem>\n        {projects?.map((project: any) => (\n          <SelectItem key={project._id} value={project._id}>\n            <span className=\"truncate\" title={project.name}>\n              {project.name}\n            </span>\n          </SelectItem>\n        ))}\n      </SelectContent>\n    </Select>\n  );\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation, useQuery } from \"convex/react\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport { Expand, Loader2, Send, Square, Upload } from \"lucide-react\";\nimport { memo, useEffect, useRef, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport useBrowserFeature from \"@/hooks/useBrowserFeature\";\nimport { useChatInputEvents } from \"@/hooks/useChatInputEvents\";\nimport { useChatInputKeyboard } from \"@/hooks/useChatInputKeyboard\";\nimport { useMobileDetect } from \"@/hooks/useMobileDetect\";\nimport { getModelConfig } from \"@/lib/ai/utils\";\nimport { analytics } from \"@/lib/analytics\";\nimport { useSendMessage } from \"@/lib/hooks/mutations\";\nimport { cn } from \"@/lib/utils\";\nimport { type ChatWidth, getChatWidthClass } from \"@/lib/utils/chatWidth\";\nimport type { OptimisticMessage } from \"@/types/optimistic\";\nimport { AttachmentPreview } from \"./AttachmentPreview\";\nimport { AudioWaveform } from \"./AudioWaveform\";\nimport { ExpandedInputDialog } from \"./ExpandedInputDialog\";\nimport { FileUpload } from \"./FileUpload\";\nimport { InputBottomBar } from \"./InputBottomBar\";\nimport { QuotePreview } from \"./QuotePreview\";\nimport { RateLimitDialog } from \"./RateLimitDialog\";\nimport type { ThinkingEffort } from \"./ThinkingEffortSelector\";\nimport { VoiceInput, type VoiceInputRef } from \"./VoiceInput\";\n\ninterface Attachment {\n  type: \"file\" | \"image\" | \"audio\";\n  name: string;\n  storageId: string;\n  mimeType: string;\n  size: number;\n}\n\ninterface ChatInputProps {\n  conversationId: Id<\"conversations\">;\n  isGenerating: boolean;\n  selectedModel: string;\n  onModelChange: (modelId: string) => void;\n  thinkingEffort?: ThinkingEffort;\n  onThinkingEffortChange?: (effort: ThinkingEffort) => void;\n  attachments: Attachment[];\n  onAttachmentsChange: (attachments: Attachment[]) => void;\n  isComparisonMode?: boolean;\n  selectedModels?: string[];\n  onStartComparison?: (models: string[]) => void;\n  onExitComparison?: () => void;\n  isEmpty?: boolean;\n  modelSelectorOpen?: boolean;\n  onModelSelectorOpenChange?: (open: boolean) => void;\n  comparisonDialogOpen?: boolean;\n  onComparisonDialogOpenChange?: (open: boolean) => void;\n  chatWidth?: ChatWidth;\n  onOptimisticUpdate?: (messages: OptimisticMessage[]) => void;\n}\n\nexport const ChatInput = memo(function ChatInput({\n  conversationId,\n  isGenerating,\n  selectedModel,\n  onModelChange,\n  thinkingEffort,\n  onThinkingEffortChange,\n  attachments,\n  chatWidth,\n  onAttachmentsChange,\n  isComparisonMode = false,\n  selectedModels = [],\n  onStartComparison,\n  onExitComparison,\n  isEmpty = false,\n  modelSelectorOpen,\n  onModelSelectorOpenChange,\n  comparisonDialogOpen,\n  onComparisonDialogOpenChange,\n  onOptimisticUpdate,\n}: ChatInputProps) {\n  const [input, setInput] = useState(\"\");\n  const [isSending, setIsSending] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingStream, setRecordingStream] = useState<MediaStream | null>(\n    null,\n  );\n  const [_isTranscribing, setIsTranscribing] = useState(false);\n  const [isFocused, setIsFocused] = useState(false);\n  const [isDraggingOver, setIsDraggingOver] = useState(false);\n  const [showRateLimitDialog, setShowRateLimitDialog] = useState(false);\n  const [showExpandedInput, setShowExpandedInput] = useState(false);\n  const [lastCompletedMessageId, setLastCompletedMessageId] = useState<\n    string | null\n  >(null);\n  const [quote, setQuote] = useState<string | null>(null);\n\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  const formRef = useRef<HTMLFormElement>(null);\n  const voiceInputRef = useRef<VoiceInputRef>(null);\n  const dragCounterRef = useRef(0);\n  const { isMobile, isTouchDevice } = useMobileDetect();\n  const hasSpeechRecognition = useBrowserFeature(\"webkitSpeechRecognition\");\n\n  const { mutate: sendMessage } = useSendMessage(onOptimisticUpdate);\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const stopGeneration = useMutation(api.chat.stopGeneration);\n  const lastAssistantMessage = useQuery(api.messages.getLastAssistantMessage, {\n    conversationId,\n  });\n\n  // Check model capabilities\n  const modelConfig = getModelConfig(selectedModel);\n  const _supportsVision =\n    modelConfig?.capabilities?.includes(\"vision\") ?? false;\n  const supportsThinking = !!modelConfig?.reasoning;\n\n  // Drag and drop handlers\n  const handleDragEnter = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    dragCounterRef.current++;\n    if (e.dataTransfer.types.includes(\"Files\")) {\n      setIsDraggingOver(true);\n    }\n  };\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    dragCounterRef.current--;\n    if (dragCounterRef.current === 0) {\n      setIsDraggingOver(false);\n    }\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    dragCounterRef.current = 0;\n    setIsDraggingOver(false);\n  };\n\n  const handleSubmit = async (e: React.FormEvent | React.KeyboardEvent) => {\n    e.preventDefault();\n    if (isGenerating) return;\n    if ((!input.trim() && !quote) || isSending || uploading) return;\n\n    setIsSending(true);\n\n    const originalInput = input.trim();\n    const originalQuote = quote;\n    const originalAttachments = [...attachments];\n    const messageContent = originalQuote\n      ? `> ${originalQuote}\\n\\n${originalInput}`\n      : originalInput;\n\n    sendMessage(\n      {\n        conversationId,\n        content: messageContent,\n        ...(isComparisonMode\n          ? { models: selectedModels }\n          : { modelId: selectedModel }),\n        thinkingEffort,\n        attachments: attachments.length > 0 ? attachments : undefined,\n      },\n      {\n        onError: (error) => {\n          const currentInput = textareaRef.current?.value?.trim() || \"\";\n          if (!currentInput) {\n            setInput(originalInput);\n            setQuote(originalQuote);\n            onAttachmentsChange(originalAttachments);\n          }\n\n          if (\n            error instanceof Error &&\n            error.message.includes(\"Daily message limit\")\n          ) {\n            setShowRateLimitDialog(true);\n          }\n        },\n      },\n    );\n\n    setInput(\"\");\n    setQuote(null);\n    onAttachmentsChange([]);\n    setIsSending(false);\n\n    if (!isMobile) {\n      setTimeout(() => textareaRef.current?.focus(), 0);\n    }\n  };\n\n  const { handleKeyDown } = useChatInputKeyboard({\n    input,\n    setInput,\n    textareaRef,\n    onSubmit: handleSubmit,\n  });\n\n  useChatInputEvents({\n    textareaRef,\n    setInput,\n    setQuote,\n    isEmpty,\n    isMobile,\n    isTouchDevice,\n    lastAssistantMessageId: lastAssistantMessage?._id,\n    lastAssistantMessageStatus: lastAssistantMessage?.status,\n    lastCompletedMessageId,\n    setLastCompletedMessageId,\n  });\n\n  const handleStop = async (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    try {\n      await stopGeneration({ conversationId });\n      analytics.track(\"generation_stopped\", {\n        model: selectedModel,\n        source: \"stop_button\",\n      });\n    } catch (error) {\n      console.error(\"Failed to stop generation:\", error);\n    }\n  };\n\n  // Auto-resize textarea - NOW RUNS ON INPUT CHANGE\n  useEffect(() => {\n    const textarea = textareaRef.current;\n    if (!textarea) return;\n    textarea.style.height = \"auto\";\n    textarea.style.height = `${Math.min(textarea.scrollHeight, 200)}px`;\n  }, [input]);\n\n  const getPlaceholder = () => {\n    const config = getModelConfig(selectedModel);\n    if (config?.capabilities?.includes(\"vision\")) {\n      return \"Describe an image or upload a file...\";\n    }\n    if (\n      config?.capabilities?.includes(\"thinking\") ||\n      config?.capabilities?.includes(\"extended-thinking\")\n    ) {\n      return \"Ask me to reason through a problem...\";\n    }\n    return \"Message blah.chat...\";\n  };\n\n  // Determine what to show on right side\n  const hasContent = input.trim().length > 0 || quote;\n  const canSend =\n    (hasContent || isRecording || isGenerating) && !isSending && !uploading;\n  const showMic =\n    !hasContent && !isGenerating && hasSpeechRecognition && !isRecording;\n  const showExpandButton = input.length > 100;\n\n  return (\n    <div\n      className={cn(\n        \"w-full mx-auto px-2 sm:px-4 pb-4 sm:pb-6 !pb-[calc(1rem+env(safe-area-inset-bottom))] transition-[max-width] duration-300 ease-out\",\n        getChatWidthClass(chatWidth, false),\n      )}\n    >\n      <form\n        ref={formRef}\n        onSubmit={handleSubmit}\n        onDragEnter={handleDragEnter}\n        onDragLeave={handleDragLeave}\n        onDragOver={handleDragOver}\n        onDrop={handleDrop}\n        role=\"search\"\n        aria-label=\"Send message to AI\"\n        className={cn(\n          \"relative flex flex-col gap-2 p-2 transition-all duration-300 ease-out\",\n          \"bg-background/60 backdrop-blur-xl\",\n          \"border border-white/[0.06] dark:border-white/[0.08]\",\n          \"rounded-3xl\",\n          \"shadow-[0_1px_2px_rgba(0,0,0,0.04),0_4px_8px_rgba(0,0,0,0.06),0_8px_16px_rgba(0,0,0,0.04)]\",\n          isFocused && [\n            \"ring-1 ring-primary/20\",\n            \"shadow-[0_0_0_1px_rgba(var(--primary-rgb),0.1),0_2px_8px_rgba(var(--primary-rgb),0.08),0_8px_24px_rgba(var(--primary-rgb),0.06)]\",\n            \"border-primary/20\",\n          ],\n          !isFocused &&\n            \"hover:border-white/[0.1] hover:shadow-[0_1px_2px_rgba(0,0,0,0.04),0_4px_12px_rgba(0,0,0,0.08),0_12px_24px_rgba(0,0,0,0.06)]\",\n        )}\n      >\n        {/* Drop zone overlay */}\n        <AnimatePresence>\n          {isDraggingOver && (\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n              transition={{ duration: 0.15 }}\n              className=\"absolute inset-0 z-10 rounded-3xl overflow-hidden pointer-events-none\"\n            >\n              <div className=\"absolute inset-0 border-2 border-dashed border-primary/50 rounded-3xl animate-pulse\" />\n              <div className=\"absolute inset-0 bg-primary/5 backdrop-blur-sm flex items-center justify-center\">\n                <motion.div\n                  initial={{ y: 4, opacity: 0 }}\n                  animate={{ y: 0, opacity: 1 }}\n                  transition={{ delay: 0.05 }}\n                  className=\"flex flex-col items-center gap-2\"\n                >\n                  <div className=\"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center\">\n                    <Upload className=\"w-6 h-6 text-primary\" />\n                  </div>\n                  <span className=\"text-sm font-medium text-primary\">\n                    Drop files here\n                  </span>\n                </motion.div>\n              </div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* Quote Preview */}\n        {quote && (\n          <QuotePreview quote={quote} onDismiss={() => setQuote(null)} />\n        )}\n\n        {/* Attachment previews */}\n        {attachments.length > 0 && (\n          <div className=\"px-3 pt-2\">\n            <AttachmentPreview\n              attachments={attachments}\n              onRemove={(idx) =>\n                onAttachmentsChange(attachments.filter((_, i) => i !== idx))\n              }\n            />\n          </div>\n        )}\n\n        {/* Main input row - ChatGPT style: [+] [textarea] [mic/send] */}\n        <div className=\"flex gap-2 items-end px-2\">\n          {/* Plus button - LEFT, bottom-aligned */}\n          <div className=\"pb-1.5 flex-shrink-0\">\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <div>\n                  <FileUpload\n                    conversationId={conversationId}\n                    attachments={attachments}\n                    onAttachmentsChange={onAttachmentsChange}\n                    onUploadComplete={() => textareaRef.current?.focus()}\n                    uploading={uploading}\n                    setUploading={setUploading}\n                  />\n                </div>\n              </TooltipTrigger>\n              <TooltipContent side=\"top\">\n                <p>Attach files</p>\n              </TooltipContent>\n            </Tooltip>\n          </div>\n\n          {/* Textarea container - grows upward, takes remaining space */}\n          <div className=\"flex-1 min-w-0 relative\">\n            {isRecording ? (\n              <div className=\"relative min-h-[50px] flex items-center justify-center rounded-xl overflow-hidden\">\n                <div className=\"absolute inset-0 bg-gradient-to-r from-primary/5 via-primary/10 to-primary/5 animate-pulse\" />\n                <div className=\"absolute inset-0 border border-primary/20 rounded-xl\" />\n                <AudioWaveform\n                  stream={recordingStream!}\n                  height={50}\n                  className=\"absolute inset-0 w-full h-full\"\n                />\n              </div>\n            ) : (\n              <>\n                <Textarea\n                  ref={textareaRef}\n                  data-testid=\"chat-input\"\n                  value={input}\n                  onChange={(e) => setInput(e.target.value)}\n                  onKeyDown={handleKeyDown}\n                  onFocus={() => setIsFocused(true)}\n                  onBlur={() => setIsFocused(false)}\n                  placeholder={getPlaceholder()}\n                  aria-label=\"Message input\"\n                  aria-describedby=\"input-hint\"\n                  aria-multiline=\"true\"\n                  className=\"resize-none min-h-[50px] max-h-[200px] py-3 px-2 pr-8 bg-transparent border-0 shadow-none focus-visible:ring-0 text-base placeholder:text-muted-foreground/50\"\n                  rows={1}\n                  disabled={isSending || uploading}\n                  data-tour=\"input\"\n                />\n                {/* Expand button for long text */}\n                {showExpandButton && (\n                  <Tooltip>\n                    <TooltipTrigger asChild>\n                      <Button\n                        type=\"button\"\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => setShowExpandedInput(true)}\n                        className=\"absolute top-2 right-1 h-6 w-6 text-muted-foreground/50 hover:text-muted-foreground hover:bg-transparent\"\n                        aria-label=\"Expand input\"\n                      >\n                        <Expand className=\"w-3.5 h-3.5\" />\n                      </Button>\n                    </TooltipTrigger>\n                    <TooltipContent side=\"top\">\n                      <p>Expand editor</p>\n                    </TooltipContent>\n                  </Tooltip>\n                )}\n              </>\n            )}\n          </div>\n\n          <div id=\"input-hint\" className=\"sr-only\">\n            Type your message. Press Enter to send, Shift+Enter for new line.\n          </div>\n\n          {/* Right button(s) - bottom-aligned */}\n          <div className=\"pb-1.5 flex-shrink-0 flex items-center gap-1\">\n            {/* Show mic when empty, send when has content (ChatGPT behavior) */}\n            {showMic ? (\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <div>\n                    <VoiceInput\n                      ref={voiceInputRef}\n                      onTranscript={async (text, autoSend) => {\n                        setIsTranscribing(false);\n                        if (autoSend && text.trim()) {\n                          setIsSending(true);\n                          try {\n                            await sendMessage({\n                              conversationId,\n                              content: text.trim(),\n                              ...(isComparisonMode\n                                ? { models: selectedModels }\n                                : { modelId: selectedModel }),\n                              thinkingEffort,\n                              attachments:\n                                attachments.length > 0\n                                  ? attachments\n                                  : undefined,\n                            });\n                            onAttachmentsChange([]);\n                          } catch (error) {\n                            if (\n                              error instanceof Error &&\n                              error.message.includes(\"Daily message limit\")\n                            ) {\n                              setShowRateLimitDialog(true);\n                            } else {\n                              console.error(\"Failed to send message:\", error);\n                            }\n                          } finally {\n                            setIsSending(false);\n                          }\n                        } else {\n                          setInput((prev) =>\n                            prev.trim() ? `${prev} ${text}` : text,\n                          );\n                        }\n                      }}\n                      onRecordingStateChange={(recording, stream) => {\n                        setIsRecording(recording);\n                        setRecordingStream(stream || null);\n                        if (!recording && stream) setIsTranscribing(true);\n                      }}\n                      isDisabled={isSending || uploading}\n                    />\n                  </div>\n                </TooltipTrigger>\n                <TooltipContent>\n                  <p>Voice input</p>\n                </TooltipContent>\n              </Tooltip>\n            ) : (\n              <motion.div\n                whileHover={canSend ? { scale: 1.05 } : undefined}\n                whileTap={canSend ? { scale: 0.95, rotate: -2 } : undefined}\n                transition={{ type: \"spring\", stiffness: 400, damping: 17 }}\n              >\n                <Button\n                  type={\n                    isGenerating ? \"button\" : isRecording ? \"button\" : \"submit\"\n                  }\n                  size=\"icon\"\n                  onClick={\n                    isGenerating\n                      ? handleStop\n                      : isRecording\n                        ? () => voiceInputRef.current?.stopRecording(\"send\")\n                        : undefined\n                  }\n                  data-testid=\"send-button\"\n                  aria-label={\n                    isGenerating\n                      ? \"Stop generating response\"\n                      : isRecording\n                        ? \"Stop recording and send\"\n                        : \"Send message\"\n                  }\n                  className={cn(\n                    \"h-10 w-10 rounded-full transition-all duration-200\",\n                    !canSend\n                      ? \"bg-muted/50 text-muted-foreground/50\"\n                      : [\n                          \"bg-primary text-primary-foreground\",\n                          \"shadow-[0_2px_8px_rgba(var(--primary-rgb),0.25)]\",\n                          \"hover:shadow-[0_4px_16px_rgba(var(--primary-rgb),0.35)]\",\n                        ],\n                  )}\n                  disabled={!canSend}\n                >\n                  {isSending ? (\n                    <Loader2\n                      className=\"w-5 h-5 animate-spin\"\n                      aria-hidden=\"true\"\n                    />\n                  ) : isGenerating ? (\n                    <Square\n                      className=\"w-4 h-4 fill-current\"\n                      aria-hidden=\"true\"\n                    />\n                  ) : (\n                    <Send className=\"w-5 h-5 ml-0.5\" aria-hidden=\"true\" />\n                  )}\n                </Button>\n              </motion.div>\n            )}\n          </div>\n        </div>\n\n        <InputBottomBar\n          isComparisonMode={isComparisonMode}\n          selectedModels={selectedModels}\n          onExitComparison={onExitComparison}\n          onStartComparison={onStartComparison}\n          comparisonDialogOpen={comparisonDialogOpen}\n          onComparisonDialogOpenChange={onComparisonDialogOpenChange}\n          selectedModel={selectedModel}\n          onModelChange={onModelChange}\n          modelSelectorOpen={modelSelectorOpen}\n          onModelSelectorOpenChange={onModelSelectorOpenChange}\n          supportsThinking={supportsThinking}\n          thinkingEffort={thinkingEffort}\n          onThinkingEffortChange={onThinkingEffortChange}\n          isEmpty={isEmpty}\n          hasContent={input.length > 0}\n        />\n      </form>\n\n      <RateLimitDialog\n        open={showRateLimitDialog}\n        onOpenChange={setShowRateLimitDialog}\n        limit={50}\n      />\n\n      <ExpandedInputDialog\n        open={showExpandedInput}\n        onOpenChange={setShowExpandedInput}\n        value={input}\n        onChange={setInput}\n        onSubmit={() => {\n          setShowExpandedInput(false);\n          formRef.current?.requestSubmit();\n        }}\n        placeholder={getPlaceholder()}\n      />\n    </div>\n  );\n});\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport { useAction, useMutation, useQuery } from \"convex/react\";\nimport { Mic } from \"lucide-react\";\nimport {\n  forwardRef,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from \"react\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport { useUserPreference } from \"@/hooks/useUserPreference\";\nimport { analytics } from \"@/lib/analytics\";\nimport { cn } from \"@/lib/utils\";\n\ninterface VoiceInputProps {\n  onTranscript: (text: string, autoSend: boolean) => void;\n  onRecordingStateChange?: (recording: boolean, stream?: MediaStream) => void;\n  isDisabled?: boolean;\n}\n\nexport interface VoiceInputRef {\n  stopRecording: (mode: \"preview\" | \"send\") => void;\n}\n\nexport const VoiceInput = forwardRef<VoiceInputRef, VoiceInputProps>(\n  ({ onTranscript, onRecordingStateChange, isDisabled }, ref) => {\n    const [isRecording, setIsRecording] = useState(false);\n    const [isProcessing, setIsProcessing] = useState(false);\n\n    const mediaRecorderRef = useRef<MediaRecorder | null>(null);\n    const audioChunksRef = useRef<Blob[]>([]);\n    const streamRef = useRef<MediaStream | null>(null);\n    const stopModeRef = useRef<\"preview\" | \"send\" | null>(null);\n\n    // @ts-ignore - Type depth exceeded with complex Convex query (85+ modules)\n    const user = useQuery(api.users.getCurrentUser as any);\n    const transcribeAudio = useAction(api.transcription.transcribeAudio);\n    const generateUploadUrl = useMutation(api.files.generateUploadUrl);\n\n    // Phase 4: Use new preference hooks\n    const sttEnabled = useUserPreference(\"sttEnabled\");\n    const sttProvider = useUserPreference(\"sttProvider\");\n\n    const startRecording = useCallback(async () => {\n      if (!sttEnabled) {\n        toast.error(\"Voice input disabled in settings\");\n        return;\n      }\n\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          audio: true,\n        });\n        streamRef.current = stream;\n\n        const recorder = new MediaRecorder(stream, {\n          mimeType: \"audio/webm;codecs=opus\",\n        });\n\n        audioChunksRef.current = [];\n\n        recorder.ondataavailable = (e) => {\n          if (e.data.size > 0) {\n            audioChunksRef.current.push(e.data);\n          }\n        };\n\n        recorder.onstop = async () => {\n          setIsProcessing(true);\n          onRecordingStateChange?.(false);\n\n          const audioBlob = new Blob(audioChunksRef.current, {\n            type: \"audio/webm\",\n          });\n\n          // Track recording stopped\n          analytics.track(\"voice_recording_stopped\", {\n            durationMs: audioBlob.size / 16,\n          });\n\n          try {\n            // Upload audio to Convex storage first\n            const uploadUrl = await generateUploadUrl();\n            const uploadResponse = await fetch(uploadUrl, {\n              method: \"POST\",\n              headers: { \"Content-Type\": audioBlob.type },\n              body: audioBlob,\n            });\n\n            if (!uploadResponse.ok) {\n              throw new Error(\"Failed to upload audio file\");\n            }\n\n            const { storageId } = await uploadResponse.json();\n\n            // Client-side timeout (95s - slightly longer than backend 90s)\n            const timeoutPromise = new Promise<never>((_, reject) =>\n              setTimeout(() => reject(new Error(\"TIMEOUT\")), 95_000),\n            );\n\n            const transcriptionPromise = transcribeAudio({\n              storageId,\n              mimeType: \"audio/webm\",\n            });\n\n            const transcript = await Promise.race([\n              transcriptionPromise,\n              timeoutPromise,\n            ]);\n\n            const autoSend = stopModeRef.current === \"send\";\n            onTranscript(transcript, autoSend);\n\n            // Track successful transcription\n            analytics.track(\"transcription_completed\", {\n              autoSendUsed: autoSend,\n            });\n          } catch (error) {\n            console.error(\"Transcription failed:\", error);\n\n            // Better error messages\n            const message =\n              error instanceof Error ? error.message : String(error);\n            if (message === \"TIMEOUT\") {\n              toast.error(\n                \"Transcription timed out. Try recording a shorter message.\",\n              );\n            } else {\n              toast.error(message || \"STT not working right now\");\n            }\n\n            onTranscript(\"\", false);\n          } finally {\n            setIsProcessing(false);\n            stopModeRef.current = null;\n          }\n        };\n\n        recorder.start();\n        mediaRecorderRef.current = recorder;\n        setIsRecording(true);\n        onRecordingStateChange?.(true, stream);\n\n        // Track recording started\n        analytics.track(\"voice_recording_started\");\n      } catch (error) {\n        console.error(\"MediaRecorder failed:\", error);\n        toast.error(\"Microphone access denied\");\n      }\n    }, [\n      sttEnabled,\n      transcribeAudio,\n      onTranscript,\n      onRecordingStateChange,\n      generateUploadUrl,\n    ]);\n\n    const stopRecording = useCallback(\n      (mode: \"preview\" | \"send\") => {\n        if (!isRecording || !mediaRecorderRef.current) return;\n\n        stopModeRef.current = mode;\n        mediaRecorderRef.current.stop();\n\n        if (streamRef.current) {\n          streamRef.current.getTracks().forEach((track) => track.stop());\n          streamRef.current = null;\n        }\n\n        setIsRecording(false);\n      },\n      [isRecording],\n    );\n\n    const toggleRecording = useCallback(() => {\n      if (isRecording) {\n        stopRecording(\"preview\");\n      } else {\n        startRecording();\n      }\n    }, [isRecording, startRecording, stopRecording]);\n\n    // Expose stopRecording to parent via ref\n    useImperativeHandle(\n      ref,\n      () => ({\n        stopRecording,\n      }),\n      [stopRecording],\n    );\n\n    if (!sttEnabled) {\n      return null; // Hide button if STT disabled\n    }\n\n    return (\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"icon\"\n        onClick={toggleRecording}\n        disabled={isDisabled || isProcessing || !user}\n        aria-label={\n          isRecording ? \"Stop recording\" : `Start voice input (${sttProvider})`\n        }\n        className={cn(\n          \"h-8 w-8 rounded-full transition-all duration-300\",\n          isRecording\n            ? \"bg-primary text-primary-foreground hover:bg-primary/90\"\n            : \"text-muted-foreground hover:text-foreground hover:bg-muted/50\",\n        )}\n      >\n        <div\n          className=\"relative w-4 h-4 flex items-center justify-center\"\n          aria-hidden=\"true\"\n        >\n          <div\n            className={cn(\n              \"absolute inset-0 flex items-center justify-center transition-all duration-300 transform\",\n              isRecording\n                ? \"opacity-100 scale-100 rotate-0\"\n                : \"opacity-0 scale-50 rotate-90\",\n            )}\n          >\n            <div className=\"h-3 w-3 bg-current rounded-[2px]\" />\n          </div>\n          <div\n            className={cn(\n              \"absolute inset-0 flex items-center justify-center transition-all duration-300 transform\",\n              !isRecording\n                ? \"opacity-100 scale-100 rotate-0\"\n                : \"opacity-0 scale-50 -rotate-90\",\n            )}\n          >\n            <Mic className=\"w-4 h-4\" />\n          </div>\n        </div>\n      </Button>\n    );\n  },\n);\n\nVoiceInput.displayName = \"VoiceInput\";\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useQuery } from \"convex/react\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport {\n  FileIcon,\n  FileSpreadsheet,\n  FileText,\n  Image as ImageIcon,\n  Mic,\n  X,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\n\ninterface Attachment {\n  type: \"file\" | \"image\" | \"audio\";\n  name: string;\n  storageId: string;\n  mimeType: string;\n  size: number;\n}\n\ninterface AttachmentPreviewProps {\n  attachments: Attachment[];\n  onRemove: (index: number) => void;\n}\n\nconst fileTypeColors: Record<string, string> = {\n  pdf: \"from-red-500/20 to-red-600/10 border-red-500/20\",\n  doc: \"from-blue-500/20 to-blue-600/10 border-blue-500/20\",\n  docx: \"from-blue-500/20 to-blue-600/10 border-blue-500/20\",\n  xls: \"from-green-500/20 to-green-600/10 border-green-500/20\",\n  xlsx: \"from-green-500/20 to-green-600/10 border-green-500/20\",\n  csv: \"from-green-500/20 to-green-600/10 border-green-500/20\",\n  txt: \"from-zinc-500/20 to-zinc-600/10 border-zinc-500/20\",\n  default: \"from-muted/50 to-muted/30 border-border/50\",\n};\n\nfunction getFileExtension(name: string): string {\n  return name.split(\".\").pop()?.toLowerCase() || \"\";\n}\n\nfunction getFileIcon(mimeType: string, name: string) {\n  const ext = getFileExtension(name);\n\n  if (\n    mimeType.includes(\"spreadsheet\") ||\n    [\"xls\", \"xlsx\", \"csv\"].includes(ext)\n  ) {\n    return FileSpreadsheet;\n  }\n  if (\n    mimeType.includes(\"pdf\") ||\n    mimeType.includes(\"document\") ||\n    [\"doc\", \"docx\", \"txt\", \"pdf\"].includes(ext)\n  ) {\n    return FileText;\n  }\n  return FileIcon;\n}\n\nfunction formatSize(bytes: number): string {\n  if (bytes < 1024) return `${bytes} B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n}\n\nexport function AttachmentPreview({\n  attachments,\n  onRemove,\n}: AttachmentPreviewProps) {\n  return (\n    <div className=\"flex gap-2 flex-wrap\">\n      <AnimatePresence mode=\"popLayout\">\n        {attachments.map((attachment, idx) => (\n          <motion.div\n            key={`${attachment.storageId}-${idx}`}\n            initial={{ opacity: 0, y: 8, scale: 0.95 }}\n            animate={{ opacity: 1, y: 0, scale: 1 }}\n            exit={{ opacity: 0, y: -8, scale: 0.95 }}\n            transition={{\n              duration: 0.2,\n              delay: idx * 0.05,\n              ease: [0.4, 0, 0.2, 1],\n            }}\n          >\n            {attachment.type === \"image\" ? (\n              <ImageAttachment\n                attachment={attachment}\n                onRemove={() => onRemove(idx)}\n              />\n            ) : attachment.type === \"audio\" ? (\n              <AudioAttachment\n                attachment={attachment}\n                onRemove={() => onRemove(idx)}\n              />\n            ) : (\n              <FileAttachment\n                attachment={attachment}\n                onRemove={() => onRemove(idx)}\n              />\n            )}\n          </motion.div>\n        ))}\n      </AnimatePresence>\n    </div>\n  );\n}\n\nfunction ImageAttachment({\n  attachment,\n  onRemove,\n}: {\n  attachment: Attachment;\n  onRemove: () => void;\n}) {\n  // @ts-ignore - Type depth exceeded\n  const url = useQuery(api.files.getFileUrl, {\n    storageId: attachment.storageId as Id<\"_storage\">,\n  });\n\n  return (\n    <div className=\"relative group overflow-hidden rounded-xl w-16 h-16 bg-muted/30 border border-border/30\">\n      {url ? (\n        <img\n          src={url}\n          alt={attachment.name}\n          className=\"object-cover w-full h-full transition-transform duration-200 group-hover:scale-110\"\n        />\n      ) : (\n        <div className=\"w-full h-full flex items-center justify-center\">\n          <ImageIcon className=\"w-6 h-6 text-muted-foreground/50\" />\n        </div>\n      )}\n\n      {/* Hover overlay */}\n      <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200\" />\n\n      {/* Remove button */}\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"icon\"\n        onClick={onRemove}\n        className=\"absolute top-1 right-1 h-5 w-5 p-0 rounded-full bg-black/50 text-white opacity-0 group-hover:opacity-100 transition-opacity hover:bg-black/70\"\n        aria-label={`Remove ${attachment.name}`}\n      >\n        <X className=\"w-3 h-3\" />\n      </Button>\n\n      {/* Size badge */}\n      <span className=\"absolute bottom-1 left-1 text-[10px] text-white/80 bg-black/40 px-1 rounded opacity-0 group-hover:opacity-100 transition-opacity\">\n        {formatSize(attachment.size)}\n      </span>\n    </div>\n  );\n}\n\nfunction AudioAttachment({\n  attachment,\n  onRemove,\n}: {\n  attachment: Attachment;\n  onRemove: () => void;\n}) {\n  return (\n    <div className=\"relative group flex items-center gap-2 px-3 py-2 rounded-full bg-gradient-to-r from-violet-500/20 to-violet-600/10 border border-violet-500/20\">\n      <div className=\"w-6 h-6 rounded-full bg-violet-500/20 flex items-center justify-center\">\n        <Mic className=\"w-3.5 h-3.5 text-violet-400\" />\n      </div>\n\n      <div className=\"max-w-[100px] min-w-0\">\n        <p className=\"text-xs font-medium truncate text-foreground/90\">\n          {attachment.name}\n        </p>\n        <p className=\"text-[10px] text-muted-foreground\">\n          {formatSize(attachment.size)}\n        </p>\n      </div>\n\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"icon\"\n        onClick={onRemove}\n        className=\"h-5 w-5 p-0 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-violet-500/20\"\n        aria-label={`Remove ${attachment.name}`}\n      >\n        <X className=\"w-3 h-3\" />\n      </Button>\n    </div>\n  );\n}\n\nfunction FileAttachment({\n  attachment,\n  onRemove,\n}: {\n  attachment: Attachment;\n  onRemove: () => void;\n}) {\n  const ext = getFileExtension(attachment.name);\n  const colorClass = fileTypeColors[ext] || fileTypeColors.default;\n  const Icon = getFileIcon(attachment.mimeType, attachment.name);\n\n  return (\n    <div\n      className={cn(\n        \"relative group flex items-center gap-2 px-3 py-2 rounded-full bg-gradient-to-r border\",\n        colorClass,\n      )}\n    >\n      <Icon className=\"w-4 h-4 text-muted-foreground flex-shrink-0\" />\n\n      <div className=\"max-w-[100px] min-w-0\">\n        <p className=\"text-xs font-medium truncate text-foreground/90\">\n          {attachment.name}\n        </p>\n        <p className=\"text-[10px] text-muted-foreground\">\n          {formatSize(attachment.size)}\n        </p>\n      </div>\n\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"icon\"\n        onClick={onRemove}\n        className=\"h-5 w-5 p-0 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-muted/50\"\n        aria-label={`Remove ${attachment.name}`}\n      >\n        <X className=\"w-3 h-3\" />\n      </Button>\n    </div>\n  );\n}\n","\"use client\";\n\nimport { useEffect, useRef } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface AudioWaveformProps {\n  stream: MediaStream;\n  height?: number;\n  className?: string;\n}\n\nexport function AudioWaveform({\n  stream,\n  height = 120,\n  className,\n}: AudioWaveformProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const analyserRef = useRef<AnalyserNode | null>(null);\n  const animationFrameRef = useRef<number | null>(null);\n  const audioContextRef = useRef<AudioContext | null>(null);\n  // Ref to store the computed color\n  const colorRef = useRef<string>(\"\");\n\n  useEffect(() => {\n    // Resolve the primary color using a temporary element\n    const tempEl = document.createElement(\"div\");\n    tempEl.style.color = \"var(--primary)\";\n    tempEl.style.display = \"none\";\n    document.body.appendChild(tempEl);\n    const computedColor = getComputedStyle(tempEl).color;\n    colorRef.current = computedColor;\n    document.body.removeChild(tempEl);\n  }, []);\n\n  useEffect(() => {\n    if (!stream) return;\n\n    // Setup Web Audio API\n    const audioContext = new AudioContext();\n    const analyser = audioContext.createAnalyser();\n    const source = audioContext.createMediaStreamSource(stream);\n\n    analyser.fftSize = 512; // Higher resolution for smoother bars\n    analyser.smoothingTimeConstant = 0.85; // Smooth animation\n    source.connect(analyser);\n\n    audioContextRef.current = audioContext;\n    analyserRef.current = analyser;\n\n    const dataArray = new Uint8Array(analyser.frequencyBinCount);\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    // Set canvas resolution for high-DPI displays\n    const dpr = window.devicePixelRatio || 1;\n    const rect = canvas.getBoundingClientRect();\n    canvas.width = rect.width * dpr;\n    canvas.height = rect.height * dpr;\n    ctx.scale(dpr, dpr);\n\n    // ElevenLabs-style: fewer bars, centered, rounded\n    const barCount = 64;\n    const barWidth = 3;\n    const barGap = 2;\n    const totalBarWidth = barWidth + barGap;\n    const totalWidth = barCount * totalBarWidth;\n    const offsetX = (rect.width - totalWidth) / 2;\n\n    // Render loop\n    const draw = () => {\n      analyser.getByteFrequencyData(dataArray);\n\n      // Clear canvas\n      ctx.clearRect(0, 0, rect.width, rect.height);\n\n      // Sample data evenly across frequency range\n      const step = Math.floor(dataArray.length / barCount);\n\n      // Draw centered bars\n      for (let i = 0; i < barCount; i++) {\n        const dataIndex = i * step;\n        const normalized = dataArray[dataIndex] / 255; // 0-1 range\n\n        // Minimum height for visual appeal\n        const minHeight = 4;\n        const maxHeight = rect.height * 0.8;\n        const barHeight = Math.max(minHeight, normalized * maxHeight);\n\n        const x = offsetX + i * totalBarWidth;\n        const y = (rect.height - barHeight) / 2; // Center vertically\n\n        // ElevenLabs-style gradient\n        const opacity = 0.6 + normalized * 0.4; // 0.6-1.0 range\n\n        // Use the resolved RGB color with opacity\n        // computedColor is usually \"rgb(r, g, b)\" or \"rgba(r, g, b, a)\"\n        // We can use color-mix or just set globalAlpha, but setting fillStyle is better.\n        // If it's rgb(...), we can replace ')' with ', opacity)'.\n        // Or simpler: use ctx.globalAlpha for opacity if we draw one by one,\n        // but that affects the whole context state.\n        // Best: use `color-mix(in srgb, ${colorRef.current}, transparent ${100 - opacity * 100}%)`\n        // or just rely on CSS color module 4 relative syntax if supported,\n        // but safe fallback is to use the computed RGB string.\n\n        if (colorRef.current.startsWith(\"rgb\")) {\n          // rgb(r, g, b) -> rgba(r, g, b, opacity)\n          const rgbValues = colorRef.current.match(/\\d+/g);\n          if (rgbValues && rgbValues.length >= 3) {\n            ctx.fillStyle = `rgba(${rgbValues[0]}, ${rgbValues[1]}, ${rgbValues[2]}, ${opacity})`;\n          } else {\n            ctx.fillStyle = colorRef.current; // Fallback\n          }\n        } else {\n          // Fallback for other formats\n          ctx.fillStyle = colorRef.current;\n          ctx.globalAlpha = opacity;\n        }\n\n        // Rounded rectangle\n        ctx.beginPath();\n        ctx.roundRect(x, y, barWidth, barHeight, barWidth / 2);\n        ctx.fill();\n\n        // Reset alpha if we used it\n        ctx.globalAlpha = 1.0;\n      }\n\n      animationFrameRef.current = requestAnimationFrame(draw);\n    };\n\n    draw();\n\n    // Cleanup\n    return () => {\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n      source.disconnect();\n      analyser.disconnect();\n      audioContext.close();\n    };\n  }, [stream]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      className={cn(\"w-full h-full\", className)} // Ensure full height\n      style={{ height: \"100%\", width: \"100%\" }} // Force full size\n    />\n  );\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation } from \"convex/react\";\nimport { Loader2, Plus } from \"lucide-react\";\nimport { useCallback } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport { analytics } from \"@/lib/analytics\";\n\ninterface Attachment {\n  type: \"file\" | \"image\" | \"audio\";\n  name: string;\n  storageId: string;\n  mimeType: string;\n  size: number;\n  url?: string;\n}\n\ninterface FileUploadProps {\n  conversationId?: Id<\"conversations\">;\n  attachments: Attachment[];\n  onAttachmentsChange: (attachments: Attachment[]) => void;\n  onUploadComplete?: () => void;\n  maxSizeMB?: number;\n}\n\nexport function FileUpload({\n  conversationId,\n  attachments,\n  onAttachmentsChange,\n  onUploadComplete,\n  maxSizeMB = 10,\n  uploading,\n  setUploading,\n}: FileUploadProps & {\n  uploading: boolean;\n  setUploading: (uploading: boolean) => void;\n}) {\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const generateUploadUrl = useMutation(api.files.generateUploadUrl);\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const saveFile = useMutation(api.files.saveFile);\n\n  const onDrop = useCallback(\n    async (acceptedFiles: File[]) => {\n      setUploading(true);\n\n      try {\n        const newAttachments: Attachment[] = [];\n\n        for (const file of acceptedFiles) {\n          // Validate size\n          if (file.size > maxSizeMB * 1024 * 1024) {\n            toast.error(`${file.name} exceeds ${maxSizeMB}MB limit`);\n            continue;\n          }\n\n          // Get upload URL\n          const uploadUrl = await generateUploadUrl();\n\n          // Upload file\n          const result = await fetch(uploadUrl, {\n            method: \"POST\",\n            headers: { \"Content-Type\": file.type },\n            body: file,\n          });\n\n          const { storageId } = await result.json();\n\n          // Save file metadata\n          await saveFile({\n            storageId,\n            name: file.name,\n            mimeType: file.type,\n            size: file.size,\n            conversationId,\n          });\n\n          // Determine type\n          let type: \"file\" | \"image\" | \"audio\" = \"file\";\n          if (file.type.startsWith(\"image/\")) type = \"image\";\n          else if (file.type.startsWith(\"audio/\")) type = \"audio\";\n\n          newAttachments.push({\n            type,\n            name: file.name,\n            storageId,\n            mimeType: file.type,\n            size: file.size,\n          });\n\n          // Track each attachment upload\n          analytics.track(\"attachment_uploaded\", {\n            type,\n            size: file.size,\n            mimeType: file.type,\n            countPerMessage: 1,\n          });\n        }\n\n        onAttachmentsChange([...attachments, ...newAttachments]);\n        toast.success(\n          `Uploaded ${newAttachments.length} file${newAttachments.length === 1 ? \"\" : \"s\"}`,\n        );\n        // Focus input after successful upload\n        onUploadComplete?.();\n      } catch (error) {\n        console.error(\"Upload failed:\", error);\n        toast.error(\"Failed to upload files\");\n      } finally {\n        setUploading(false);\n      }\n    },\n    [\n      attachments,\n      conversationId,\n      generateUploadUrl,\n      maxSizeMB,\n      onAttachmentsChange,\n      onUploadComplete,\n      saveFile,\n      setUploading,\n    ],\n  );\n\n  const { getRootProps, getInputProps } = useDropzone({\n    onDrop,\n    disabled: uploading,\n    maxSize: maxSizeMB * 1024 * 1024,\n    noClick: false,\n    noKeyboard: false,\n  });\n\n  return (\n    <Button\n      type=\"button\"\n      variant=\"ghost\"\n      size=\"icon\"\n      {...getRootProps()}\n      disabled={uploading}\n      title=\"Attach files\"\n      className=\"h-8 w-8 rounded-full text-muted-foreground hover:text-foreground hover:bg-muted/50 transition-colors\"\n    >\n      <input {...getInputProps()} />\n      {uploading ? (\n        <Loader2 className=\"w-5 h-5 animate-spin\" />\n      ) : (\n        <Plus className=\"w-5 h-5\" />\n      )}\n      <span className=\"sr-only\">Attach files</span>\n    </Button>\n  );\n}\n","\"use client\";\n\nimport { ArrowLeftRight } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { QuickModelSwitcher } from \"./QuickModelSwitcher\";\n\ninterface ComparisonTriggerProps {\n  onStartComparison: (models: string[]) => void;\n  isActive: boolean;\n  selectedModels?: string[];\n  open?: boolean;\n  onOpenChange?: (open: boolean) => void;\n}\n\nexport function ComparisonTrigger({\n  onStartComparison,\n  isActive,\n  selectedModels = [],\n  open: externalOpen,\n  onOpenChange: externalOnOpenChange,\n}: ComparisonTriggerProps) {\n  const [internalOpen, setInternalOpen] = useState(false);\n\n  // Use external state if provided, otherwise use internal state\n  const open = externalOpen !== undefined ? externalOpen : internalOpen;\n  const setOpen = externalOnOpenChange || setInternalOpen;\n\n  return (\n    <>\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <Button\n            variant=\"ghost\"\n            disabled={isActive}\n            title=\"Compare models\"\n            onClick={() => setOpen(true)}\n            className=\"h-7 text-xs border border-primary/20 bg-primary/2 hover:bg-primary/10 text-primary/80 hover:text-primary/80 cursor-pointer px-3 rounded-full transition-colors min-w-0 w-auto font-medium gap-1.5\"\n            data-tour=\"comparison\"\n          >\n            <ArrowLeftRight className=\"w-3.5 h-3.5\" />\n            <span className=\"hidden sm:inline\">Compare</span>\n          </Button>\n        </TooltipTrigger>\n        <TooltipContent>\n          <p>Compare models</p>\n        </TooltipContent>\n      </Tooltip>\n      <QuickModelSwitcher\n        currentModel=\"\"\n        onSelectModel={() => {}}\n        open={open}\n        onOpenChange={setOpen}\n        mode=\"multiple\"\n        selectedModels={selectedModels}\n        onSelectedModelsChange={(models) => {\n          onStartComparison(models);\n          setOpen(false);\n        }}\n      />\n    </>\n  );\n}\n","\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { getServerSafeModifierKey } from \"@/lib/utils/platform\";\n\n/**\n * Hook that provides the platform-specific modifier key in a hydration-safe way.\n *\n * During SSR and initial hydration, returns \"Ctrl\" to prevent hydration mismatches.\n * After hydration, updates to the correct platform-specific key (âŒ˜ on Mac, Ctrl elsewhere).\n */\nexport function useModifierKey(): string {\n  const [modifierKey, setModifierKey] = useState(\"Ctrl\");\n\n  useEffect(() => {\n    // After hydration, update to the actual platform-specific key\n    setModifierKey(getServerSafeModifierKey());\n  }, []);\n\n  return modifierKey;\n}\n","\"use client\";\n\nimport { Keyboard } from \"lucide-react\";\nimport { HydrationSafeShortcutBadge } from \"@/components/chat/HydrationSafeShortcutBadge\";\nimport { Button } from \"@/components/ui/button\";\nimport { ShortcutBadge } from \"@/components/ui/shortcut-badge\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { useMobileDetect } from \"@/hooks/useMobileDetect\";\n\ninterface KeyboardHintsProps {\n  isEmpty: boolean;\n  hasContent: boolean;\n}\n\nexport function KeyboardHints({ isEmpty, hasContent }: KeyboardHintsProps) {\n  const { isMobile } = useMobileDetect();\n\n  if (isMobile) return null;\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"h-7 w-7 text-muted-foreground/60 hover:text-muted-foreground hover:bg-transparent\"\n          aria-label=\"Keyboard shortcuts\"\n        >\n          <Keyboard className=\"h-4 w-4\" />\n        </Button>\n      </TooltipTrigger>\n      <TooltipContent side=\"top\" align=\"end\" className=\"p-3 space-y-2\">\n        <p className=\"text-xs font-medium text-foreground mb-2\">Shortcuts</p>\n        {hasContent ? (\n          <>\n            <ShortcutRow keys={[\"Enter\"]} label=\"Send message\" />\n            <ShortcutRow keys={[\"Shift\", \"Enter\"]} label=\"New line\" />\n          </>\n        ) : isEmpty ? (\n          <>\n            <ShortcutRowWithMod keys={[\"mod\", \"K\"]} label=\"Commands\" />\n            <ShortcutRow keys={[\"Alt\", \"N\"]} label=\"New chat\" />\n          </>\n        ) : (\n          <ShortcutRow keys={[\"Shift\", \"Enter\"]} label=\"New line\" />\n        )}\n      </TooltipContent>\n    </Tooltip>\n  );\n}\n\nfunction ShortcutRow({ keys, label }: { keys: string[]; label: string }) {\n  return (\n    <div className=\"flex items-center justify-between gap-4 text-xs\">\n      <span className=\"text-muted-foreground\">{label}</span>\n      <ShortcutBadge keys={keys} />\n    </div>\n  );\n}\n\nfunction ShortcutRowWithMod({\n  keys,\n  label,\n}: {\n  keys: string[];\n  label: string;\n}) {\n  return (\n    <div className=\"flex items-center justify-between gap-4 text-xs\">\n      <span className=\"text-muted-foreground\">{label}</span>\n      <HydrationSafeShortcutBadge keys={keys} />\n    </div>\n  );\n}\n","import { Zap } from \"lucide-react\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { analytics } from \"@/lib/analytics\";\nimport { cn } from \"@/lib/utils\";\n\nexport type ThinkingEffort = \"none\" | \"low\" | \"medium\" | \"high\";\n\ninterface ThinkingEffortSelectorProps {\n  value: ThinkingEffort;\n  onChange: (effort: ThinkingEffort) => void;\n  className?: string;\n}\n\nconst efforts = [\n  { value: \"none\", label: \"No Reasoning\" },\n  { value: \"low\", label: \"Low Reasoning\" },\n  { value: \"medium\", label: \"Medium Reasoning\" },\n  { value: \"high\", label: \"High Reasoning\" },\n] as const;\n\nexport function ThinkingEffortSelector({\n  value,\n  onChange,\n  className,\n}: ThinkingEffortSelectorProps) {\n  const handleChange = (effort: ThinkingEffort) => {\n    onChange(effort);\n\n    // Track thinking effort selection\n    analytics.track(\"thinking_effort_selected\", {\n      effort,\n      previousEffort: value,\n    });\n  };\n\n  return (\n    <Select\n      value={value}\n      onValueChange={(v) => handleChange(v as ThinkingEffort)}\n    >\n      <SelectTrigger\n        className={cn(\n          \"h-7 text-xs border border-primary/20 bg-primary/5 hover:bg-primary/10 text-primary px-3 rounded-full transition-colors min-w-0 w-auto font-medium gap-1\",\n          className,\n        )}\n      >\n        <SelectValue placeholder=\"Reasoning effort\">\n          <div className=\"flex items-center gap-1.5\">\n            <Zap className=\"w-3.5 h-3.5\" />\n            <span className=\"hidden sm:inline\">\n              {efforts.find((e) => e.value === value)?.label}\n            </span>\n          </div>\n        </SelectValue>\n      </SelectTrigger>\n      <SelectContent>\n        {efforts.map((effort: any) => (\n          <SelectItem\n            key={effort.value}\n            value={effort.value}\n            className=\"text-xs\"\n          >\n            {effort.label}\n          </SelectItem>\n        ))}\n      </SelectContent>\n    </Select>\n  );\n}\n","\"use client\";\n\nimport { Info, X } from \"lucide-react\";\nimport Link from \"next/link\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { ComparisonTrigger } from \"./ComparisonTrigger\";\nimport { KeyboardHints } from \"./KeyboardHints\";\nimport { QuickModelSwitcher } from \"./QuickModelSwitcher\";\nimport {\n  type ThinkingEffort,\n  ThinkingEffortSelector,\n} from \"./ThinkingEffortSelector\";\n\ninterface InputBottomBarProps {\n  // Comparison mode\n  isComparisonMode: boolean;\n  selectedModels: string[];\n  onExitComparison?: () => void;\n  onStartComparison?: (models: string[]) => void;\n  comparisonDialogOpen?: boolean;\n  onComparisonDialogOpenChange?: (open: boolean) => void;\n\n  // Model selection\n  selectedModel: string;\n  onModelChange: (modelId: string) => void;\n  modelSelectorOpen?: boolean;\n  onModelSelectorOpenChange?: (open: boolean) => void;\n\n  // Thinking effort\n  supportsThinking: boolean;\n  thinkingEffort?: ThinkingEffort;\n  onThinkingEffortChange?: (effort: ThinkingEffort) => void;\n\n  // Keyboard hints\n  isEmpty: boolean;\n  hasContent: boolean;\n}\n\n/**\n * Bottom control bar for the chat input.\n * Layout: [Model + Thinking] â†spacerâ†’ [Compare + Keyboard + Info]\n */\nexport function InputBottomBar({\n  isComparisonMode,\n  selectedModels,\n  onExitComparison,\n  onStartComparison,\n  comparisonDialogOpen,\n  onComparisonDialogOpenChange,\n  selectedModel,\n  onModelChange,\n  modelSelectorOpen,\n  onModelSelectorOpenChange,\n  supportsThinking,\n  thinkingEffort,\n  onThinkingEffortChange,\n  isEmpty,\n  hasContent,\n}: InputBottomBarProps) {\n  return (\n    <div className=\"px-3 pb-2 flex justify-between items-center gap-2\">\n      {/* Left group: Primary actions (Model + Thinking) */}\n      <div className=\"flex items-center gap-1.5\">\n        {isComparisonMode && onExitComparison ? (\n          <Badge\n            variant=\"secondary\"\n            className=\"flex items-center gap-1.5 pr-1 text-xs font-medium\"\n          >\n            <span className=\"text-muted-foreground\">Comparing</span>\n            <span className=\"text-foreground\">{selectedModels.length}</span>\n            <Button\n              size=\"icon\"\n              variant=\"ghost\"\n              className=\"h-4 w-4 p-0 hover:bg-muted/50 rounded-full\"\n              onClick={onExitComparison}\n              aria-label=\"Exit comparison mode\"\n            >\n              <X className=\"w-3 h-3\" />\n            </Button>\n          </Badge>\n        ) : (\n          <QuickModelSwitcher\n            currentModel={selectedModel}\n            onSelectModel={onModelChange}\n            open={modelSelectorOpen ?? false}\n            onOpenChange={onModelSelectorOpenChange ?? (() => {})}\n            mode=\"single\"\n            showTrigger={true}\n          />\n        )}\n\n        {supportsThinking &&\n          thinkingEffort &&\n          onThinkingEffortChange &&\n          !isComparisonMode && (\n            <ThinkingEffortSelector\n              value={thinkingEffort}\n              onChange={onThinkingEffortChange}\n            />\n          )}\n      </div>\n\n      {/* Right group: Secondary actions (Compare + Keyboard + Info) */}\n      <div className=\"flex items-center gap-0.5\">\n        {onStartComparison && (\n          <ComparisonTrigger\n            onStartComparison={onStartComparison}\n            isActive={isComparisonMode}\n            selectedModels={selectedModels}\n            open={comparisonDialogOpen}\n            onOpenChange={onComparisonDialogOpenChange}\n          />\n        )}\n\n        <KeyboardHints isEmpty={isEmpty} hasContent={hasContent} />\n\n        <AIInfoTooltip />\n      </div>\n    </div>\n  );\n}\n\n/**\n * AI disclaimer moved to compact info icon with tooltip.\n * Recovers vertical space while keeping the information accessible.\n */\nfunction AIInfoTooltip() {\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"h-7 w-7 text-muted-foreground/40 hover:text-muted-foreground/60 hover:bg-transparent\"\n          aria-label=\"AI information\"\n        >\n          <Info className=\"h-3.5 w-3.5\" />\n        </Button>\n      </TooltipTrigger>\n      <TooltipContent side=\"top\" align=\"end\" className=\"max-w-xs\">\n        <p className=\"text-xs text-muted-foreground\">\n          AI can make mistakes.{\" \"}\n          <Link\n            href=\"/ai-info\"\n            className=\"underline hover:text-foreground transition-colors\"\n          >\n            Verify important info\n          </Link>\n          .\n        </p>\n      </TooltipContent>\n    </Tooltip>\n  );\n}\n","\"use client\";\n\nimport { Quote, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface QuotePreviewProps {\n  quote: string;\n  onDismiss: () => void;\n}\n\n/**\n * Preview component for quoted/replied text in the chat input.\n */\nexport function QuotePreview({ quote, onDismiss }: QuotePreviewProps) {\n  return (\n    <div className=\"mx-2 mt-2 p-3 rounded-xl bg-muted/50 dark:bg-white/5 border border-border/50 dark:border-white/10 flex items-start gap-3 group relative\">\n      <div className=\"shrink-0 mt-0.5\">\n        <Quote className=\"w-4 h-4 text-primary/70\" />\n      </div>\n      <div className=\"flex-1 min-w-0\">\n        <p className=\"text-sm text-foreground/90 line-clamp-3 leading-relaxed font-medium\">\n          {quote}\n        </p>\n      </div>\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        size=\"icon\"\n        className=\"h-6 w-6 -mr-1 -mt-1 opacity-60 group-hover:opacity-100 transition-opacity\"\n        onClick={onDismiss}\n      >\n        <X className=\"w-3 h-3\" />\n      </Button>\n    </div>\n  );\n}\n","\"use client\";\n\nimport { AlertCircle, Clock } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\n\ninterface RateLimitDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  limit: number;\n}\n\nexport function RateLimitDialog({\n  open,\n  onOpenChange,\n  limit,\n}: RateLimitDialogProps) {\n  const [timeUntilReset, setTimeUntilReset] = useState(\"\");\n\n  useEffect(() => {\n    const updateTime = () => {\n      const now = new Date();\n      const tomorrow = new Date(now);\n      tomorrow.setDate(tomorrow.getDate() + 1);\n      tomorrow.setHours(0, 0, 0, 0);\n\n      const diff = tomorrow.getTime() - now.getTime();\n      const hours = Math.floor(diff / (1000 * 60 * 60));\n      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\n\n      setTimeUntilReset(`${hours}h ${minutes}m`);\n    };\n\n    if (open) {\n      updateTime();\n      const interval = setInterval(updateTime, 60000); // update every minute\n      return () => clearInterval(interval);\n    }\n  }, [open]);\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <div className=\"flex items-center gap-2 mb-2\">\n            <div className=\"p-2 rounded-full bg-destructive/10\">\n              <AlertCircle className=\"w-5 h-5 text-destructive\" />\n            </div>\n            <DialogTitle>Daily Limit Reached</DialogTitle>\n          </div>\n          <DialogDescription className=\"text-left space-y-3 pt-2\">\n            <p>\n              You've reached your daily limit of{\" \"}\n              <strong>{limit} messages</strong>.\n            </p>\n            <div className=\"flex items-center gap-2 p-3 rounded-lg bg-muted/50 border\">\n              <Clock className=\"w-4 h-4 text-muted-foreground\" />\n              <span className=\"text-sm\">\n                Resets in{\" \"}\n                <strong className=\"text-foreground\">{timeUntilReset}</strong>\n              </span>\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              Your message count resets at midnight (local time). Come back\n              tomorrow to continue chatting!\n            </p>\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"flex justify-end mt-2\">\n          <Button onClick={() => onOpenChange(false)}>Got it</Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","\"use client\";\n\nimport { X } from \"lucide-react\";\nimport { useEffect, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Textarea } from \"@/components/ui/textarea\";\n\ninterface ExpandedInputDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  value: string;\n  onChange: (value: string) => void;\n  onSubmit: () => void;\n  placeholder?: string;\n}\n\nexport function ExpandedInputDialog({\n  open,\n  onOpenChange,\n  value,\n  onChange,\n  onSubmit,\n  placeholder,\n}: ExpandedInputDialogProps) {\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n  useEffect(() => {\n    if (open && textareaRef.current) {\n      // Focus and move cursor to end\n      textareaRef.current.focus();\n      textareaRef.current.setSelectionRange(value.length, value.length);\n    }\n  }, [open, value.length]);\n\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    // Cmd/Ctrl + Enter to submit\n    if ((e.metaKey || e.ctrlKey) && e.key === \"Enter\") {\n      e.preventDefault();\n      onSubmit();\n    }\n    // Escape to close\n    if (e.key === \"Escape\") {\n      e.preventDefault();\n      onOpenChange(false);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-3xl h-[80vh] flex flex-col gap-0 p-0\">\n        <DialogHeader className=\"px-4 py-3 border-b shrink-0\">\n          <div className=\"flex items-center justify-between\">\n            <DialogTitle className=\"text-sm font-medium text-muted-foreground\">\n              Edit message\n            </DialogTitle>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-7 w-7\"\n              onClick={() => onOpenChange(false)}\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </DialogHeader>\n\n        <div className=\"flex-1 p-4 overflow-hidden\">\n          <Textarea\n            ref={textareaRef}\n            value={value}\n            onChange={(e) => onChange(e.target.value)}\n            onKeyDown={handleKeyDown}\n            placeholder={placeholder}\n            className=\"h-full w-full resize-none border-0 bg-transparent focus-visible:ring-0 text-base\"\n          />\n        </div>\n\n        <div className=\"px-4 py-3 border-t shrink-0 flex items-center justify-between\">\n          <span className=\"text-xs text-muted-foreground\">\n            {value.length} characters\n          </span>\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-xs text-muted-foreground\">\n              âŒ˜ + Enter to send\n            </span>\n            <Button onClick={onSubmit} disabled={!value.trim()} size=\"sm\">\n              Send\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","export const CHAT_WIDTH_CLASSES = {\n  narrow: \"max-w-2xl\",\n  standard: \"max-w-4xl\",\n  wide: \"max-w-6xl\",\n  full: \"max-w-[95%]\",\n} as const;\n\nexport type ChatWidth = keyof typeof CHAT_WIDTH_CLASSES;\n\nexport function getChatWidthClass(\n  width: ChatWidth | undefined,\n  isComparison = false,\n): string {\n  if (isComparison) return CHAT_WIDTH_CLASSES.full;\n  return CHAT_WIDTH_CLASSES[width || \"standard\"];\n}\n","import { useEffect, useState } from \"react\";\n\nexport default function useBrowserFeature(featureName: string): boolean {\n  const [hasFeature, setHasFeature] = useState(false);\n\n  useEffect(() => {\n    setHasFeature(typeof window !== \"undefined\" && featureName in window);\n  }, [featureName]);\n\n  return hasFeature;\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M8 3 4 7l4 4', key: '9rb6wj' }],\n  ['path', { d: 'M4 7h16', key: '6tx8e3' }],\n  ['path', { d: 'm16 21 4-4-4-4', key: 'siv7j2' }],\n  ['path', { d: 'M20 17H4', key: 'h6l3hr' }],\n];\n\n/**\n * @component @name ArrowLeftRight\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNOCAzIDQgN2w0IDQiIC8+CiAgPHBhdGggZD0iTTQgN2gxNiIgLz4KICA8cGF0aCBkPSJtMTYgMjEgNC00LTQtNCIgLz4KICA8cGF0aCBkPSJNMjAgMTdINCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left-right\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeftRight = createLucideIcon('arrow-left-right', __iconNode);\n\nexport default ArrowLeftRight;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm15 15 6 6', key: '1s409w' }],\n  ['path', { d: 'm15 9 6-6', key: 'ko1vev' }],\n  ['path', { d: 'M21 16v5h-5', key: '1ck2sf' }],\n  ['path', { d: 'M21 8V3h-5', key: '1qoq8a' }],\n  ['path', { d: 'M3 16v5h5', key: '1t08am' }],\n  ['path', { d: 'm3 21 6-6', key: 'wwnumi' }],\n  ['path', { d: 'M3 8V3h5', key: '1ln10m' }],\n  ['path', { d: 'M9 9 3 3', key: 'v551iv' }],\n];\n\n/**\n * @component @name Expand\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTUgMTUgNiA2IiAvPgogIDxwYXRoIGQ9Im0xNSA5IDYtNiIgLz4KICA8cGF0aCBkPSJNMjEgMTZ2NWgtNSIgLz4KICA8cGF0aCBkPSJNMjEgOFYzaC01IiAvPgogIDxwYXRoIGQ9Ik0zIDE2djVoNSIgLz4KICA8cGF0aCBkPSJtMyAyMSA2LTYiIC8+CiAgPHBhdGggZD0iTTMgOFYzaDUiIC8+CiAgPHBhdGggZD0iTTkgOSAzIDMiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/expand\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Expand = createLucideIcon('expand', __iconNode);\n\nexport default Expand;\n","import { useModifierKey } from \"@/hooks/useModifierKey\";\n\ninterface HydrationSafeShortcutBadgeProps {\n  keys: string[];\n}\n\n/**\n * Hydration-safe wrapper around ShortcutBadge that handles the \"mod\" key properly\n * to prevent SSR/client mismatches.\n */\nexport function HydrationSafeShortcutBadge({\n  keys,\n}: HydrationSafeShortcutBadgeProps) {\n  const modifierKey = useModifierKey();\n\n  const displayKeys = keys.map((key) => (key === \"mod\" ? modifierKey : key));\n\n  return (\n    <kbd className=\"inline-flex h-5 select-none items-center gap-1 rounded border bg-background/50 px-1.5 font-mono text-[10px] font-medium text-muted-foreground\">\n      {displayKeys.map((key, i) => (\n        <span key={key}>\n          {i > 0 && <span className=\"mx-0.5\">+</span>}\n          {key}\n        </span>\n      ))}\n    </kbd>\n  );\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z',\n      key: '1oefj6',\n    },\n  ],\n  ['path', { d: 'M14 2v5a1 1 0 0 0 1 1h5', key: 'wfsgrz' }],\n  ['path', { d: 'M8 13h2', key: 'yr2amv' }],\n  ['path', { d: 'M14 13h2', key: 'un5t4a' }],\n  ['path', { d: 'M8 17h2', key: '2yhykz' }],\n  ['path', { d: 'M14 17h2', key: '10kma7' }],\n];\n\n/**\n * @component @name FileSpreadsheet\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNiAyMmEyIDIgMCAwIDEtMi0yVjRhMiAyIDAgMCAxIDItMmg4YTIuNCAyLjQgMCAwIDEgMS43MDQuNzA2bDMuNTg4IDMuNTg4QTIuNCAyLjQgMCAwIDEgMjAgOHYxMmEyIDIgMCAwIDEtMiAyeiIgLz4KICA8cGF0aCBkPSJNMTQgMnY1YTEgMSAwIDAgMCAxIDFoNSIgLz4KICA8cGF0aCBkPSJNOCAxM2gyIiAvPgogIDxwYXRoIGQ9Ik0xNCAxM2gyIiAvPgogIDxwYXRoIGQ9Ik04IDE3aDIiIC8+CiAgPHBhdGggZD0iTTE0IDE3aDIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/file-spreadsheet\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst FileSpreadsheet = createLucideIcon('file-spreadsheet', __iconNode);\n\nexport default FileSpreadsheet;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z',\n      key: '1ffxy3',\n    },\n  ],\n  ['path', { d: 'm21.854 2.147-10.94 10.939', key: '12cjpa' }],\n];\n\n/**\n * @component @name Send\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTQuNTM2IDIxLjY4NmEuNS41IDAgMCAwIC45MzctLjAyNGw2LjUtMTlhLjQ5Ni40OTYgMCAwIDAtLjYzNS0uNjM1bC0xOSA2LjVhLjUuNSAwIDAgMC0uMDI0LjkzN2w3LjkzIDMuMThhMiAyIDAgMCAxIDEuMTEyIDEuMTF6IiAvPgogIDxwYXRoIGQ9Im0yMS44NTQgMi4xNDctMTAuOTQgMTAuOTM5IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/send\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Send = createLucideIcon('send', __iconNode);\n\nexport default Send;\n","import type { RefObject } from \"react\";\n\ninterface UseChatInputKeyboardProps {\n  input: string;\n  setInput: (value: string) => void;\n  textareaRef: RefObject<HTMLTextAreaElement | null>;\n  onSubmit: (e: React.FormEvent | React.KeyboardEvent) => void;\n}\n\n/**\n * Hook for chat input keyboard handling.\n * Handles Enter to submit and Cmd+$ for math block insertion.\n */\nexport function useChatInputKeyboard({\n  input,\n  setInput,\n  textareaRef,\n  onSubmit,\n}: UseChatInputKeyboardProps) {\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    // Enter without Shift submits the form\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      onSubmit(e);\n    }\n\n    // Cmd/Ctrl+$ - Insert math block template\n    if ((e.metaKey || e.ctrlKey) && e.key === \"$\") {\n      e.preventDefault();\n      const textarea = textareaRef.current;\n      if (!textarea) return;\n\n      const start = textarea.selectionStart;\n      const end = textarea.selectionEnd;\n      const before = input.substring(0, start);\n      const after = input.substring(end);\n\n      const template = \"$$\\n\\n$$\";\n      const newValue = before + template + after;\n      setInput(newValue);\n\n      // Position cursor inside math block (after $$\\n)\n      setTimeout(() => {\n        textarea.focus();\n        textarea.selectionStart = textarea.selectionEnd = start + 3;\n      }, 0);\n    }\n  };\n\n  return { handleKeyDown };\n}\n","import { type RefObject, useEffect, useRef } from \"react\";\n\ninterface UseChatInputEventsProps {\n  textareaRef: RefObject<HTMLTextAreaElement | null>;\n  setInput: (value: string | ((prev: string) => string)) => void;\n  setQuote: (quote: string | null) => void;\n  isEmpty: boolean;\n  isMobile: boolean;\n  isTouchDevice: boolean;\n  lastAssistantMessageId?: string;\n  lastAssistantMessageStatus?: string;\n  lastCompletedMessageId: string | null;\n  setLastCompletedMessageId: (id: string) => void;\n}\n\n/**\n * Hook for chat input custom event handling.\n * Manages insert-prompt, quote-selection, focus events, and auto-focus behavior.\n */\nexport function useChatInputEvents({\n  textareaRef,\n  setInput,\n  setQuote,\n  isEmpty,\n  isMobile,\n  isTouchDevice,\n  lastAssistantMessageId,\n  lastAssistantMessageStatus,\n  lastCompletedMessageId,\n  setLastCompletedMessageId,\n}: UseChatInputEventsProps) {\n  // Handle prompted actions from EmptyScreen\n  useEffect(() => {\n    const handleInsertPrompt = (e: CustomEvent<string>) => {\n      setInput(e.detail);\n      textareaRef.current?.focus();\n    };\n\n    window.addEventListener(\"insert-prompt\" as any, handleInsertPrompt as any);\n    return () => {\n      window.removeEventListener(\n        \"insert-prompt\" as any,\n        handleInsertPrompt as any,\n      );\n    };\n  }, [setInput, textareaRef]);\n\n  // Handle quote selection\n  useEffect(() => {\n    const handleQuoteSelection = (e: CustomEvent<string>) => {\n      setQuote(e.detail);\n      textareaRef.current?.focus();\n    };\n\n    window.addEventListener(\n      \"quote-selection\" as any,\n      handleQuoteSelection as any,\n    );\n    return () => {\n      window.removeEventListener(\n        \"quote-selection\" as any,\n        handleQuoteSelection as any,\n      );\n    };\n  }, [setQuote, textareaRef]);\n\n  // Handle focus restoration after dialogs close\n  useEffect(() => {\n    const handleFocusInput = () => {\n      textareaRef.current?.focus();\n    };\n\n    window.addEventListener(\"focus-chat-input\", handleFocusInput);\n    return () => {\n      window.removeEventListener(\"focus-chat-input\", handleFocusInput);\n    };\n  }, [textareaRef]);\n\n  // Autofocus on empty state (skip mobile/touch)\n  // Only run once on mount when empty, not on every re-render\n  const hasAutoFocused = useRef(false);\n  useEffect(() => {\n    if (\n      isEmpty &&\n      !isMobile &&\n      !isTouchDevice &&\n      textareaRef.current &&\n      !hasAutoFocused.current\n    ) {\n      hasAutoFocused.current = true;\n      const timer = setTimeout(() => {\n        textareaRef.current?.focus();\n      }, 300);\n      return () => clearTimeout(timer);\n    }\n  }, [isEmpty, isMobile, isTouchDevice, textareaRef]);\n\n  // Auto-focus input after AI message generation completes\n  // Track timeout for cleanup\n  const completionFocusTimerRef = useRef<ReturnType<typeof setTimeout> | null>(\n    null,\n  );\n\n  useEffect(() => {\n    // Clear any pending focus timeout\n    if (completionFocusTimerRef.current) {\n      clearTimeout(completionFocusTimerRef.current);\n      completionFocusTimerRef.current = null;\n    }\n\n    if (\n      !isMobile &&\n      lastAssistantMessageStatus === \"complete\" &&\n      lastAssistantMessageId !== lastCompletedMessageId &&\n      document.activeElement?.tagName !== \"INPUT\" &&\n      document.activeElement?.tagName !== \"TEXTAREA\"\n    ) {\n      setLastCompletedMessageId(lastAssistantMessageId!);\n      completionFocusTimerRef.current = setTimeout(() => {\n        // Only focus if user still isn't in an input\n        if (\n          document.activeElement?.tagName !== \"INPUT\" &&\n          document.activeElement?.tagName !== \"TEXTAREA\"\n        ) {\n          textareaRef.current?.focus();\n        }\n        completionFocusTimerRef.current = null;\n      }, 100);\n    }\n\n    return () => {\n      if (completionFocusTimerRef.current) {\n        clearTimeout(completionFocusTimerRef.current);\n        completionFocusTimerRef.current = null;\n      }\n    };\n  }, [\n    lastAssistantMessageStatus,\n    lastAssistantMessageId,\n    lastCompletedMessageId,\n    setLastCompletedMessageId,\n    isMobile,\n    textareaRef,\n  ]);\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm16 3 4 4-4 4', key: '1x1c3m' }],\n  ['path', { d: 'M20 7H4', key: 'zbl0bi' }],\n  ['path', { d: 'm8 21-4-4 4-4', key: 'h9nckh' }],\n  ['path', { d: 'M4 17h16', key: 'g4d7ey' }],\n];\n\n/**\n * @component @name ArrowRightLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTYgMyA0IDQtNCA0IiAvPgogIDxwYXRoIGQ9Ik0yMCA3SDQiIC8+CiAgPHBhdGggZD0ibTggMjEtNC00IDQtNCIgLz4KICA8cGF0aCBkPSJNNCAxN2gxNiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-right-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowRightLeft = createLucideIcon('arrow-right-left', __iconNode);\n\nexport default ArrowRightLeft;\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useAction, useMutation } from \"convex/react\";\nimport { ArrowRightLeft, Loader2 } from \"lucide-react\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { MODEL_CONFIG } from \"@/lib/ai/models\";\nimport { analytics } from \"@/lib/analytics\";\nimport { MarkdownContent } from \"./MarkdownContent\";\n\ninterface Props {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  currentModelId: string;\n  suggestedModelId: string;\n  currentResponse: string;\n  onSwitch: (modelId: string) => void;\n  conversationId: Id<\"conversations\">;\n  userMessage: string;\n}\n\nexport function ModelPreviewModal({\n  open,\n  onOpenChange,\n  currentModelId,\n  suggestedModelId,\n  currentResponse,\n  onSwitch,\n  conversationId,\n  userMessage,\n}: Props) {\n  const [previewResponse, setPreviewResponse] = useState<string>(\"\");\n  const [loading, setLoading] = useState(true);\n  const [comparisonStartTime, setComparisonStartTime] = useState<number>(0);\n\n  const currentModel = MODEL_CONFIG[currentModelId];\n  const suggestedModel = MODEL_CONFIG[suggestedModelId];\n\n  // Mutations\n  const dismissRecommendation = useMutation(\n    // @ts-ignore - Type depth exceeded with complex Convex mutation (94+ modules)\n    api.conversations.dismissModelRecommendation,\n  );\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (94+ modules)\n  const updatePreferences = useMutation(api.users.updatePreferences);\n\n  // Scroll synchronization refs\n  const leftScrollRef = useRef<HTMLDivElement>(null);\n  const rightScrollRef = useRef<HTMLDivElement>(null);\n  const isScrolling = useRef<\"left\" | \"right\" | null>(null);\n\n  // @ts-ignore - Type depth exceeded with complex Convex action (94+ modules)\n  const generatePreview = useAction(api.ai.modelTriage.generatePreview);\n\n  const generatePreviewResponse = useCallback(async () => {\n    setLoading(true);\n    try {\n      const result = await generatePreview({\n        conversationId,\n        suggestedModelId,\n        userMessage,\n      });\n      setPreviewResponse(result.content);\n\n      analytics.track(\"recommendation_preview_completed\", {\n        conversationId,\n        currentModel: currentModelId,\n        suggestedModel: suggestedModelId,\n        generationTimeMs: Date.now() - comparisonStartTime,\n        responseLength: result.content.length,\n        timestamp: Date.now(),\n      });\n\n      analytics.track(\"recommendation_preview_compared\", {\n        conversationId,\n        currentModel: currentModelId,\n        suggestedModel: suggestedModelId,\n        userSpentTimeComparingMs: Date.now() - comparisonStartTime,\n        timestamp: Date.now(),\n      });\n    } catch (error) {\n      console.error(\"Failed to generate preview:\", error);\n      setPreviewResponse(\"Failed to generate preview. Please try again.\");\n    } finally {\n      setLoading(false);\n    }\n  }, [\n    generatePreview,\n    conversationId,\n    suggestedModelId,\n    userMessage,\n    currentModelId,\n    comparisonStartTime,\n  ]);\n\n  useEffect(() => {\n    if (open) {\n      setComparisonStartTime(Date.now());\n      generatePreviewResponse();\n    }\n  }, [open, generatePreviewResponse]);\n\n  // Synchronized scrolling logic\n  useEffect(() => {\n    const leftEl = leftScrollRef.current;\n    const rightEl = rightScrollRef.current;\n\n    if (!leftEl || !rightEl) return;\n\n    const handleScrollLeft = () => {\n      if (isScrolling.current === \"right\") return;\n      isScrolling.current = \"left\";\n\n      // Calculate percentage to handle different content heights\n      const percentage =\n        leftEl.scrollTop / (leftEl.scrollHeight - leftEl.clientHeight);\n      // Determine the target scroll position for the right element\n      // However, for direct comparison, pixel-for-pixel might be better if content is similar\n      // But since models generate different lengths, percentage matching is safer for \"end\" alignment\n      // Let's try direct pixel first, but often percentage feels more \"connected\" if lengths differ drastically.\n      // Given the user wants to \"compare\", they likely want to read line by line.\n      // If one text is much longer, percentage sync can make the shorter one scrol fast.\n      // Let's stick to percentage as it ensures both reach bottom together.\n\n      if (rightEl.scrollHeight > rightEl.clientHeight) {\n        rightEl.scrollTop =\n          percentage * (rightEl.scrollHeight - rightEl.clientHeight);\n      }\n\n      // Reset lock after a small delay to allow loop to break\n      window.requestAnimationFrame(() => {\n        if (isScrolling.current === \"left\") isScrolling.current = null;\n      });\n    };\n\n    const handleScrollRight = () => {\n      if (isScrolling.current === \"left\") return;\n      isScrolling.current = \"right\";\n\n      const percentage =\n        rightEl.scrollTop / (rightEl.scrollHeight - rightEl.clientHeight);\n\n      if (leftEl.scrollHeight > leftEl.clientHeight) {\n        leftEl.scrollTop =\n          percentage * (leftEl.scrollHeight - leftEl.clientHeight);\n      }\n\n      window.requestAnimationFrame(() => {\n        if (isScrolling.current === \"right\") isScrolling.current = null;\n      });\n    };\n\n    leftEl.addEventListener(\"scroll\", handleScrollLeft);\n    rightEl.addEventListener(\"scroll\", handleScrollRight);\n\n    return () => {\n      leftEl.removeEventListener(\"scroll\", handleScrollLeft);\n      rightEl.removeEventListener(\"scroll\", handleScrollRight);\n    };\n  }, []); // Re-attach when content changes\n\n  const handleSwitch = async () => {\n    if (!suggestedModel || !currentModel) return;\n\n    // Calculate savings for analytics\n    const savingsPercent = Math.round(\n      (1 -\n        (suggestedModel.pricing.input + suggestedModel.pricing.output) /\n          (currentModel.pricing.input + currentModel.pricing.output)) *\n        100,\n    );\n\n    analytics.track(\"recommendation_accepted\", {\n      conversationId,\n      from: currentModelId,\n      to: suggestedModelId,\n      savings: savingsPercent,\n      viaPreview: true,\n      userSpentTimeComparingMs: Date.now() - comparisonStartTime,\n      timestamp: Date.now(),\n    });\n\n    // 1. Switch the current conversation's model (Local)\n    onSwitch(suggestedModelId);\n\n    // 2. Dismiss the recommendation banner (Clean up)\n    try {\n      await dismissRecommendation({ conversationId });\n    } catch (err) {\n      console.error(\"Failed to dismiss recommendation:\", err);\n    }\n\n    // 3. Update global default model (Global) - Lock to \"fixed\" and set model\n    try {\n      console.log(\"[ModelPreviewModal] Updating preferences:\", {\n        newChatModelSelection: \"fixed\",\n        defaultModel: suggestedModelId,\n      });\n      await updatePreferences({\n        preferences: {\n          newChatModelSelection: \"fixed\",\n          defaultModel: suggestedModelId,\n        },\n      });\n      console.log(\"[ModelPreviewModal] Preferences updated successfully\");\n      analytics.track(\"model_preference_updated\", {\n        event: \"recommendation_switch\",\n        modelId: suggestedModelId,\n      });\n    } catch (err) {\n      console.error(\n        \"[ModelPreviewModal] Failed to update global preference:\",\n        err,\n      );\n    }\n\n    // 4. Refocus input for seamless continuation\n    window.dispatchEvent(new CustomEvent(\"focus-chat-input\"));\n\n    onOpenChange(false);\n  };\n\n  // Helper to get savings percentage\n  const savingsPercent = Math.round(\n    (1 -\n      (suggestedModel.pricing.input + suggestedModel.pricing.output) /\n        (currentModel.pricing.input + currentModel.pricing.output)) *\n      100,\n  );\n\n  if (!currentModel || !suggestedModel) return null;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"w-full max-w-[96vw] xl:max-w-[1600px] h-[92vh] flex flex-col p-0 gap-0 overflow-hidden border-surface-glass-border bg-background/95 backdrop-blur-xl\">\n        <DialogHeader className=\"px-8 py-5 border-b shrink-0 flex flex-row items-center justify-between bg-muted/30\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"p-2.5 rounded-full bg-primary/10 text-primary\">\n              <ArrowRightLeft className=\"w-5 h-5\" />\n            </div>\n            <div>\n              <DialogTitle className=\"text-xl font-semibold tracking-tight\">\n                Model Comparison\n              </DialogTitle>\n              <p className=\"text-sm text-muted-foreground mt-1.5 font-normal\">\n                Review how the suggested model responds to your request\n              </p>\n            </div>\n          </div>\n        </DialogHeader>\n\n        <div className=\"flex-1 min-h-0 grid grid-cols-1 xl:grid-cols-2 divide-y xl:divide-y-0 xl:divide-x divide-border overflow-hidden bg-muted/5 relative\">\n          {/* Current Model Column */}\n          <div className=\"flex flex-col min-h-0 bg-background/50 h-full\">\n            <div className=\"p-4 px-6 border-b flex items-center justify-between bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 sticky top-0 z-10 shadow-sm\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"font-semibold text-foreground flex items-center gap-3 text-lg\">\n                  {currentModel.name}\n                  <Badge\n                    variant=\"secondary\"\n                    className=\"text-[10px] font-mono tracking-wider px-2 py-0.5 uppercase opacity-80\"\n                  >\n                    Current\n                  </Badge>\n                </div>\n              </div>\n              <div className=\"flex flex-col items-end text-xs gap-0.5\">\n                <span className=\"text-foreground font-mono font-medium text-sm\">\n                  $\n                  {(\n                    (currentModel.pricing.input + currentModel.pricing.output) /\n                    2\n                  ).toFixed(2)}{\" \"}\n                  / 1M\n                </span>\n                <span className=\"text-muted-foreground/60\">Estimated Cost</span>\n              </div>\n            </div>\n\n            <div ref={leftScrollRef} className=\"flex-1 overflow-y-auto\">\n              <div className=\"max-w-none p-8 md:p-10\">\n                <MarkdownContent content={currentResponse} />\n              </div>\n            </div>\n          </div>\n\n          {/* Suggested Model Column */}\n          <div className=\"flex flex-col min-h-0 bg-background h-full relative group\">\n            <div className=\"p-4 px-6 border-b flex items-center justify-between bg-blue-50/10 backdrop-blur supports-[backdrop-filter]:bg-blue-50/5 sticky top-0 z-10 shadow-sm\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"font-semibold text-foreground flex items-center gap-3 text-lg\">\n                  {suggestedModel.name}\n                  <Badge className=\"bg-green-500/15 text-green-700 dark:text-green-400 hover:bg-green-500/25 border-green-500/20 text-[10px] font-mono tracking-wider px-2 py-0.5 uppercase\">\n                    {savingsPercent}% Cheaper\n                  </Badge>\n                </div>\n              </div>\n              <div className=\"flex flex-col items-end text-xs gap-0.5\">\n                <span className=\"text-green-600 dark:text-green-400 font-mono font-medium text-sm\">\n                  $\n                  {(\n                    (suggestedModel.pricing.input +\n                      suggestedModel.pricing.output) /\n                    2\n                  ).toFixed(2)}{\" \"}\n                  / 1M\n                </span>\n                <span className=\"text-muted-foreground/60\">Estimated Cost</span>\n              </div>\n            </div>\n\n            <div\n              ref={rightScrollRef}\n              className=\"flex-1 overflow-y-auto bg-gradient-to-b from-blue-50/5 to-transparent\"\n            >\n              {loading ? (\n                <div className=\"flex flex-col items-center justify-center h-full gap-5 text-muted-foreground p-10\">\n                  <Loader2 className=\"h-10 w-10 animate-spin text-primary/50\" />\n                  <p className=\"text-sm font-medium animate-pulse tracking-wide\">\n                    Generating comparison response...\n                  </p>\n                </div>\n              ) : (\n                <div className=\"max-w-none p-8 md:p-10\">\n                  <MarkdownContent content={previewResponse} />\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        <DialogFooter className=\"border-t p-6 bg-background/95 backdrop-blur shrink-0 flex flex-col xl:flex-row !justify-end gap-4 items-center z-20 shadow-[0_-5px_20px_-10px_rgba(0,0,0,0.1)]\">\n          <div className=\"flex items-center gap-4 w-full xl:w-auto justify-end\">\n            <Button\n              variant=\"ghost\"\n              onClick={() => onOpenChange(false)}\n              className=\"text-muted-foreground hover:text-foreground px-6\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSwitch}\n              disabled={loading}\n              size=\"lg\"\n              className=\"bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg shadow-primary/20 flex-1 xl:flex-none min-w-[200px] font-medium\"\n            >\n              Switch to {suggestedModel.name}\n            </Button>\n          </div>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","\"use client\";\n\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport { CheckCircle, X } from \"lucide-react\";\nimport { useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { analytics } from \"@/lib/analytics\";\n\ninterface Props {\n  modelId: string;\n  modelName: string;\n  onSetDefault: () => void;\n  onDismiss: () => void;\n  conversationId: Id<\"conversations\">;\n}\n\nexport function SetDefaultModelPrompt({\n  modelId,\n  modelName,\n  onSetDefault,\n  onDismiss,\n  conversationId,\n}: Props) {\n  useEffect(() => {\n    analytics.track(\"set_default_prompt_shown\", {\n      conversationId,\n      modelId,\n      afterAcceptingRecommendation: true,\n      timestamp: Date.now(),\n    });\n  }, [conversationId, modelId]);\n\n  const handleSetDefault = () => {\n    analytics.track(\"set_default_accepted\", {\n      conversationId,\n      modelId,\n      timestamp: Date.now(),\n    });\n    onSetDefault();\n  };\n\n  const handleDismiss = () => {\n    analytics.track(\"set_default_dismissed\", {\n      conversationId,\n      modelId,\n      timestamp: Date.now(),\n    });\n    onDismiss();\n  };\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0, y: -10 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.3, ease: \"easeOut\" }}\n        className=\"mx-auto mb-4 max-w-3xl rounded-xl border border-green-500/30 bg-gradient-to-r from-green-500/10 to-emerald-500/10 p-4 shadow-lg\"\n      >\n        <div className=\"flex items-start gap-3\">\n          <div className=\"mt-0.5 rounded-lg bg-green-500/20 p-2\">\n            <CheckCircle className=\"h-4 w-4 text-green-400\" />\n          </div>\n\n          <div className=\"flex-1\">\n            <p className=\"text-sm font-medium text-green-200\">\n              {modelName} worked great! ðŸ’š\n            </p>\n            <p className=\"text-sm text-muted-foreground mt-1\">\n              Make it your default model for future chats?\n            </p>\n          </div>\n\n          <div className=\"flex items-start gap-2\">\n            <Button\n              size=\"sm\"\n              onClick={handleSetDefault}\n              className=\"bg-green-500 hover:bg-green-600 text-white\"\n            >\n              Set as default\n            </Button>\n            <Button\n              size=\"sm\"\n              variant=\"ghost\"\n              onClick={handleDismiss}\n              className=\"text-muted-foreground hover:text-foreground\"\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n","\"use client\";\n\nimport { Loader2, Pause, Play, RotateCcw, X } from \"lucide-react\";\nimport { useCallback, useEffect, useMemo } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { useTTSPlayer } from \"@/contexts/TTSContext\";\nimport { cn } from \"@/lib/utils\";\n\nfunction formatTime(seconds: number) {\n  if (!Number.isFinite(seconds) || seconds < 0) return \"0:00\";\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60)\n    .toString()\n    .padStart(2, \"0\");\n  return `${mins}:${secs}`;\n}\n\nconst SPEED_OPTIONS = [0.5, 0.75, 1, 1.25, 1.5, 1.75, 2];\n\nexport function TTSPlayerBar({ className }: { className?: string }) {\n  const {\n    state,\n    pause,\n    resume,\n    stop: _stop,\n    seekBy,\n    seekTo,\n    setSpeed,\n    close,\n  } = useTTSPlayer();\n  const { isVisible, isLoading, isPlaying, duration, currentTime, speed } =\n    state;\n\n  const progressMax = useMemo(() => {\n    if (duration && duration > 0) return duration;\n    return Math.max(currentTime, 1);\n  }, [duration, currentTime]);\n\n  const handlePlayPause = useCallback(() => {\n    if (isLoading) return;\n    if (isPlaying) {\n      pause();\n    } else {\n      void resume();\n    }\n  }, [isLoading, isPlaying, pause, resume]);\n\n  const cycleSpeed = useCallback(\n    (direction: \"up\" | \"down\") => {\n      const currentIndex = SPEED_OPTIONS.indexOf(speed);\n      let nextIndex;\n      if (direction === \"up\") {\n        nextIndex = (currentIndex + 1) % SPEED_OPTIONS.length;\n      } else {\n        nextIndex =\n          (currentIndex - 1 + SPEED_OPTIONS.length) % SPEED_OPTIONS.length;\n      }\n      setSpeed(SPEED_OPTIONS[nextIndex]);\n    },\n    [speed, setSpeed],\n  );\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    if (!isVisible) return;\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Ignore if user is typing in an input\n      if (\n        document.activeElement?.tagName === \"INPUT\" ||\n        document.activeElement?.tagName === \"TEXTAREA\" ||\n        document.activeElement?.getAttribute(\"contenteditable\") === \"true\"\n      ) {\n        return;\n      }\n\n      switch (e.key.toLowerCase()) {\n        case \" \":\n          e.preventDefault();\n          handlePlayPause();\n          break;\n        case \"escape\":\n          e.preventDefault();\n          close();\n          break;\n        case \"l\":\n          e.preventDefault();\n          seekBy(15);\n          break;\n        case \"h\":\n          e.preventDefault();\n          seekBy(-15);\n          break;\n        case \"k\":\n          e.preventDefault();\n          cycleSpeed(\"up\");\n          break;\n        case \"j\":\n          e.preventDefault();\n          cycleSpeed(\"down\");\n          break;\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [isVisible, handlePlayPause, close, seekBy, cycleSpeed]);\n\n  if (!isVisible && !isLoading) return null;\n\n  return (\n    <div\n      className={cn(\n        \"pointer-events-none fixed left-0 right-0 top-[76px] z-40 px-4\",\n        \"flex justify-center\", // Center alignment\n        className,\n      )}\n    >\n      <div\n        className={cn(\n          \"pointer-events-auto flex w-full max-w-lg flex-col gap-0 overflow-hidden\",\n          \"rounded-2xl border border-white/20 bg-background/80 shadow-2xl backdrop-blur-xl\",\n          \"dark:border-white/10 dark:bg-black/60\",\n          \"transform transition-all duration-300 ease-out animate-in fade-in slide-in-from-top-4\",\n        )}\n      >\n        {/* Header / Meta */}\n        <div className=\"flex items-center justify-between border-b border-white/5 bg-white/5 px-4 py-2.5\">\n          <div className=\"flex items-center gap-3 overflow-hidden text-xs text-muted-foreground\">\n            <span>\n              <kbd className=\"rounded bg-secondary px-1.5 py-0.5 font-mono text-[10px]\">\n                Space\n              </kbd>{\" \"}\n              Play/Pause\n            </span>\n            <span>\n              <kbd className=\"rounded bg-secondary px-1.5 py-0.5 font-mono text-[10px]\">\n                K\n              </kbd>\n              /\n              <kbd className=\"rounded bg-secondary px-1.5 py-0.5 font-mono text-[10px]\">\n                J\n              </kbd>{\" \"}\n              Speed\n            </span>\n            <span>\n              <kbd className=\"rounded bg-secondary px-1.5 py-0.5 font-mono text-[10px]\">\n                H\n              </kbd>\n              /\n              <kbd className=\"rounded bg-secondary px-1.5 py-0.5 font-mono text-[10px]\">\n                L\n              </kbd>{\" \"}\n              Â±15s\n            </span>\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-6 w-6 shrink-0 rounded-full text-muted-foreground hover:bg-white/10 hover:text-foreground\"\n            onClick={close}\n            title=\"Close (Esc)\"\n          >\n            <X className=\"h-3.5 w-3.5\" />\n          </Button>\n        </div>\n\n        {/* Main Controls Area */}\n        <div className=\"p-4\">\n          {/* Progress Bar */}\n          <div className=\"mb-4 flex items-center gap-3\">\n            <span className=\"w-9 text-right text-xs tabular-nums text-muted-foreground\">\n              {formatTime(currentTime)}\n            </span>\n            <Slider\n              value={[Math.min(currentTime, progressMax)]}\n              min={0}\n              max={progressMax}\n              step={0.1}\n              onValueChange={([val]) => seekTo(val)}\n              className=\"mt-0.5 flex-1 cursor-pointer\"\n              aria-label=\"Seek\"\n            />\n            <span className=\"w-9 text-xs tabular-nums text-muted-foreground\">\n              {formatTime(duration)}\n            </span>\n          </div>\n\n          {/* Buttons */}\n          <div className=\"flex items-center justify-between\">\n            {/* Speed Control (Cyclic) */}\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className={cn(\n                \"h-8 min-w-[3rem] px-0 text-xs font-medium text-muted-foreground hover:text-foreground\",\n                \"rounded-full bg-secondary/50 hover:bg-secondary\",\n              )}\n              onClick={() => cycleSpeed(\"up\")}\n              title=\"Change Speed (J/K)\"\n            >\n              {speed}x\n            </Button>\n\n            {/* Playback Controls */}\n            <div className=\"flex items-center gap-3\">\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-9 w-9 rounded-full text-foreground/80 hover:bg-primary/10 hover:text-primary\"\n                onClick={() => seekBy(-15)}\n                disabled={isLoading}\n                title=\"Rewind 15s (H)\"\n              >\n                <RotateCcw className=\"h-4 w-4\" />\n              </Button>\n\n              <Button\n                size=\"icon\"\n                className=\"h-12 w-12 rounded-full shadow-lg shadow-primary/20 transition-transform active:scale-95\"\n                onClick={handlePlayPause}\n                disabled={isLoading}\n                title={isPlaying ? \"Pause (Space)\" : \"Play (Space)\"}\n              >\n                {isLoading ? (\n                  <Loader2 className=\"h-5 w-5 animate-spin\" />\n                ) : isPlaying ? (\n                  <Pause className=\"h-5 w-5 fill-current\" />\n                ) : (\n                  <Play className=\"h-5 w-5 fill-current ml-0.5\" />\n                )}\n              </Button>\n\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"h-9 w-9 rounded-full text-foreground/80 hover:bg-primary/10 hover:text-primary\"\n                onClick={() => seekBy(15)}\n                disabled={isLoading}\n                title=\"Forward 15s (L)\"\n              >\n                <div className=\"relative\">\n                  <RotateCcw className=\"h-4 w-4 scale-x-[-1]\" />\n                </div>\n              </Button>\n            </div>\n\n            {/* Placeholder for symmetry or other action like Stop which is implicit in close */}\n            <div className=\"w-[3rem]\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import {\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useState,\n} from \"react\";\n\ninterface UseAutoScrollOptions {\n  threshold?: number;\n  animationDuration?: number;\n  disableAutoScroll?: boolean;\n}\n\ninterface UseAutoScrollReturn {\n  containerRef: React.RefObject<HTMLDivElement | null>;\n  scrollToBottom: (behavior?: ScrollBehavior) => boolean;\n  showScrollButton: boolean;\n  isAtBottom: boolean;\n}\n\nexport function useAutoScroll(\n  options: UseAutoScrollOptions = {},\n): UseAutoScrollReturn {\n  const {\n    threshold = 100,\n    animationDuration = 400,\n    disableAutoScroll = false,\n  } = options;\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  const isAutoScrolling = useRef(false);\n  const resizeRAF = useRef<number | undefined>(undefined);\n\n  const [userScrolledUp, setUserScrolledUp] = useState(false);\n  const [isAtBottom, setIsAtBottom] = useState(true);\n  const [showScrollButton, setShowScrollButton] = useState(false);\n  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);\n\n  // Refs to avoid stale closures in MutationObserver callback\n  const userScrolledUpRef = useRef(userScrolledUp);\n  const isAtBottomRef = useRef(isAtBottom);\n  const disableAutoScrollRef = useRef(disableAutoScroll);\n\n  // Keep refs in sync with state - useLayoutEffect for synchronous update BEFORE MutationObserver\n  useLayoutEffect(() => {\n    userScrolledUpRef.current = userScrolledUp;\n  }, [userScrolledUp]);\n\n  useLayoutEffect(() => {\n    isAtBottomRef.current = isAtBottom;\n  }, [isAtBottom]);\n\n  useLayoutEffect(() => {\n    disableAutoScrollRef.current = disableAutoScroll;\n  }, [disableAutoScroll]);\n\n  // Detect prefers-reduced-motion preference\n  useEffect(() => {\n    const mediaQuery = window.matchMedia(\"(prefers-reduced-motion: reduce)\");\n    setPrefersReducedMotion(mediaQuery.matches);\n\n    const handler = (e: MediaQueryListEvent) =>\n      setPrefersReducedMotion(e.matches);\n    mediaQuery.addEventListener(\"change\", handler);\n    return () => mediaQuery.removeEventListener(\"change\", handler);\n  }, []);\n\n  const checkIfAtBottom = useCallback(\n    (container: HTMLElement): boolean => {\n      return (\n        container.scrollHeight - container.scrollTop - container.clientHeight <\n        threshold\n      );\n    },\n    [threshold],\n  );\n\n  const scrollToBottom = useCallback(\n    (behavior: ScrollBehavior = \"smooth\"): boolean => {\n      const container = containerRef.current;\n      if (!container) return false;\n\n      isAutoScrolling.current = true;\n      // Respect prefers-reduced-motion\n      const actualBehavior = prefersReducedMotion ? \"auto\" : behavior;\n      const target = container.scrollHeight - container.clientHeight;\n      container.scrollTo({ top: target, behavior: actualBehavior });\n\n      // Verify after animation completes\n      const verifyTimeout = actualBehavior === \"smooth\" ? animationDuration : 0;\n      setTimeout(() => {\n        isAutoScrolling.current = false;\n        if (!container) return;\n\n        const currentIsAtBottom = checkIfAtBottom(container);\n        setIsAtBottom(currentIsAtBottom);\n\n        // Retry if scroll failed and user didn't manually scroll\n        if (!currentIsAtBottom && !userScrolledUp) {\n          requestAnimationFrame(() => {\n            if (container) {\n              container.scrollTo({\n                top: container.scrollHeight - container.clientHeight,\n                behavior: \"auto\",\n              });\n            }\n          });\n        }\n      }, verifyTimeout);\n\n      return true;\n    },\n    [animationDuration, checkIfAtBottom, userScrolledUp, prefersReducedMotion],\n  );\n\n  // Handle user scroll events\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const handleScroll = () => {\n      const currentIsAtBottom = checkIfAtBottom(container);\n      setIsAtBottom(currentIsAtBottom);\n\n      // User scrolled up if not at bottom AND scroll wasn't auto-triggered\n      if (!currentIsAtBottom && !isAutoScrolling.current) {\n        setUserScrolledUp(true);\n        setShowScrollButton(true);\n      } else if (currentIsAtBottom) {\n        setUserScrolledUp(false);\n        setShowScrollButton(false);\n      }\n    };\n\n    container.addEventListener(\"scroll\", handleScroll, { passive: true });\n    return () => container.removeEventListener(\"scroll\", handleScroll);\n  }, [checkIfAtBottom]);\n\n  // Ref for scrollToBottom to avoid recreating MutationObserver\n  const scrollToBottomRef = useRef(scrollToBottom);\n  useEffect(() => {\n    scrollToBottomRef.current = scrollToBottom;\n  }, [scrollToBottom]);\n\n  // MutationObserver for dynamic content changes during streaming\n  // ResizeObserver on the container doesn't fire when scrollable content grows,\n  // so we use MutationObserver to detect DOM changes (text updates, new nodes)\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const mutationObserver = new MutationObserver(() => {\n      // Use refs for fresh values - avoids stale closure issue\n      // Only auto-scroll if enabled, user is at bottom, and hasn't scrolled up\n      if (\n        !disableAutoScrollRef.current &&\n        !userScrolledUpRef.current &&\n        isAtBottomRef.current\n      ) {\n        // Debounce - cancel pending RAF before scheduling new\n        if (resizeRAF.current) cancelAnimationFrame(resizeRAF.current);\n\n        resizeRAF.current = requestAnimationFrame(() => {\n          scrollToBottomRef.current(\"auto\");\n        });\n      }\n    });\n\n    // Watch for text content changes and new nodes (covers streaming updates)\n    mutationObserver.observe(container, {\n      childList: true,\n      subtree: true,\n      characterData: true,\n    });\n\n    return () => {\n      mutationObserver.disconnect();\n      if (resizeRAF.current) {\n        cancelAnimationFrame(resizeRAF.current);\n      }\n    };\n  }, []); // Empty deps - observer setup only once, uses refs for fresh values\n\n  return {\n    containerRef,\n    scrollToBottom,\n    showScrollButton,\n    isAtBottom,\n  };\n}\n","\"use client\";\n\nimport type { RefObject } from \"react\";\nimport { useEffect, useRef } from \"react\";\n\ninterface Message {\n  _id: string;\n  role: string;\n}\n\ninterface UseConversationScrollOptions {\n  containerRef: RefObject<HTMLElement | null>;\n  conversationId?: string;\n  messageCount: number;\n  highlightMessageId?: string;\n  messages: Message[];\n}\n\nconst MAX_SCROLL_ATTEMPTS = 20;\nconst SCROLL_RETRY_DELAY = 50;\nconst HINT_OFFSET = 50;\n\n/** Scrolls to bottom on conversation switch, and to new user message on send */\nexport function useConversationScroll({\n  containerRef,\n  conversationId,\n  messageCount,\n  highlightMessageId,\n  messages,\n}: UseConversationScrollOptions): void {\n  const lastScrolledConversationRef = useRef<string | null>(null);\n  const prevMessageCountRef = useRef(messageCount);\n\n  // Scroll to bottom on conversation switch\n  useEffect(() => {\n    if (highlightMessageId || !conversationId || messageCount === 0) return;\n    if (lastScrolledConversationRef.current === conversationId) return;\n\n    let attempts = 0;\n    let timeoutId: ReturnType<typeof setTimeout>;\n\n    const tryScroll = () => {\n      const container = containerRef.current;\n      if (container && container.scrollHeight > container.clientHeight) {\n        container.scrollTop = container.scrollHeight;\n        lastScrolledConversationRef.current = conversationId;\n        return;\n      }\n      if (++attempts < MAX_SCROLL_ATTEMPTS) {\n        timeoutId = setTimeout(tryScroll, SCROLL_RETRY_DELAY);\n      }\n    };\n\n    const rafId = requestAnimationFrame(tryScroll);\n    return () => {\n      cancelAnimationFrame(rafId);\n      clearTimeout(timeoutId);\n    };\n  }, [conversationId, highlightMessageId, messageCount, containerRef]);\n\n  // Scroll to new user message on send\n  useEffect(() => {\n    const prevCount = prevMessageCountRef.current;\n    if (messageCount > prevCount) {\n      const newUserMessage = messages\n        .slice(prevCount)\n        .find((m) => m.role === \"user\");\n      if (newUserMessage) {\n        requestAnimationFrame(() => {\n          const element = document.getElementById(\n            `message-${newUserMessage._id}`,\n          );\n          const container = containerRef.current;\n          if (element && container) {\n            const containerRect = container.getBoundingClientRect();\n            const elementRect = element.getBoundingClientRect();\n            const elementTop =\n              elementRect.top - containerRect.top + container.scrollTop;\n            container.scrollTo({\n              top: Math.max(0, elementTop - HINT_OFFSET),\n              behavior: \"smooth\",\n            });\n          }\n        });\n      }\n    }\n    prevMessageCountRef.current = messageCount;\n  }, [messages, messageCount, containerRef]);\n}\n","\"use client\";\n\nimport type { Virtualizer } from \"@tanstack/react-virtual\";\nimport { type RefObject, useEffect, useRef } from \"react\";\nimport type { GroupedItem } from \"@/hooks/useMessageGrouping\";\n\ninterface UseHighlightScrollOptions {\n  highlightMessageId?: string;\n  grouped: GroupedItem[];\n  containerRef: RefObject<HTMLElement | null>;\n  virtualizer: Virtualizer<any, any>;\n}\n\nconst HINT_OFFSET = 80;\nconst SCROLL_DELAY = 300;\nconst HIGHLIGHT_DURATION = 1200;\n\n/** Scrolls to and highlights a message when URL contains ?messageId=X */\nexport function useHighlightScroll({\n  highlightMessageId,\n  grouped,\n  containerRef,\n  virtualizer,\n}: UseHighlightScrollOptions): void {\n  const scrolledToHighlight = useRef(false);\n\n  useEffect(() => {\n    if (!highlightMessageId || scrolledToHighlight.current) return;\n\n    const targetIndex = grouped.findIndex((item) => {\n      if (item.type === \"message\") return item.data._id === highlightMessageId;\n      if (item.type === \"comparison\") {\n        return (\n          item.userMessage._id === highlightMessageId ||\n          item.assistantMessages.some((m) => m._id === highlightMessageId)\n        );\n      }\n      return false;\n    });\n\n    if (targetIndex === -1) return;\n\n    requestAnimationFrame(() => {\n      virtualizer.scrollToIndex(targetIndex, {\n        align: \"start\",\n        behavior: \"smooth\",\n      });\n    });\n\n    setTimeout(() => {\n      const element = document.getElementById(`message-${highlightMessageId}`);\n      const container = containerRef.current;\n      if (element && container) {\n        const containerRect = container.getBoundingClientRect();\n        const elementRect = element.getBoundingClientRect();\n        const elementTop =\n          elementRect.top - containerRect.top + container.scrollTop;\n\n        container.scrollTo({\n          top: Math.max(0, elementTop - HINT_OFFSET),\n          behavior: \"smooth\",\n        });\n\n        element.classList.add(\"message-highlight\");\n        setTimeout(\n          () => element.classList.remove(\"message-highlight\"),\n          HIGHLIGHT_DURATION,\n        );\n      }\n    }, SCROLL_DELAY);\n\n    scrolledToHighlight.current = true;\n  }, [highlightMessageId, grouped, virtualizer, containerRef]);\n\n  useEffect(() => {\n    scrolledToHighlight.current = false;\n  }, [highlightMessageId]);\n}\n","\"use client\";\n\nimport type { Doc } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMemo } from \"react\";\n\ntype MessageWithUser = Doc<\"messages\"> & {\n  senderUser?: { name?: string; imageUrl?: string } | null;\n};\n\nexport type GroupedItem =\n  | { type: \"message\"; data: MessageWithUser }\n  | {\n      type: \"comparison\";\n      id: string;\n      userMessage: MessageWithUser;\n      assistantMessages: MessageWithUser[];\n      timestamp: number;\n    };\n\n/** Groups messages by comparisonGroupId, filtering out consolidated ones */\nexport function useMessageGrouping(messages: MessageWithUser[]): GroupedItem[] {\n  return useMemo(() => {\n    const visibleMessages = messages.filter(\n      (m) => !(m.role === \"assistant\" && m.consolidatedMessageId),\n    );\n\n    const comparisonGroups: Record<string, MessageWithUser[]> = {};\n    for (const msg of visibleMessages) {\n      if (msg.comparisonGroupId) {\n        comparisonGroups[msg.comparisonGroupId] ||= [];\n        comparisonGroups[msg.comparisonGroupId].push(msg);\n      }\n    }\n\n    const items: GroupedItem[] = [];\n    const processedGroups = new Set<string>();\n\n    for (const msg of visibleMessages) {\n      if (msg.comparisonGroupId) {\n        if (!processedGroups.has(msg.comparisonGroupId)) {\n          const groupMsgs = comparisonGroups[msg.comparisonGroupId];\n          const userMessage = groupMsgs.find((m) => m.role === \"user\");\n          const assistantMessages = groupMsgs.filter(\n            (m) => m.role === \"assistant\",\n          );\n\n          if (userMessage && assistantMessages.length > 0) {\n            items.push({\n              type: \"comparison\",\n              id: msg.comparisonGroupId,\n              userMessage,\n              assistantMessages,\n              timestamp: Math.min(...groupMsgs.map((m) => m.createdAt)),\n            });\n          } else if (userMessage) {\n            items.push({ type: \"message\", data: userMessage });\n          }\n          processedGroups.add(msg.comparisonGroupId);\n        }\n      } else {\n        items.push({ type: \"message\", data: msg });\n      }\n    }\n\n    return items;\n  }, [messages]);\n}\n","// src/queryObserver.ts\nimport { focusManager } from \"./focusManager.js\";\nimport { notifyManager } from \"./notifyManager.js\";\nimport { fetchState } from \"./query.js\";\nimport { Subscribable } from \"./subscribable.js\";\nimport { pendingThenable } from \"./thenable.js\";\nimport {\n  isServer,\n  isValidTimeout,\n  noop,\n  replaceData,\n  resolveEnabled,\n  resolveStaleTime,\n  shallowEqualObjects,\n  timeUntilStale\n} from \"./utils.js\";\nimport { timeoutManager } from \"./timeoutManager.js\";\nvar QueryObserver = class extends Subscribable {\n  constructor(client, options) {\n    super();\n    this.options = options;\n    this.#client = client;\n    this.#selectError = null;\n    this.#currentThenable = pendingThenable();\n    this.bindMethods();\n    this.setOptions(options);\n  }\n  #client;\n  #currentQuery = void 0;\n  #currentQueryInitialState = void 0;\n  #currentResult = void 0;\n  #currentResultState;\n  #currentResultOptions;\n  #currentThenable;\n  #selectError;\n  #selectFn;\n  #selectResult;\n  // This property keeps track of the last query with defined data.\n  // It will be used to pass the previous data and query to the placeholder function between renders.\n  #lastQueryWithDefinedData;\n  #staleTimeoutId;\n  #refetchIntervalId;\n  #currentRefetchInterval;\n  #trackedProps = /* @__PURE__ */ new Set();\n  bindMethods() {\n    this.refetch = this.refetch.bind(this);\n  }\n  onSubscribe() {\n    if (this.listeners.size === 1) {\n      this.#currentQuery.addObserver(this);\n      if (shouldFetchOnMount(this.#currentQuery, this.options)) {\n        this.#executeFetch();\n      } else {\n        this.updateResult();\n      }\n      this.#updateTimers();\n    }\n  }\n  onUnsubscribe() {\n    if (!this.hasListeners()) {\n      this.destroy();\n    }\n  }\n  shouldFetchOnReconnect() {\n    return shouldFetchOn(\n      this.#currentQuery,\n      this.options,\n      this.options.refetchOnReconnect\n    );\n  }\n  shouldFetchOnWindowFocus() {\n    return shouldFetchOn(\n      this.#currentQuery,\n      this.options,\n      this.options.refetchOnWindowFocus\n    );\n  }\n  destroy() {\n    this.listeners = /* @__PURE__ */ new Set();\n    this.#clearStaleTimeout();\n    this.#clearRefetchInterval();\n    this.#currentQuery.removeObserver(this);\n  }\n  setOptions(options) {\n    const prevOptions = this.options;\n    const prevQuery = this.#currentQuery;\n    this.options = this.#client.defaultQueryOptions(options);\n    if (this.options.enabled !== void 0 && typeof this.options.enabled !== \"boolean\" && typeof this.options.enabled !== \"function\" && typeof resolveEnabled(this.options.enabled, this.#currentQuery) !== \"boolean\") {\n      throw new Error(\n        \"Expected enabled to be a boolean or a callback that returns a boolean\"\n      );\n    }\n    this.#updateQuery();\n    this.#currentQuery.setOptions(this.options);\n    if (prevOptions._defaulted && !shallowEqualObjects(this.options, prevOptions)) {\n      this.#client.getQueryCache().notify({\n        type: \"observerOptionsUpdated\",\n        query: this.#currentQuery,\n        observer: this\n      });\n    }\n    const mounted = this.hasListeners();\n    if (mounted && shouldFetchOptionally(\n      this.#currentQuery,\n      prevQuery,\n      this.options,\n      prevOptions\n    )) {\n      this.#executeFetch();\n    }\n    this.updateResult();\n    if (mounted && (this.#currentQuery !== prevQuery || resolveEnabled(this.options.enabled, this.#currentQuery) !== resolveEnabled(prevOptions.enabled, this.#currentQuery) || resolveStaleTime(this.options.staleTime, this.#currentQuery) !== resolveStaleTime(prevOptions.staleTime, this.#currentQuery))) {\n      this.#updateStaleTimeout();\n    }\n    const nextRefetchInterval = this.#computeRefetchInterval();\n    if (mounted && (this.#currentQuery !== prevQuery || resolveEnabled(this.options.enabled, this.#currentQuery) !== resolveEnabled(prevOptions.enabled, this.#currentQuery) || nextRefetchInterval !== this.#currentRefetchInterval)) {\n      this.#updateRefetchInterval(nextRefetchInterval);\n    }\n  }\n  getOptimisticResult(options) {\n    const query = this.#client.getQueryCache().build(this.#client, options);\n    const result = this.createResult(query, options);\n    if (shouldAssignObserverCurrentProperties(this, result)) {\n      this.#currentResult = result;\n      this.#currentResultOptions = this.options;\n      this.#currentResultState = this.#currentQuery.state;\n    }\n    return result;\n  }\n  getCurrentResult() {\n    return this.#currentResult;\n  }\n  trackResult(result, onPropTracked) {\n    return new Proxy(result, {\n      get: (target, key) => {\n        this.trackProp(key);\n        onPropTracked?.(key);\n        if (key === \"promise\") {\n          this.trackProp(\"data\");\n          if (!this.options.experimental_prefetchInRender && this.#currentThenable.status === \"pending\") {\n            this.#currentThenable.reject(\n              new Error(\n                \"experimental_prefetchInRender feature flag is not enabled\"\n              )\n            );\n          }\n        }\n        return Reflect.get(target, key);\n      }\n    });\n  }\n  trackProp(key) {\n    this.#trackedProps.add(key);\n  }\n  getCurrentQuery() {\n    return this.#currentQuery;\n  }\n  refetch({ ...options } = {}) {\n    return this.fetch({\n      ...options\n    });\n  }\n  fetchOptimistic(options) {\n    const defaultedOptions = this.#client.defaultQueryOptions(options);\n    const query = this.#client.getQueryCache().build(this.#client, defaultedOptions);\n    return query.fetch().then(() => this.createResult(query, defaultedOptions));\n  }\n  fetch(fetchOptions) {\n    return this.#executeFetch({\n      ...fetchOptions,\n      cancelRefetch: fetchOptions.cancelRefetch ?? true\n    }).then(() => {\n      this.updateResult();\n      return this.#currentResult;\n    });\n  }\n  #executeFetch(fetchOptions) {\n    this.#updateQuery();\n    let promise = this.#currentQuery.fetch(\n      this.options,\n      fetchOptions\n    );\n    if (!fetchOptions?.throwOnError) {\n      promise = promise.catch(noop);\n    }\n    return promise;\n  }\n  #updateStaleTimeout() {\n    this.#clearStaleTimeout();\n    const staleTime = resolveStaleTime(\n      this.options.staleTime,\n      this.#currentQuery\n    );\n    if (isServer || this.#currentResult.isStale || !isValidTimeout(staleTime)) {\n      return;\n    }\n    const time = timeUntilStale(this.#currentResult.dataUpdatedAt, staleTime);\n    const timeout = time + 1;\n    this.#staleTimeoutId = timeoutManager.setTimeout(() => {\n      if (!this.#currentResult.isStale) {\n        this.updateResult();\n      }\n    }, timeout);\n  }\n  #computeRefetchInterval() {\n    return (typeof this.options.refetchInterval === \"function\" ? this.options.refetchInterval(this.#currentQuery) : this.options.refetchInterval) ?? false;\n  }\n  #updateRefetchInterval(nextInterval) {\n    this.#clearRefetchInterval();\n    this.#currentRefetchInterval = nextInterval;\n    if (isServer || resolveEnabled(this.options.enabled, this.#currentQuery) === false || !isValidTimeout(this.#currentRefetchInterval) || this.#currentRefetchInterval === 0) {\n      return;\n    }\n    this.#refetchIntervalId = timeoutManager.setInterval(() => {\n      if (this.options.refetchIntervalInBackground || focusManager.isFocused()) {\n        this.#executeFetch();\n      }\n    }, this.#currentRefetchInterval);\n  }\n  #updateTimers() {\n    this.#updateStaleTimeout();\n    this.#updateRefetchInterval(this.#computeRefetchInterval());\n  }\n  #clearStaleTimeout() {\n    if (this.#staleTimeoutId) {\n      timeoutManager.clearTimeout(this.#staleTimeoutId);\n      this.#staleTimeoutId = void 0;\n    }\n  }\n  #clearRefetchInterval() {\n    if (this.#refetchIntervalId) {\n      timeoutManager.clearInterval(this.#refetchIntervalId);\n      this.#refetchIntervalId = void 0;\n    }\n  }\n  createResult(query, options) {\n    const prevQuery = this.#currentQuery;\n    const prevOptions = this.options;\n    const prevResult = this.#currentResult;\n    const prevResultState = this.#currentResultState;\n    const prevResultOptions = this.#currentResultOptions;\n    const queryChange = query !== prevQuery;\n    const queryInitialState = queryChange ? query.state : this.#currentQueryInitialState;\n    const { state } = query;\n    let newState = { ...state };\n    let isPlaceholderData = false;\n    let data;\n    if (options._optimisticResults) {\n      const mounted = this.hasListeners();\n      const fetchOnMount = !mounted && shouldFetchOnMount(query, options);\n      const fetchOptionally = mounted && shouldFetchOptionally(query, prevQuery, options, prevOptions);\n      if (fetchOnMount || fetchOptionally) {\n        newState = {\n          ...newState,\n          ...fetchState(state.data, query.options)\n        };\n      }\n      if (options._optimisticResults === \"isRestoring\") {\n        newState.fetchStatus = \"idle\";\n      }\n    }\n    let { error, errorUpdatedAt, status } = newState;\n    data = newState.data;\n    let skipSelect = false;\n    if (options.placeholderData !== void 0 && data === void 0 && status === \"pending\") {\n      let placeholderData;\n      if (prevResult?.isPlaceholderData && options.placeholderData === prevResultOptions?.placeholderData) {\n        placeholderData = prevResult.data;\n        skipSelect = true;\n      } else {\n        placeholderData = typeof options.placeholderData === \"function\" ? options.placeholderData(\n          this.#lastQueryWithDefinedData?.state.data,\n          this.#lastQueryWithDefinedData\n        ) : options.placeholderData;\n      }\n      if (placeholderData !== void 0) {\n        status = \"success\";\n        data = replaceData(\n          prevResult?.data,\n          placeholderData,\n          options\n        );\n        isPlaceholderData = true;\n      }\n    }\n    if (options.select && data !== void 0 && !skipSelect) {\n      if (prevResult && data === prevResultState?.data && options.select === this.#selectFn) {\n        data = this.#selectResult;\n      } else {\n        try {\n          this.#selectFn = options.select;\n          data = options.select(data);\n          data = replaceData(prevResult?.data, data, options);\n          this.#selectResult = data;\n          this.#selectError = null;\n        } catch (selectError) {\n          this.#selectError = selectError;\n        }\n      }\n    }\n    if (this.#selectError) {\n      error = this.#selectError;\n      data = this.#selectResult;\n      errorUpdatedAt = Date.now();\n      status = \"error\";\n    }\n    const isFetching = newState.fetchStatus === \"fetching\";\n    const isPending = status === \"pending\";\n    const isError = status === \"error\";\n    const isLoading = isPending && isFetching;\n    const hasData = data !== void 0;\n    const result = {\n      status,\n      fetchStatus: newState.fetchStatus,\n      isPending,\n      isSuccess: status === \"success\",\n      isError,\n      isInitialLoading: isLoading,\n      isLoading,\n      data,\n      dataUpdatedAt: newState.dataUpdatedAt,\n      error,\n      errorUpdatedAt,\n      failureCount: newState.fetchFailureCount,\n      failureReason: newState.fetchFailureReason,\n      errorUpdateCount: newState.errorUpdateCount,\n      isFetched: newState.dataUpdateCount > 0 || newState.errorUpdateCount > 0,\n      isFetchedAfterMount: newState.dataUpdateCount > queryInitialState.dataUpdateCount || newState.errorUpdateCount > queryInitialState.errorUpdateCount,\n      isFetching,\n      isRefetching: isFetching && !isPending,\n      isLoadingError: isError && !hasData,\n      isPaused: newState.fetchStatus === \"paused\",\n      isPlaceholderData,\n      isRefetchError: isError && hasData,\n      isStale: isStale(query, options),\n      refetch: this.refetch,\n      promise: this.#currentThenable,\n      isEnabled: resolveEnabled(options.enabled, query) !== false\n    };\n    const nextResult = result;\n    if (this.options.experimental_prefetchInRender) {\n      const finalizeThenableIfPossible = (thenable) => {\n        if (nextResult.status === \"error\") {\n          thenable.reject(nextResult.error);\n        } else if (nextResult.data !== void 0) {\n          thenable.resolve(nextResult.data);\n        }\n      };\n      const recreateThenable = () => {\n        const pending = this.#currentThenable = nextResult.promise = pendingThenable();\n        finalizeThenableIfPossible(pending);\n      };\n      const prevThenable = this.#currentThenable;\n      switch (prevThenable.status) {\n        case \"pending\":\n          if (query.queryHash === prevQuery.queryHash) {\n            finalizeThenableIfPossible(prevThenable);\n          }\n          break;\n        case \"fulfilled\":\n          if (nextResult.status === \"error\" || nextResult.data !== prevThenable.value) {\n            recreateThenable();\n          }\n          break;\n        case \"rejected\":\n          if (nextResult.status !== \"error\" || nextResult.error !== prevThenable.reason) {\n            recreateThenable();\n          }\n          break;\n      }\n    }\n    return nextResult;\n  }\n  updateResult() {\n    const prevResult = this.#currentResult;\n    const nextResult = this.createResult(this.#currentQuery, this.options);\n    this.#currentResultState = this.#currentQuery.state;\n    this.#currentResultOptions = this.options;\n    if (this.#currentResultState.data !== void 0) {\n      this.#lastQueryWithDefinedData = this.#currentQuery;\n    }\n    if (shallowEqualObjects(nextResult, prevResult)) {\n      return;\n    }\n    this.#currentResult = nextResult;\n    const shouldNotifyListeners = () => {\n      if (!prevResult) {\n        return true;\n      }\n      const { notifyOnChangeProps } = this.options;\n      const notifyOnChangePropsValue = typeof notifyOnChangeProps === \"function\" ? notifyOnChangeProps() : notifyOnChangeProps;\n      if (notifyOnChangePropsValue === \"all\" || !notifyOnChangePropsValue && !this.#trackedProps.size) {\n        return true;\n      }\n      const includedProps = new Set(\n        notifyOnChangePropsValue ?? this.#trackedProps\n      );\n      if (this.options.throwOnError) {\n        includedProps.add(\"error\");\n      }\n      return Object.keys(this.#currentResult).some((key) => {\n        const typedKey = key;\n        const changed = this.#currentResult[typedKey] !== prevResult[typedKey];\n        return changed && includedProps.has(typedKey);\n      });\n    };\n    this.#notify({ listeners: shouldNotifyListeners() });\n  }\n  #updateQuery() {\n    const query = this.#client.getQueryCache().build(this.#client, this.options);\n    if (query === this.#currentQuery) {\n      return;\n    }\n    const prevQuery = this.#currentQuery;\n    this.#currentQuery = query;\n    this.#currentQueryInitialState = query.state;\n    if (this.hasListeners()) {\n      prevQuery?.removeObserver(this);\n      query.addObserver(this);\n    }\n  }\n  onQueryUpdate() {\n    this.updateResult();\n    if (this.hasListeners()) {\n      this.#updateTimers();\n    }\n  }\n  #notify(notifyOptions) {\n    notifyManager.batch(() => {\n      if (notifyOptions.listeners) {\n        this.listeners.forEach((listener) => {\n          listener(this.#currentResult);\n        });\n      }\n      this.#client.getQueryCache().notify({\n        query: this.#currentQuery,\n        type: \"observerResultsUpdated\"\n      });\n    });\n  }\n};\nfunction shouldLoadOnMount(query, options) {\n  return resolveEnabled(options.enabled, query) !== false && query.state.data === void 0 && !(query.state.status === \"error\" && options.retryOnMount === false);\n}\nfunction shouldFetchOnMount(query, options) {\n  return shouldLoadOnMount(query, options) || query.state.data !== void 0 && shouldFetchOn(query, options, options.refetchOnMount);\n}\nfunction shouldFetchOn(query, options, field) {\n  if (resolveEnabled(options.enabled, query) !== false && resolveStaleTime(options.staleTime, query) !== \"static\") {\n    const value = typeof field === \"function\" ? field(query) : field;\n    return value === \"always\" || value !== false && isStale(query, options);\n  }\n  return false;\n}\nfunction shouldFetchOptionally(query, prevQuery, options, prevOptions) {\n  return (query !== prevQuery || resolveEnabled(prevOptions.enabled, query) === false) && (!options.suspense || query.state.status !== \"error\") && isStale(query, options);\n}\nfunction isStale(query, options) {\n  return resolveEnabled(options.enabled, query) !== false && query.isStaleByTime(resolveStaleTime(options.staleTime, query));\n}\nfunction shouldAssignObserverCurrentProperties(observer, optimisticResult) {\n  if (!shallowEqualObjects(observer.getCurrentResult(), optimisticResult)) {\n    return true;\n  }\n  return false;\n}\nexport {\n  QueryObserver\n};\n//# sourceMappingURL=queryObserver.js.map","import { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useQuery as useConvexQuery } from \"convex/react\";\nimport { useApiClient } from \"@/lib/api/client\";\nimport { shouldUseConvex } from \"@/lib/utils/platform\";\n\nexport interface UseConversationsOptions {\n  page?: number;\n  pageSize?: number;\n  archived?: boolean;\n}\n\n/**\n * Hybrid query hook for conversations\n * - Web: Convex WebSocket subscription (real-time)\n * - Mobile: REST API with React Query (HTTP polling)\n */\nexport function useConversations(options: UseConversationsOptions = {}) {\n  const { page = 1, pageSize = 20, archived = false } = options;\n  const useConvexMode = shouldUseConvex();\n  const apiClient = useApiClient();\n\n  // Convex WebSocket subscription (web desktop)\n  // Note: api.conversations.list doesn't support archived param (hardcoded to false)\n  // Archived conversations need different query or REST API\n  const convexData = useConvexQuery(\n    api.conversations.list,\n    useConvexMode && !archived ? {} : \"skip\",\n  );\n\n  // REST API query (mobile)\n  const restQuery = useQuery({\n    queryKey: [\"conversations\", { page, pageSize, archived }],\n    queryFn: async () => {\n      const params = new URLSearchParams({\n        page: String(page),\n        pageSize: String(pageSize),\n        archived: String(archived),\n      });\n      return apiClient.get(`/conversations?${params}`);\n    },\n    enabled: !useConvexMode,\n    staleTime: 30_000, // 30s (matches CachePresets.LIST)\n  });\n\n  // Return unified interface\n  if (useConvexMode) {\n    return {\n      data: convexData\n        ? {\n            items: convexData,\n            pagination: {\n              page: 1,\n              pageSize: convexData.length,\n              total: convexData.length,\n              hasNext: false,\n            },\n          }\n        : undefined,\n      isLoading: convexData === undefined,\n      error: null,\n      refetch: () => Promise.resolve(),\n    };\n  }\n\n  return {\n    data: restQuery.data,\n    isLoading: restQuery.isLoading,\n    error: restQuery.error,\n    refetch: restQuery.refetch,\n  };\n}\n","\"use client\";\n\n// src/QueryErrorResetBoundary.tsx\nimport * as React from \"react\";\nimport { jsx } from \"react/jsx-runtime\";\nfunction createValue() {\n  let isReset = false;\n  return {\n    clearReset: () => {\n      isReset = false;\n    },\n    reset: () => {\n      isReset = true;\n    },\n    isReset: () => {\n      return isReset;\n    }\n  };\n}\nvar QueryErrorResetBoundaryContext = React.createContext(createValue());\nvar useQueryErrorResetBoundary = () => React.useContext(QueryErrorResetBoundaryContext);\nvar QueryErrorResetBoundary = ({\n  children\n}) => {\n  const [value] = React.useState(() => createValue());\n  return /* @__PURE__ */ jsx(QueryErrorResetBoundaryContext.Provider, { value, children: typeof children === \"function\" ? children(value) : children });\n};\nexport {\n  QueryErrorResetBoundary,\n  useQueryErrorResetBoundary\n};\n//# sourceMappingURL=QueryErrorResetBoundary.js.map","\"use client\";\n\n// src/errorBoundaryUtils.ts\nimport * as React from \"react\";\nimport { shouldThrowError } from \"@tanstack/query-core\";\nvar ensurePreventErrorBoundaryRetry = (options, errorResetBoundary) => {\n  if (options.suspense || options.throwOnError || options.experimental_prefetchInRender) {\n    if (!errorResetBoundary.isReset()) {\n      options.retryOnMount = false;\n    }\n  }\n};\nvar useClearResetErrorBoundary = (errorResetBoundary) => {\n  React.useEffect(() => {\n    errorResetBoundary.clearReset();\n  }, [errorResetBoundary]);\n};\nvar getHasError = ({\n  result,\n  errorResetBoundary,\n  throwOnError,\n  query,\n  suspense\n}) => {\n  return result.isError && !errorResetBoundary.isReset() && !result.isFetching && query && (suspense && result.data === void 0 || shouldThrowError(throwOnError, [result.error, query]));\n};\nexport {\n  ensurePreventErrorBoundaryRetry,\n  getHasError,\n  useClearResetErrorBoundary\n};\n//# sourceMappingURL=errorBoundaryUtils.js.map","\"use client\";\n\n// src/IsRestoringProvider.ts\nimport * as React from \"react\";\nvar IsRestoringContext = React.createContext(false);\nvar useIsRestoring = () => React.useContext(IsRestoringContext);\nvar IsRestoringProvider = IsRestoringContext.Provider;\nexport {\n  IsRestoringProvider,\n  useIsRestoring\n};\n//# sourceMappingURL=IsRestoringProvider.js.map","// src/suspense.ts\nvar defaultThrowOnError = (_error, query) => query.state.data === void 0;\nvar ensureSuspenseTimers = (defaultedOptions) => {\n  if (defaultedOptions.suspense) {\n    const MIN_SUSPENSE_TIME_MS = 1e3;\n    const clamp = (value) => value === \"static\" ? value : Math.max(value ?? MIN_SUSPENSE_TIME_MS, MIN_SUSPENSE_TIME_MS);\n    const originalStaleTime = defaultedOptions.staleTime;\n    defaultedOptions.staleTime = typeof originalStaleTime === \"function\" ? (...args) => clamp(originalStaleTime(...args)) : clamp(originalStaleTime);\n    if (typeof defaultedOptions.gcTime === \"number\") {\n      defaultedOptions.gcTime = Math.max(\n        defaultedOptions.gcTime,\n        MIN_SUSPENSE_TIME_MS\n      );\n    }\n  }\n};\nvar willFetch = (result, isRestoring) => result.isLoading && result.isFetching && !isRestoring;\nvar shouldSuspend = (defaultedOptions, result) => defaultedOptions?.suspense && result.isPending;\nvar fetchOptimistic = (defaultedOptions, observer, errorResetBoundary) => observer.fetchOptimistic(defaultedOptions).catch(() => {\n  errorResetBoundary.clearReset();\n});\nexport {\n  defaultThrowOnError,\n  ensureSuspenseTimers,\n  fetchOptimistic,\n  shouldSuspend,\n  willFetch\n};\n//# sourceMappingURL=suspense.js.map","\"use client\";\n\n// src/useBaseQuery.ts\nimport * as React from \"react\";\nimport { isServer, noop, notifyManager } from \"@tanstack/query-core\";\nimport { useQueryClient } from \"./QueryClientProvider.js\";\nimport { useQueryErrorResetBoundary } from \"./QueryErrorResetBoundary.js\";\nimport {\n  ensurePreventErrorBoundaryRetry,\n  getHasError,\n  useClearResetErrorBoundary\n} from \"./errorBoundaryUtils.js\";\nimport { useIsRestoring } from \"./IsRestoringProvider.js\";\nimport {\n  ensureSuspenseTimers,\n  fetchOptimistic,\n  shouldSuspend,\n  willFetch\n} from \"./suspense.js\";\nfunction useBaseQuery(options, Observer, queryClient) {\n  if (process.env.NODE_ENV !== \"production\") {\n    if (typeof options !== \"object\" || Array.isArray(options)) {\n      throw new Error(\n        'Bad argument type. Starting with v5, only the \"Object\" form is allowed when calling query related functions. Please use the error stack to find the culprit call. More info here: https://tanstack.com/query/latest/docs/react/guides/migrating-to-v5#supports-a-single-signature-one-object'\n      );\n    }\n  }\n  const isRestoring = useIsRestoring();\n  const errorResetBoundary = useQueryErrorResetBoundary();\n  const client = useQueryClient(queryClient);\n  const defaultedOptions = client.defaultQueryOptions(options);\n  client.getDefaultOptions().queries?._experimental_beforeQuery?.(\n    defaultedOptions\n  );\n  if (process.env.NODE_ENV !== \"production\") {\n    if (!defaultedOptions.queryFn) {\n      console.error(\n        `[${defaultedOptions.queryHash}]: No queryFn was passed as an option, and no default queryFn was found. The queryFn parameter is only optional when using a default queryFn. More info here: https://tanstack.com/query/latest/docs/framework/react/guides/default-query-function`\n      );\n    }\n  }\n  defaultedOptions._optimisticResults = isRestoring ? \"isRestoring\" : \"optimistic\";\n  ensureSuspenseTimers(defaultedOptions);\n  ensurePreventErrorBoundaryRetry(defaultedOptions, errorResetBoundary);\n  useClearResetErrorBoundary(errorResetBoundary);\n  const isNewCacheEntry = !client.getQueryCache().get(defaultedOptions.queryHash);\n  const [observer] = React.useState(\n    () => new Observer(\n      client,\n      defaultedOptions\n    )\n  );\n  const result = observer.getOptimisticResult(defaultedOptions);\n  const shouldSubscribe = !isRestoring && options.subscribed !== false;\n  React.useSyncExternalStore(\n    React.useCallback(\n      (onStoreChange) => {\n        const unsubscribe = shouldSubscribe ? observer.subscribe(notifyManager.batchCalls(onStoreChange)) : noop;\n        observer.updateResult();\n        return unsubscribe;\n      },\n      [observer, shouldSubscribe]\n    ),\n    () => observer.getCurrentResult(),\n    () => observer.getCurrentResult()\n  );\n  React.useEffect(() => {\n    observer.setOptions(defaultedOptions);\n  }, [defaultedOptions, observer]);\n  if (shouldSuspend(defaultedOptions, result)) {\n    throw fetchOptimistic(defaultedOptions, observer, errorResetBoundary);\n  }\n  if (getHasError({\n    result,\n    errorResetBoundary,\n    throwOnError: defaultedOptions.throwOnError,\n    query: client.getQueryCache().get(defaultedOptions.queryHash),\n    suspense: defaultedOptions.suspense\n  })) {\n    throw result.error;\n  }\n  ;\n  client.getDefaultOptions().queries?._experimental_afterQuery?.(\n    defaultedOptions,\n    result\n  );\n  if (defaultedOptions.experimental_prefetchInRender && !isServer && willFetch(result, isRestoring)) {\n    const promise = isNewCacheEntry ? (\n      // Fetch immediately on render in order to ensure `.promise` is resolved even if the component is unmounted\n      fetchOptimistic(defaultedOptions, observer, errorResetBoundary)\n    ) : (\n      // subscribe to the \"cache promise\" so that we can finalize the currentThenable once data comes in\n      client.getQueryCache().get(defaultedOptions.queryHash)?.promise\n    );\n    promise?.catch(noop).finally(() => {\n      observer.updateResult();\n    });\n  }\n  return !defaultedOptions.notifyOnChangeProps ? observer.trackResult(result) : result;\n}\nexport {\n  useBaseQuery\n};\n//# sourceMappingURL=useBaseQuery.js.map","\"use client\";\n\n// src/useQuery.ts\nimport { QueryObserver } from \"@tanstack/query-core\";\nimport { useBaseQuery } from \"./useBaseQuery.js\";\nfunction useQuery(options, queryClient) {\n  return useBaseQuery(options, QueryObserver, queryClient);\n}\nexport {\n  useQuery\n};\n//# sourceMappingURL=useQuery.js.map","import { getModelConfig } from \"@/lib/ai/utils\";\n\n// Exact model matches (top models)\nconst SUGGESTED_PROMPTS: Record<string, readonly string[]> = {\n  \"gpt-5\": [\n    \"Analyze this architecture diagram and suggest improvements\",\n    \"Debug React useEffect infinite loop with async dependencies\",\n    \"Extract structured data from handwritten notes\",\n    \"Compare these two UI mockups and list differences\",\n    \"Review this PR for security vulnerabilities and best practices\",\n    \"Refactor this component to follow React composition patterns\",\n    \"Explain TCP/IP handshake like I'm interviewing for senior engineer\",\n    \"Write comprehensive test cases for this authentication flow\",\n    \"Prove: sum of first n cubes equals (n(n+1)/2)Â²\",\n    \"Find the logic error in this distributed consensus algorithm\",\n    \"Debug race condition in concurrent Rust code\",\n    \"Analyze failure scenario in blockchain consensus\",\n    \"Derive Black-Scholes equation from first principles\",\n    \"Find edge case causing intermittent deadlock\",\n    \"Prove correctness of this sorting algorithm variant\",\n    \"Optimize this dynamic programming solution\",\n    \"Design distributed caching system for 1M requests/sec\",\n    \"Analyze architectural tradeoffs for microservices migration\",\n    \"Review API design for RESTful best practices\",\n    \"Refactor monolith to event-driven architecture\",\n  ],\n} as const;\n\n// Capability-based fallbacks\nconst CAPABILITY_PROMPTS = {\n  thinking: [\n    \"Prove: $$\\\\sum_{i=1}^{n} i = \\\\frac{n(n+1)}{2}$$ using mathematical induction\",\n    \"Derive quadratic formula from $$ax^2 + bx + c = 0$$\",\n    \"Find the subtle bug in this encryption logic: `AES-GCM` with fixed IV\",\n    \"Debug infinite recursion in `dfs` traversal: provide fixed code\",\n  ],\n  vision: [\n    \"Extract structured JSON data from this invoice image\",\n    \"Identify accessibility violations in this UI design screenshot\",\n    \"Analyze the trend in this sales chart and predict next month\",\n    \"Transcribe this handwritten medical note into text\",\n  ],\n  fast: [\n    \"Summarize this article in 3 bullet points\",\n    \"Write a regex to validate US phone numbers: `(555) 123-4567`\",\n    \"Fix this TypeScript error: `Property 'id' does not exist on type 'User'`\",\n    \"Generate 5 creative names for a coffee shop app\",\n  ],\n  general: [\n    \"Explain photosynthesis: $$\\\\ce{6CO2 + 6H2O ->[light] C6H12O6 + 6O2}$$\",\n    \"Compare PostgreSQL vs MongoDB for high-write logging system\",\n    \"Refactor this nested callback code to `async/await`\",\n    \"Solve for mass in $$E = mc^2$$ given Energy = 50J\",\n  ],\n} as const;\n\nexport type PromptCategory =\n  | \"suggested\"\n  | \"thinking\"\n  | \"vision\"\n  | \"fast\"\n  | \"general\";\n\nexport interface PromptResult {\n  category: PromptCategory;\n  prompts: readonly string[];\n  source: \"exact-model\" | \"capability\" | \"default\";\n}\n\n/**\n * Get appropriate prompts for model based on exact match or capabilities\n * Cascade: exact model â†’ capability â†’ general\n */\nexport function getPromptsForModel(modelId: string | undefined): PromptResult {\n  // No model selected\n  if (!modelId) {\n    return {\n      category: \"general\",\n      prompts: CAPABILITY_PROMPTS.general,\n      source: \"default\",\n    };\n  }\n\n  // 1. Try exact model match\n  if (modelId in SUGGESTED_PROMPTS) {\n    return {\n      category: \"suggested\",\n      prompts: SUGGESTED_PROMPTS[modelId as keyof typeof SUGGESTED_PROMPTS],\n      source: \"exact-model\",\n    };\n  }\n\n  // 2. Try capability-based match\n  const config = getModelConfig(modelId);\n  if (!config) {\n    return {\n      category: \"general\",\n      prompts: CAPABILITY_PROMPTS.general,\n      source: \"default\",\n    };\n  }\n\n  // Priority: thinking > vision > fast > general\n  if (\n    config.capabilities.includes(\"thinking\") ||\n    config.capabilities.includes(\"extended-thinking\") ||\n    config.reasoning\n  ) {\n    return {\n      category: \"thinking\",\n      prompts: CAPABILITY_PROMPTS.thinking,\n      source: \"capability\",\n    };\n  }\n\n  if (config.capabilities.includes(\"vision\")) {\n    return {\n      category: \"vision\",\n      prompts: CAPABILITY_PROMPTS.vision,\n      source: \"capability\",\n    };\n  }\n\n  // Fast models (mini, flash, nano in name)\n  const nameLC = config.name.toLowerCase();\n  if (\n    nameLC.includes(\"mini\") ||\n    nameLC.includes(\"flash\") ||\n    nameLC.includes(\"nano\")\n  ) {\n    return {\n      category: \"fast\",\n      prompts: CAPABILITY_PROMPTS.fast,\n      source: \"capability\",\n    };\n  }\n\n  // Default\n  return {\n    category: \"general\",\n    prompts: CAPABILITY_PROMPTS.general,\n    source: \"capability\",\n  };\n}\n\n// Export for testing/reference\nexport { CAPABILITY_PROMPTS, SUGGESTED_PROMPTS };\n","\"use client\";\n\nimport { ArrowRight, Brain, Code2, Eye, Sparkles, Zap } from \"lucide-react\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport type { PromptCategory } from \"@/lib/prompts/examplePrompts\";\nimport {\n  CAPABILITY_PROMPTS,\n  getPromptsForModel,\n} from \"@/lib/prompts/examplePrompts\";\nimport { cn } from \"@/lib/utils\";\nimport { MarkdownContent } from \"./MarkdownContent\";\n\nfunction getTimeOfDay(): \"morning\" | \"afternoon\" | \"evening\" {\n  const hour = new Date().getHours();\n  if (hour < 12) return \"morning\";\n  if (hour < 17) return \"afternoon\";\n  return \"evening\";\n}\n\nconst TIME_GREETINGS: Record<\"morning\" | \"afternoon\" | \"evening\", string[]> = {\n  morning: [\"Good morning\", \"Morning\", \"Ready to start the day\"],\n  afternoon: [\"Good afternoon\", \"How's the day going\", \"Afternoon\"],\n  evening: [\"Good evening\", \"Evening work session\", \"How can I help tonight\"],\n};\n\ninterface EmptyScreenProps {\n  onClick: (value: string) => void;\n  selectedModel?: string;\n  conversationCount?: number;\n  nickname?: string;\n}\n\nexport function EmptyScreen({\n  onClick,\n  selectedModel,\n  conversationCount,\n  nickname,\n}: EmptyScreenProps) {\n  const result = getPromptsForModel(selectedModel);\n  const [activeCategory, setActiveCategory] = useState<PromptCategory>(\n    result.category,\n  );\n\n  // Stable random greeting - only changes on mount\n  const greeting = useMemo(() => {\n    const timeOfDay = getTimeOfDay();\n    const greetings = TIME_GREETINGS[timeOfDay];\n    return greetings[Math.floor(Math.random() * greetings.length)];\n  }, []);\n\n  // Update active category when model changes\n  useEffect(() => {\n    setActiveCategory(result.category);\n  }, [result.category]);\n\n  const isReturningUser = (conversationCount ?? 0) >= 2;\n\n  // Simple view for returning users\n  if (isReturningUser) {\n    const displayGreeting = nickname ? `${greeting}, ${nickname}` : greeting;\n\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-[50vh] px-8 text-center animate-message-enter w-full\">\n        <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold mb-8 bg-linear-to-br from-foreground to-muted-foreground bg-clip-text text-transparent\">\n          {displayGreeting}\n        </h1>\n\n        {/* Keyboard shortcuts - hidden on mobile */}\n        <div className=\"hidden sm:flex gap-4 md:gap-6 text-xs text-muted-foreground/60 animate-in fade-in duration-700 delay-300 flex-wrap justify-center\">\n          <div className=\"flex items-center gap-1.5\">\n            <kbd className=\"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100\">\n              <span className=\"text-xs\">âŒ˜</span>J\n            </kbd>\n            <span>models</span>\n          </div>\n          <div className=\"flex items-center gap-1.5\">\n            <kbd className=\"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100\">\n              <span className=\"text-xs\">âŒ˜</span>K\n            </kbd>\n            <span>commands</span>\n          </div>\n          <div className=\"flex items-center gap-1.5\">\n            <kbd className=\"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100\">\n              <span className=\"text-xs\">âŒ˜</span>\n              {\";\"}\n            </kbd>\n            <span>templates</span>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Category config\n  const categories: Array<{\n    key: PromptCategory;\n    label: string;\n    icon: typeof Sparkles;\n    prompts: readonly string[];\n  }> = [\n    // Show \"Suggested\" only if exact model match\n    ...(result.source === \"exact-model\"\n      ? [\n          {\n            key: \"suggested\" as const,\n            label: \"Suggested\",\n            icon: Sparkles,\n            prompts: result.prompts,\n          },\n        ]\n      : []),\n    {\n      key: \"thinking\" as const,\n      label: \"Thinking\",\n      icon: Brain,\n      prompts: CAPABILITY_PROMPTS.thinking,\n    },\n    {\n      key: \"vision\" as const,\n      label: \"Vision\",\n      icon: Eye,\n      prompts: CAPABILITY_PROMPTS.vision,\n    },\n    {\n      key: \"fast\" as const,\n      label: \"Fast\",\n      icon: Zap,\n      prompts: CAPABILITY_PROMPTS.fast,\n    },\n    {\n      key: \"general\" as const,\n      label: \"General\",\n      icon: Code2,\n      prompts: CAPABILITY_PROMPTS.general,\n    },\n  ];\n\n  const activePrompts =\n    categories.find((c) => c.key === activeCategory)?.prompts || result.prompts;\n\n  return (\n    <div className=\"flex flex-col items-center justify-center min-h-[50vh] px-4 text-center animate-message-enter\">\n      <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold mb-6 sm:mb-8 bg-linear-to-br from-foreground to-muted-foreground bg-clip-text text-transparent\">\n        How can I help you?\n      </h1>\n\n      {/* Category tabs - hide on mobile */}\n      <div className=\"hidden sm:flex flex-wrap gap-2 justify-center mb-12 max-w-2xl\">\n        {categories.map((category) => {\n          const Icon = category.icon;\n          return (\n            <Button\n              key={category.key}\n              variant=\"outline\"\n              className={cn(\n                \"rounded-full gap-2 px-4 h-9 transition-all duration-300 border-white/10 hover:scale-105 cursor-pointer\",\n                activeCategory === category.key\n                  ? \"bg-primary/20 text-primary border-primary/20 hover:bg-primary/30\"\n                  : \"bg-background/40 hover:bg-background/80 hover:border-white/20\",\n              )}\n              onClick={() => setActiveCategory(category.key)}\n            >\n              <Icon className=\"w-4 h-4\" />\n              <span className=\"text-sm font-medium\">{category.label}</span>\n            </Button>\n          );\n        })}\n      </div>\n\n      {/* Prompts - staggered animation */}\n      <div className=\"grid gap-1.5 sm:gap-2 w-full max-w-full sm:max-w-md text-left mb-6 sm:mb-8 px-2 sm:px-0\">\n        {activePrompts.slice(0, 4).map((prompt, i) => (\n          <div\n            key={prompt}\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => onClick(prompt)}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault();\n                onClick(prompt);\n              }\n            }}\n            className=\"group flex h-16 items-center justify-between p-2 sm:p-3 rounded-lg sm:rounded-xl hover:bg-white/5 transition-all duration-200 border border-transparent hover:border-white/5 text-xs sm:text-sm text-muted-foreground hover:text-foreground cursor-pointer\"\n            style={{\n              animationDelay: `${i * 100}ms`,\n            }}\n          >\n            <div className=\"line-clamp-2 text-left\">\n              <MarkdownContent content={prompt} />\n            </div>\n            <ArrowRight className=\"w-3.5 h-3.5 sm:w-4 sm:h-4 opacity-0 -translate-x-2 group-hover:translate-x-0 group-hover:opacity-50 transition-all duration-300 shrink-0 ml-1.5 sm:ml-3\" />\n          </div>\n        ))}\n      </div>\n\n      {/* Footer Hints */}\n      <div className=\"hidden sm:flex gap-6 text-xs text-muted-foreground/60 animate-in fade-in duration-700 delay-500\">\n        <div className=\"flex items-center gap-1.5\">\n          <kbd className=\"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100\">\n            <span className=\"text-xs\">âŒ˜</span>J\n          </kbd>\n          <span>models</span>\n        </div>\n        <div className=\"flex items-center gap-1.5\">\n          <kbd className=\"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100\">\n            <span className=\"text-xs\">âŒ˜</span>K\n          </kbd>\n          <span>commands</span>\n        </div>\n        <div className=\"flex items-center gap-1.5\">\n          <kbd className=\"pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100\">\n            <span className=\"text-xs\">âŒ˜</span>\n            {\";\"}\n          </kbd>\n          <span>templates</span>\n        </div>\n      </div>\n    </div>\n  );\n}\n","\"use client\";\n\nimport { useVirtualizer } from \"@tanstack/react-virtual\";\nimport { ArrowDown } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAutoScroll } from \"@/hooks/useAutoScroll\";\nimport { useConversationScroll } from \"@/hooks/useConversationScroll\";\nimport { useHighlightScroll } from \"@/hooks/useHighlightScroll\";\nimport { useMessageGrouping } from \"@/hooks/useMessageGrouping\";\nimport { useUserPreference } from \"@/hooks/useUserPreference\";\nimport { useConversations } from \"@/lib/hooks/queries/useConversations\";\nimport { cn } from \"@/lib/utils\";\nimport type { ChatWidth } from \"@/lib/utils/chatWidth\";\nimport type { Doc } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { ChatMessage } from \"./ChatMessage\";\nimport { ComparisonView } from \"./ComparisonView\";\nimport { EmptyScreen } from \"./EmptyScreen\";\n\ntype MessageWithUser = Doc<\"messages\"> & {\n  senderUser?: { name?: string; imageUrl?: string } | null;\n};\n\ninterface VirtualizedMessageListProps {\n  messages: MessageWithUser[];\n  selectedModel?: string;\n  onVote?: (winnerId: string, rating: string) => void;\n  onConsolidate?: (model: string, mode: \"same-chat\" | \"new-chat\") => void;\n  onToggleModelNames?: () => void;\n  showModelNames: boolean;\n  highlightMessageId?: string;\n  chatWidth?: ChatWidth;\n  isCollaborative?: boolean;\n  isGenerating?: boolean;\n}\n\nexport function VirtualizedMessageList({\n  messages,\n  selectedModel,\n  onVote,\n  onConsolidate,\n  onToggleModelNames,\n  showModelNames,\n  chatWidth,\n  highlightMessageId,\n  isCollaborative,\n  isGenerating,\n}: VirtualizedMessageListProps) {\n  const { containerRef, scrollToBottom, showScrollButton } = useAutoScroll({\n    threshold: 100,\n    animationDuration: 400,\n    disableAutoScroll: true,\n  });\n\n  const { data: conversationsData } = useConversations();\n  const conversationCount =\n    (conversationsData as { items?: unknown[] } | undefined)?.items?.length ??\n    0;\n  const customInstructions = useUserPreference(\"customInstructions\");\n  const nickname =\n    (customInstructions as { nickname?: string } | undefined)?.nickname || \"\";\n\n  const conversationId = messages[0]?.conversationId;\n  const grouped = useMessageGrouping(messages);\n\n  const virtualizer = useVirtualizer({\n    count: grouped.length,\n    getScrollElement: () => containerRef.current,\n    estimateSize: () => 150,\n    overscan: 5,\n  });\n\n  const virtualItems = virtualizer.getVirtualItems();\n\n  useHighlightScroll({\n    highlightMessageId,\n    grouped,\n    containerRef,\n    virtualizer,\n  });\n  useConversationScroll({\n    containerRef,\n    conversationId,\n    messageCount: messages.length,\n    highlightMessageId,\n    messages,\n  });\n\n  if (messages.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center h-full w-full\">\n        <EmptyScreen\n          selectedModel={selectedModel}\n          conversationCount={conversationCount}\n          nickname={nickname}\n          onClick={(val: string) => {\n            const event = new CustomEvent(\"insert-prompt\", { detail: val });\n            window.dispatchEvent(event);\n          }}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex-1 max-h-full min-h-0 min-w-0 relative flex flex-col overflow-hidden\">\n      <div\n        ref={containerRef}\n        role=\"log\"\n        aria-live=\"polite\"\n        aria-label=\"Chat message history\"\n        aria-atomic=\"false\"\n        className=\"flex-1 w-full min-w-0 min-h-0 overflow-y-auto relative\"\n        style={{\n          contain: \"layout style paint\",\n          contentVisibility: \"auto\",\n        }}\n      >\n        <div\n          className={cn(isGenerating && \"pb-[80vh]\")}\n          style={{\n            height: `${virtualizer.getTotalSize()}px`,\n            width: \"100%\",\n            position: \"relative\",\n          }}\n        >\n          {virtualItems.map((virtualItem) => {\n            const item = grouped[virtualItem.index];\n            const isMessage = item.type === \"message\";\n\n            return (\n              <div\n                key={virtualItem.key}\n                data-index={virtualItem.index}\n                ref={virtualizer.measureElement}\n                style={{\n                  position: \"absolute\",\n                  top: 0,\n                  left: 0,\n                  width: \"100%\",\n                  transform: `translateY(${virtualItem.start}px)`,\n                }}\n              >\n                <div\n                  className={cn(\n                    \"grid gap-4 px-4 py-2 transition-all duration-300 ease-out\",\n                    chatWidth === \"narrow\" &&\n                      \"grid-cols-[1fr_min(42rem,100%)_1fr]\",\n                    chatWidth === \"standard\" &&\n                      \"grid-cols-[1fr_min(56rem,100%)_1fr]\",\n                    chatWidth === \"wide\" &&\n                      \"grid-cols-[1fr_min(72rem,100%)_1fr]\",\n                    chatWidth === \"full\" && \"grid-cols-[1fr_min(92%,100%)_1fr]\",\n                    !chatWidth && \"grid-cols-[1fr_min(56rem,100%)_1fr]\",\n                  )}\n                >\n                  {isMessage ? (\n                    <div className=\"col-start-2\">\n                      <ChatMessage\n                        message={item.data}\n                        nextMessage={(() => {\n                          if (virtualItem.index + 1 >= grouped.length)\n                            return undefined;\n                          const nextItem = grouped[virtualItem.index + 1];\n                          return nextItem.type === \"message\"\n                            ? nextItem.data\n                            : undefined;\n                        })()}\n                        isCollaborative={isCollaborative}\n                        senderUser={item.data.senderUser}\n                      />\n                    </div>\n                  ) : (\n                    <>\n                      <div className=\"col-start-2\">\n                        <ChatMessage\n                          message={item.userMessage}\n                          isCollaborative={isCollaborative}\n                          senderUser={item.userMessage.senderUser}\n                        />\n                      </div>\n                      <div className=\"col-span-full mt-4\">\n                        <ComparisonView\n                          assistantMessages={item.assistantMessages}\n                          comparisonGroupId={item.id}\n                          showModelNames={showModelNames}\n                          onVote={onVote || (() => {})}\n                          onConsolidate={onConsolidate || (() => {})}\n                          onToggleModelNames={onToggleModelNames || (() => {})}\n                        />\n                      </div>\n                    </>\n                  )}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n      {showScrollButton && (\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"absolute bottom-4 left-1/2 -translate-x-1/2 shadow-lg transition-all duration-200 z-10 gap-1\"\n          onClick={() => scrollToBottom(\"smooth\")}\n          aria-label=\"Scroll to bottom\"\n        >\n          Scroll to bottom\n          <ArrowDown className=\"w-3 h-3\" aria-hidden=\"true\" />\n        </Button>\n      )}\n    </div>\n  );\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport commandScore from \"command-score\";\nimport { useMutation, useQuery } from \"convex/react\";\nimport { FileText, Search, Sparkles } from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport {\n  CommandDialog,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n  CommandSeparator,\n} from \"@/components/ui/command\";\nimport {\n  HoverCard,\n  HoverCardContent,\n  HoverCardTrigger,\n} from \"@/components/ui/hover-card\";\nimport { analytics } from \"@/lib/analytics\";\nimport { cn } from \"@/lib/utils\";\n\nimport { useTemplateStore } from \"@/stores/templateStore\";\n\nconst CATEGORIES = [\n  { id: \"all\", label: \"All Templates\" },\n  { id: \"coding\", label: \"Coding\" },\n  { id: \"writing\", label: \"Writing\" },\n  { id: \"analysis\", label: \"Analysis\" },\n  { id: \"creative\", label: \"Creative\" },\n] as const;\n\ninterface QuickTemplateSwitcherProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSelectTemplate?: (templatePrompt: string) => void;\n  mode?: \"navigate\" | \"insert\";\n}\n\nexport function QuickTemplateSwitcher({\n  open,\n  onOpenChange,\n  onSelectTemplate,\n  mode = \"navigate\",\n}: QuickTemplateSwitcherProps) {\n  const router = useRouter();\n  const [activeCategory, setActiveCategory] = useState<string>(\"all\");\n  const setTemplateText = useTemplateStore((s) => s.setTemplateText);\n\n  // @ts-ignore - Type depth exceeded with complex Convex query\n  const templates = useQuery(api.templates.list, {});\n  // @ts-ignore - Type depth exceeded with complex Convex mutation\n  const incrementUsage = useMutation(api.templates.incrementUsage);\n\n  const prevOpenRef = useRef(open);\n\n  useEffect(() => {\n    const justOpened = open && !prevOpenRef.current;\n    prevOpenRef.current = open;\n\n    if (justOpened) {\n      analytics.track(\"template_switcher_opened\", { mode });\n    }\n  }, [open, mode]);\n\n  const filteredTemplates = useMemo(() => {\n    if (!templates) return { builtIn: [], user: [] };\n\n    const filtered =\n      activeCategory === \"all\"\n        ? templates\n        : templates.filter((t: any) => t.category === activeCategory);\n\n    return {\n      builtIn: filtered.filter((t: any) => t.isBuiltIn),\n      user: filtered.filter((t: any) => !t.isBuiltIn),\n    };\n  }, [templates, activeCategory]);\n\n  const handleSelect = async (template: {\n    _id: Id<\"templates\">;\n    prompt: string;\n    name: string;\n  }) => {\n    try {\n      await incrementUsage({ id: template._id });\n    } catch (error) {\n      console.error(\"Failed to increment usage:\", error);\n    }\n\n    analytics.track(\"template_selected\", {\n      templateId: template._id,\n      templateName: template.name,\n      mode,\n    });\n\n    if (mode === \"insert\" && onSelectTemplate) {\n      onSelectTemplate(template.prompt);\n      onOpenChange(false);\n      setTimeout(() => {\n        window.dispatchEvent(new CustomEvent(\"focus-chat-input\"));\n      }, 50);\n    } else {\n      onOpenChange(false);\n      setTemplateText(template.prompt, template.name);\n      router.push(\"/chat?from=template\");\n    }\n  };\n\n  const renderTemplateItem = (template: any) => {\n    const itemContent = (\n      <CommandItem\n        key={template._id}\n        value={template._id}\n        keywords={[\n          template.name,\n          template.category,\n          template.description || \"\",\n        ]}\n        onSelect={() => handleSelect(template)}\n        className={cn(\n          \"group flex items-center justify-between px-3 py-3 rounded-lg cursor-pointer aria-selected:bg-muted/50 transition-colors\",\n        )}\n      >\n        <div className=\"flex items-center gap-3 min-w-0 flex-1\">\n          <div\n            className={cn(\n              \"flex items-center justify-center w-8 h-8 rounded-lg border shrink-0\",\n              template.isBuiltIn\n                ? \"bg-amber-500/10 text-amber-600 dark:text-amber-500 border-amber-500/30\"\n                : \"bg-primary/10 text-primary border-primary/30\",\n            )}\n          >\n            {template.isBuiltIn ? (\n              <Sparkles className=\"w-4 h-4\" />\n            ) : (\n              <FileText className=\"w-4 h-4\" />\n            )}\n          </div>\n\n          <div className=\"flex flex-col min-w-0 gap-0.5\">\n            <span className=\"font-medium text-sm truncate text-foreground\">\n              {template.name}\n            </span>\n            <span className=\"text-xs text-muted-foreground truncate\">\n              {template.description || `${template.prompt.slice(0, 60)}...`}\n            </span>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-2 pl-2 text-xs text-muted-foreground/50\">\n          <span className=\"capitalize\">{template.category}</span>\n          {template.usageCount > 0 && (\n            <>\n              <span className=\"text-muted-foreground/30\">â€¢</span>\n              <span>{template.usageCount} uses</span>\n            </>\n          )}\n        </div>\n      </CommandItem>\n    );\n\n    return (\n      <HoverCard key={template._id} openDelay={300}>\n        <HoverCardTrigger asChild>{itemContent}</HoverCardTrigger>\n        <HoverCardContent\n          side=\"right\"\n          align=\"start\"\n          className=\"w-80 p-4\"\n          sideOffset={10}\n        >\n          <div className=\"space-y-2\">\n            <h4 className=\"font-medium\">{template.name}</h4>\n            {template.description && (\n              <p className=\"text-sm text-muted-foreground\">\n                {template.description}\n              </p>\n            )}\n            <div className=\"bg-muted/50 rounded-lg p-3 max-h-40 overflow-y-auto\">\n              <p className=\"text-xs text-muted-foreground whitespace-pre-wrap\">\n                {template.prompt}\n              </p>\n            </div>\n          </div>\n        </HoverCardContent>\n      </HoverCard>\n    );\n  };\n\n  return (\n    <CommandDialog\n      open={open}\n      onOpenChange={onOpenChange}\n      commandProps={{\n        filter: (value, search, keywords) => {\n          const extendValue = `${value} ${keywords?.join(\" \") || \"\"}`;\n          const score = commandScore(extendValue, search);\n          return score;\n        },\n      }}\n      className=\"max-w-[95vw] md:max-w-3xl h-[80vh] md:h-[500px] p-0 gap-0 overflow-hidden bg-background/95 backdrop-blur-xl border-border/50 shadow-2xl\"\n    >\n      <div className=\"flex items-center border-b px-4 py-3 shrink-0\">\n        <Search className=\"w-4 h-4 mr-2 text-muted-foreground\" />\n        <CommandInput\n          placeholder={`Search ${activeCategory === \"all\" ? \"\" : `${activeCategory} `}templates...`}\n          className=\"flex-1 h-9 bg-transparent border-0 ring-0 focus:ring-0 text-sm\"\n        />\n      </div>\n\n      <div className=\"flex h-[400px] overflow-hidden\">\n        {/* Sidebar Categories */}\n        <div className=\"w-[160px] border-r bg-muted/30 p-2 flex flex-col gap-1 shrink-0 overflow-y-auto\">\n          <div className=\"px-2 py-1.5 text-xs font-medium text-muted-foreground uppercase tracking-wider mb-1\">\n            Categories\n          </div>\n          {CATEGORIES.map((cat) => {\n            const isActive = activeCategory === cat.id;\n            return (\n              <button\n                key={cat.id}\n                type=\"button\"\n                onClick={() => setActiveCategory(cat.id)}\n                className={cn(\n                  \"w-full flex items-center px-2.5 py-2 rounded-md text-sm transition-colors text-left\",\n                  isActive\n                    ? \"bg-primary/10 text-primary font-medium\"\n                    : \"text-muted-foreground hover:bg-muted/50 hover:text-foreground\",\n                )}\n              >\n                {cat.label}\n              </button>\n            );\n          })}\n        </div>\n\n        {/* Main List Area */}\n        <div className=\"flex-1 flex flex-col min-w-0 bg-background/50\">\n          <CommandList className=\"max-h-[400px] overflow-y-auto p-2\">\n            <CommandEmpty>No templates found.</CommandEmpty>\n\n            {/* User Templates */}\n            {filteredTemplates.user.length > 0 && (\n              <CommandGroup heading=\"Your Templates\">\n                {filteredTemplates.user.map((template: any) =>\n                  renderTemplateItem(template),\n                )}\n              </CommandGroup>\n            )}\n\n            {filteredTemplates.user.length > 0 &&\n              filteredTemplates.builtIn.length > 0 && <CommandSeparator />}\n\n            {/* Built-in Templates */}\n            {filteredTemplates.builtIn.length > 0 && (\n              <CommandGroup heading=\"Built-in Templates\">\n                {filteredTemplates.builtIn.map((template: any) =>\n                  renderTemplateItem(template),\n                )}\n              </CommandGroup>\n            )}\n          </CommandList>\n        </div>\n      </div>\n\n      {/* Footer hint */}\n      <div className=\"border-t px-4 py-2 flex items-center justify-between text-xs text-muted-foreground\">\n        <span>\n          Press <kbd className=\"px-1 py-0.5 rounded bg-muted\">â†µ</kbd> to select\n        </span>\n        <span>\n          <kbd className=\"px-1 py-0.5 rounded bg-muted\">âŒ˜;</kbd> to open\n        </span>\n      </div>\n    </CommandDialog>\n  );\n}\n","\"use client\";\n\nimport { GripVerticalIcon } from \"lucide-react\";\nimport type * as React from \"react\";\nimport { Group, Panel, Separator } from \"react-resizable-panels\";\n\nimport { cn } from \"@/lib/utils\";\n\nfunction ResizablePanelGroup({\n  className,\n  ...props\n}: React.ComponentProps<typeof Group>) {\n  return (\n    <Group\n      data-slot=\"resizable-panel-group\"\n      className={cn(\n        \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n        className,\n      )}\n      {...props}\n    />\n  );\n}\n\nfunction ResizablePanel({ ...props }: React.ComponentProps<typeof Panel>) {\n  return <Panel data-slot=\"resizable-panel\" {...props} />;\n}\n\nfunction ResizableHandle({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator> & {\n  withHandle?: boolean;\n}) {\n  return (\n    <Separator\n      data-slot=\"resizable-handle\"\n      className={cn(\n        \"bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n        className,\n      )}\n      {...props}\n    >\n      {withHandle && (\n        <div className=\"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border\">\n          <GripVerticalIcon className=\"size-2.5\" />\n        </div>\n      )}\n    </Separator>\n  );\n}\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle };\n","export function assert(\n  expectedCondition: unknown,\n  message: string = \"Assertion error\"\n): asserts expectedCondition {\n  if (!expectedCondition) {\n    throw Error(message);\n  }\n}\n","import type { RegisteredGroup } from \"../../components/group/types\";\n\nexport function calculateAvailableGroupSize({\n  group\n}: {\n  group: RegisteredGroup;\n}) {\n  const { orientation, panels } = group;\n\n  return panels.reduce((totalSize, panel) => {\n    totalSize +=\n      orientation === \"horizontal\"\n        ? panel.element.offsetWidth\n        : panel.element.offsetHeight;\n    return totalSize;\n  }, 0);\n}\n","import type { Orientation } from \"./types\";\n\nexport function sortByElementOffset<\n  Type extends { element: HTMLElement },\n  ReturnType extends Type[]\n>(orientation: Orientation, panelsOrSeparators: Type[]): ReturnType {\n  return panelsOrSeparators.sort(\n    orientation === \"horizontal\" ? horizontalSort : verticalSort\n  ) as ReturnType;\n}\n\nfunction horizontalSort<Type extends { element: HTMLElement }>(\n  a: Type,\n  b: Type\n) {\n  const delta = a.element.offsetLeft - b.element.offsetLeft;\n  if (delta !== 0) {\n    return delta;\n  }\n  return a.element.offsetWidth - b.element.offsetWidth;\n}\n\nfunction verticalSort<Type extends { element: HTMLElement }>(a: Type, b: Type) {\n  const delta = a.element.offsetTop - b.element.offsetTop;\n  if (delta !== 0) {\n    return delta;\n  }\n  return a.element.offsetHeight - b.element.offsetHeight;\n}\n","// Detects HTMLElement without requiring instanceof and browser globals\nexport function isHTMLElement(value: unknown): value is HTMLElement {\n  return (\n    value !== null &&\n    typeof value === \"object\" &&\n    \"nodeType\" in value &&\n    value.nodeType === Node.ELEMENT_NODE\n  );\n}\n","import type { Point } from \"../../types\";\n\nexport function getDistanceBetweenPointAndRect(\n  point: Point,\n  rect: DOMRectReadOnly\n) {\n  return {\n    x:\n      point.x >= rect.left && point.x <= rect.right\n        ? 0\n        : Math.min(\n            Math.abs(point.x - rect.left),\n            Math.abs(point.x - rect.right)\n          ),\n    y:\n      point.y >= rect.top && point.y <= rect.bottom\n        ? 0\n        : Math.min(\n            Math.abs(point.y - rect.top),\n            Math.abs(point.y - rect.bottom)\n          )\n  };\n}\n","import type { Orientation } from \"../../components/group/types\";\nimport { assert } from \"../../utils/assert\";\nimport { getDistanceBetweenPointAndRect } from \"./getDistanceBetweenPointAndRect\";\n\nexport function findClosestRect({\n  orientation,\n  rects,\n  targetRect\n}: {\n  orientation: Orientation;\n  rects: DOMRectReadOnly[];\n  targetRect: DOMRectReadOnly;\n}): DOMRectReadOnly {\n  const centerPoint = {\n    x: targetRect.x + targetRect.width / 2,\n    y: targetRect.y + targetRect.height / 2\n  };\n\n  let closestRect: DOMRectReadOnly | undefined = undefined;\n  let minDistance = Number.MAX_VALUE;\n\n  for (const rect of rects) {\n    const { x, y } = getDistanceBetweenPointAndRect(centerPoint, rect);\n\n    const distance = orientation === \"horizontal\" ? x : y;\n\n    if (distance < minDistance) {\n      minDistance = distance;\n      closestRect = rect;\n    }\n  }\n\n  assert(closestRect, \"No rect found\");\n\n  return closestRect;\n}\n","import { sortByElementOffset } from \"../../components/group/sortByElementOffset\";\nimport type { RegisteredGroup } from \"../../components/group/types\";\nimport type { RegisteredPanel } from \"../../components/panel/types\";\nimport type { RegisteredSeparator } from \"../../components/separator/types\";\nimport { isHTMLElement } from \"../../utils/isHTMLElement\";\nimport { findClosestRect } from \"../utils/findClosestRect\";\nimport { calculateAvailableGroupSize } from \"./calculateAvailableGroupSize\";\n\ntype PanelsTuple = [panel: RegisteredPanel, panel: RegisteredPanel];\n\nexport type HitRegion = {\n  group: RegisteredGroup;\n  groupSize: number;\n  panels: PanelsTuple;\n  rect: DOMRect;\n  separator?: RegisteredSeparator | undefined;\n};\n\n/**\n * Determines hit regions for a Group; a hit region is either:\n * - 1: An explicit Separator element\n * - 2: The edge of a Panel element that has another Panel beside it\n *\n * This method determines bounding rects of all regions for the particular group.\n */\nexport function calculateHitRegions(group: RegisteredGroup) {\n  const { element: groupElement, orientation, panels, separators } = group;\n\n  // Sort elements by offset before traversing\n  const sortedChildElements: HTMLElement[] = sortByElementOffset(\n    orientation,\n    Array.from(groupElement.children)\n      .filter(isHTMLElement)\n      .map((element) => ({ element: element as HTMLElement }))\n  ).map(({ element }) => element);\n\n  const hitRegions: HitRegion[] = [];\n\n  let hasInterleavedStaticContent = false;\n  let prevPanel: RegisteredPanel | undefined = undefined;\n  let pendingSeparators: RegisteredSeparator[] = [];\n\n  for (const childElement of sortedChildElements) {\n    if (childElement.hasAttribute(\"data-panel\")) {\n      const panelData = panels.find(\n        (current) => current.element === childElement\n      );\n      if (panelData) {\n        if (prevPanel) {\n          const prevRect = prevPanel.element.getBoundingClientRect();\n          const rect = childElement.getBoundingClientRect();\n\n          let pendingRectsOrSeparators: (DOMRect | RegisteredSeparator)[];\n\n          // If an explicit Separator has been rendered, always watch it\n          // Otherwise watch the entire space between the panels\n          // The one caveat is when there are non-interactive element(s) between panels,\n          // in which case we may need to watch individual panel edges\n          if (hasInterleavedStaticContent) {\n            const firstPanelEdgeRect =\n              orientation === \"horizontal\"\n                ? new DOMRect(prevRect.right, prevRect.top, 0, prevRect.height)\n                : new DOMRect(\n                    prevRect.left,\n                    prevRect.bottom,\n                    prevRect.width,\n                    0\n                  );\n            const secondPanelEdgeRect =\n              orientation === \"horizontal\"\n                ? new DOMRect(rect.left, rect.top, 0, rect.height)\n                : new DOMRect(rect.left, rect.top, rect.width, 0);\n\n            switch (pendingSeparators.length) {\n              case 0: {\n                pendingRectsOrSeparators = [\n                  firstPanelEdgeRect,\n                  secondPanelEdgeRect\n                ];\n                break;\n              }\n              case 1: {\n                const separator = pendingSeparators[0];\n                const closestRect = findClosestRect({\n                  orientation,\n                  rects: [prevRect, rect],\n                  targetRect: separator.element.getBoundingClientRect()\n                });\n\n                pendingRectsOrSeparators = [\n                  separator,\n                  closestRect === prevRect\n                    ? secondPanelEdgeRect\n                    : firstPanelEdgeRect\n                ];\n                break;\n              }\n              default: {\n                pendingRectsOrSeparators = pendingSeparators;\n                break;\n              }\n            }\n          } else {\n            if (pendingSeparators.length) {\n              pendingRectsOrSeparators = pendingSeparators;\n            } else {\n              pendingRectsOrSeparators = [\n                orientation === \"horizontal\"\n                  ? new DOMRect(\n                      prevRect.right,\n                      rect.top,\n                      rect.left - prevRect.right,\n                      rect.height\n                    )\n                  : new DOMRect(\n                      rect.left,\n                      prevRect.bottom,\n                      rect.width,\n                      rect.top - prevRect.bottom\n                    )\n              ];\n            }\n          }\n\n          for (const rectOrSeparator of pendingRectsOrSeparators) {\n            hitRegions.push({\n              group,\n              groupSize: calculateAvailableGroupSize({ group }),\n              panels: [prevPanel, panelData],\n              separator:\n                \"width\" in rectOrSeparator ? undefined : rectOrSeparator,\n              rect:\n                \"width\" in rectOrSeparator\n                  ? rectOrSeparator\n                  : rectOrSeparator.element.getBoundingClientRect()\n            });\n          }\n        }\n\n        hasInterleavedStaticContent = false;\n        prevPanel = panelData;\n        pendingSeparators = [];\n      }\n    } else if (childElement.hasAttribute(\"data-separator\")) {\n      const separatorData = separators.find(\n        (current) => current.element === childElement\n      );\n      if (separatorData) {\n        // Separators will be included implicitly in the area between the previous and next panel\n        // It's important to track them though, to handle the scenario of non-interactive group content\n        pendingSeparators.push(separatorData);\n      } else {\n        prevPanel = undefined;\n        pendingSeparators = [];\n      }\n    } else {\n      hasInterleavedStaticContent = true;\n    }\n  }\n\n  return hitRegions;\n}\n","export function convertEmToPixels(element: Element, value: number) {\n  const style = getComputedStyle(element);\n  const fontSize = parseFloat(style.fontSize);\n\n  return value * fontSize;\n}\n","export function convertRemToPixels(element: Element, value: number) {\n  const style = getComputedStyle(element.ownerDocument.body);\n  const fontSize = parseFloat(style.fontSize);\n\n  return value * fontSize;\n}\n","export function convertVhToPixels(value: number) {\n  return (value / 100) * window.innerHeight;\n}\n","export function convertVwToPixels(value: number) {\n  return (value / 100) * window.innerWidth;\n}\n","import type { SizeUnit } from \"../../components/panel/types\";\n\nexport function parseSizeAndUnit(\n  size: number | string\n): [numeric: number, size: SizeUnit] {\n  switch (typeof size) {\n    case \"number\": {\n      return [size, \"px\"];\n    }\n    case \"string\": {\n      const numeric = parseFloat(size);\n\n      if (size.endsWith(\"%\")) {\n        return [numeric, \"%\"];\n      } else if (size.endsWith(\"px\")) {\n        return [numeric, \"px\"];\n      } else if (size.endsWith(\"rem\")) {\n        return [numeric, \"rem\"];\n      } else if (size.endsWith(\"em\")) {\n        return [numeric, \"em\"];\n      } else if (size.endsWith(\"vh\")) {\n        return [numeric, \"vh\"];\n      } else if (size.endsWith(\"vw\")) {\n        return [numeric, \"vw\"];\n      }\n\n      return [numeric, \"%\"];\n    }\n  }\n}\n","import { convertEmToPixels } from \"./convertEmToPixels\";\nimport { convertRemToPixels } from \"./convertRemToPixels\";\nimport { convertVhToPixels } from \"./convertVhToPixels\";\nimport { convertVwToPixels } from \"./convertVwToPixels\";\nimport { parseSizeAndUnit } from \"./parseSizeAndUnit\";\n\nexport function sizeStyleToPixels({\n  groupSize,\n  panelElement,\n  styleProp\n}: {\n  groupSize: number;\n  panelElement: HTMLElement;\n  styleProp: number | string;\n}) {\n  let pixels: number | undefined = undefined;\n\n  const [size, unit] = parseSizeAndUnit(styleProp);\n\n  switch (unit) {\n    case \"%\": {\n      pixels = (size / 100) * groupSize;\n      break;\n    }\n    case \"px\": {\n      pixels = size;\n      break;\n    }\n    case \"rem\": {\n      pixels = convertRemToPixels(panelElement, size);\n      break;\n    }\n    case \"em\": {\n      pixels = convertEmToPixels(panelElement, size);\n      break;\n    }\n    case \"vh\": {\n      pixels = convertVhToPixels(size);\n      break;\n    }\n    case \"vw\": {\n      pixels = convertVwToPixels(size);\n      break;\n    }\n  }\n\n  return pixels;\n}\n","export function formatLayoutNumber(number: number) {\n  return parseFloat(number.toFixed(3));\n}\n","import type { RegisteredGroup } from \"../../components/group/types\";\nimport type { PanelConstraints } from \"../../components/panel/types\";\nimport { sizeStyleToPixels } from \"../styles/sizeStyleToPixels\";\nimport { formatLayoutNumber } from \"../utils/formatLayoutNumber\";\nimport { calculateAvailableGroupSize } from \"./calculateAvailableGroupSize\";\n\nexport function calculatePanelConstraints(group: RegisteredGroup) {\n  const { panels } = group;\n\n  const groupSize = calculateAvailableGroupSize({ group });\n  if (groupSize === 0) {\n    // Can't calculate anything meaningful if the group has a width/height of 0\n    // (This could indicate that it's within a hidden subtree)\n    return panels.map((current) => ({\n      collapsedSize: 0,\n      collapsible: current.panelConstraints.collapsible === true,\n      defaultSize: undefined,\n      minSize: 0,\n      maxSize: 100,\n      panelId: current.id\n    }));\n  }\n\n  return panels.map<PanelConstraints>((panel) => {\n    const { element, panelConstraints } = panel;\n\n    let collapsedSize = 0;\n    if (panelConstraints.collapsedSize) {\n      const pixels = sizeStyleToPixels({\n        groupSize,\n        panelElement: element,\n        styleProp: panelConstraints.collapsedSize\n      });\n\n      collapsedSize = formatLayoutNumber((pixels / groupSize) * 100);\n    }\n\n    let defaultSize: number | undefined = undefined;\n    if (panelConstraints.defaultSize) {\n      const pixels = sizeStyleToPixels({\n        groupSize,\n        panelElement: element,\n        styleProp: panelConstraints.defaultSize\n      });\n\n      defaultSize = formatLayoutNumber((pixels / groupSize) * 100);\n    }\n\n    let minSize = 0;\n    if (panelConstraints.minSize) {\n      const pixels = sizeStyleToPixels({\n        groupSize,\n        panelElement: element,\n        styleProp: panelConstraints.minSize\n      });\n\n      minSize = formatLayoutNumber((pixels / groupSize) * 100);\n    }\n\n    let maxSize = 100;\n    if (panelConstraints.maxSize) {\n      const pixels = sizeStyleToPixels({\n        groupSize,\n        panelElement: element,\n        styleProp: panelConstraints.maxSize\n      });\n\n      maxSize = formatLayoutNumber((pixels / groupSize) * 100);\n    }\n\n    return {\n      collapsedSize,\n      collapsible: panelConstraints.collapsible === true,\n      defaultSize,\n      minSize,\n      maxSize,\n      panelId: panel.id\n    };\n  });\n}\n","export type EventMap = {\n  [key: string]: unknown;\n};\n\nexport type EventListener<Data> = (data: Data) => void;\n\nexport class EventEmitter<Events extends EventMap> {\n  #listenerMap: {\n    [Key in keyof Events]?: EventListener<Events[Key]>[];\n  } = {};\n\n  addListener<Type extends keyof Events>(\n    type: Type,\n    listener: EventListener<Events[Type]>\n  ) {\n    const listeners = this.#listenerMap[type];\n    if (listeners === undefined) {\n      this.#listenerMap[type] = [listener];\n    } else {\n      if (!listeners.includes(listener)) {\n        listeners.push(listener);\n      }\n    }\n\n    return () => {\n      this.removeListener(type, listener);\n    };\n  }\n\n  emit<Type extends keyof Events>(type: Type, data: Events[Type]) {\n    const listeners = this.#listenerMap[type];\n    if (listeners !== undefined) {\n      if (listeners.length === 1) {\n        const listener = listeners[0];\n        listener.call(null, data);\n      } else {\n        let didThrow = false;\n        let caughtError = null;\n\n        // Clone the current listeners before calling\n        // in case calling triggers listeners to be added or removed\n        const clonedListeners = Array.from(listeners);\n        for (let i = 0; i < clonedListeners.length; i++) {\n          const listener = clonedListeners[i];\n          try {\n            listener.call(null, data);\n          } catch (error) {\n            if (caughtError === null) {\n              didThrow = true;\n              caughtError = error;\n            }\n          }\n        }\n\n        if (didThrow) {\n          throw caughtError;\n        }\n      }\n    }\n  }\n\n  removeAllListeners() {\n    this.#listenerMap = {};\n  }\n\n  removeListener<Type extends keyof Events>(\n    type: Type,\n    listener: EventListener<Events[Type]>\n  ) {\n    const listeners = this.#listenerMap[type];\n    if (listeners !== undefined) {\n      const index = listeners.indexOf(listener);\n      if (index >= 0) {\n        listeners.splice(index, 1);\n      }\n    }\n  }\n}\n","import { formatLayoutNumber } from \"./formatLayoutNumber\";\n\nexport function layoutNumbersEqual(\n  actual: number,\n  expected: number,\n  minimumDelta = 0\n) {\n  return (\n    Math.abs(formatLayoutNumber(actual) - formatLayoutNumber(expected)) <=\n    minimumDelta\n  );\n}\n","import type { Layout, RegisteredGroup } from \"../components/group/types\";\nimport type {\n  PanelConstraints,\n  RegisteredPanel\n} from \"../components/panel/types\";\nimport type { RegisteredSeparator } from \"../components/separator/types\";\nimport { EventEmitter } from \"../utils/EventEmitter\";\nimport type { InteractionState } from \"./types\";\nimport { layoutNumbersEqual } from \"./utils/layoutNumbersEqual\";\n\ntype UpdaterFunction = (prevState: State) => Partial<State>;\n\nexport type SeparatorToPanelsMap = Map<\n  RegisteredSeparator,\n  [primaryPanel: RegisteredPanel, secondaryPanel: RegisteredPanel]\n>;\n\nexport type MountedGroupMap = Map<\n  RegisteredGroup,\n  {\n    defaultLayoutDeferred: boolean;\n    derivedPanelConstraints: PanelConstraints[];\n    layout: Layout;\n    separatorToPanels: SeparatorToPanelsMap;\n  }\n>;\n\ntype Events = {\n  cursorFlagsChange: number;\n  interactionStateChange: InteractionState;\n  mountedGroupsChange: MountedGroupMap;\n};\n\ntype State = {\n  cursorFlags: number;\n  interactionState: InteractionState;\n  mountedGroups: MountedGroupMap;\n};\n\nlet state: State = {\n  cursorFlags: 0,\n  interactionState: {\n    state: \"inactive\"\n  },\n  mountedGroups: new Map()\n};\n\nexport const eventEmitter = new EventEmitter<Events>();\n\nexport function read(): State {\n  return state;\n}\n\nexport function update(value: Partial<State> | UpdaterFunction) {\n  const partialState = typeof value === \"function\" ? value(state) : value;\n  if (state === partialState) {\n    return state;\n  }\n\n  const prevState = state;\n\n  state = {\n    ...state,\n    ...partialState\n  };\n\n  if (partialState.cursorFlags !== undefined) {\n    eventEmitter.emit(\"cursorFlagsChange\", state.cursorFlags);\n  }\n\n  if (partialState.interactionState !== undefined) {\n    eventEmitter.emit(\"interactionStateChange\", state.interactionState);\n  }\n\n  if (partialState.mountedGroups !== undefined) {\n    // If any collapsible Panels have been collapsed by this size change, record their previous sizes\n    state.mountedGroups.forEach((value, group) => {\n      value.derivedPanelConstraints.forEach((constraints) => {\n        if (constraints.collapsible) {\n          const { layout: prevLayout } =\n            prevState.mountedGroups.get(group) ?? {};\n          if (prevLayout) {\n            const isCollapsed = layoutNumbersEqual(\n              constraints.collapsedSize,\n              value.layout[constraints.panelId]\n            );\n            const wasCollapsed = layoutNumbersEqual(\n              constraints.collapsedSize,\n              prevLayout[constraints.panelId]\n            );\n            if (isCollapsed && !wasCollapsed) {\n              group.inMemoryLastExpandedPanelSizes[constraints.panelId] =\n                prevLayout[constraints.panelId];\n            }\n          }\n        }\n      });\n    });\n\n    eventEmitter.emit(\"mountedGroupsChange\", state.mountedGroups);\n  }\n\n  return state;\n}\n","export function isArrayEqual(a: number[], b: number[]) {\n  if (a.length !== b.length) {\n    return false;\n  } else {\n    for (let index = 0; index < a.length; index++) {\n      if (a[index] != b[index]) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n","import { layoutNumbersEqual } from \"./layoutNumbersEqual\";\n\nexport function compareLayoutNumbers(actual: number, expected: number) {\n  if (layoutNumbersEqual(actual, expected)) {\n    return 0;\n  } else {\n    return actual > expected ? 1 : -1;\n  }\n}\n","import type { PanelConstraints } from \"../../components/panel/types\";\nimport { compareLayoutNumbers } from \"./compareLayoutNumbers\";\nimport { formatLayoutNumber } from \"./formatLayoutNumber\";\n\n// Panel size must be in percentages; pixel values should be pre-converted\nexport function validatePanelSize({\n  panelConstraints,\n  size\n}: {\n  panelConstraints: PanelConstraints;\n  size: number;\n}) {\n  const {\n    collapsedSize = 0,\n    collapsible,\n    maxSize = 100,\n    minSize = 0\n  } = panelConstraints;\n\n  if (compareLayoutNumbers(size, minSize) < 0) {\n    if (collapsible) {\n      // Collapsible panels should snap closed or open only once they cross the halfway point between collapsed and min size.\n      const halfwayPoint = (collapsedSize + minSize) / 2;\n      if (compareLayoutNumbers(size, halfwayPoint) < 0) {\n        size = collapsedSize;\n      } else {\n        size = minSize;\n      }\n    } else {\n      size = minSize;\n    }\n  }\n\n  size = Math.min(maxSize, size);\n  size = formatLayoutNumber(size);\n\n  return size;\n}\n","import type { Layout } from \"../../components/group/types\";\nimport type { PanelConstraints } from \"../../components/panel/types\";\nimport { assert } from \"../../utils/assert\";\nimport { isArrayEqual } from \"../../utils/isArrayEqual\";\nimport { compareLayoutNumbers } from \"../utils/compareLayoutNumbers\";\nimport { layoutNumbersEqual } from \"../utils/layoutNumbersEqual\";\nimport { validatePanelSize } from \"../utils/validatePanelSize\";\n\n// All units must be in percentages; pixel values should be pre-converted\nexport function adjustLayoutByDelta({\n  delta,\n  initialLayout: initialLayoutProp,\n  panelConstraints: panelConstraintsArray,\n  pivotIndices,\n  prevLayout: prevLayoutProp,\n  trigger\n}: {\n  delta: number;\n  initialLayout: Layout;\n  panelConstraints: PanelConstraints[];\n  pivotIndices: number[];\n  prevLayout: Layout;\n  trigger: \"imperative-api\" | \"keyboard\" | \"mouse-or-touch\";\n}): Layout {\n  if (layoutNumbersEqual(delta, 0)) {\n    return initialLayoutProp;\n  }\n\n  const initialLayout = Object.values(initialLayoutProp);\n  const prevLayout = Object.values(prevLayoutProp);\n  const nextLayout = [...initialLayout];\n\n  const [firstPivotIndex, secondPivotIndex] = pivotIndices;\n  assert(firstPivotIndex != null, \"Invalid first pivot index\");\n  assert(secondPivotIndex != null, \"Invalid second pivot index\");\n\n  let deltaApplied = 0;\n\n  // const DEBUG = [];\n  // DEBUG.push(`adjustLayoutByDelta()`);\n  // DEBUG.push(`  initialLayout: ${initialLayout.join(\", \")}`);\n  // DEBUG.push(`  prevLayout: ${prevLayout.join(\", \")}`);\n  // DEBUG.push(`  delta: ${delta}`);\n  // DEBUG.push(`  pivotIndices: ${pivotIndices.join(\", \")}`);\n  // DEBUG.push(`  trigger: ${trigger}`);\n  // DEBUG.push(\"\");\n\n  // A resizing panel affects the panels before or after it.\n  //\n  // A negative delta means the panel(s) immediately after the separator should grow/expand by decreasing its offset.\n  // Other panels may also need to shrink/contract (and shift) to make room, depending on the min weights.\n  //\n  // A positive delta means the panel(s) immediately before the separator should \"expand\".\n  // This is accomplished by shrinking/contracting (and shifting) one or more of the panels after the separator.\n\n  {\n    // If this is a resize triggered by a keyboard event, our logic for expanding/collapsing is different.\n    // We no longer check the halfway threshold because this may prevent the panel from expanding at all.\n    if (trigger === \"keyboard\") {\n      {\n        // Check if we should expand a collapsed panel\n        const index = delta < 0 ? secondPivotIndex : firstPivotIndex;\n        const panelConstraints = panelConstraintsArray[index];\n        assert(\n          panelConstraints,\n          `Panel constraints not found for index ${index}`\n        );\n\n        const {\n          collapsedSize = 0,\n          collapsible,\n          minSize = 0\n        } = panelConstraints;\n\n        // DEBUG.push(`edge case check 1: ${index}`);\n        // DEBUG.push(`  -> collapsible? ${collapsible}`);\n        if (collapsible) {\n          const prevSize = initialLayout[index];\n          assert(\n            prevSize != null,\n            `Previous layout not found for panel index ${index}`\n          );\n\n          if (layoutNumbersEqual(prevSize, collapsedSize)) {\n            const localDelta = minSize - prevSize;\n            // DEBUG.push(`  -> expand delta: ${localDelta}`);\n\n            if (compareLayoutNumbers(localDelta, Math.abs(delta)) > 0) {\n              delta = delta < 0 ? 0 - localDelta : localDelta;\n              // DEBUG.push(`  -> delta: ${delta}`);\n            }\n          }\n        }\n      }\n\n      {\n        // Check if we should collapse a panel at its minimum size\n        const index = delta < 0 ? firstPivotIndex : secondPivotIndex;\n        const panelConstraints = panelConstraintsArray[index];\n        assert(\n          panelConstraints,\n          `No panel constraints found for index ${index}`\n        );\n\n        const {\n          collapsedSize = 0,\n          collapsible,\n          minSize = 0\n        } = panelConstraints;\n\n        // DEBUG.push(`edge case check 2: ${index}`);\n        // DEBUG.push(`  -> collapsible? ${collapsible}`);\n        if (collapsible) {\n          const prevSize = initialLayout[index];\n          assert(\n            prevSize != null,\n            `Previous layout not found for panel index ${index}`\n          );\n\n          if (layoutNumbersEqual(prevSize, minSize)) {\n            const localDelta = prevSize - collapsedSize;\n            // DEBUG.push(`  -> expand delta: ${localDelta}`);\n\n            if (compareLayoutNumbers(localDelta, Math.abs(delta)) > 0) {\n              delta = delta < 0 ? 0 - localDelta : localDelta;\n              // DEBUG.push(`  -> delta: ${delta}`);\n            }\n          }\n        }\n      }\n    }\n    // DEBUG.push(\"\");\n  }\n\n  {\n    // Pre-calculate max available delta in the opposite direction of our pivot.\n    // This will be the maximum amount we're allowed to expand/contract the panels in the primary direction.\n    // If this amount is less than the requested delta, adjust the requested delta.\n    // If this amount is greater than the requested delta, that's useful information tooâ€“\n    // as an expanding panel might change from collapsed to min size.\n\n    const increment = delta < 0 ? 1 : -1;\n\n    let index = delta < 0 ? secondPivotIndex : firstPivotIndex;\n    let maxAvailableDelta = 0;\n\n    // DEBUG.push(\"pre calc...\");\n    while (true) {\n      const prevSize = initialLayout[index];\n      assert(\n        prevSize != null,\n        `Previous layout not found for panel index ${index}`\n      );\n\n      const maxSafeSize = validatePanelSize({\n        panelConstraints: panelConstraintsArray[index],\n        size: 100\n      });\n      const delta = maxSafeSize - prevSize;\n      // DEBUG.push(`  ${index}: ${prevSize} -> ${maxSafeSize}`);\n\n      maxAvailableDelta += delta;\n      index += increment;\n\n      if (index < 0 || index >= panelConstraintsArray.length) {\n        break;\n      }\n    }\n\n    // DEBUG.push(`  -> max available delta: ${maxAvailableDelta}`);\n    const minAbsDelta = Math.min(Math.abs(delta), Math.abs(maxAvailableDelta));\n    delta = delta < 0 ? 0 - minAbsDelta : minAbsDelta;\n    // DEBUG.push(`  -> adjusted delta: ${delta}`);\n    // DEBUG.push(\"\");\n  }\n\n  {\n    // Delta added to a panel needs to be subtracted from other panels (within the constraints that those panels allow).\n\n    const pivotIndex = delta < 0 ? firstPivotIndex : secondPivotIndex;\n    let index = pivotIndex;\n    while (index >= 0 && index < panelConstraintsArray.length) {\n      const deltaRemaining = Math.abs(delta) - Math.abs(deltaApplied);\n\n      const prevSize = initialLayout[index];\n      assert(\n        prevSize != null,\n        `Previous layout not found for panel index ${index}`\n      );\n\n      const unsafeSize = prevSize - deltaRemaining;\n      const safeSize = validatePanelSize({\n        panelConstraints: panelConstraintsArray[index],\n        size: unsafeSize\n      });\n\n      if (!layoutNumbersEqual(prevSize, safeSize)) {\n        deltaApplied += prevSize - safeSize;\n\n        nextLayout[index] = safeSize;\n\n        if (\n          deltaApplied\n            .toFixed(3)\n            .localeCompare(Math.abs(delta).toFixed(3), undefined, {\n              numeric: true\n            }) >= 0\n        ) {\n          break;\n        }\n      }\n\n      if (delta < 0) {\n        index--;\n      } else {\n        index++;\n      }\n    }\n  }\n  // DEBUG.push(`after 1: ${nextLayout.join(\", \")}`);\n  // DEBUG.push(`  deltaApplied: ${deltaApplied}`);\n  // DEBUG.push(\"\");\n\n  // If we were unable to resize any of the panels panels, return the previous state.\n  // This will essentially bailout and ignore e.g. drags past a panel's boundaries\n  if (isArrayEqual(prevLayout, nextLayout)) {\n    // DEBUG.push(`bailout to previous layout: ${prevLayout.join(\", \")}`);\n    // console.log(DEBUG.join(\"\\n\"));\n\n    return prevLayoutProp;\n  }\n\n  {\n    // Now distribute the applied delta to the panels in the other direction\n    const pivotIndex = delta < 0 ? secondPivotIndex : firstPivotIndex;\n\n    const prevSize = initialLayout[pivotIndex];\n    assert(\n      prevSize != null,\n      `Previous layout not found for panel index ${pivotIndex}`\n    );\n\n    const unsafeSize = prevSize + deltaApplied;\n    const safeSize = validatePanelSize({\n      panelConstraints: panelConstraintsArray[pivotIndex],\n      size: unsafeSize\n    });\n\n    // Adjust the pivot panel before, but only by the amount that surrounding panels were able to shrink/contract.\n    nextLayout[pivotIndex] = safeSize;\n\n    // Edge case where expanding or contracting one panel caused another one to change collapsed state\n    if (!layoutNumbersEqual(safeSize, unsafeSize)) {\n      let deltaRemaining = unsafeSize - safeSize;\n\n      const pivotIndex = delta < 0 ? secondPivotIndex : firstPivotIndex;\n      let index = pivotIndex;\n      while (index >= 0 && index < panelConstraintsArray.length) {\n        const prevSize = nextLayout[index];\n        assert(\n          prevSize != null,\n          `Previous layout not found for panel index ${index}`\n        );\n\n        const unsafeSize = prevSize + deltaRemaining;\n        const safeSize = validatePanelSize({\n          panelConstraints: panelConstraintsArray[index],\n          size: unsafeSize\n        });\n\n        if (!layoutNumbersEqual(prevSize, safeSize)) {\n          deltaRemaining -= safeSize - prevSize;\n\n          nextLayout[index] = safeSize;\n        }\n\n        if (layoutNumbersEqual(deltaRemaining, 0)) {\n          break;\n        }\n\n        if (delta > 0) {\n          index--;\n        } else {\n          index++;\n        }\n      }\n    }\n  }\n  // DEBUG.push(`after 2: ${nextLayout.join(\", \")}`);\n  // DEBUG.push(`  deltaApplied: ${deltaApplied}`);\n  // DEBUG.push(\"\");\n\n  const totalSize = Object.values(nextLayout).reduce(\n    (total, size) => size + total,\n    0\n  );\n  // DEBUG.push(`total size: ${totalSize}`);\n\n  // If our new layout doesn't add up to 100%, that means the requested delta can't be applied\n  // In that case, fall back to our most recent valid layout\n  // Allow for a small rounding difference, else e.g. 3 panel layouts may never be considered valid\n  if (!layoutNumbersEqual(totalSize, 100, 0.1)) {\n    // DEBUG.push(`bailout to previous layout: ${prevLayout.join(\", \")}`);\n    // console.log(DEBUG.join(\"\\n\"));\n\n    return prevLayoutProp;\n  }\n\n  const prevLayoutKeys = Object.keys(prevLayoutProp);\n\n  // console.log(DEBUG.join(\"\\n\"));\n  return nextLayout.reduce<Layout>((accumulated, current, index) => {\n    accumulated[prevLayoutKeys[index]] = current;\n    return accumulated;\n  }, {});\n}\n","import { assert } from \"../../utils/assert\";\nimport { read } from \"../mutableState\";\n\nexport function findSeparatorGroup(separatorElement: HTMLElement) {\n  const groupElement = separatorElement.parentElement;\n  assert(groupElement, \"Parent group element not found\");\n\n  const { mountedGroups } = read();\n\n  for (const [group] of mountedGroups) {\n    if (group.element === groupElement) {\n      return group;\n    }\n  }\n\n  throw Error(\"Could not find parent Group for separator element\");\n}\n","import type { Layout } from \"../../components/group/types\";\nimport { compareLayoutNumbers } from \"./compareLayoutNumbers\";\n\nexport function layoutsEqual(a: Layout, b: Layout): boolean {\n  if (Object.keys(a).length !== Object.keys(b).length) {\n    return false;\n  }\n\n  for (const id in a) {\n    // Edge case: Panel id has been changed\n    if (b[id] === undefined || compareLayoutNumbers(a[id], b[id]) !== 0) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import type { Layout } from \"../../components/group/types\";\nimport type { PanelConstraints } from \"../../components/panel/types\";\nimport { assert } from \"../../utils/assert\";\nimport { layoutNumbersEqual } from \"./layoutNumbersEqual\";\nimport { validatePanelSize } from \"./validatePanelSize\";\n\n// All units must be in percentages; pixel values should be pre-converted\nexport function validatePanelGroupLayout({\n  layout,\n  panelConstraints\n}: {\n  layout: Layout;\n  panelConstraints: PanelConstraints[];\n}): Layout {\n  const prevLayout = Object.values(layout);\n  const nextLayout = [...prevLayout];\n\n  const nextLayoutTotalSize = nextLayout.reduce(\n    (accumulated, current) => accumulated + current,\n    0\n  );\n\n  // Validate layout expectations\n  if (nextLayout.length !== panelConstraints.length) {\n    throw Error(\n      `Invalid ${panelConstraints.length} panel layout: ${nextLayout\n        .map((size) => `${size}%`)\n        .join(\", \")}`\n    );\n  } else if (\n    !layoutNumbersEqual(nextLayoutTotalSize, 100) &&\n    nextLayout.length > 0\n  ) {\n    for (let index = 0; index < panelConstraints.length; index++) {\n      const unsafeSize = nextLayout[index];\n      assert(unsafeSize != null, `No layout data found for index ${index}`);\n      const safeSize = (100 / nextLayoutTotalSize) * unsafeSize;\n      nextLayout[index] = safeSize;\n    }\n  }\n\n  let remainingSize = 0;\n\n  // First pass: Validate the proposed layout given each panel's constraints\n  for (let index = 0; index < panelConstraints.length; index++) {\n    const unsafeSize = nextLayout[index];\n    assert(unsafeSize != null, `No layout data found for index ${index}`);\n\n    const safeSize = validatePanelSize({\n      panelConstraints: panelConstraints[index],\n      size: unsafeSize\n    });\n\n    if (unsafeSize != safeSize) {\n      remainingSize += unsafeSize - safeSize;\n\n      nextLayout[index] = safeSize;\n    }\n  }\n\n  // If there is additional, left over space, assign it to any panel(s) that permits it\n  // (It's not worth taking multiple additional passes to evenly distribute)\n  if (!layoutNumbersEqual(remainingSize, 0)) {\n    for (let index = 0; index < panelConstraints.length; index++) {\n      const prevSize = nextLayout[index];\n      assert(prevSize != null, `No layout data found for index ${index}`);\n      const unsafeSize = prevSize + remainingSize;\n      const safeSize = validatePanelSize({\n        panelConstraints: panelConstraints[index],\n        size: unsafeSize\n      });\n\n      if (prevSize !== safeSize) {\n        remainingSize -= safeSize - prevSize;\n        nextLayout[index] = safeSize;\n\n        // Once we've used up the remainder, bail\n        if (layoutNumbersEqual(remainingSize, 0)) {\n          break;\n        }\n      }\n    }\n  }\n\n  const prevLayoutKeys = Object.keys(layout);\n\n  return nextLayout.reduce<Layout>((accumulated, current, index) => {\n    accumulated[prevLayoutKeys[index]] = current;\n    return accumulated;\n  }, {});\n}\n","import type {\n  GroupImperativeHandle,\n  Layout\n} from \"../../components/group/types\";\nimport { read, update } from \"../mutableState\";\nimport { layoutsEqual } from \"./layoutsEqual\";\nimport { validatePanelGroupLayout } from \"./validatePanelGroupLayout\";\n\nexport function getImperativeGroupMethods({\n  groupId\n}: {\n  groupId: string;\n}): GroupImperativeHandle {\n  const find = () => {\n    const { mountedGroups } = read();\n    for (const [group, value] of mountedGroups) {\n      if (group.id === groupId) {\n        return { group, ...value };\n      }\n    }\n\n    throw Error(`Could not find Group with id \"${groupId}\"`);\n  };\n\n  return {\n    getLayout() {\n      const { defaultLayoutDeferred, layout } = find();\n\n      if (defaultLayoutDeferred) {\n        // This indicates that the Group has not finished mounting yet\n        // Likely because it has been rendered inside of a hidden DOM subtree\n        // Any layout value will not have been validated and so it should not be returned\n        return {};\n      }\n\n      return layout;\n    },\n    setLayout(unsafeLayout: Layout) {\n      const {\n        defaultLayoutDeferred,\n        derivedPanelConstraints,\n        group,\n        layout: prevLayout,\n        separatorToPanels\n      } = find();\n\n      const nextLayout = validatePanelGroupLayout({\n        layout: unsafeLayout,\n        panelConstraints: derivedPanelConstraints\n      });\n\n      if (defaultLayoutDeferred) {\n        // This indicates that the Group has not finished mounting yet\n        // Likely because it has been rendered inside of a hidden DOM subtree\n        // In this case we cannot fully validate the layout, so we shouldn't apply it\n        // It's okay to run the validate function above though,\n        // it will still warn about certain types of errors (e.g. wrong number of panels)\n        return prevLayout;\n      }\n\n      if (!layoutsEqual(prevLayout, nextLayout)) {\n        update((prevState) => ({\n          mountedGroups: new Map(prevState.mountedGroups).set(group, {\n            defaultLayoutDeferred,\n            derivedPanelConstraints,\n            layout: nextLayout,\n            separatorToPanels\n          })\n        }));\n      }\n\n      return nextLayout;\n    }\n  };\n}\n","import type { RegisteredGroup } from \"../../components/group/types\";\nimport { assert } from \"../../utils/assert\";\nimport { read } from \"../mutableState\";\n\nexport function getMountedGroup(group: RegisteredGroup) {\n  const { mountedGroups } = read();\n\n  const mountedGroup = mountedGroups.get(group);\n  assert(mountedGroup, `Mounted Group ${group.id} not found`);\n\n  return mountedGroup;\n}\n","import { assert } from \"../../utils/assert\";\nimport { update } from \"../mutableState\";\nimport { adjustLayoutByDelta } from \"./adjustLayoutByDelta\";\nimport { findSeparatorGroup } from \"./findSeparatorGroup\";\nimport { getImperativeGroupMethods } from \"./getImperativeGroupMethods\";\nimport { getMountedGroup } from \"./getMountedGroup\";\nimport { layoutsEqual } from \"./layoutsEqual\";\nimport { validatePanelGroupLayout } from \"./validatePanelGroupLayout\";\n\nexport function adjustLayoutForSeparator(\n  separatorElement: HTMLElement,\n  delta: number\n) {\n  const group = findSeparatorGroup(separatorElement);\n  const mountedGroup = getMountedGroup(group);\n\n  const separator = group.separators.find(\n    (current) => current.element === separatorElement\n  );\n  assert(separator, \"Matching separator not found\");\n\n  const panels = mountedGroup.separatorToPanels.get(separator);\n  assert(panels, \"Matching panels not found\");\n\n  const pivotIndices = panels.map((panel) => group.panels.indexOf(panel));\n\n  const groupAPI = getImperativeGroupMethods({ groupId: group.id });\n  const prevLayout = groupAPI.getLayout();\n\n  const unsafeLayout = adjustLayoutByDelta({\n    delta,\n    initialLayout: prevLayout,\n    panelConstraints: mountedGroup.derivedPanelConstraints,\n    pivotIndices,\n    prevLayout,\n    trigger: \"keyboard\"\n  });\n  const nextLayout = validatePanelGroupLayout({\n    layout: unsafeLayout,\n    panelConstraints: mountedGroup.derivedPanelConstraints\n  });\n\n  if (!layoutsEqual(prevLayout, nextLayout)) {\n    update((prevState) => ({\n      mountedGroups: new Map(prevState.mountedGroups).set(group, {\n        defaultLayoutDeferred: mountedGroup.defaultLayoutDeferred,\n        derivedPanelConstraints: mountedGroup.derivedPanelConstraints,\n        layout: nextLayout,\n        separatorToPanels: mountedGroup.separatorToPanels\n      })\n    }));\n  }\n}\n","import { assert } from \"../../utils/assert\";\nimport { adjustLayoutForSeparator } from \"../utils/adjustLayoutForSeparator\";\nimport { findSeparatorGroup } from \"../utils/findSeparatorGroup\";\nimport { getMountedGroup } from \"../utils/getMountedGroup\";\n\nexport function onDocumentKeyDown(event: KeyboardEvent) {\n  if (event.defaultPrevented) {\n    return;\n  }\n\n  const separatorElement = event.currentTarget as HTMLElement;\n\n  const group = findSeparatorGroup(separatorElement);\n  if (group.disabled) {\n    return;\n  }\n\n  switch (event.key) {\n    case \"ArrowDown\": {\n      event.preventDefault();\n\n      if (group.orientation === \"vertical\") {\n        adjustLayoutForSeparator(separatorElement, 5);\n      }\n      break;\n    }\n    case \"ArrowLeft\": {\n      event.preventDefault();\n\n      if (group.orientation === \"horizontal\") {\n        adjustLayoutForSeparator(separatorElement, -5);\n      }\n      break;\n    }\n    case \"ArrowRight\": {\n      event.preventDefault();\n\n      if (group.orientation === \"horizontal\") {\n        adjustLayoutForSeparator(separatorElement, 5);\n      }\n      break;\n    }\n    case \"ArrowUp\": {\n      event.preventDefault();\n\n      if (group.orientation === \"vertical\") {\n        adjustLayoutForSeparator(separatorElement, -5);\n      }\n      break;\n    }\n    case \"End\": {\n      event.preventDefault();\n\n      // Moves splitter to the position that gives the primary pane its largest allowed size.\n      // This may completely collapse the secondary pane.\n\n      adjustLayoutForSeparator(separatorElement, 100);\n      break;\n    }\n    case \"Enter\": {\n      event.preventDefault();\n\n      // If the primary pane is not collapsed, collapses the pane.\n      // If the pane is collapsed, restores the splitter to its previous position.\n\n      const group = findSeparatorGroup(separatorElement);\n      const { derivedPanelConstraints, layout, separatorToPanels } =\n        getMountedGroup(group);\n\n      const separator = group.separators.find(\n        (current) => current.element === separatorElement\n      );\n      assert(separator, \"Matching separator not found\");\n\n      const panels = separatorToPanels.get(separator);\n      assert(panels, \"Matching panels not found\");\n\n      const primaryPanel = panels[0];\n      const constraints = derivedPanelConstraints.find(\n        (current) => current.panelId === primaryPanel.id\n      );\n      assert(constraints, \"Panel metadata not found\");\n\n      if (constraints.collapsible) {\n        const prevSize = layout[primaryPanel.id];\n\n        const nextSize =\n          constraints.collapsedSize === prevSize\n            ? (group.inMemoryLastExpandedPanelSizes[primaryPanel.id] ??\n              constraints.minSize)\n            : constraints.collapsedSize;\n\n        adjustLayoutForSeparator(separatorElement, nextSize - prevSize);\n      }\n      break;\n    }\n    case \"F6\": {\n      event.preventDefault();\n\n      // Cycle through window panes.\n\n      const group = findSeparatorGroup(separatorElement);\n\n      const separatorElements = group.separators.map(\n        (separator) => separator.element\n      );\n\n      const index = Array.from(separatorElements).findIndex(\n        (current) => current === event.currentTarget\n      );\n      assert(index !== null, \"Index not found\");\n\n      const nextIndex = event.shiftKey\n        ? index > 0\n          ? index - 1\n          : separatorElements.length - 1\n        : index + 1 < separatorElements.length\n          ? index + 1\n          : 0;\n\n      const nextSeparatorElement = separatorElements[nextIndex] as HTMLElement;\n      nextSeparatorElement.focus();\n      break;\n    }\n    case \"Home\": {\n      event.preventDefault();\n\n      // Moves splitter to the position that gives the primary pane its smallest allowed size.\n      // This may completely collapse the primary pane.\n\n      adjustLayoutForSeparator(separatorElement, -100);\n      break;\n    }\n  }\n}\n","// Constants used for memoization\nexport const EMPTY_ARRAY: unknown[] = [];\nexport const EMPTY_DOM_RECT: DOMRectReadOnly = {\n  bottom: 0,\n  height: 0,\n  left: 0,\n  right: 0,\n  toJSON: () => {},\n  top: 0,\n  width: 0,\n  x: 0,\n  y: 0\n};\nexport const EMPTY_OBJECT = {};\nexport const EMPTY_POINT = { x: 0, y: 0 };\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const IDENTITY_FUNCTION = (value: any) => value;\nexport const NOOP_FUNCTION = () => {};\n\n// Cursor flags\nexport const CURSOR_FLAG_HORIZONTAL_MIN = 0b0001;\nexport const CURSOR_FLAG_HORIZONTAL_MAX = 0b0010;\nexport const CURSOR_FLAG_VERTICAL_MIN = 0b0100;\nexport const CURSOR_FLAG_VERTICAL_MAX = 0b1000;\n\n// Misc. shared values\nexport const DEFAULT_POINTER_PRECISION = {\n  coarse: 10,\n  precise: 5\n};\n","import type { Orientation } from \"../../components/group/types\";\nimport type { Point } from \"../../types\";\nimport type { HitRegion } from \"../dom/calculateHitRegions\";\nimport { getDistanceBetweenPointAndRect } from \"./getDistanceBetweenPointAndRect\";\n\nexport function findClosetHitRegion(\n  orientation: Orientation,\n  hitRegions: HitRegion[],\n  point: Point\n) {\n  let closestHitRegion: HitRegion | undefined = undefined;\n  let minDistance = {\n    x: Infinity,\n    y: Infinity\n  };\n\n  for (const hitRegion of hitRegions) {\n    const data = getDistanceBetweenPointAndRect(point, hitRegion.rect);\n    switch (orientation) {\n      case \"horizontal\": {\n        if (data.x <= minDistance.x) {\n          closestHitRegion = hitRegion;\n          minDistance = data;\n        }\n        break;\n      }\n      case \"vertical\": {\n        if (data.y <= minDistance.y) {\n          closestHitRegion = hitRegion;\n          minDistance = data;\n        }\n        break;\n      }\n    }\n  }\n\n  return closestHitRegion\n    ? {\n        distance: minDistance,\n        hitRegion: closestHitRegion\n      }\n    : undefined;\n}\n","let cached: boolean | undefined = undefined;\n\nexport function isCoarsePointer(): boolean {\n  if (cached === undefined) {\n    if (typeof matchMedia === \"function\") {\n      cached = !!matchMedia(\"(pointer:coarse)\").matches;\n    } else {\n      cached = false;\n    }\n  }\n\n  return cached;\n}\n","// Detects ShadowRoot without requiring instanceof and browser globals\nexport function isShadowRoot(value: unknown): value is ShadowRoot {\n  return (\n    value !== null &&\n    typeof value === \"object\" &&\n    \"nodeType\" in value &&\n    value.nodeType === Node.DOCUMENT_FRAGMENT_NODE\n  );\n}\n","// Forked from NPM stacking-order@2.0.0\n// - github.com/Rich-Harris/stacking-order/issues/3\n// - github.com/Rich-Harris/stacking-order/issues/6\n\nimport { assert } from \"../utils/assert\";\nimport { isShadowRoot } from \"../utils/isShadowRoot\";\n\n/**\n * Determine which of two nodes appears in front of the other â€”\n * if `a` is in front, returns 1, otherwise returns -1\n * @param {HTMLElement | SVGElement} a\n * @param {HTMLElement | SVGElement} b\n */\nexport function compare(\n  a: HTMLElement | SVGElement,\n  b: HTMLElement | SVGElement\n): number {\n  if (a === b) throw new Error(\"Cannot compare node with itself\");\n\n  const ancestors = {\n    a: get_ancestors(a),\n    b: get_ancestors(b)\n  };\n\n  let common_ancestor;\n\n  // remove shared ancestors\n  while (ancestors.a.at(-1) === ancestors.b.at(-1)) {\n    a = ancestors.a.pop() as HTMLElement;\n    b = ancestors.b.pop() as HTMLElement;\n\n    common_ancestor = a;\n  }\n\n  assert(\n    common_ancestor,\n    \"Stacking order can only be calculated for elements with a common ancestor\"\n  );\n\n  const z_indexes = {\n    a: get_z_index(find_stacking_context(ancestors.a)),\n    b: get_z_index(find_stacking_context(ancestors.b))\n  };\n\n  if (z_indexes.a === z_indexes.b) {\n    const children = common_ancestor.childNodes;\n\n    const furthest_ancestors = {\n      a: ancestors.a.at(-1),\n      b: ancestors.b.at(-1)\n    };\n\n    let i = children.length;\n    while (i--) {\n      const child = children[i];\n      if (child === furthest_ancestors.a) return 1;\n      if (child === furthest_ancestors.b) return -1;\n    }\n  }\n\n  return Math.sign(z_indexes.a - z_indexes.b);\n}\n\nconst props =\n  /\\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\\b/;\n\n/** @param {HTMLElement | SVGElement} node */\nfunction is_flex_item(node: HTMLElement | SVGElement) {\n  // @ts-expect-error ParentNode vs Element\n  const display = getComputedStyle(get_parent(node) ?? node).display;\n  return display === \"flex\" || display === \"inline-flex\";\n}\n\n/** @param {HTMLElement | SVGElement} node */\nfunction creates_stacking_context(node: HTMLElement | SVGElement) {\n  const style = getComputedStyle(node);\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context\n  if (style.position === \"fixed\") return true;\n  // Forked to fix upstream bug https://github.com/Rich-Harris/stacking-order/issues/3\n  // if (\n  //   (style.zIndex !== \"auto\" && style.position !== \"static\") ||\n  //   is_flex_item(node)\n  // )\n  if (\n    style.zIndex !== \"auto\" &&\n    (style.position !== \"static\" || is_flex_item(node))\n  )\n    return true;\n  if (+style.opacity < 1) return true;\n  if (\"transform\" in style && style.transform !== \"none\") return true;\n  if (\"webkitTransform\" in style && style.webkitTransform !== \"none\")\n    return true;\n  if (\"mixBlendMode\" in style && style.mixBlendMode !== \"normal\") return true;\n  if (\"filter\" in style && style.filter !== \"none\") return true;\n  if (\"webkitFilter\" in style && style.webkitFilter !== \"none\") return true;\n  if (\"isolation\" in style && style.isolation === \"isolate\") return true;\n  if (props.test(style.willChange)) return true;\n  // @ts-expect-error Unrecognized prop\n  if (style.webkitOverflowScrolling === \"touch\") return true;\n\n  return false;\n}\n\n/** @param {(HTMLElement| SVGElement)[]} nodes */\nfunction find_stacking_context(nodes: (HTMLElement | SVGElement)[]) {\n  let i = nodes.length;\n\n  while (i--) {\n    const node = nodes[i];\n    assert(node, \"Missing node\");\n    if (creates_stacking_context(node)) return node;\n  }\n\n  return null;\n}\n\n/** @param {HTMLElement | SVGElement} node */\nfunction get_z_index(node: HTMLElement | SVGElement | null) {\n  return (node && Number(getComputedStyle(node).zIndex)) || 0;\n}\n\n/** @param {HTMLElement} node */\nfunction get_ancestors(node: HTMLElement | SVGElement | null) {\n  const ancestors = [];\n\n  while (node) {\n    ancestors.push(node);\n    // @ts-expect-error ParentNode vs Element\n    node = get_parent(node);\n  }\n\n  return ancestors; // [ node, ... <body>, <html>, document ]\n}\n\n/** @param {HTMLElement} node */\nfunction get_parent(node: HTMLElement) {\n  const { parentNode } = node;\n  if (isShadowRoot(parentNode)) {\n    return parentNode.host;\n  }\n  return parentNode;\n}\n","import type { Rect } from \"../../types\";\n\nexport function doRectsIntersect(a: Rect, b: Rect): boolean {\n  return (\n    a.x < b.x + b.width &&\n    a.x + a.width > b.x &&\n    a.y < b.y + b.height &&\n    a.y + a.height > b.y\n  );\n}\n","import { isHTMLElement } from \"../../utils/isHTMLElement\";\nimport { compare } from \"../../vendor/stacking-order\";\nimport { doRectsIntersect } from \"./doRectsIntersect\";\n\n// This library adds pointer event handlers to the Window for two reasons:\n// 1. It allows detecting when the pointer is \"near\" to a panel border or separator element,\n//    (which can be particularly helpful on touch devices)\n// 2. It allows detecting pointer interactions that apply to multiple, nearby panels/separators\n//    (in the event of e.g. nested groups)\n//\n// Because events are handled at the Window, it's important to detect when another element is \"above\" a separator (e.g. a modal)\n// as this should prevent the separator element from being clicked.\n// This function does that determination.\nexport function isViableHitTarget({\n  groupElement,\n  hitRegion,\n  pointerEventTarget\n}: {\n  groupElement: HTMLElement;\n  hitRegion: DOMRect;\n  pointerEventTarget: EventTarget | null;\n}) {\n  if (\n    !isHTMLElement(pointerEventTarget) ||\n    pointerEventTarget.contains(groupElement) ||\n    groupElement.contains(pointerEventTarget)\n  ) {\n    // Calculating stacking order has a cost;\n    // If either group or element contain the other, the click is safe and we can skip calculating the indices\n    return true;\n  }\n\n  if (compare(pointerEventTarget, groupElement) > 0) {\n    // If the pointer target is above the separator, check for overlap\n    // If they are near each other, but not overlapping, then the separator is still a viable target\n    //\n    // Note that it's not sufficient to compare only the target\n    // The target might be a small element inside of a larger container\n    // (For example, a SPAN or a DIV inside of a larger modal dialog)\n    let currentElement: HTMLElement | SVGElement | null = pointerEventTarget;\n    while (currentElement) {\n      if (currentElement.contains(groupElement)) {\n        return true;\n      } else if (\n        doRectsIntersect(currentElement.getBoundingClientRect(), hitRegion)\n      ) {\n        return false;\n      }\n\n      currentElement = currentElement.parentElement;\n    }\n  }\n\n  return true;\n}\n","import { DEFAULT_POINTER_PRECISION } from \"../../constants\";\nimport type { MountedGroupMap } from \"../mutableState\";\nimport {\n  calculateHitRegions,\n  type HitRegion\n} from \"../dom/calculateHitRegions\";\nimport { findClosetHitRegion } from \"./findClosetHitRegion\";\nimport { isCoarsePointer } from \"./isCoarsePointer\";\nimport { isViableHitTarget } from \"./isViableHitTarget\";\n\nexport function findMatchingHitRegions(\n  event: PointerEvent,\n  mountedGroups: MountedGroupMap\n): HitRegion[] {\n  const matchingHitRegions: HitRegion[] = [];\n\n  mountedGroups.forEach((_, groupData) => {\n    if (groupData.disabled) {\n      return;\n    }\n\n    const maxDistance = isCoarsePointer()\n      ? DEFAULT_POINTER_PRECISION.coarse\n      : DEFAULT_POINTER_PRECISION.precise;\n\n    const hitRegions = calculateHitRegions(groupData);\n    const match = findClosetHitRegion(groupData.orientation, hitRegions, {\n      x: event.clientX,\n      y: event.clientY\n    });\n\n    if (\n      match &&\n      match.distance.x <= maxDistance &&\n      match.distance.y <= maxDistance &&\n      isViableHitTarget({\n        groupElement: groupData.element,\n        hitRegion: match.hitRegion.rect,\n        pointerEventTarget: event.target\n      })\n    ) {\n      matchingHitRegions.push(match.hitRegion);\n    }\n  });\n\n  return matchingHitRegions;\n}\n","import type { Layout, RegisteredGroup } from \"../../components/group/types\";\nimport type { RegisteredPanel } from \"../../components/panel/types\";\nimport type { RegisteredSeparator } from \"../../components/separator/types\";\nimport { read, update } from \"../mutableState\";\nimport { findMatchingHitRegions } from \"../utils/findMatchingHitRegions\";\n\nexport function onDocumentPointerDown(event: PointerEvent) {\n  if (event.defaultPrevented) {\n    return;\n  }\n\n  const { mountedGroups } = read();\n\n  const hitRegions = findMatchingHitRegions(event, mountedGroups);\n\n  const groups = new Set<RegisteredGroup>();\n  const panels = new Set<RegisteredPanel>();\n  const separators = new Set<RegisteredSeparator>();\n  const initialLayoutMap = new Map<RegisteredGroup, Layout>();\n\n  let didChangeFocus = false;\n\n  hitRegions.forEach((current) => {\n    groups.add(current.group);\n    current.panels.forEach((panel) => {\n      panels.add(panel);\n    });\n\n    if (current.separator) {\n      separators.add(current.separator);\n\n      if (!didChangeFocus) {\n        didChangeFocus = true;\n\n        current.separator.element.focus();\n      }\n    }\n\n    const match = mountedGroups.get(current.group);\n    if (match) {\n      initialLayoutMap.set(current.group, match.layout);\n    }\n  });\n\n  update({\n    interactionState: {\n      hitRegions,\n      initialLayoutMap,\n      pointerDownAtPoint: { x: event.clientX, y: event.clientY },\n      state: \"active\"\n    }\n  });\n\n  if (hitRegions.length) {\n    event.preventDefault();\n  }\n}\n","import type { Properties } from \"csstype\";\nimport type { RegisteredGroup } from \"../../components/group/types\";\nimport {\n  CURSOR_FLAG_HORIZONTAL_MAX,\n  CURSOR_FLAG_HORIZONTAL_MIN,\n  CURSOR_FLAG_VERTICAL_MAX,\n  CURSOR_FLAG_VERTICAL_MIN\n} from \"../../constants\";\nimport type { InteractionState } from \"../types\";\n\nexport function getCursorStyle({\n  cursorFlags,\n  groups,\n  state\n}: {\n  cursorFlags: number;\n  groups: RegisteredGroup[];\n  state: InteractionState[\"state\"];\n}): Properties[\"cursor\"] | null {\n  let horizontalCount = 0;\n  let verticalCount = 0;\n\n  switch (state) {\n    case \"active\":\n    case \"hover\": {\n      groups.forEach((group) => {\n        if (group.disableCursor) {\n          return;\n        }\n\n        switch (group.orientation) {\n          case \"horizontal\": {\n            horizontalCount++;\n            break;\n          }\n          case \"vertical\": {\n            verticalCount++;\n            break;\n          }\n        }\n      });\n    }\n  }\n\n  if (horizontalCount === 0 && verticalCount === 0) {\n    return null;\n  }\n\n  switch (state) {\n    case \"active\": {\n      const horizontalMin = (cursorFlags & CURSOR_FLAG_HORIZONTAL_MIN) !== 0;\n      const horizontalMax = (cursorFlags & CURSOR_FLAG_HORIZONTAL_MAX) !== 0;\n      const verticalMin = (cursorFlags & CURSOR_FLAG_VERTICAL_MIN) !== 0;\n      const verticalMax = (cursorFlags & CURSOR_FLAG_VERTICAL_MAX) !== 0;\n\n      if (cursorFlags) {\n        if (horizontalMin) {\n          if (verticalMin) {\n            return \"se-resize\";\n          } else if (verticalMax) {\n            return \"ne-resize\";\n          } else {\n            return \"e-resize\";\n          }\n        } else if (horizontalMax) {\n          if (verticalMin) {\n            return \"sw-resize\";\n          } else if (verticalMax) {\n            return \"nw-resize\";\n          } else {\n            return \"w-resize\";\n          }\n        } else if (verticalMin) {\n          return \"s-resize\";\n        } else if (verticalMax) {\n          return \"n-resize\";\n        }\n      }\n      break;\n    }\n  }\n\n  if (horizontalCount > 0 && verticalCount > 0) {\n    return \"move\";\n  } else if (horizontalCount > 0) {\n    return \"ew-resize\";\n  } else {\n    return \"ns-resize\";\n  }\n}\n","import { read } from \"../mutableState\";\nimport { getCursorStyle } from \"./getCursorStyle\";\n\nconst documentToStyleMap = new WeakMap<\n  Document,\n  {\n    prevStyle: string | undefined;\n    styleSheet: CSSStyleSheet;\n  }\n>();\n\nexport function updateCursorStyle(ownerDocument: Document) {\n  if (ownerDocument.defaultView === null) {\n    return;\n  }\n\n  let { prevStyle, styleSheet } = documentToStyleMap.get(ownerDocument) ?? {};\n\n  if (styleSheet === undefined) {\n    styleSheet = new ownerDocument.defaultView.CSSStyleSheet();\n\n    ownerDocument.adoptedStyleSheets = [styleSheet];\n  }\n\n  const { cursorFlags, interactionState } = read();\n\n  switch (interactionState.state) {\n    case \"active\":\n    case \"hover\": {\n      const cursorStyle = getCursorStyle({\n        cursorFlags,\n        groups: interactionState.hitRegions.map((current) => current.group),\n        state: interactionState.state\n      });\n\n      const nextStyle = `*{cursor: ${cursorStyle} !important; ${interactionState.state === \"active\" ? \"touch-action: none;\" : \"\"} }`;\n      if (prevStyle === nextStyle) {\n        return;\n      }\n\n      prevStyle = nextStyle;\n\n      if (cursorStyle) {\n        if (styleSheet.cssRules.length === 0) {\n          styleSheet.insertRule(nextStyle);\n        } else {\n          styleSheet.replaceSync(nextStyle);\n        }\n      } else if (styleSheet.cssRules.length === 1) {\n        styleSheet.deleteRule(0);\n      }\n      break;\n    }\n    case \"inactive\": {\n      prevStyle = undefined;\n\n      if (styleSheet.cssRules.length === 1) {\n        styleSheet.deleteRule(0);\n      }\n      break;\n    }\n  }\n\n  documentToStyleMap.set(ownerDocument, {\n    prevStyle,\n    styleSheet\n  });\n}\n","import type { Layout, RegisteredGroup } from \"../../components/group/types\";\nimport {\n  CURSOR_FLAG_HORIZONTAL_MAX,\n  CURSOR_FLAG_HORIZONTAL_MIN,\n  CURSOR_FLAG_VERTICAL_MAX,\n  CURSOR_FLAG_VERTICAL_MIN\n} from \"../../constants\";\nimport type { Point } from \"../../types\";\nimport { updateCursorStyle } from \"../cursor/updateCursorStyle\";\nimport type { HitRegion } from \"../dom/calculateHitRegions\";\nimport { update, type MountedGroupMap } from \"../mutableState\";\nimport { adjustLayoutByDelta } from \"./adjustLayoutByDelta\";\nimport { layoutsEqual } from \"./layoutsEqual\";\n\nexport function updateActiveHitRegions({\n  document,\n  event,\n  hitRegions,\n  initialLayoutMap,\n  mountedGroups,\n  pointerDownAtPoint\n}: {\n  document: Document;\n  event: {\n    clientX: number;\n    clientY: number;\n  };\n  hitRegions: HitRegion[];\n  initialLayoutMap: Map<RegisteredGroup, Layout>;\n  mountedGroups: MountedGroupMap;\n  pointerDownAtPoint?: Point;\n}) {\n  let cursorFlags = 0;\n  const nextMountedGroups = new Map(mountedGroups);\n\n  // Note that HitRegions are frozen once a drag has started\n  // Modify the Group layouts for all matching HitRegions though\n  hitRegions.forEach((current) => {\n    const { group, groupSize } = current;\n    const { disableCursor, orientation, panels } = group;\n\n    let deltaAsPercentage = 0;\n    if (pointerDownAtPoint) {\n      if (orientation === \"horizontal\") {\n        deltaAsPercentage =\n          ((event.clientX - pointerDownAtPoint.x) / groupSize) * 100;\n      } else {\n        deltaAsPercentage =\n          ((event.clientY - pointerDownAtPoint.y) / groupSize) * 100;\n      }\n    } else {\n      if (orientation === \"horizontal\") {\n        deltaAsPercentage = event.clientX < 0 ? -100 : 100;\n      } else {\n        deltaAsPercentage = event.clientY < 0 ? -100 : 100;\n      }\n    }\n\n    const initialLayout = initialLayoutMap.get(group);\n\n    const {\n      defaultLayoutDeferred,\n      derivedPanelConstraints,\n      layout: prevLayout,\n      separatorToPanels\n    } = mountedGroups.get(group) ?? { defaultLayoutDeferred: false };\n    if (\n      derivedPanelConstraints &&\n      initialLayout &&\n      prevLayout &&\n      separatorToPanels\n    ) {\n      const nextLayout = adjustLayoutByDelta({\n        delta: deltaAsPercentage,\n        initialLayout,\n        panelConstraints: derivedPanelConstraints,\n        pivotIndices: current.panels.map((panel) => panels.indexOf(panel)),\n        prevLayout,\n        trigger: \"mouse-or-touch\"\n      });\n\n      if (layoutsEqual(nextLayout, prevLayout)) {\n        if (deltaAsPercentage !== 0 && !disableCursor) {\n          // An unchanged means the cursor has exceeded the allowed bounds\n          switch (orientation) {\n            case \"horizontal\": {\n              cursorFlags |=\n                deltaAsPercentage < 0\n                  ? CURSOR_FLAG_HORIZONTAL_MIN\n                  : CURSOR_FLAG_HORIZONTAL_MAX;\n              break;\n            }\n            case \"vertical\": {\n              cursorFlags |=\n                deltaAsPercentage < 0\n                  ? CURSOR_FLAG_VERTICAL_MIN\n                  : CURSOR_FLAG_VERTICAL_MAX;\n              break;\n            }\n          }\n        }\n      } else {\n        nextMountedGroups.set(current.group, {\n          defaultLayoutDeferred,\n          derivedPanelConstraints: derivedPanelConstraints,\n          layout: nextLayout,\n          separatorToPanels\n        });\n\n        // Save the most recent layout for this group of panels in-memory\n        // so that layouts will be remembered between different sets of conditionally rendered panels\n        const panelIdsKey = current.group.panels.map(({ id }) => id).join(\",\");\n        current.group.inMemoryLayouts[panelIdsKey] = nextLayout;\n      }\n    }\n  });\n\n  update({\n    cursorFlags,\n    mountedGroups: nextMountedGroups\n  });\n\n  updateCursorStyle(document);\n}\n","import { read } from \"../mutableState\";\nimport { updateActiveHitRegions } from \"../utils/updateActiveHitRegion\";\n\nexport function onDocumentPointerLeave(event: PointerEvent) {\n  const { interactionState, mountedGroups } = read();\n\n  switch (interactionState.state) {\n    case \"active\": {\n      updateActiveHitRegions({\n        document: event.currentTarget as Document,\n        event,\n        hitRegions: interactionState.hitRegions,\n        initialLayoutMap: interactionState.initialLayoutMap,\n        mountedGroups\n      });\n    }\n  }\n}\n","import { updateCursorStyle } from \"../cursor/updateCursorStyle\";\nimport { read, update } from \"../mutableState\";\nimport { findMatchingHitRegions } from \"../utils/findMatchingHitRegions\";\nimport { updateActiveHitRegions } from \"../utils/updateActiveHitRegion\";\n\nexport function onDocumentPointerMove(event: PointerEvent) {\n  if (event.defaultPrevented) {\n    return;\n  }\n\n  const { interactionState, mountedGroups } = read();\n\n  switch (interactionState.state) {\n    case \"active\": {\n      // Edge case (see #340)\n      // Detect when the pointer has been released outside an iframe on a different domain\n      if (\n        // Skip this check for \"pointerleave\" events, else Firefox triggers a false positive (see #514)\n        event.buttons === 0\n      ) {\n        update((prevState) =>\n          prevState.interactionState.state === \"inactive\"\n            ? prevState\n            : {\n                cursorFlags: 0,\n                interactionState: {\n                  state: \"inactive\"\n                }\n              }\n        );\n\n        return;\n      }\n\n      updateActiveHitRegions({\n        document: event.currentTarget as Document,\n        event,\n        hitRegions: interactionState.hitRegions,\n        initialLayoutMap: interactionState.initialLayoutMap,\n        mountedGroups,\n        pointerDownAtPoint: interactionState.pointerDownAtPoint\n      });\n      break;\n    }\n    default: {\n      // Update HitRegions if a drag has not been started\n      const hitRegions = findMatchingHitRegions(event, mountedGroups);\n\n      if (hitRegions.length === 0) {\n        if (interactionState.state !== \"inactive\") {\n          update({\n            interactionState: { state: \"inactive\" }\n          });\n        }\n      } else {\n        update({\n          interactionState: {\n            hitRegions,\n            state: \"hover\"\n          }\n        });\n      }\n\n      updateCursorStyle(event.currentTarget as Document);\n      break;\n    }\n  }\n}\n","import { updateCursorStyle } from \"../cursor/updateCursorStyle\";\nimport { read, update } from \"../mutableState\";\n\nexport function onDocumentPointerUp(event: PointerEvent) {\n  if (event.defaultPrevented) {\n    return;\n  }\n\n  event.preventDefault();\n\n  const { interactionState } = read();\n\n  switch (interactionState.state) {\n    case \"active\": {\n      update({\n        cursorFlags: 0,\n        interactionState: {\n          state: \"inactive\"\n        }\n      });\n\n      updateCursorStyle(event.currentTarget as Document);\n    }\n  }\n}\n","import type { Layout } from \"../../components/group/types\";\nimport type { PanelConstraints } from \"../../components/panel/types\";\nimport { formatLayoutNumber } from \"./formatLayoutNumber\";\n\nexport function calculateDefaultLayout(\n  derivedPanelConstraints: PanelConstraints[]\n): Layout {\n  let explicitCount = 0;\n  let total = 0;\n\n  const layout: Layout = {};\n\n  for (const current of derivedPanelConstraints) {\n    if (current.defaultSize !== undefined) {\n      explicitCount++;\n\n      const size = formatLayoutNumber(current.defaultSize);\n\n      total += size;\n      layout[current.panelId] = size;\n    } else {\n      // @ts-expect-error Add panel keys in order to simplify traversal elsewhere; we'll fill them in in the loop below\n      layout[current.panelId] = undefined;\n    }\n  }\n\n  const remainingPanelCount = derivedPanelConstraints.length - explicitCount;\n  if (remainingPanelCount !== 0) {\n    const size = formatLayoutNumber((100 - total) / remainingPanelCount);\n\n    for (const current of derivedPanelConstraints) {\n      if (current.defaultSize === undefined) {\n        layout[current.panelId] = size;\n      }\n    }\n  }\n\n  return layout;\n}\n","import type { RegisteredGroup } from \"../../components/group/types\";\nimport { calculateAvailableGroupSize } from \"../dom/calculateAvailableGroupSize\";\nimport { formatLayoutNumber } from \"./formatLayoutNumber\";\n\nexport function notifyPanelOnResize(\n  group: RegisteredGroup,\n  element: HTMLElement,\n  borderBoxSize: readonly ResizeObserverSize[]\n) {\n  const resizeObserverSize = borderBoxSize[0];\n  if (!resizeObserverSize) {\n    return;\n  }\n\n  const panel = group.panels.find((current) => current.element === element);\n  if (!panel || !panel.onResize) {\n    return;\n  }\n\n  const groupSize = calculateAvailableGroupSize({ group });\n\n  panel.onResize(\n    {\n      asPercentage: formatLayoutNumber(\n        (resizeObserverSize.inlineSize / groupSize) * 100\n      ),\n      inPixels: resizeObserverSize.inlineSize\n    },\n    panel.id\n  );\n}\n","export function objectsEqual(a: object, b: object) {\n  const keys = Object.keys(a);\n  if (keys.length !== Object.keys(b).length) {\n    return false;\n  }\n\n  for (const key in a) {\n    if (a[key as keyof typeof a] !== b[key as keyof typeof b]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import type { Layout } from \"../../components/group/types\";\nimport type { RegisteredPanel } from \"../../components/panel/types\";\n\nexport function validateLayoutKeys(panels: RegisteredPanel[], layout: Layout) {\n  const panelIds = panels.map((panel) => panel.id);\n  const layoutKeys = Object.keys(layout);\n\n  if (panelIds.length !== layoutKeys.length) {\n    return false;\n  }\n\n  for (const panelId of panelIds) {\n    if (!layoutKeys.includes(panelId)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import type { Layout, RegisteredGroup } from \"../components/group/types\";\nimport { assert } from \"../utils/assert\";\nimport { calculateAvailableGroupSize } from \"./dom/calculateAvailableGroupSize\";\nimport { calculateHitRegions } from \"./dom/calculateHitRegions\";\nimport { calculatePanelConstraints } from \"./dom/calculatePanelConstraints\";\nimport { onDocumentKeyDown } from \"./event-handlers/onDocumentKeyDown\";\nimport { onDocumentPointerDown } from \"./event-handlers/onDocumentPointerDown\";\nimport { onDocumentPointerLeave } from \"./event-handlers/onDocumentPointerLeave\";\nimport { onDocumentPointerMove } from \"./event-handlers/onDocumentPointerMove\";\nimport { onDocumentPointerUp } from \"./event-handlers/onDocumentPointerUp\";\nimport { update, type SeparatorToPanelsMap } from \"./mutableState\";\nimport { calculateDefaultLayout } from \"./utils/calculateDefaultLayout\";\nimport { layoutsEqual } from \"./utils/layoutsEqual\";\nimport { notifyPanelOnResize } from \"./utils/notifyPanelOnResize\";\nimport { objectsEqual } from \"./utils/objectsEqual\";\nimport { validateLayoutKeys } from \"./utils/validateLayoutKeys\";\nimport { validatePanelGroupLayout } from \"./utils/validatePanelGroupLayout\";\n\nconst ownerDocumentReferenceCounts = new Map<Document, number>();\n\nexport function mountGroup(group: RegisteredGroup) {\n  let isMounted = true;\n\n  assert(\n    group.element.ownerDocument.defaultView,\n    \"Cannot register an unmounted Group\"\n  );\n\n  const ResizeObserver = group.element.ownerDocument.defaultView.ResizeObserver;\n\n  const panelIds = new Set<string>();\n  const separatorIds = new Set<string>();\n\n  // Add Panels with onResize callbacks to ResizeObserver\n  // Add Group to ResizeObserver also in order to sync % based constraints\n  const resizeObserver = new ResizeObserver((entries) => {\n    for (const entry of entries) {\n      const { borderBoxSize, target } = entry;\n      if (target === group.element) {\n        if (isMounted) {\n          const groupSize = calculateAvailableGroupSize({ group });\n          if (groupSize === 0) {\n            // Can't calculate anything meaningful if the group has a width/height of 0\n            // (This could indicate that it's within a hidden subtree)\n            return;\n          }\n\n          update((prevState) => {\n            const match = prevState.mountedGroups.get(group);\n            if (match) {\n              // Update non-percentage based constraints\n              const nextDerivedPanelConstraints =\n                calculatePanelConstraints(group);\n\n              // Revalidate layout in case constraints have changed\n              const prevLayout = match.defaultLayoutDeferred\n                ? calculateDefaultLayout(nextDerivedPanelConstraints)\n                : match.layout;\n              const nextLayout = validatePanelGroupLayout({\n                layout: prevLayout,\n                panelConstraints: nextDerivedPanelConstraints\n              });\n\n              if (\n                !match.defaultLayoutDeferred &&\n                layoutsEqual(prevLayout, nextLayout) &&\n                objectsEqual(\n                  match.derivedPanelConstraints,\n                  nextDerivedPanelConstraints\n                )\n              ) {\n                return prevState;\n              }\n\n              return {\n                mountedGroups: new Map(prevState.mountedGroups).set(group, {\n                  defaultLayoutDeferred: false,\n                  derivedPanelConstraints: nextDerivedPanelConstraints,\n                  layout: nextLayout,\n                  separatorToPanels: match.separatorToPanels\n                })\n              };\n            }\n\n            return prevState;\n          });\n        }\n      } else {\n        notifyPanelOnResize(group, target as HTMLElement, borderBoxSize);\n      }\n    }\n  });\n  resizeObserver.observe(group.element);\n  group.panels.forEach((panel) => {\n    assert(\n      !panelIds.has(panel.id),\n      `Panel ids must be unique; id \"${panel.id}\" was used more than once`\n    );\n\n    panelIds.add(panel.id);\n\n    if (panel.onResize) {\n      resizeObserver.observe(panel.element);\n    }\n  });\n\n  const groupSize = calculateAvailableGroupSize({ group });\n\n  // Calculate initial layout for the new Panel configuration\n  const derivedPanelConstraints = calculatePanelConstraints(group);\n  const panelIdsKey = group.panels.map(({ id }) => id).join(\",\");\n\n  // Gracefully handle an invalid default layout\n  // This could happen when e.g. useDefaultLayout is combined with dynamic Panels\n  // In this case the best we can do is ignore the incoming layout\n  let defaultLayout: Layout | undefined = group.defaultLayout;\n  if (defaultLayout) {\n    if (!validateLayoutKeys(group.panels, defaultLayout)) {\n      defaultLayout = undefined;\n    }\n  }\n\n  const defaultLayoutUnsafe: Layout =\n    group.inMemoryLayouts[panelIdsKey] ??\n    defaultLayout ??\n    calculateDefaultLayout(derivedPanelConstraints);\n  const defaultLayoutSafe = validatePanelGroupLayout({\n    layout: defaultLayoutUnsafe,\n    panelConstraints: derivedPanelConstraints\n  });\n\n  const hitRegions = calculateHitRegions(group);\n\n  const ownerDocument = group.element.ownerDocument;\n\n  update((prevState) => {\n    const separatorToPanels: SeparatorToPanelsMap = new Map();\n\n    ownerDocumentReferenceCounts.set(\n      ownerDocument,\n      (ownerDocumentReferenceCounts.get(ownerDocument) ?? 0) + 1\n    );\n\n    hitRegions.forEach((hitRegion) => {\n      if (hitRegion.separator) {\n        separatorToPanels.set(hitRegion.separator, hitRegion.panels);\n      }\n    });\n\n    return {\n      mountedGroups: new Map(prevState.mountedGroups).set(group, {\n        defaultLayoutDeferred: groupSize === 0,\n        derivedPanelConstraints,\n        layout: defaultLayoutSafe,\n        separatorToPanels\n      })\n    };\n  });\n\n  group.separators.forEach((separator) => {\n    assert(\n      !separatorIds.has(separator.id),\n      `Separator ids must be unique; id \"${separator.id}\" was used more than once`\n    );\n\n    separatorIds.add(separator.id);\n\n    separator.element.addEventListener(\"keydown\", onDocumentKeyDown);\n  });\n\n  // If this is the first group to be mounted, initialize event handlers\n  if (ownerDocumentReferenceCounts.get(ownerDocument) === 1) {\n    ownerDocument.addEventListener(\"pointerdown\", onDocumentPointerDown);\n    ownerDocument.addEventListener(\"pointerleave\", onDocumentPointerLeave);\n    ownerDocument.addEventListener(\"pointermove\", onDocumentPointerMove);\n    ownerDocument.addEventListener(\"pointerup\", onDocumentPointerUp);\n  }\n\n  return function unmountGroup() {\n    isMounted = false;\n\n    ownerDocumentReferenceCounts.set(\n      ownerDocument,\n      Math.max(0, (ownerDocumentReferenceCounts.get(ownerDocument) ?? 0) - 1)\n    );\n\n    update((prevState) => {\n      const mountedGroups = new Map(prevState.mountedGroups);\n      mountedGroups.delete(group);\n\n      return { mountedGroups };\n    });\n\n    group.separators.forEach((separator) => {\n      separator.element.removeEventListener(\"keydown\", onDocumentKeyDown);\n    });\n\n    // If this was the last group to be mounted, tear down event handlers\n    if (!ownerDocumentReferenceCounts.get(ownerDocument)) {\n      ownerDocument.removeEventListener(\"pointerdown\", onDocumentPointerDown);\n      ownerDocument.removeEventListener(\"pointerleave\", onDocumentPointerLeave);\n      ownerDocument.removeEventListener(\"pointermove\", onDocumentPointerMove);\n      ownerDocument.removeEventListener(\"pointerup\", onDocumentPointerUp);\n    }\n\n    resizeObserver.disconnect();\n  };\n}\n","import { useId as useIdReact } from \"react\";\n\nexport function useId(stableId: number | string | undefined) {\n  const dynamicId = useIdReact();\n\n  return `${stableId ?? dynamicId}`;\n}\n","import { useEffect, useLayoutEffect } from \"react\";\n\nexport const useIsomorphicLayoutEffect =\n  typeof window !== \"undefined\" ? useLayoutEffect : useEffect;\n","import { useCallback, useRef } from \"react\";\nimport { useIsomorphicLayoutEffect } from \"./useIsomorphicLayoutEffect\";\n\n// Forked from useEventCallback (usehooks-ts)\nexport function useStableCallback<Return>(fn: () => Return): () => Return;\nexport function useStableCallback<Args, Return>(\n  fn: (args: Args) => Return\n): (args: Args) => Return;\nexport function useStableCallback<Args, Return>(\n  fn: (args: Args) => Return\n): (args: Args) => Return {\n  const ref = useRef<typeof fn>(fn);\n\n  useIsomorphicLayoutEffect(() => {\n    ref.current = fn;\n  }, [fn]);\n\n  return useCallback((args: Args) => ref.current?.(args), [ref]) as (\n    args: Args\n  ) => Return;\n}\n","import { type Ref } from \"react\";\nimport { useStableCallback } from \"./useStableCallback\";\n\ntype PossibleRef<Type> = Ref<Type> | undefined;\n\nexport function useMergedRefs<Type>(...refs: PossibleRef<Type>[]) {\n  return useStableCallback((value: Type | null) => {\n    refs.forEach((ref) => {\n      if (ref) {\n        switch (typeof ref) {\n          case \"function\": {\n            ref(value);\n            break;\n          }\n          case \"object\": {\n            ref.current = value;\n            break;\n          }\n        }\n      }\n    });\n  });\n}\n","import { useRef } from \"react\";\nimport { useIsomorphicLayoutEffect } from \"./useIsomorphicLayoutEffect\";\n\nexport function useStableObject<Type extends object>(\n  unstableObject: Type\n): Type {\n  const ref = useRef<Type>({ ...unstableObject });\n\n  useIsomorphicLayoutEffect(() => {\n    for (const key in unstableObject) {\n      ref.current[key] = unstableObject[key];\n    }\n  }, [unstableObject]);\n\n  return ref.current;\n}\n","export const POINTER_EVENTS_CSS_PROPERTY_NAME =\n  \"--react-resizable-panels--panel--pointer-events\";\n","export function getPanelSizeCssPropertyName(groupId: string, panelId: string) {\n  const groupIdEscaped = groupId.replace(/[^a-zA-Z0-9\\-_]/g, \"\");\n  const panelIdEscaped = panelId.replace(/[^a-zA-Z0-9\\-_]/g, \"\");\n\n  return `--react-resizable-panels--${groupIdEscaped}--${panelIdEscaped}`;\n}\n","import { createContext } from \"react\";\nimport type { GroupContextType } from \"./types\";\n\nexport const GroupContext = createContext<GroupContextType | null>(null);\n","import { useImperativeHandle, useRef, type Ref } from \"react\";\nimport { IDENTITY_FUNCTION } from \"../../constants\";\nimport { getImperativeGroupMethods } from \"../../global/utils/getImperativeGroupMethods\";\nimport { useIsomorphicLayoutEffect } from \"../../hooks/useIsomorphicLayoutEffect\";\nimport type { GroupImperativeHandle } from \"./types\";\n\nexport function useGroupImperativeHandle(\n  groupId: string,\n  groupRef: Ref<GroupImperativeHandle> | undefined\n) {\n  const imperativeGroupRef = useRef<GroupImperativeHandle>({\n    getLayout: () => ({}),\n    setLayout: IDENTITY_FUNCTION\n  });\n\n  useImperativeHandle(groupRef, () => imperativeGroupRef.current, []);\n\n  useIsomorphicLayoutEffect(() => {\n    Object.assign(\n      imperativeGroupRef.current,\n      getImperativeGroupMethods({ groupId })\n    );\n  });\n}\n","\"use client\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport { mountGroup } from \"../../global/mountGroup\";\nimport { eventEmitter, read } from \"../../global/mutableState\";\nimport { layoutsEqual } from \"../../global/utils/layoutsEqual\";\nimport { useId } from \"../../hooks/useId\";\nimport { useIsomorphicLayoutEffect } from \"../../hooks/useIsomorphicLayoutEffect\";\nimport { useMergedRefs } from \"../../hooks/useMergedRefs\";\nimport { useStableCallback } from \"../../hooks/useStableCallback\";\nimport { useStableObject } from \"../../hooks/useStableObject\";\nimport { POINTER_EVENTS_CSS_PROPERTY_NAME } from \"../panel/constants\";\nimport type { RegisteredPanel } from \"../panel/types\";\nimport type { RegisteredSeparator } from \"../separator/types\";\nimport { getPanelSizeCssPropertyName } from \"./getPanelSizeCssPropertyName\";\nimport { GroupContext } from \"./GroupContext\";\nimport { sortByElementOffset } from \"./sortByElementOffset\";\nimport type { GroupProps, Layout, RegisteredGroup } from \"./types\";\nimport { useGroupImperativeHandle } from \"./useGroupImperativeHandle\";\n\n/**\n * A Group wraps a set of resizable Panel components.\n * Group content can be resized _horizontally_ or _vertically_.\n *\n * Group elements always include the following attributes:\n *\n * ```html\n * <div data-group data-testid=\"group-id-prop\" id=\"group-id-prop\">\n * ```\n *\n * â„¹ï¸ [Test id](https://testing-library.com/docs/queries/bytestid/) can be used to narrow selection when unit testing.\n */\nexport function Group({\n  children,\n  className,\n  defaultLayout,\n  disableCursor,\n  disabled,\n  elementRef,\n  groupRef,\n  id: idProp,\n  onLayoutChange: onLayoutChangeUnstable,\n  orientation = \"horizontal\",\n  style,\n  ...rest\n}: GroupProps) {\n  const prevLayoutRef = useRef<Layout>({});\n\n  const onLayoutChangeStable = useStableCallback((layout: Layout) => {\n    if (layoutsEqual(prevLayoutRef.current, layout)) {\n      // Memoize callback\n      return;\n    }\n\n    prevLayoutRef.current = layout;\n    onLayoutChangeUnstable?.(layout);\n  });\n\n  const id = useId(idProp);\n\n  const [dragActive, setDragActive] = useState(false);\n  const [element, setElement] = useState<HTMLDivElement | null>(null);\n  const [layout, setLayout] = useState<Layout>(defaultLayout ?? {});\n  const [panels, setPanels] = useState<RegisteredPanel[]>([]);\n  const [separators, setSeparators] = useState<RegisteredSeparator[]>([]);\n\n  const inMemoryValuesRef = useRef<{\n    lastExpandedPanelSizes: { [panelIds: string]: number };\n    layouts: { [panelIds: string]: Layout };\n  }>({\n    lastExpandedPanelSizes: {},\n    layouts: {}\n  });\n\n  const mergedRef = useMergedRefs(setElement, elementRef);\n\n  useGroupImperativeHandle(id, groupRef);\n\n  const context = useMemo(\n    () => ({\n      id,\n      orientation,\n      registerPanel: (panel: RegisteredPanel) => {\n        setPanels((prev) => sortByElementOffset(orientation, [...prev, panel]));\n        return () => {\n          setPanels((prev) => prev.filter((current) => current !== panel));\n        };\n      },\n      registerSeparator: (separator: RegisteredSeparator) => {\n        setSeparators((prev) =>\n          sortByElementOffset(orientation, [...prev, separator])\n        );\n        return () => {\n          setSeparators((prev) =>\n            prev.filter((current) => current !== separator)\n          );\n        };\n      }\n    }),\n    [id, orientation]\n  );\n\n  const stableProps = useStableObject({\n    defaultLayout,\n    disableCursor\n  });\n\n  const registeredGroupRef = useRef<RegisteredGroup | null>(null);\n\n  // Register Group and child Panels/Separators with global state\n  // Listen to global state for drag state related to this Group\n  useIsomorphicLayoutEffect(() => {\n    if (element === null) {\n      return;\n    }\n\n    const group: RegisteredGroup = {\n      defaultLayout: stableProps.defaultLayout,\n      disableCursor: !!stableProps.disableCursor,\n      disabled: !!disabled,\n      element,\n      id,\n      inMemoryLastExpandedPanelSizes:\n        inMemoryValuesRef.current.lastExpandedPanelSizes,\n      inMemoryLayouts: inMemoryValuesRef.current.layouts,\n      orientation,\n      panels,\n      separators\n    };\n\n    registeredGroupRef.current = group;\n\n    const unmountGroup = mountGroup(group);\n\n    const globalState = read();\n    const match = globalState.mountedGroups.get(group);\n    if (match) {\n      const { defaultLayoutDeferred, derivedPanelConstraints, layout } = match;\n\n      if (!defaultLayoutDeferred && derivedPanelConstraints.length > 0) {\n        // This indicates that the Group has not finished mounting yet\n        // Likely because it has been rendered inside of a hidden DOM subtree\n        // Ignore layouts in this case because they will not have been validated\n        setLayout(layout);\n        onLayoutChangeStable?.(layout);\n      }\n    }\n\n    const removeInteractionStateChangeListener = eventEmitter.addListener(\n      \"interactionStateChange\",\n      (interactionState) => {\n        switch (interactionState.state) {\n          case \"active\": {\n            setDragActive(\n              interactionState.hitRegions.some(\n                (current) => current.group === group\n              )\n            );\n            break;\n          }\n          default: {\n            setDragActive(false);\n            break;\n          }\n        }\n      }\n    );\n\n    const removeMountedGroupsChangeEventListener = eventEmitter.addListener(\n      \"mountedGroupsChange\",\n      (mountedGroups) => {\n        const match = mountedGroups.get(group);\n        if (match) {\n          const { defaultLayoutDeferred, derivedPanelConstraints, layout } =\n            match;\n\n          if (defaultLayoutDeferred || derivedPanelConstraints.length === 0) {\n            // This indicates that the Group has not finished mounting yet\n            // Likely because it has been rendered inside of a hidden DOM subtree\n            // Ignore layouts in this case because they will not have been validated\n            return;\n          }\n\n          setLayout(layout);\n          onLayoutChangeStable?.(layout);\n        }\n      }\n    );\n\n    return () => {\n      registeredGroupRef.current = null;\n\n      unmountGroup();\n      removeInteractionStateChangeListener();\n      removeMountedGroupsChangeEventListener();\n    };\n  }, [\n    disabled,\n    element,\n    id,\n    onLayoutChangeStable,\n    orientation,\n    panels,\n    separators,\n    stableProps\n  ]);\n\n  // Not all props require re-registering the group;\n  // Some can be updated after the group has been registered\n  useEffect(() => {\n    const registeredGroup = registeredGroupRef.current;\n    if (registeredGroup) {\n      registeredGroup.defaultLayout = defaultLayout;\n      registeredGroup.disableCursor = !!disableCursor;\n    }\n  });\n\n  // Panel layouts and Group dragging state are shared via CSS variables\n  const cssVariables: { [key: string]: number | string | undefined } = {\n    [POINTER_EVENTS_CSS_PROPERTY_NAME]: dragActive ? \"none\" : undefined\n  };\n  for (const panelId in layout) {\n    const propertyName = getPanelSizeCssPropertyName(id, panelId);\n    const flexGrow = layout[panelId];\n    cssVariables[propertyName] = flexGrow;\n  }\n\n  return (\n    <GroupContext.Provider value={context}>\n      <div\n        {...rest}\n        aria-orientation={orientation}\n        className={className}\n        data-group\n        data-testid={id}\n        id={id}\n        ref={mergedRef}\n        style={{\n          ...style,\n          ...cssVariables,\n          display: \"flex\",\n          flexDirection: orientation === \"horizontal\" ? \"row\" : \"column\",\n          flexWrap: \"nowrap\"\n        }}\n      >\n        {children}\n      </div>\n    </GroupContext.Provider>\n  );\n}\n","export function debounce(fn: () => void, durationMs?: number): () => void;\nexport function debounce<Args>(\n  fn: (args: Args) => void,\n  durationMs?: number\n): (args: Args) => void;\nexport function debounce<Args>(\n  fn: (args: Args) => void,\n  durationMs: number = 10\n): (args: Args) => void {\n  let timeout: NodeJS.Timeout | null = null;\n\n  return (args: Args) => {\n    if (timeout !== null) {\n      clearTimeout(timeout);\n    }\n\n    timeout = setTimeout(() => {\n      fn(args);\n    }, durationMs);\n  };\n}\n","export function getStorageKey(id: string): string {\n  return `react-resizable-panels:${id}`;\n}\n","import { useMemo, useSyncExternalStore } from \"react\";\nimport { debounce } from \"../../utils/debounce\";\nimport { getStorageKey } from \"./auto-save/getStorageKey\";\nimport type { Layout, LayoutStorage, OnGroupLayoutChange } from \"./types\";\n\nexport function useDefaultLayout({\n  debounceSaveMs = 100,\n  storage,\n  ...rest\n}: {\n  /**\n   * Debounce save operation by the specified number of milliseconds; defaults to 100ms\n   */\n  debounceSaveMs?: number;\n\n  /**\n   * Storage implementation; supports localStorage, sessionStorage, and custom implementations\n   * Refer to documentation site for example integrations.\n   */\n  storage: LayoutStorage;\n} & (\n  | {\n      /**\n       * Group id; must be unique in order for layouts to be saved separately.\n       * @deprecated Use the {@link id} param instead\n       */\n      groupId: string;\n    }\n  | {\n      /**\n       * Unique layout identifier.\n       */\n      id: string;\n    }\n)) {\n  const id = \"id\" in rest ? rest.id : rest.groupId;\n\n  const storageKey = getStorageKey(id);\n\n  // In the event that a client-only storage API is provided,\n  // useSyncExternalStore prevents server/client hydration mismatch warning\n  // This is not ideal; if possible a server-friendly storage API should be used\n  const defaultLayoutString = useSyncExternalStore(\n    subscribe,\n    () => storage.getItem(storageKey),\n    () => storage.getItem(storageKey)\n  );\n\n  const defaultLayout = useMemo(\n    () =>\n      defaultLayoutString\n        ? (JSON.parse(defaultLayoutString) as Layout)\n        : undefined,\n    [defaultLayoutString]\n  );\n\n  const onLayoutChange = useMemo<NonNullable<OnGroupLayoutChange>>(() => {\n    const saveLayout = (layout: Layout) => {\n      try {\n        storage.setItem(storageKey, JSON.stringify(layout));\n      } catch (error) {\n        console.error(error);\n      }\n    };\n\n    return debounceSaveMs > 0\n      ? debounce(saveLayout, debounceSaveMs)\n      : saveLayout;\n  }, [debounceSaveMs, storage, storageKey]);\n\n  return {\n    defaultLayout,\n    onLayoutChange\n  };\n}\n\nfunction subscribe() {\n  return function unsubscribe() {};\n}\n","import { useState } from \"react\";\nimport type { GroupImperativeHandle } from \"./types\";\n\n/**\n * Convenience hook to return a properly typed ref callback for the Group component.\n *\n * Use this hook when you need to share the ref with another component or hook.\n */\nexport function useGroupCallbackRef() {\n  return useState<GroupImperativeHandle | null>(null);\n}\n","import { useRef } from \"react\";\nimport type { GroupImperativeHandle } from \"./types\";\n\n/**\n * Convenience hook to return a properly typed ref for the Group component.\n */\nexport function useGroupRef() {\n  return useRef<GroupImperativeHandle>(null);\n}\n","import { useContext } from \"react\";\nimport { assert } from \"../../utils/assert\";\nimport { GroupContext } from \"./GroupContext\";\n\nexport function useGroupContext() {\n  const context = useContext(GroupContext);\n  assert(\n    context,\n    \"Group Context not found; did you render a Panel or Separator outside of a Group?\"\n  );\n\n  return context;\n}\n","import type { PanelImperativeHandle } from \"../../components/panel/types\";\nimport { calculateAvailableGroupSize } from \"../dom/calculateAvailableGroupSize\";\nimport { read, update } from \"../mutableState\";\nimport { adjustLayoutByDelta } from \"./adjustLayoutByDelta\";\nimport { formatLayoutNumber } from \"./formatLayoutNumber\";\nimport { layoutNumbersEqual } from \"./layoutNumbersEqual\";\nimport { layoutsEqual } from \"./layoutsEqual\";\nimport { validatePanelGroupLayout } from \"./validatePanelGroupLayout\";\n\nexport function getImperativePanelMethods({\n  groupId,\n  panelId\n}: {\n  groupId: string;\n  panelId: string;\n}): PanelImperativeHandle {\n  const find = () => {\n    const { mountedGroups } = read();\n    for (const [\n      group,\n      {\n        defaultLayoutDeferred,\n        derivedPanelConstraints,\n        layout,\n        separatorToPanels\n      }\n    ] of mountedGroups) {\n      if (group.id === groupId) {\n        return {\n          defaultLayoutDeferred,\n          derivedPanelConstraints,\n          group,\n          layout,\n          separatorToPanels\n        };\n      }\n    }\n\n    throw Error(`Group ${groupId} not found`);\n  };\n\n  const getPanelConstraints = () => {\n    const match = find().derivedPanelConstraints.find(\n      (current) => current.panelId === panelId\n    );\n    if (match !== undefined) {\n      return match;\n    }\n\n    throw Error(`Panel constraints not found for Panel ${panelId}`);\n  };\n\n  const getPanel = () => {\n    const match = find().group.panels.find((current) => current.id === panelId);\n    if (match !== undefined) {\n      return match;\n    }\n\n    throw Error(`Layout not found for Panel ${panelId}`);\n  };\n\n  const getPanelSize = () => {\n    const match = find().layout[panelId];\n    if (match !== undefined) {\n      return match;\n    }\n\n    throw Error(`Layout not found for Panel ${panelId}`);\n  };\n\n  const setPanelSize = (nextSize: number) => {\n    const prevSize = getPanelSize();\n    if (nextSize === prevSize) {\n      return;\n    }\n\n    const {\n      defaultLayoutDeferred,\n      derivedPanelConstraints,\n      group,\n      layout: prevLayout,\n      separatorToPanels\n    } = find();\n\n    const index = group.panels.findIndex((current) => current.id === panelId);\n    const isLastPanel = index === group.panels.length - 1;\n\n    const unsafeLayout = adjustLayoutByDelta({\n      delta: isLastPanel ? prevSize - nextSize : nextSize - prevSize,\n      initialLayout: prevLayout,\n      panelConstraints: derivedPanelConstraints,\n      pivotIndices: isLastPanel ? [index - 1, index] : [index, index + 1],\n      prevLayout,\n      trigger: \"imperative-api\"\n    });\n\n    const nextLayout = validatePanelGroupLayout({\n      layout: unsafeLayout,\n      panelConstraints: derivedPanelConstraints\n    });\n    if (!layoutsEqual(prevLayout, nextLayout)) {\n      update((prevState) => ({\n        mountedGroups: new Map(prevState.mountedGroups).set(group, {\n          defaultLayoutDeferred,\n          derivedPanelConstraints,\n          layout: nextLayout,\n          separatorToPanels\n        })\n      }));\n    }\n  };\n\n  return {\n    collapse: () => {\n      const { collapsible, collapsedSize } = getPanelConstraints();\n      const size = getPanelSize();\n\n      if (collapsible && size !== collapsedSize) {\n        setPanelSize(collapsedSize);\n      }\n    },\n    expand: () => {\n      const { collapsible, collapsedSize, minSize } = getPanelConstraints();\n      const size = getPanelSize();\n\n      if (collapsible && size === collapsedSize) {\n        setPanelSize(minSize);\n      }\n    },\n    getSize: () => {\n      const { group } = find();\n      const asPercentage = getPanelSize();\n      const { element } = getPanel();\n\n      const inPixels =\n        group.orientation === \"horizontal\"\n          ? element.offsetWidth\n          : element.offsetHeight;\n\n      return {\n        asPercentage,\n        inPixels\n      };\n    },\n    isCollapsed: () => {\n      const { collapsible, collapsedSize } = getPanelConstraints();\n      const size = getPanelSize();\n\n      return collapsible && layoutNumbersEqual(collapsedSize, size);\n    },\n    resize: (size: number | string) => {\n      const prevSize = getPanelSize();\n      if (prevSize !== size) {\n        let asPercentage;\n        switch (typeof size) {\n          case \"number\": {\n            const { group } = find();\n            const groupSize = calculateAvailableGroupSize({ group });\n            asPercentage = formatLayoutNumber((size / groupSize) * 100);\n            break;\n          }\n          case \"string\": {\n            asPercentage = parseFloat(size);\n            break;\n          }\n        }\n\n        setPanelSize(asPercentage);\n      }\n    }\n  } satisfies PanelImperativeHandle;\n}\n","import { useImperativeHandle, useRef, type Ref } from \"react\";\nimport { NOOP_FUNCTION } from \"../../constants\";\nimport { getImperativePanelMethods } from \"../../global/utils/getImperativePanelMethods\";\nimport { useIsomorphicLayoutEffect } from \"../../hooks/useIsomorphicLayoutEffect\";\nimport { useGroupContext } from \"../group/useGroupContext\";\nimport type { PanelImperativeHandle } from \"./types\";\n\nexport function usePanelImperativeHandle(\n  panelId: string,\n  panelRef: Ref<PanelImperativeHandle> | undefined\n) {\n  const { id: groupId } = useGroupContext();\n\n  const imperativePanelRef = useRef<PanelImperativeHandle>({\n    collapse: NOOP_FUNCTION,\n    expand: NOOP_FUNCTION,\n    getSize: () => ({\n      asPercentage: 0,\n      inPixels: 0\n    }),\n    isCollapsed: () => false,\n    resize: NOOP_FUNCTION\n  });\n\n  useImperativeHandle(panelRef, () => imperativePanelRef.current, []);\n\n  useIsomorphicLayoutEffect(() => {\n    Object.assign(\n      imperativePanelRef.current,\n      getImperativePanelMethods({ groupId, panelId })\n    );\n  });\n}\n","\"use client\";\n\nimport type { Property } from \"csstype\";\nimport { useState, type CSSProperties } from \"react\";\nimport { useId } from \"../../hooks/useId\";\nimport { useIsomorphicLayoutEffect } from \"../../hooks/useIsomorphicLayoutEffect\";\nimport { useMergedRefs } from \"../../hooks/useMergedRefs\";\nimport { useStableCallback } from \"../../hooks/useStableCallback\";\nimport { getPanelSizeCssPropertyName } from \"../group/getPanelSizeCssPropertyName\";\nimport { useGroupContext } from \"../group/useGroupContext\";\nimport { POINTER_EVENTS_CSS_PROPERTY_NAME } from \"./constants\";\nimport type { PanelProps, PanelSize } from \"./types\";\nimport { usePanelImperativeHandle } from \"./usePanelImperativeHandle\";\n\n/**\n * A Panel wraps resizable content and can be configured with min/max size constraints and collapsible behavior.\n *\n * Panel size props can be in the following formats:\n * - Percentage of the parent Group (0..100)\n * - Pixels\n * - Relative font units (em, rem)\n * - Viewport relative units (vh, vw)\n *\n * â„¹ï¸ Numeric values are assumed to be pixels.\n * Strings without explicit units are assumed to be percentages (0%..100%).\n * Percentages may also be specified as strings ending with \"%\" (e.g. \"33%\")\n * Pixels may also be specified as strings ending with the unit \"px\".\n * Other units should be specified as strings ending with their CSS property units (e.g. 1rem, 50vh)\n *\n * Panel elements always include the following attributes:\n *\n * ```html\n * <div data-panel data-testid=\"panel-id-prop\" id=\"panel-id-prop\">\n * ```\n *\n * â„¹ï¸ [Test id](https://testing-library.com/docs/queries/bytestid/) can be used to narrow selection when unit testing.\n */\nexport function Panel({\n  children,\n  className,\n  collapsedSize = \"0%\",\n  collapsible = false,\n  defaultSize,\n  elementRef,\n  id: idProp,\n  maxSize = \"100%\",\n  minSize = \"0%\",\n  onResize: onResizeUnstable,\n  panelRef,\n  style,\n  ...rest\n}: PanelProps) {\n  const idIsStable = !!idProp;\n\n  const id = useId(idProp);\n\n  const [element, setElement] = useState<HTMLDivElement | null>(null);\n\n  const mergedRef = useMergedRefs(setElement, elementRef);\n\n  const { id: groupId, registerPanel } = useGroupContext();\n\n  const hasOnResize = onResizeUnstable !== null;\n  const onResizeStable = useStableCallback((panelSize: PanelSize) => {\n    onResizeUnstable?.(panelSize, idProp);\n  });\n\n  // Register Panel with parent Group\n  useIsomorphicLayoutEffect(() => {\n    if (element !== null) {\n      return registerPanel({\n        element,\n        id,\n        idIsStable,\n        onResize: hasOnResize ? onResizeStable : undefined,\n        panelConstraints: {\n          collapsedSize,\n          collapsible,\n          defaultSize,\n          maxSize,\n          minSize\n        }\n      });\n    }\n  }, [\n    collapsedSize,\n    collapsible,\n    defaultSize,\n    element,\n    hasOnResize,\n    id,\n    idIsStable,\n    maxSize,\n    minSize,\n    onResizeStable,\n    registerPanel\n  ]);\n\n  usePanelImperativeHandle(id, panelRef);\n\n  const flexGrowVar = getPanelSizeCssPropertyName(groupId, id);\n\n  return (\n    <div\n      {...rest}\n      data-panel\n      data-testid={id}\n      id={id}\n      ref={mergedRef}\n      style={{\n        ...PROHIBITED_CSS_PROPERTIES,\n\n        flexBasis: 0,\n        flexGrow: `var(${flexGrowVar}, 1)`,\n        flexShrink: 1,\n\n        // Prevent Panel content from interfering with panel size\n        overflow: \"hidden\",\n\n        // Disable pointer events inside of a panel during resize\n        // This avoid edge cases like nested iframes\n        pointerEvents:\n          `var(${POINTER_EVENTS_CSS_PROPERTY_NAME})` as Property.PointerEvents\n      }}\n    >\n      <div\n        className={className}\n        style={{\n          width: \"100%\",\n          height: \"100%\",\n          ...style\n        }}\n      >\n        {children}\n      </div>\n    </div>\n  );\n}\n\nconst PROHIBITED_CSS_PROPERTIES: CSSProperties = {\n  minHeight: \"unset\",\n  maxHeight: \"unset\",\n  height: \"unset\",\n\n  minWidth: \"unset\",\n  maxWidth: \"unset\",\n  width: \"unset\",\n\n  flex: \"unset\",\n  flexBasis: \"unset\",\n  flexShrink: \"unset\",\n  flexGrow: \"unset\",\n\n  border: \"unset\",\n  borderWidth: \"unset\",\n  padding: \"unset\",\n  margin: \"unset\"\n};\n","import { useState } from \"react\";\nimport type { PanelImperativeHandle } from \"./types\";\n\n/**\n * Convenience hook to return a properly typed ref callback for the Panel component.\n *\n * Use this hook when you need to share the ref with another component or hook.\n */\nexport function usePanelCallbackRef() {\n  return useState<PanelImperativeHandle | null>(null);\n}\n","import { useRef } from \"react\";\nimport type { PanelImperativeHandle } from \"./types\";\n\n/**\n * Convenience hook to return a properly typed ref for the Panel component.\n */\nexport function usePanelRef() {\n  return useRef<PanelImperativeHandle>(null);\n}\n","import type { Layout } from \"../../components/group/types\";\nimport type { PanelConstraints } from \"../../components/panel/types\";\nimport { adjustLayoutByDelta } from \"./adjustLayoutByDelta\";\nimport { validatePanelGroupLayout } from \"./validatePanelGroupLayout\";\n\nexport function calculateSeparatorAriaValues({\n  layout,\n  panelConstraints,\n  panelId,\n  panelIndex\n}: {\n  layout: Layout;\n  panelConstraints: PanelConstraints[];\n  panelId: string;\n  panelIndex: number;\n}): {\n  valueControls: string | undefined;\n  valueMax: number | undefined;\n  valueMin: number | undefined;\n  valueNow: number | undefined;\n} {\n  let valueMax: number | undefined = undefined;\n  let valueMin: number | undefined = undefined;\n\n  const panelSize = layout[panelId];\n\n  const constraints = panelConstraints.find(\n    (current) => current.panelId === panelId\n  );\n  if (constraints) {\n    const maxSize = constraints.maxSize;\n    const minSize = (valueMin = constraints.collapsible\n      ? constraints.collapsedSize\n      : constraints.minSize);\n\n    const pivotIndices = [panelIndex, panelIndex + 1];\n\n    const minSizeLayout = validatePanelGroupLayout({\n      layout: adjustLayoutByDelta({\n        delta: minSize - panelSize,\n        initialLayout: layout,\n        panelConstraints,\n        pivotIndices,\n        prevLayout: layout,\n        trigger: \"keyboard\"\n      }),\n      panelConstraints\n    });\n\n    valueMin = minSizeLayout[panelId];\n\n    const maxSizeLayout = validatePanelGroupLayout({\n      layout: adjustLayoutByDelta({\n        delta: maxSize - panelSize,\n        initialLayout: layout,\n        panelConstraints,\n        pivotIndices,\n        prevLayout: layout,\n        trigger: \"keyboard\"\n      }),\n      panelConstraints\n    });\n\n    valueMax = maxSizeLayout[panelId];\n  }\n\n  return {\n    valueControls: panelId,\n    valueMax,\n    valueMin,\n    valueNow: panelSize\n  };\n}\n","\"use client\";\n\nimport { useState } from \"react\";\nimport { eventEmitter } from \"../../global/mutableState\";\nimport type { InteractionState } from \"../../global/types\";\nimport { calculateSeparatorAriaValues } from \"../../global/utils/calculateSeparatorAriaValues\";\nimport { useId } from \"../../hooks/useId\";\nimport { useIsomorphicLayoutEffect } from \"../../hooks/useIsomorphicLayoutEffect\";\nimport { useMergedRefs } from \"../../hooks/useMergedRefs\";\nimport { useGroupContext } from \"../group/useGroupContext\";\nimport type { RegisteredSeparator, SeparatorProps } from \"./types\";\n\n/**\n * Separators are not _required_ but they are _recommended_ as they improve keyboard accessibility.\n *\n * Separators should be rendered as the direct child of a Group component.\n *\n * Separator elements always include the following attributes:\n *\n * ```html\n * <div data-separator data-testid=\"separator-id-prop\" id=\"separator-id-prop\" role=\"separator\">\n * ```\n *\n * â„¹ï¸ [Test id](https://testing-library.com/docs/queries/bytestid/) can be used to narrow selection when unit testing.\n *\n * â„¹ï¸ In addition to the attributes shown above, separator also renders all required [WAI-ARIA properties](https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Reference/Roles/separator_role#associated_wai-aria_roles_states_and_properties).\n */\nexport function Separator({\n  children,\n  className,\n  elementRef,\n  id: idProp,\n  style,\n  ...rest\n}: SeparatorProps) {\n  const id = useId(idProp);\n\n  const [aria, setAria] = useState<{\n    valueControls?: string | undefined;\n    valueMin?: number | undefined;\n    valueMax?: number | undefined;\n    valueNow?: number | undefined;\n  }>({});\n\n  const [dragState, setDragState] =\n    useState<InteractionState[\"state\"]>(\"inactive\");\n  const [element, setElement] = useState<HTMLDivElement | null>(null);\n\n  const mergedRef = useMergedRefs(setElement, elementRef);\n\n  const {\n    id: groupId,\n    orientation: groupOrientation,\n    registerSeparator\n  } = useGroupContext();\n\n  const orientation =\n    groupOrientation === \"horizontal\" ? \"vertical\" : \"horizontal\";\n\n  // Register Separator with parent Group\n  // Listen to global state for drag state related to this Separator\n  useIsomorphicLayoutEffect(() => {\n    if (element !== null) {\n      const separator: RegisteredSeparator = {\n        element,\n        id\n      };\n\n      const unregisterSeparator = registerSeparator(separator);\n\n      const removeInteractionStateChangeListener = eventEmitter.addListener(\n        \"interactionStateChange\",\n        (interactionState) => {\n          setDragState(\n            interactionState.state !== \"inactive\" &&\n              interactionState.hitRegions.some(\n                (hitRegion) => hitRegion.separator === separator\n              )\n              ? interactionState.state\n              : \"inactive\"\n          );\n        }\n      );\n\n      const removeMountedGroupsChangeListener = eventEmitter.addListener(\n        \"mountedGroupsChange\",\n        (mountedGroups) => {\n          mountedGroups.forEach(\n            (\n              { derivedPanelConstraints, layout, separatorToPanels },\n              mountedGroup\n            ) => {\n              if (mountedGroup.id === groupId) {\n                const panels = separatorToPanels.get(separator);\n                if (panels) {\n                  const primaryPanel = panels[0];\n                  const panelIndex = mountedGroup.panels.indexOf(primaryPanel);\n\n                  setAria(\n                    calculateSeparatorAriaValues({\n                      layout,\n                      panelConstraints: derivedPanelConstraints,\n                      panelId: primaryPanel.id,\n                      panelIndex\n                    })\n                  );\n                }\n              }\n            }\n          );\n        }\n      );\n\n      return () => {\n        removeInteractionStateChangeListener();\n        removeMountedGroupsChangeListener();\n        unregisterSeparator();\n      };\n    }\n  }, [element, groupId, id, registerSeparator]);\n\n  return (\n    <div\n      {...rest}\n      aria-controls={aria.valueControls}\n      aria-orientation={orientation}\n      aria-valuemax={aria.valueMax}\n      aria-valuemin={aria.valueMin}\n      aria-valuenow={aria.valueNow}\n      children={children}\n      className={className}\n      data-separator={dragState}\n      data-testid={id}\n      id={id}\n      ref={mergedRef}\n      role=\"separator\"\n      style={{\n        flexBasis: \"auto\",\n        ...style,\n        flexGrow: 0,\n        flexShrink: 0\n      }}\n      tabIndex={0}\n    />\n  );\n}\n","import type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useCallback, useEffect, useRef } from \"react\";\n\ninterface UseCanvasAutoSyncOptions {\n  conversationId: Id<\"conversations\">;\n  isDocumentMode: boolean;\n  documentId: Id<\"canvasDocuments\"> | null;\n  activeCanvasDocumentId: Id<\"canvasDocuments\"> | undefined;\n  setDocumentId: (id: Id<\"canvasDocuments\"> | null) => void;\n}\n\ninterface UseCanvasAutoSyncReturn {\n  handleClose: () => void;\n}\n\n/**\n * Manages canvas panel state in sync with conversation mode and navigation.\n *\n * Handles scenarios:\n * 1. Auto-close canvas when exiting document mode\n * 2. Clear canvas when switching conversations\n * 3. Auto-open canvas when conversation has an active document in document mode\n * 4. Respect user's manual close action (don't auto-reopen until conversation changes)\n */\nexport function useCanvasAutoSync({\n  conversationId,\n  isDocumentMode,\n  documentId,\n  activeCanvasDocumentId,\n  setDocumentId,\n}: UseCanvasAutoSyncOptions): UseCanvasAutoSyncReturn {\n  const prevConversationIdRef = useRef(conversationId);\n  const userClosedRef = useRef(false);\n\n  // Handle manual close - sets flag to prevent auto-reopen\n  const handleClose = useCallback(() => {\n    userClosedRef.current = true;\n    setDocumentId(null);\n  }, [setDocumentId]);\n\n  // Auto-close Canvas when exiting document mode\n  useEffect(() => {\n    if (!isDocumentMode && documentId) {\n      setDocumentId(null);\n    }\n  }, [isDocumentMode, documentId, setDocumentId]);\n\n  // Clear Canvas and reset flag when switching conversations\n  useEffect(() => {\n    if (prevConversationIdRef.current !== conversationId) {\n      prevConversationIdRef.current = conversationId;\n      userClosedRef.current = false; // Reset on conversation change\n      if (documentId) {\n        setDocumentId(null);\n      }\n    }\n  }, [conversationId, documentId, setDocumentId]);\n\n  // Auto-open canvas panel when conversation has an active document AND is in document mode\n  // BUT only if user hasn't manually closed it\n  useEffect(() => {\n    if (\n      activeCanvasDocumentId &&\n      !documentId &&\n      isDocumentMode &&\n      !userClosedRef.current\n    ) {\n      setDocumentId(activeCanvasDocumentId);\n    }\n  }, [activeCanvasDocumentId, documentId, setDocumentId, isDocumentMode]);\n\n  return { handleClose };\n}\n","\"use client\";\n\nimport { useEffect } from \"react\";\n\ninterface UseChatKeyboardShortcutsOptions {\n  onOpenQuickSwitcher: () => void;\n  onOpenTemplateSelector: () => void;\n}\n\n/**\n * Listens for keyboard shortcuts to open quick switchers:\n * - âŒ˜J: Open quick model switcher\n * - âŒ˜;: Open quick template switcher\n *\n * Uses custom events dispatched from global keyboard handler.\n */\nexport function useChatKeyboardShortcuts({\n  onOpenQuickSwitcher,\n  onOpenTemplateSelector,\n}: UseChatKeyboardShortcutsOptions): void {\n  // Quick model switcher keyboard shortcut (âŒ˜J)\n  useEffect(() => {\n    window.addEventListener(\"open-quick-model-switcher\", onOpenQuickSwitcher);\n    return () =>\n      window.removeEventListener(\n        \"open-quick-model-switcher\",\n        onOpenQuickSwitcher,\n      );\n  }, [onOpenQuickSwitcher]);\n\n  // Quick template switcher keyboard shortcut (âŒ˜;)\n  useEffect(() => {\n    window.addEventListener(\n      \"open-quick-template-switcher\",\n      onOpenTemplateSelector,\n    );\n    return () =>\n      window.removeEventListener(\n        \"open-quick-template-switcher\",\n        onOpenTemplateSelector,\n      );\n  }, [onOpenTemplateSelector]);\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Doc, Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation } from \"convex/react\";\nimport { useCallback, useMemo, useState } from \"react\";\nimport { DEFAULT_MODEL_ID } from \"@/lib/ai/operational-models\";\nimport { isValidModel } from \"@/lib/ai/utils\";\n\ninterface UseChatModelSelectionOptions {\n  conversationId: Id<\"conversations\">;\n  conversation: Doc<\"conversations\"> | null | undefined;\n  user: Doc<\"users\"> | null | undefined;\n  defaultModel: string | undefined;\n}\n\ninterface UseChatModelSelectionReturn {\n  selectedModel: string;\n  displayModel: string;\n  modelLoading: boolean;\n  optimisticModel: string | null;\n  handleModelChange: (modelId: string) => Promise<void>;\n}\n\n/**\n * Manages model selection for a chat conversation.\n *\n * Priority order:\n * 1. Conversation model (if valid)\n * 2. User's default model (if valid)\n * 3. System default model\n *\n * Includes optimistic updates during model changes.\n */\nexport function useChatModelSelection({\n  conversationId,\n  conversation,\n  user,\n  defaultModel,\n}: UseChatModelSelectionOptions): UseChatModelSelectionReturn {\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const updateModelMutation = useMutation(api.conversations.updateModel);\n\n  // Separate state for optimistic updates during model changes\n  const [optimisticModel, setOptimisticModel] = useState<string | null>(null);\n\n  // Calculate final model selection based on priority logic\n  // Only show the model once both conversation and user data are loaded\n  const { selectedModel, modelLoading } = useMemo(() => {\n    // Show loading until we have definitive answers about both conversation and user\n    const conversationLoaded = conversation !== undefined; // null = not found, undefined = loading\n    const userLoaded = user !== undefined;\n\n    if (!conversationLoaded || !userLoaded) {\n      return { selectedModel: \"\", modelLoading: true };\n    }\n\n    // Now we can determine the final model without flickering\n    let finalModel = DEFAULT_MODEL_ID;\n\n    // Priority 1: Conversation model (if valid)\n    if (conversation?.model && isValidModel(conversation.model)) {\n      finalModel = conversation.model;\n    }\n    // Priority 2: User's default model (if valid)\n    else if (defaultModel && isValidModel(defaultModel)) {\n      finalModel = defaultModel;\n    }\n    // Priority 3: System default (always valid)\n    else {\n      finalModel = DEFAULT_MODEL_ID;\n    }\n\n    return { selectedModel: finalModel, modelLoading: false };\n  }, [conversation, user, defaultModel]);\n\n  // The actual model to display - prefers optimistic updates over stable state\n  const displayModel = optimisticModel || selectedModel;\n\n  const handleModelChange = useCallback(\n    async (modelId: string) => {\n      // Optimistic update - shows immediately while persisting\n      setOptimisticModel(modelId);\n\n      // Persist to DB if conversation exists\n      if (conversationId) {\n        try {\n          await updateModelMutation({\n            conversationId,\n            model: modelId,\n          });\n          // Clear optimistic state after successful persist\n          setOptimisticModel(null);\n        } catch (error) {\n          console.error(\"Failed to persist model:\", error);\n          // Revert optimistic update on failure\n          setOptimisticModel(null);\n        }\n      }\n      // New conversations: model saved when first message sent (chat.ts:75)\n    },\n    [conversationId, updateModelMutation],\n  );\n\n  return {\n    selectedModel,\n    displayModel,\n    modelLoading,\n    optimisticModel,\n    handleModelChange,\n  };\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Doc, Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation } from \"convex/react\";\nimport { useRouter } from \"next/navigation\";\nimport { useCallback } from \"react\";\nimport type { OptimisticMessage } from \"@/types/optimistic\";\n\ntype ServerMessage = Doc<\"messages\">;\ntype MessageWithOptimistic = ServerMessage | OptimisticMessage;\ntype ConsolidationMode = \"same-chat\" | \"new-chat\";\n\ninterface UseComparisonHandlersOptions {\n  conversationId: Id<\"conversations\">;\n  messages: MessageWithOptimistic[] | undefined;\n}\n\ninterface UseComparisonHandlersReturn {\n  handleVote: (winnerId: string, rating: string) => Promise<void>;\n  handleConsolidate: (model: string, mode: ConsolidationMode) => Promise<void>;\n}\n\n/**\n * Handles voting and consolidation actions for comparison mode.\n */\nexport function useComparisonHandlers({\n  conversationId,\n  messages,\n}: UseComparisonHandlersOptions): UseComparisonHandlersReturn {\n  const router = useRouter();\n\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const recordVote = useMutation(api.votes.recordVote);\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const createConsolidation = useMutation(\n    api.conversations.createConsolidationConversation,\n  );\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const consolidateInPlace = useMutation(\n    api.conversations.consolidateInSameChat,\n  );\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const updateModelMutation = useMutation(api.conversations.updateModel);\n\n  const handleVote = useCallback(\n    async (winnerId: string, rating: string) => {\n      // Only handle votes for server-confirmed messages (not optimistic)\n      const msg = messages?.find(\n        (m) => !(\"_optimistic\" in m) && m._id === winnerId,\n      );\n      if (msg?.comparisonGroupId) {\n        const voteRating = rating as\n          | \"left_better\"\n          | \"right_better\"\n          | \"tie\"\n          | \"both_bad\";\n        await recordVote({\n          comparisonGroupId: msg.comparisonGroupId,\n          winnerId: msg._id as Id<\"messages\">,\n          rating: voteRating,\n        });\n      }\n    },\n    [messages, recordVote],\n  );\n\n  const handleConsolidate = useCallback(\n    async (model: string, mode: ConsolidationMode) => {\n      const msg = messages?.find((m) => m.comparisonGroupId);\n      if (!msg?.comparisonGroupId) return;\n\n      if (mode === \"same-chat\") {\n        // Consolidate in place - no navigation\n        await consolidateInPlace({\n          conversationId: conversationId,\n          comparisonGroupId: msg.comparisonGroupId,\n          consolidationModel: model,\n        });\n\n        // Update conversation model to match consolidation choice\n        await updateModelMutation({\n          conversationId: conversationId,\n          model: model,\n        });\n      } else {\n        // Create new conversation and navigate\n        const { conversationId: newConvId } = await createConsolidation({\n          comparisonGroupId: msg.comparisonGroupId,\n          consolidationModel: model,\n        });\n        router.push(`/chat/${newConvId}`);\n      }\n    },\n    [\n      conversationId,\n      messages,\n      consolidateInPlace,\n      createConsolidation,\n      updateModelMutation,\n      router,\n    ],\n  );\n\n  return {\n    handleVote,\n    handleConsolidate,\n  };\n}\n","import { useCallback, useState } from \"react\";\nimport { analytics } from \"@/lib/analytics\";\n\nexport function useComparisonMode() {\n  const [isActive, setIsActive] = useState(false);\n  const [selectedModels, setSelectedModels] = useState<string[]>([]);\n  const [activeComparisonId, setActiveComparisonId] = useState<string | null>(\n    null,\n  );\n\n  const startComparison = useCallback((models: string[]) => {\n    if (models.length < 2) {\n      console.warn(\"Cannot start comparison: Select at least 2 models\");\n      return false;\n    }\n    if (models.length > 4) {\n      console.warn(\"Cannot start comparison: Maximum 4 models allowed\");\n      return false;\n    }\n    setSelectedModels(models);\n    setIsActive(true);\n\n    // Track comparison started\n    analytics.track(\"comparison_started\", {\n      modelCount: models.length,\n      models: models.join(\",\"),\n    });\n\n    return true;\n  }, []);\n\n  const exitComparison = useCallback(() => {\n    setIsActive(false);\n    setSelectedModels([]);\n    setActiveComparisonId(null);\n\n    // Track comparison exited (use ref pattern to avoid stale closure)\n    analytics.track(\"comparison_exited\", {});\n  }, []);\n\n  return {\n    isActive,\n    selectedModels,\n    activeComparisonId,\n    startComparison,\n    exitComparison,\n    setActiveComparisonId,\n  };\n}\n","\"use client\";\n\nimport type { Doc, Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useRouter } from \"next/navigation\";\nimport { useCallback, useMemo } from \"react\";\n\ninterface UseConversationNavigationOptions {\n  conversationId: Id<\"conversations\">;\n  filteredConversations: Doc<\"conversations\">[] | undefined;\n}\n\ninterface UseConversationNavigationReturn {\n  currentIndex: number;\n  isFirst: boolean;\n  isLast: boolean;\n  navigateToPrevious: () => void;\n  navigateToNext: () => void;\n}\n\n/**\n * Handles navigation between conversations using arrow keys or buttons.\n * Sorts conversations by creation time (newest first) and provides\n * previous/next navigation.\n */\nexport function useConversationNavigation({\n  conversationId,\n  filteredConversations,\n}: UseConversationNavigationOptions): UseConversationNavigationReturn {\n  const router = useRouter();\n\n  const { currentIndex, isFirst, isLast, sortedConversations } = useMemo(() => {\n    if (!filteredConversations?.length || !conversationId) {\n      return {\n        currentIndex: -1,\n        isFirst: true,\n        isLast: true,\n        sortedConversations: [],\n      };\n    }\n\n    const sorted = [...filteredConversations].sort(\n      (a, b) => b._creationTime - a._creationTime,\n    );\n    const idx = sorted.findIndex((c) => c._id === conversationId);\n\n    return {\n      currentIndex: idx,\n      isFirst: idx <= 0,\n      isLast: idx >= sorted.length - 1,\n      sortedConversations: sorted,\n    };\n  }, [filteredConversations, conversationId]);\n\n  const navigateToPrevious = useCallback(() => {\n    if (isFirst || sortedConversations.length === 0) return;\n\n    const prevIdx = Math.max(currentIndex - 1, 0);\n    router.push(`/chat/${sortedConversations[prevIdx]._id}`);\n  }, [isFirst, sortedConversations, currentIndex, router]);\n\n  const navigateToNext = useCallback(() => {\n    if (isLast || sortedConversations.length === 0) return;\n\n    const nextIdx = Math.min(currentIndex + 1, sortedConversations.length - 1);\n    router.push(`/chat/${sortedConversations[nextIdx]._id}`);\n  }, [isLast, sortedConversations, currentIndex, router]);\n\n  return {\n    currentIndex,\n    isFirst,\n    isLast,\n    navigateToPrevious,\n    navigateToNext,\n  };\n}\n","import { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Doc } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation } from \"convex/react\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport type { OptimisticMessage } from \"@/types/optimistic\";\n\ntype Message = Doc<\"messages\"> | OptimisticMessage;\n\ninterface UseModelRecommendationOptions {\n  conversation: Doc<\"conversations\"> | null | undefined;\n  messages: Message[] | undefined;\n  onModelChange: (modelId: string) => Promise<void>;\n}\n\nexport function useModelRecommendation({\n  conversation,\n  messages,\n  onModelChange,\n}: UseModelRecommendationOptions) {\n  // Preview modal state\n  const [previewModalOpen, setPreviewModalOpen] = useState(false);\n  const [previewModelId, setPreviewModelId] = useState<string | null>(null);\n\n  // Set-as-default prompt state\n  const [showSetDefaultPrompt, setShowSetDefaultPrompt] = useState(false);\n  const [switchedModelId, setSwitchedModelId] = useState<string | null>(null);\n  const [switchedModelAt, setSwitchedModelAt] = useState<number | null>(null);\n\n  // @ts-ignore - Type depth exceeded with complex Convex mutation (85+ modules)\n  const updatePreferences = useMutation(api.users.updatePreferences);\n\n  // Switch to recommended model\n  const handleSwitchModel = useCallback(\n    async (modelId: string) => {\n      await onModelChange(modelId);\n      setSwitchedModelId(modelId);\n      setSwitchedModelAt(Date.now());\n    },\n    [onModelChange],\n  );\n\n  // Open preview modal for a model\n  const handlePreviewModel = useCallback((modelId: string) => {\n    setPreviewModelId(modelId);\n    setPreviewModalOpen(true);\n  }, []);\n\n  // Set switched model as user's default\n  const handleSetAsDefault = useCallback(async () => {\n    if (!switchedModelId) return;\n\n    await updatePreferences({\n      preferences: {\n        defaultModel: switchedModelId,\n      },\n    });\n\n    setShowSetDefaultPrompt(false);\n  }, [switchedModelId, updatePreferences]);\n\n  // Show set-as-default prompt after first successful generation with switched model\n  useEffect(() => {\n    if (switchedModelId && switchedModelAt && messages && messages.length > 0) {\n      const lastMessage = messages[messages.length - 1];\n\n      // Check if last message was generated with switched model and completed\n      if (\n        lastMessage.role === \"assistant\" &&\n        lastMessage.status === \"complete\" &&\n        conversation?.model === switchedModelId &&\n        lastMessage._creationTime > switchedModelAt\n      ) {\n        // Show prompt after a brief delay (2 seconds)\n        const timer = setTimeout(() => {\n          setShowSetDefaultPrompt(true);\n        }, 2000);\n\n        return () => clearTimeout(timer);\n      }\n    }\n  }, [messages, switchedModelId, switchedModelAt, conversation?.model]);\n\n  // Listen for model preview events (from recommendation banner)\n  useEffect(() => {\n    const handler = (e: Event) => {\n      const customEvent = e as CustomEvent<{ modelId: string }>;\n      setPreviewModelId(customEvent.detail.modelId);\n      setPreviewModalOpen(true);\n    };\n    window.addEventListener(\"open-model-preview\", handler);\n    return () => window.removeEventListener(\"open-model-preview\", handler);\n  }, []);\n\n  return {\n    // Preview modal\n    previewModalOpen,\n    setPreviewModalOpen,\n    previewModelId,\n\n    // Set-as-default prompt\n    showSetDefaultPrompt,\n    switchedModelId,\n\n    // Handlers\n    handleSwitchModel,\n    handlePreviewModel,\n    handleSetAsDefault,\n    dismissSetDefaultPrompt: () => setShowSetDefaultPrompt(false),\n  };\n}\n","\"use client\";\n\nimport type { Doc } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useCallback, useMemo, useState } from \"react\";\nimport type { OptimisticMessage } from \"@/types/optimistic\";\n\ntype ServerMessage = Doc<\"messages\">;\nexport type MessageWithOptimistic = ServerMessage | OptimisticMessage;\n\ninterface UseOptimisticMessagesOptions {\n  serverMessages: ServerMessage[] | undefined;\n}\n\ninterface UseOptimisticMessagesReturn {\n  messages: MessageWithOptimistic[];\n  addOptimisticMessages: (msgs: OptimisticMessage[]) => void;\n}\n\n/**\n * Manages optimistic UI for messages - overlay local optimistic messages\n * on top of server state with deduplication when server confirms.\n *\n * Uses useState instead of useOptimistic for instant rendering with TanStack Query.\n */\nexport function useOptimisticMessages({\n  serverMessages,\n}: UseOptimisticMessagesOptions): UseOptimisticMessagesReturn {\n  const [optimisticMessages, setOptimisticMessages] = useState<\n    OptimisticMessage[]\n  >([]);\n\n  // Callback for ChatInput to add optimistic messages (instant, before API call)\n  const addOptimisticMessages = useCallback(\n    (newMessages: OptimisticMessage[]) => {\n      setOptimisticMessages((prev) => [...prev, ...newMessages]);\n    },\n    [],\n  );\n\n  // Merge server messages with optimistic messages, deduplicating confirmed ones\n  const messages = useMemo<MessageWithOptimistic[]>(() => {\n    const server = (serverMessages || []) as MessageWithOptimistic[];\n\n    if (optimisticMessages.length === 0) {\n      return server;\n    }\n\n    // Filter out optimistic messages that have been confirmed by server\n    // Match by role + timestamp within 5s window (handles slow networks)\n    // For assistant messages, also match by model (prevents comparison mode collisions)\n    const pendingOptimistic = optimisticMessages.filter((opt) => {\n      const hasServerVersion = server.some((m) => {\n        // Basic check: role and timestamp within 5s\n        if (m.role !== opt.role) return false;\n        if (Math.abs(m.createdAt - opt.createdAt) >= 5000) return false;\n\n        // For assistant messages, also check model (comparison mode dedup)\n        if (opt.role === \"assistant\" && opt.model && m.model !== opt.model) {\n          return false;\n        }\n\n        return true;\n      });\n      return !hasServerVersion;\n    });\n\n    // Merge and sort chronologically (don't clear state here to avoid blink)\n    return [...server, ...pendingOptimistic].sort(\n      (a, b) => a.createdAt - b.createdAt,\n    );\n  }, [serverMessages, optimisticMessages]);\n\n  // NOTE: We intentionally don't clean up optimistic messages from state\n  // The useMemo already filters them out visually when server confirms.\n  // Keeping them in state avoids the re-render that causes flash.\n  // They'll be cleared naturally on next message send or page navigation.\n\n  return {\n    messages,\n    addOptimisticMessages,\n  };\n}\n","\"use client\";\n\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { useEffect } from \"react\";\n\n/**\n * Handles template insertion from sessionStorage after navigation\n * from the templates page.\n *\n * When user clicks \"Use Template\" on templates page:\n * 1. Template text stored in sessionStorage\n * 2. Navigates to chat with ?insertTemplate=true\n * 3. This hook reads sessionStorage and dispatches insert-prompt event\n * 4. Cleans up URL param\n */\nexport function useTemplateInsertion(): void {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n\n  useEffect(() => {\n    const insertTemplate = searchParams.get(\"insertTemplate\");\n    if (insertTemplate !== \"true\") return;\n\n    // Read template text from sessionStorage\n    const templateText = sessionStorage.getItem(\"pending-template-text\");\n    if (templateText) {\n      // Clear sessionStorage\n      sessionStorage.removeItem(\"pending-template-text\");\n\n      // Dispatch insert-prompt event after a brief delay to ensure ChatInput is mounted\n      setTimeout(() => {\n        window.dispatchEvent(\n          new CustomEvent(\"insert-prompt\", { detail: templateText }),\n        );\n        window.dispatchEvent(new CustomEvent(\"focus-chat-input\"));\n      }, 100);\n    }\n\n    // Clean up URL param\n    const url = new URL(window.location.href);\n    url.searchParams.delete(\"insertTemplate\");\n    router.replace(url.pathname + url.search, { scroll: false });\n  }, [searchParams, router]);\n}\n","\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Doc, Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { usePaginatedQuery, useQuery } from \"convex-helpers/react/cache\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { parseAsBoolean, useQueryState } from \"nuqs\";\nimport { use, useCallback, useEffect, useRef, useState } from \"react\";\nimport { CanvasPanel } from \"@/components/canvas/CanvasPanel\";\nimport { ChatHeader } from \"@/components/chat/ChatHeader\";\nimport { ChatInput } from \"@/components/chat/ChatInput\";\nimport { MessageListSkeleton } from \"@/components/chat/MessageListSkeleton\";\nimport { ModelPreviewModal } from \"@/components/chat/ModelPreviewModal\";\nimport { ModelRecommendationBanner } from \"@/components/chat/ModelRecommendationBanner\";\nimport { QuickModelSwitcher } from \"@/components/chat/QuickModelSwitcher\";\nimport { SetDefaultModelPrompt } from \"@/components/chat/SetDefaultModelPrompt\";\nimport type { ThinkingEffort } from \"@/components/chat/ThinkingEffortSelector\";\nimport { TTSPlayerBar } from \"@/components/chat/TTSPlayerBar\";\nimport { VirtualizedMessageList } from \"@/components/chat/VirtualizedMessageList\";\nimport { QuickTemplateSwitcher } from \"@/components/templates/QuickTemplateSwitcher\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  ResizableHandle,\n  ResizablePanel,\n  ResizablePanelGroup,\n} from \"@/components/ui/resizable\";\nimport { useCanvasContext } from \"@/contexts/CanvasContext\";\nimport { useConversationContext } from \"@/contexts/ConversationContext\";\nimport { TTSProvider } from \"@/contexts/TTSContext\";\nimport { useCanvasAutoSync } from \"@/hooks/useCanvasAutoSync\";\nimport { useChatKeyboardShortcuts } from \"@/hooks/useChatKeyboardShortcuts\";\nimport { useChatModelSelection } from \"@/hooks/useChatModelSelection\";\nimport { useComparisonHandlers } from \"@/hooks/useComparisonHandlers\";\nimport { useComparisonMode } from \"@/hooks/useComparisonMode\";\nimport { useConversationNavigation } from \"@/hooks/useConversationNavigation\";\nimport { useFeatureToggles } from \"@/hooks/useFeatureToggles\";\nimport { useMobileDetect } from \"@/hooks/useMobileDetect\";\nimport { useModelRecommendation } from \"@/hooks/useModelRecommendation\";\nimport { useOptimisticMessages } from \"@/hooks/useOptimisticMessages\";\nimport { useTemplateInsertion } from \"@/hooks/useTemplateInsertion\";\nimport { useUserPreference } from \"@/hooks/useUserPreference\";\nimport { MODEL_CONFIG } from \"@/lib/ai/models\";\nimport { getModelConfig } from \"@/lib/ai/utils\";\nimport type { ChatWidth } from \"@/lib/utils/chatWidth\";\n\nfunction ChatPageContent({\n  params,\n}: {\n  params: Promise<{ conversationId: Id<\"conversations\"> }>;\n}) {\n  const unwrappedParams = use(params);\n  const conversationId = unwrappedParams.conversationId;\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const highlightMessageId = searchParams.get(\"messageId\") ?? undefined;\n\n  const { filteredConversations } = useConversationContext();\n  const { documentId, setDocumentId } = useCanvasContext();\n\n  const activeCanvasDocument = useQuery(\n    // @ts-ignore - TypeScript recursion limit with 94+ Convex modules\n    api.canvas.documents.getByConversation,\n    conversationId ? { conversationId } : \"skip\",\n  );\n\n  const conversation = useQuery(\n    // @ts-ignore - TypeScript recursion limit with 94+ Convex modules\n    api.conversations.get,\n    conversationId ? { conversationId } : \"skip\",\n  );\n  const {\n    results: serverMessages,\n    status: paginationStatus,\n    loadMore,\n  } = usePaginatedQuery(\n    api.messages.listPaginated,\n    conversationId ? { conversationId } : \"skip\",\n    {\n      initialNumItems: 50,\n    },\n  );\n  // @ts-ignore - Type depth exceeded with complex Convex query (85+ modules)\n  const user = useQuery(api.users.getCurrentUser);\n\n  // Canvas auto-sync with conversation mode and navigation\n  const isDocumentMode = conversation?.mode === \"document\";\n  const { handleClose: handleCanvasClose } = useCanvasAutoSync({\n    conversationId,\n    isDocumentMode,\n    documentId,\n    activeCanvasDocumentId: activeCanvasDocument?._id,\n    setDocumentId,\n  });\n\n  // Optimistic UI: Overlay local optimistic messages on top of server state\n  const { messages, addOptimisticMessages } = useOptimisticMessages({\n    serverMessages,\n  });\n\n  // Extract chat width preference with loading detection\n  const rawChatWidth = useQuery(api.users.getUserPreference, {\n    key: \"chatWidth\",\n  });\n  const isChatWidthLoading = rawChatWidth === undefined;\n  const chatWidth = (rawChatWidth as ChatWidth | undefined) || \"standard\";\n  const defaultModel = useUserPreference(\"defaultModel\");\n  const showModelNamesDuringComparison = useUserPreference(\n    \"showModelNamesDuringComparison\",\n  );\n  const ttsSpeed = useUserPreference(\"ttsSpeed\");\n\n  // Feature toggles for conditional UI elements\n  const features = useFeatureToggles();\n\n  // Model selection with optimistic updates\n  const { selectedModel, displayModel, modelLoading, handleModelChange } =\n    useChatModelSelection({\n      conversationId,\n      conversation,\n      user,\n      defaultModel,\n    });\n\n  const [thinkingEffort, setThinkingEffort] = useState<ThinkingEffort>(\"none\");\n  const [attachments, setAttachments] = useState<\n    Array<{\n      type: \"file\" | \"image\" | \"audio\";\n      name: string;\n      storageId: string;\n      mimeType: string;\n      size: number;\n    }>\n  >([]);\n\n  // URL state for comparison view toggles\n  const [showModelNames, setShowModelNames] = useQueryState(\n    \"showModelNames\",\n    parseAsBoolean.withDefault(showModelNamesDuringComparison),\n  );\n\n  const [modelSelectorOpen, setModelSelectorOpen] = useState(false);\n  const [comparisonDialogOpen, setComparisonDialogOpen] = useState(false);\n  const [quickSwitcherOpen, setQuickSwitcherOpen] = useState(false);\n  const [templateSelectorOpen, setTemplateSelectorOpen] = useState(false);\n\n  // Ref for infinite scroll at top of message list\n  const messageListTopRef = useRef<HTMLDivElement | null>(null);\n\n  const { isActive, selectedModels, startComparison, exitComparison } =\n    useComparisonMode();\n  const { isMobile, isTouchDevice } = useMobileDetect();\n\n  // Comparison voting and consolidation handlers\n  const { handleVote, handleConsolidate } = useComparisonHandlers({\n    conversationId,\n    messages,\n  });\n\n  // Model recommendation (extracted to hook)\n  const modelRecommendation = useModelRecommendation({\n    conversation,\n    messages,\n    onModelChange: handleModelChange,\n  });\n\n  // Keyboard shortcuts (âŒ˜J for model switcher, âŒ˜; for templates)\n  useChatKeyboardShortcuts({\n    onOpenQuickSwitcher: useCallback(() => setQuickSwitcherOpen(true), []),\n    onOpenTemplateSelector: useCallback(\n      () => setTemplateSelectorOpen(true),\n      [],\n    ),\n  });\n\n  // Template insertion from sessionStorage (after navigation from templates page)\n  useTemplateInsertion();\n\n  // Infinite scroll for loading more messages (at top of list)\n  useEffect(() => {\n    if (!messageListTopRef.current || paginationStatus !== \"CanLoadMore\") {\n      return;\n    }\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        if (entries[0].isIntersecting && paginationStatus === \"CanLoadMore\") {\n          loadMore(50);\n        }\n      },\n      { threshold: 1.0 },\n    );\n\n    observer.observe(messageListTopRef.current);\n\n    return () => observer.disconnect();\n  }, [paginationStatus, loadMore]);\n\n  // Redirect if conversation is confirmed to be null (deleted/invalid)\n  // Track if we've completed initial load to prevent premature redirects\n  const initialLoadComplete = useRef(false);\n\n  useEffect(() => {\n    // Wait for query to finish loading (undefined = loading, null = not found)\n    if (conversation === undefined) {\n      initialLoadComplete.current = false;\n      return;\n    }\n\n    // Mark initial load complete\n    initialLoadComplete.current = true;\n\n    // Only redirect if truly null (deleted/invalid conversation)\n    if (conversation === null) {\n      router.push(\"/app\");\n    }\n  }, [conversation, router]);\n\n  // Autofocus input when navigating to conversation\n  useEffect(() => {\n    if (!conversationId || isMobile || isTouchDevice) return;\n\n    const timer = setTimeout(() => {\n      window.dispatchEvent(new CustomEvent(\"focus-chat-input\"));\n    }, 50);\n\n    return () => clearTimeout(timer);\n  }, [conversationId, isMobile, isTouchDevice]);\n\n  // Derived state that handles loading gracefully\n  const isGenerating =\n    messages?.some(\n      (m) =>\n        m.role === \"assistant\" &&\n        [\"pending\", \"generating\"].includes(m.status || \"\"),\n    ) ?? false;\n\n  const modelConfig = getModelConfig(displayModel);\n  // Show selector if model has reasoning config OR \"thinking\" capability (native reasoning)\n  const showThinkingEffort =\n    !!modelConfig?.reasoning || modelConfig?.capabilities?.includes(\"thinking\");\n  const hasMessages = (messages?.length ?? 0) > 0;\n\n  // Navigation between conversations\n  const { isFirst, isLast, navigateToPrevious, navigateToNext } =\n    useConversationNavigation({\n      conversationId,\n      filteredConversations,\n    });\n\n  const isLoading =\n    serverMessages === undefined ||\n    paginationStatus === \"LoadingFirstPage\" ||\n    isChatWidthLoading;\n\n  return (\n    <TTSProvider defaultSpeed={ttsSpeed}>\n      <ResizablePanelGroup\n        orientation=\"horizontal\"\n        className=\"flex-1 min-h-0\"\n        id=\"chat-canvas-layout\"\n      >\n        {/* Chat Panel - always renders, takes full width when canvas closed */}\n        <ResizablePanel defaultSize={documentId ? 45 : 100} minSize={30}>\n          <div className=\"flex flex-col h-full\">\n            <ChatHeader\n              conversation={conversation}\n              conversationId={conversationId}\n              selectedModel={displayModel}\n              modelLoading={modelLoading}\n              hasMessages={hasMessages}\n              isFirst={isFirst}\n              isLast={isLast}\n              isComparisonActive={isActive}\n              comparisonModelCount={selectedModels.length}\n              showProjects={features.showProjects}\n              onNavigatePrevious={navigateToPrevious}\n              onNavigateNext={navigateToNext}\n              onModelBadgeClick={() => setModelSelectorOpen(true)}\n              onComparisonBadgeClick={() => setComparisonDialogOpen(true)}\n            />\n\n            <TTSPlayerBar />\n\n            <AnimatePresence mode=\"popLayout\">\n              {isLoading ? (\n                <motion.div\n                  key=\"skeleton\"\n                  initial={{ opacity: 1 }}\n                  exit={{ opacity: 0 }}\n                  transition={{ duration: 0.15 }}\n                >\n                  <MessageListSkeleton chatWidth={chatWidth} />\n                </motion.div>\n              ) : (\n                <motion.div\n                  key={`messages-${conversationId}`}\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  exit={{ opacity: 0 }}\n                  transition={{ duration: 0.2 }}\n                  className=\"flex-1 flex flex-col min-h-0\"\n                >\n                  {/* Load More Button (fallback for top of list) */}\n                  {paginationStatus === \"CanLoadMore\" && (\n                    <div className=\"flex justify-center p-4\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => loadMore(50)}\n                        className=\"text-sm\"\n                      >\n                        Load older messages\n                      </Button>\n                    </div>\n                  )}\n                  {paginationStatus === \"LoadingMore\" && (\n                    <div className=\"flex justify-center p-4\">\n                      <div className=\"text-sm text-muted-foreground\">\n                        Loading more messages...\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Invisible div for intersection observer */}\n                  <div ref={messageListTopRef} className=\"h-px\" />\n\n                  <VirtualizedMessageList\n                    messages={messages as Doc<\"messages\">[]}\n                    selectedModel={displayModel}\n                    chatWidth={chatWidth}\n                    isGenerating={isGenerating}\n                    onVote={handleVote}\n                    onConsolidate={handleConsolidate}\n                    onToggleModelNames={() =>\n                      setShowModelNames(!showModelNames)\n                    }\n                    showModelNames={showModelNames ?? false}\n                    highlightMessageId={highlightMessageId}\n                    isCollaborative={conversation?.isCollaborative}\n                  />\n\n                  {/* Model Recommendation Banner */}\n                  {conversation?.modelRecommendation &&\n                    !conversation.modelRecommendation.dismissed && (\n                      <ModelRecommendationBanner\n                        recommendation={conversation.modelRecommendation}\n                        conversationId={conversationId}\n                        onSwitch={modelRecommendation.handleSwitchModel}\n                        onPreview={modelRecommendation.handlePreviewModel}\n                      />\n                    )}\n\n                  {/* Set Default Model Prompt (shows after successful generation) */}\n                  {modelRecommendation.showSetDefaultPrompt &&\n                    modelRecommendation.switchedModelId && (\n                      <SetDefaultModelPrompt\n                        modelId={modelRecommendation.switchedModelId}\n                        modelName={\n                          MODEL_CONFIG[modelRecommendation.switchedModelId]\n                            ?.name ?? modelRecommendation.switchedModelId\n                        }\n                        conversationId={conversationId}\n                        onSetDefault={modelRecommendation.handleSetAsDefault}\n                        onDismiss={modelRecommendation.dismissSetDefaultPrompt}\n                      />\n                    )}\n\n                  {/* Preview Modal */}\n                  {modelRecommendation.previewModalOpen &&\n                    modelRecommendation.previewModelId &&\n                    conversation?.modelRecommendation && (\n                      <ModelPreviewModal\n                        open={modelRecommendation.previewModalOpen}\n                        onOpenChange={modelRecommendation.setPreviewModalOpen}\n                        currentModelId={\n                          conversation.modelRecommendation.currentModelId\n                        }\n                        suggestedModelId={modelRecommendation.previewModelId}\n                        currentResponse={\n                          messages?.find((m) => m.role === \"assistant\")\n                            ?.content ?? \"\"\n                        }\n                        onSwitch={modelRecommendation.handleSwitchModel}\n                        conversationId={conversationId}\n                        userMessage={\n                          messages?.find((m) => m.role === \"user\")?.content ??\n                          \"\"\n                        }\n                      />\n                    )}\n\n                  <QuickModelSwitcher\n                    open={quickSwitcherOpen}\n                    onOpenChange={setQuickSwitcherOpen}\n                    currentModel={selectedModel}\n                    onSelectModel={handleModelChange}\n                  />\n\n                  <QuickTemplateSwitcher\n                    open={templateSelectorOpen}\n                    onOpenChange={setTemplateSelectorOpen}\n                    mode=\"insert\"\n                    onSelectTemplate={(prompt) => {\n                      // Dispatch event to insert template into chat input\n                      window.dispatchEvent(\n                        new CustomEvent(\"insert-prompt\", { detail: prompt }),\n                      );\n                    }}\n                  />\n                </motion.div>\n              )}\n            </AnimatePresence>\n\n            {/* ChatInput always rendered - prevents focus loss during loading state transitions */}\n            <div className=\"flex shrink-0\">\n              <ChatInput\n                conversationId={conversationId}\n                chatWidth={chatWidth}\n                isGenerating={isGenerating}\n                selectedModel={displayModel}\n                onModelChange={handleModelChange}\n                thinkingEffort={showThinkingEffort ? thinkingEffort : undefined}\n                onThinkingEffortChange={setThinkingEffort}\n                attachments={attachments}\n                onAttachmentsChange={setAttachments}\n                isComparisonMode={isActive}\n                selectedModels={selectedModels}\n                onStartComparison={startComparison}\n                onExitComparison={exitComparison}\n                isEmpty={messages?.length === 0}\n                modelSelectorOpen={modelSelectorOpen}\n                onModelSelectorOpenChange={setModelSelectorOpen}\n                comparisonDialogOpen={comparisonDialogOpen}\n                onComparisonDialogOpenChange={setComparisonDialogOpen}\n                onOptimisticUpdate={addOptimisticMessages}\n              />\n            </div>\n          </div>\n        </ResizablePanel>\n\n        {/* Canvas Panel - conditionally rendered */}\n        {documentId && (\n          <>\n            <ResizableHandle withHandle />\n            <ResizablePanel defaultSize={55} minSize={25}>\n              <CanvasPanel\n                documentId={documentId}\n                onClose={handleCanvasClose}\n              />\n            </ResizablePanel>\n          </>\n        )}\n      </ResizablePanelGroup>\n    </TTSProvider>\n  );\n}\n\nexport default function ChatPage({\n  params,\n}: {\n  params: Promise<{ conversationId: Id<\"conversations\"> }>;\n}) {\n  return <ChatPageContent params={params} />;\n}\n"],"names":["assert","expectedCondition","message","calculateAvailableGroupSize","group","orientation","panels","totalSize","panel","sortByElementOffset","panelsOrSeparators","horizontalSort","verticalSort","a","b","delta","isHTMLElement","value","getDistanceBetweenPointAndRect","point","rect","findClosestRect","rects","targetRect","centerPoint","closestRect","minDistance","x","y","distance","calculateHitRegions","groupElement","separators","sortedChildElements","element","hitRegions","hasInterleavedStaticContent","prevPanel","pendingSeparators","childElement","panelData","current","prevRect","pendingRectsOrSeparators","firstPanelEdgeRect","secondPanelEdgeRect","separator","rectOrSeparator","separatorData","convertEmToPixels","style","fontSize","convertRemToPixels","convertVhToPixels","convertVwToPixels","parseSizeAndUnit","size","numeric","sizeStyleToPixels","groupSize","panelElement","styleProp","pixels","unit","formatLayoutNumber","number","calculatePanelConstraints","panelConstraints","collapsedSize","defaultSize","minSize","maxSize","EventEmitter","#listenerMap","type","listener","listeners","data","didThrow","caughtError","clonedListeners","i","error","index","layoutNumbersEqual","actual","expected","minimumDelta","state","eventEmitter","read","update","partialState","prevState","constraints","prevLayout","isCollapsed","wasCollapsed","isArrayEqual","compareLayoutNumbers","validatePanelSize","collapsible","halfwayPoint","adjustLayoutByDelta","initialLayoutProp","panelConstraintsArray","pivotIndices","prevLayoutProp","trigger","initialLayout","nextLayout","firstPivotIndex","secondPivotIndex","deltaApplied","prevSize","localDelta","increment","maxAvailableDelta","minAbsDelta","deltaRemaining","unsafeSize","safeSize","pivotIndex","total","prevLayoutKeys","accumulated","findSeparatorGroup","separatorElement","mountedGroups","layoutsEqual","id","validatePanelGroupLayout","layout","nextLayoutTotalSize","remainingSize","getImperativeGroupMethods","groupId","find","defaultLayoutDeferred","unsafeLayout","derivedPanelConstraints","separatorToPanels","getMountedGroup","mountedGroup","adjustLayoutForSeparator","onDocumentKeyDown","event","primaryPanel","nextSize","separatorElements","nextIndex","IDENTITY_FUNCTION","NOOP_FUNCTION","CURSOR_FLAG_HORIZONTAL_MIN","CURSOR_FLAG_HORIZONTAL_MAX","CURSOR_FLAG_VERTICAL_MIN","CURSOR_FLAG_VERTICAL_MAX","DEFAULT_POINTER_PRECISION","findClosetHitRegion","closestHitRegion","hitRegion","cached","isCoarsePointer","isShadowRoot","compare","ancestors","get_ancestors","common_ancestor","z_indexes","get_z_index","find_stacking_context","children","furthest_ancestors","child","props","is_flex_item","node","display","get_parent","creates_stacking_context","nodes","parentNode","doRectsIntersect","isViableHitTarget","pointerEventTarget","currentElement","findMatchingHitRegions","matchingHitRegions","_","groupData","maxDistance","match","onDocumentPointerDown","groups","initialLayoutMap","didChangeFocus","getCursorStyle","cursorFlags","horizontalCount","verticalCount","horizontalMin","horizontalMax","verticalMin","verticalMax","documentToStyleMap","updateCursorStyle","ownerDocument","prevStyle","styleSheet","interactionState","cursorStyle","nextStyle","updateActiveHitRegions","document","pointerDownAtPoint","nextMountedGroups","disableCursor","deltaAsPercentage","panelIdsKey","onDocumentPointerLeave","onDocumentPointerMove","onDocumentPointerUp","calculateDefaultLayout","explicitCount","remainingPanelCount","notifyPanelOnResize","borderBoxSize","resizeObserverSize","objectsEqual","key","validateLayoutKeys","panelIds","layoutKeys","panelId","ownerDocumentReferenceCounts","mountGroup","isMounted","ResizeObserver","separatorIds","resizeObserver","entries","entry","target","nextDerivedPanelConstraints","defaultLayout","defaultLayoutUnsafe","defaultLayoutSafe","useId","stableId","dynamicId","useIdReact","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","useStableCallback","fn","ref","useRef","useCallback","args","useMergedRefs","refs","useStableObject","unstableObject","POINTER_EVENTS_CSS_PROPERTY_NAME","getPanelSizeCssPropertyName","groupIdEscaped","panelIdEscaped","GroupContext","createContext","useGroupImperativeHandle","groupRef","imperativeGroupRef","useImperativeHandle","Group","className","disabled","elementRef","idProp","onLayoutChangeUnstable","rest","prevLayoutRef","onLayoutChangeStable","dragActive","setDragActive","useState","setElement","setLayout","setPanels","setSeparators","inMemoryValuesRef","mergedRef","context","useMemo","prev","stableProps","registeredGroupRef","unmountGroup","removeInteractionStateChangeListener","removeMountedGroupsChangeEventListener","registeredGroup","cssVariables","propertyName","flexGrow","jsx","debounce","durationMs","timeout","getStorageKey","useDefaultLayout","debounceSaveMs","storage","storageKey","defaultLayoutString","useSyncExternalStore","subscribe","onLayoutChange","saveLayout","useGroupCallbackRef","useGroupRef","useGroupContext","useContext","getImperativePanelMethods","getPanelConstraints","getPanel","getPanelSize","setPanelSize","isLastPanel","asPercentage","inPixels","usePanelImperativeHandle","panelRef","imperativePanelRef","Panel","onResizeUnstable","idIsStable","registerPanel","hasOnResize","onResizeStable","panelSize","flexGrowVar","PROHIBITED_CSS_PROPERTIES","usePanelCallbackRef","usePanelRef","calculateSeparatorAriaValues","panelIndex","valueMax","valueMin","Separator","aria","setAria","dragState","setDragState","groupOrientation","registerSeparator","unregisterSeparator","removeMountedGroupsChangeListener"],"mappings":"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","ignoreList":[6,7,34,35,37,38,41,49,51,52,53,54,55,56,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133]}