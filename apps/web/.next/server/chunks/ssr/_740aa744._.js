module.exports=[592552,a=>{"use strict";var b=a.i(367146),c=a.i(700760);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},885737,a=>{"use strict";var b=a.i(417554);a.s(["CheckCircle2",()=>b.default])},901555,a=>{"use strict";let b=(0,a.i(366705).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);a.s(["Upload",()=>b],901555)},728004,a=>{"use strict";var b=a.i(367146),c=a.i(130487);a.i(16243);var d=a.i(182234),e=a.i(698734),f=a.i(885737),g=a.i(116245),h=a.i(452549),i=a.i(901555),j=a.i(502311),k=a.i(537500),l=a.i(753884),m=a.i(968177),n=a.i(539524),o=a.i(592552);function p(){let a=(0,j.useRouter)(),[p,q]=(0,k.useState)(null),[r,s]=(0,k.useState)(null),[t,u]=(0,k.useState)(null),[v,w]=(0,k.useState)(!1),x=(0,d.useMutation)(c.api.import.importConversations),y=async a=>{let b=a.target.files?.[0];if(!b)return;u(null),s(null),q(b);let c=b.size>0xa00000?{valid:!1,error:"File too large. Maximum size is 10MB"}:[".json",".md",".txt"].includes(b.name.toLowerCase().slice(b.name.lastIndexOf(".")))?{valid:!0}:{valid:!1,error:"Invalid file type. Please upload a .json, .md, or .txt file"};if(!c.valid)return void u(c.error||"Invalid file");w(!0);try{let a=await b.text(),c=function(a){switch(function(a){let b=a.trim();if(b.startsWith("{")||b.startsWith("["))try{let a=JSON.parse(b);if(a.version&&a.conversations&&a.exportedAt)return"json";if(a.mapping||Array.isArray(a)&&a[0]?.mapping)return"chatgpt";if(a.conversations)return"json"}catch{}return b.startsWith("#")||b.includes("## You")||b.includes("## Assistant")?"markdown":"unknown"}(a)){case"json":try{let b=JSON.parse(a);if(!b.version||!b.conversations)return{success:!1,error:"Invalid JSON format: missing required fields"};let c=b.conversations.map(a=>({title:a.title,model:a.model,systemPrompt:a.systemPrompt,createdAt:a.createdAt,messages:a.messages.map(a=>({role:a.role,content:a.content,createdAt:a.createdAt,model:a.model}))})),d=c.reduce((a,b)=>a+b.messages.length,0);return{success:!0,data:{conversations:c,format:"json"},conversationsCount:c.length,messagesCount:d}}catch(a){return{success:!1,error:`Failed to parse JSON: ${a instanceof Error?a.message:"Unknown error"}`}}case"markdown":try{let b=a.split(/\n---\n\n/).filter(a=>a.trim().length>0&&!a.startsWith("# blah.chat Export"));if(0===b.length)return{success:!1,error:"No conversations found in markdown file"};let c=b.map(a=>{let b=a.match(/^# (.+?)$/m);if(!b)return null;let c=b[1],d=a.match(/\*\*Model\*\*: (.+?)$/m),e=a.match(/\*\*System Prompt\*\*: (.+?)$/m),f=[];for(let b of[...a.matchAll(/## (You|Assistant|System)\n\n([\s\S]*?)(?=\n## |$)/g)]){let a=b[1],c=b[2].trim();c=c.replace(/\*Cost:.*?\*\n*$/m,"").trim(),f.push({role:"You"===a?"user":"Assistant"===a?"assistant":"system",content:c})}return 0===f.length?null:{title:c,model:d?.[1],systemPrompt:e?.[1],messages:f}}).filter(a=>null!==a);if(0===c.length)return{success:!1,error:"Failed to parse any valid conversations from markdown"};let d=c.reduce((a,b)=>a+b.messages.length,0);return{success:!0,data:{conversations:c,format:"markdown"},conversationsCount:c.length,messagesCount:d}}catch(a){return{success:!1,error:`Failed to parse Markdown: ${a instanceof Error?a.message:"Unknown error"}`}}case"chatgpt":try{let b=JSON.parse(a),c=Array.isArray(b)?b:[b];if(0===c.length)return{success:!1,error:"No conversations found in ChatGPT export"};let d=c.map(a=>{if(!a.mapping||!a.title)return null;let b=Object.values(a.mapping).filter(a=>a.content?.parts?.length>0).map(a=>({role:a.author.role,content:a.content.parts.join("\n"),createdAt:a.create_time?1e3*a.create_time:void 0})).filter(a=>a.content.trim().length>0);return 0===b.length?null:{title:a.title,messages:b,createdAt:a.create_time?1e3*a.create_time:void 0}}).filter(a=>null!==a);if(0===d.length)return{success:!1,error:"Failed to parse any valid conversations from ChatGPT export"};let e=d.reduce((a,b)=>a+b.messages.length,0);return{success:!0,data:{conversations:d,format:"chatgpt"},conversationsCount:d.length,messagesCount:e}}catch(a){return{success:!1,error:`Failed to parse ChatGPT export: ${a instanceof Error?a.message:"Unknown error"}`}}default:return{success:!1,error:"Unable to detect file format. Please upload a JSON, Markdown, or ChatGPT export file."}}}(a);if(!c.success)return void u(c.error||"Failed to parse file");s(c.data),l.toast.success(`Found ${c.conversationsCount} conversations with ${c.messagesCount} messages`)}catch(a){u(a instanceof Error?a.message:"Failed to process file")}finally{w(!1)}},z=async()=>{if(r){w(!0);try{let b=await x({conversations:r.conversations});if(!b.success)throw Error(b.error||"Import failed");l.toast.success(`Successfully imported ${b.importedCount} conversations`),b.conversationIds.length>0?a.push(`/chat/${b.conversationIds[0]}`):a.push("/")}catch(a){l.toast.error(a instanceof Error?a.message:"Failed to import conversations"),u(a instanceof Error?a.message:"Failed to import conversations")}finally{w(!1)}}};return(0,b.jsx)("div",{className:"container max-w-4xl mx-auto p-6",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Import Conversations"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-2",children:"Import your conversations from blah.chat JSON exports, Markdown files, or ChatGPT exports"})]}),(0,b.jsx)(o.Card,{className:"p-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.FileText,{className:"w-5 h-5 text-primary"}),(0,b.jsx)("h2",{className:"font-semibold text-lg",children:"Select File"})]}),(0,b.jsx)("div",{className:"border-2 border-dashed border-border rounded-lg p-8",children:(0,b.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,b.jsx)(i.Upload,{className:"w-12 h-12 text-muted-foreground"}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"font-medium",children:p?p.name:"Click to upload or drag and drop"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"JSON, Markdown, or Text files (max 10MB)"})]}),(0,b.jsx)(n.Button,{type:"button",variant:"outline",children:"Choose File"})]}),(0,b.jsx)("input",{id:"file-upload",type:"file",className:"sr-only",accept:".json,.md,.txt",onChange:y,disabled:v})]})}),t&&(0,b.jsxs)("div",{className:"flex items-start gap-2 p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:[(0,b.jsx)(e.AlertCircle,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-destructive",children:"Error"}),(0,b.jsx)("p",{className:"text-sm text-destructive/90 mt-1",children:t})]})]})]})}),r&&(0,b.jsx)(o.Card,{className:"p-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.CheckCircle2,{className:"w-5 h-5 text-green-600"}),(0,b.jsx)("h2",{className:"font-semibold text-lg",children:"Import Preview"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:"Format Detected"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"json"===r.format?"blah.chat JSON Export":"chatgpt"===r.format?"ChatGPT Export":"Markdown"})]}),(0,b.jsx)(m.Badge,{variant:"outline",children:r.format})]}),(0,b.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg",children:[(0,b.jsx)("p",{className:"font-medium",children:"Conversations to Import"}),(0,b.jsx)("p",{className:"text-2xl font-bold mt-1",children:r.conversations.length}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Total messages:"," ",r.conversations.reduce((a,b)=>a+b.messages.length,0)]})]}),(0,b.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.conversations.map((a,c)=>(0,b.jsxs)("div",{className:"p-3 border border-border rounded-lg",children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:a.title}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[a.messages.length," messages",a.model&&` \xb7 ${a.model}`]})]},c))})]}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,b.jsx)(n.Button,{onClick:z,disabled:v,className:"flex-1",children:v?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):"Import Conversations"}),(0,b.jsx)(n.Button,{variant:"outline",onClick:()=>{q(null),s(null),u(null)},disabled:v,children:"Cancel"})]})]})}),(0,b.jsxs)(o.Card,{className:"p-6 bg-muted/30",children:[(0,b.jsx)("h3",{className:"font-semibold mb-3",children:"Supported Formats"}),(0,b.jsxs)("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-primary mt-0.5",children:"•"}),(0,b.jsxs)("span",{children:[(0,b.jsx)("strong",{children:"blah.chat JSON:"})," Full export from Settings → Export"]})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-primary mt-0.5",children:"•"}),(0,b.jsxs)("span",{children:[(0,b.jsx)("strong",{children:"ChatGPT:"})," Export from ChatGPT settings"]})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-primary mt-0.5",children:"•"}),(0,b.jsxs)("span",{children:[(0,b.jsx)("strong",{children:"Markdown:"})," Plain text conversation exports"]})]})]})]})]})})}a.s(["default",()=>p],728004)}];

//# sourceMappingURL=_740aa744._.js.map