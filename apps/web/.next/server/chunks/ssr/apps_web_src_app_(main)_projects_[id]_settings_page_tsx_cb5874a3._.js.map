{"version":3,"sources":["../../../../../../apps/web/src/app/%28main%29/projects/%5Bid%5D/settings/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { api } from \"@blah-chat/backend/convex/_generated/api\";\nimport type { Id } from \"@blah-chat/backend/convex/_generated/dataModel\";\nimport { useMutation, useQuery } from \"convex/react\";\nimport { Trash2 } from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { use, useState } from \"react\";\nimport { toast } from \"sonner\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\n\nexport default function ProjectSettingsPage({\n  params,\n}: {\n  params: Promise<{ id: string }>;\n}) {\n  const { id } = use(params);\n  const projectId = id as Id<\"projects\">;\n  const router = useRouter();\n\n  const project = useQuery(api.projects.get, { id: projectId });\n  const updateProject = useMutation(api.projects.update);\n  const deleteProject = useMutation(api.projects.deleteProject);\n\n  const [name, setName] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [systemPrompt, setSystemPrompt] = useState(\"\");\n  const [isDirty, setIsDirty] = useState(false);\n\n  // Load initial data\n  if (project && !isDirty && !name) {\n    setName(project.name);\n    setDescription(project.description || \"\");\n    setSystemPrompt(project.systemPrompt || \"\");\n    // Don't set dirty here, just init\n  }\n\n  const handleSave = async () => {\n    try {\n      await updateProject({\n        id: projectId,\n        name,\n        description,\n        systemPrompt,\n      });\n      toast.success(\"Project updated\");\n      setIsDirty(false);\n    } catch (error) {\n      toast.error(\"Failed to update project\");\n      console.error(error);\n    }\n  };\n\n  const handleDelete = async () => {\n    try {\n      await deleteProject({ id: projectId });\n      toast.success(\"Project deleted\");\n      router.push(\"/projects\");\n    } catch (error) {\n      toast.error(\"Failed to delete project\");\n      console.error(error);\n    }\n  };\n\n  if (!project) return <div className=\"p-8\">Loading...</div>;\n\n  return (\n    <div className=\"flex flex-col h-full bg-background/50 backdrop-blur-xl max-w-2xl mx-auto w-full\">\n      <header className=\"p-6 border-b bg-background/40 mb-6\">\n        <h1 className=\"text-2xl font-bold tracking-tight\">Project Settings</h1>\n        <p className=\"text-muted-foreground text-sm\">\n          Manage your project configuration\n        </p>\n      </header>\n\n      <div className=\"px-6 space-y-8 pb-10\">\n        <div className=\"space-y-4\">\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"name\">Project Name</Label>\n            <Input\n              id=\"name\"\n              value={name}\n              onChange={(e) => {\n                setName(e.target.value);\n                setIsDirty(true);\n              }}\n              placeholder=\"e.g. Website Redesign\"\n            />\n          </div>\n\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"description\">Description</Label>\n            <Textarea\n              id=\"description\"\n              value={description}\n              onChange={(e) => {\n                setDescription(e.target.value);\n                setIsDirty(true);\n              }}\n              placeholder=\"Brief description of the project\"\n              className=\"resize-none h-24\"\n            />\n          </div>\n\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"systemPrompt\">\n              System Prompt{\" \"}\n              <span className=\"text-xs text-muted-foreground\">(Optional)</span>\n            </Label>\n            <Textarea\n              id=\"systemPrompt\"\n              value={systemPrompt}\n              onChange={(e) => {\n                setSystemPrompt(e.target.value);\n                setIsDirty(true);\n              }}\n              placeholder=\"Custom instructions for AI whenever working in this project context...\"\n              className=\"resize-y h-32 font-mono text-sm\"\n            />\n            <p className=\"text-xs text-muted-foreground\">\n              This prompt will be injected into AI context for chats linked to\n              this project.\n            </p>\n          </div>\n\n          <div className=\"pt-4 flex justify-end\">\n            <Button onClick={handleSave} disabled={!isDirty}>\n              Save Changes\n            </Button>\n          </div>\n        </div>\n\n        <div className=\"border-t pt-8\">\n          <h3 className=\"text-lg font-medium text-destructive mb-4\">\n            Danger Zone\n          </h3>\n          <div className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 flex items-center justify-between\">\n            <div>\n              <p className=\"font-medium text-destructive\">Delete Project</p>\n              <p className=\"text-sm text-muted-foreground\">\n                Permanently delete this project and all its data.\n              </p>\n            </div>\n            <AlertDialog>\n              <AlertDialogTrigger asChild>\n                <Button variant=\"destructive\">\n                  <Trash2 className=\"mr-2 h-4 w-4\" />\n                  Delete Project\n                </Button>\n              </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    This action cannot be undone. This will permanently delete\n                    the project <strong>{project.name}</strong> and remove all\n                    associations. tasks, notes, and files will remain but be\n                    unlinked.\n                    {/* Wait, actual deletion logic suggests it cascades?\n                        Checking convex/projects.ts -> deleteProject:\n                        It unlinks conversations (junctions deleted), unlinks project from conversations (projectId=undefined).\n                        It deletes the project row.\n                        It DOES NOT delete the actual notes/files/conversations themselves, just the link.\n                        Wait, need to check if it deletes tasks?\n                        The deleteProject mutation I saw earlier removes junctions.\n                        Tasks? \"deleteProject\" does NOT seem to delete tasks in the code I reviewed (only junctions).\n                        Actually, tasks have projectId. It might need a clean up.\n                        But the message above is safe: \"remove all associations\".\n                    */}\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel>Cancel</AlertDialogCancel>\n                  <AlertDialogAction\n                    onClick={handleDelete}\n                    className=\"bg-destructive hover:bg-destructive/90\"\n                  >\n                    Delete Project\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}