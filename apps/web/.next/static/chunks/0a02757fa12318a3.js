(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,264036,e=>{"use strict";var a=e.i(379492),t=e.i(152088);function s({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function r({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function n({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",e),...s})}function l({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-muted-foreground text-sm",e),...s})}function d({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>d,"CardDescription",()=>l,"CardHeader",()=>r,"CardTitle",()=>n])},33928,e=>{"use strict";let a=(0,e.i(755430).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>a],33928)},829164,e=>{"use strict";var a=e.i(379492),t=e.i(152088);function s({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,t.cn)("w-full caption-bottom text-sm",e),...s})})}function r({className:e,...s}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,t.cn)("[&_tr]:border-b",e),...s})}function n({className:e,...s}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,t.cn)("[&_tr:last-child]:border-0",e),...s})}function l({className:e,...s}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,t.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function d({className:e,...s}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,t.cn)("text-muted-foreground h-10 px-2 text-left align-middle font-medium [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function i({className:e,...s}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,t.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}e.s(["Table",()=>s,"TableBody",()=>n,"TableCell",()=>i,"TableHead",()=>d,"TableHeader",()=>r,"TableRow",()=>l])},502772,e=>{"use strict";let a=(0,e.i(755430).default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);e.s(["Play",()=>a],502772)},751629,e=>{"use strict";var a=e.i(516425),t=e.i(384078);function s(e){let[s,r]=(0,t.useState)(void 0);return(0,t.useEffect)(()=>{let t=()=>{let t=a.default.isFeatureEnabled(e);return void 0!==t&&(r(t??!1),!0)};t()||a.default.onFeatureFlags(()=>{t()})},[e]),s}e.s(["useFeatureFlag",()=>s])},842937,e=>{"use strict";var a=e.i(379492),t=e.i(283164);e.i(977101);var s=e.i(727630),r=e.i(2138);let n=(0,e.i(755430).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);var l=e.i(502772),d=e.i(33928),i=e.i(384078),c=e.i(799126),o=e.i(907347),x=e.i(985902),h=e.i(264036),u=e.i(829164),m=e.i(751629);function j(){let[e,j]=(0,i.useState)(!1),[f,p]=(0,i.useState)(!1),[g,C]=(0,i.useState)(!1),N=(0,m.useFeatureFlag)("byod"),y=(0,s.useQuery)(t.api.admin.byod.getStats),v=(0,s.useQuery)(t.api.admin.byod.listInstances);if(void 0===N)return(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(r.Loader2,{className:"h-8 w-8 animate-spin"})});if(!N)return(0,a.jsx)("div",{className:"container py-8",children:(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)("h1",{className:"text-xl font-bold mb-2",children:"Feature Not Available"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"BYOD management is not enabled for your account."})]})});let T=(0,s.useAction)(t.api.byod.healthCheck.checkAllHealth),w=(0,s.useAction)(t.api.byod.migrationRunner.runMigrationsForAll),k=(0,s.useAction)(t.api.admin.byod.sendUpdateNotifications),H=async()=>{j(!0);try{let e=await T({});c.toast.success(`Health check: ${e.healthy} healthy, ${e.unhealthy} unhealthy, ${e.outdated} outdated`)}catch(e){c.toast.error("Health check failed")}finally{j(!1)}},B=async()=>{p(!0);try{let e=await w({});c.toast.success(`Migrations: ${e.succeeded} succeeded, ${e.failed} failed`)}catch(e){c.toast.error("Migrations failed")}finally{p(!1)}},M=async()=>{C(!0);try{let e=await k({});c.toast.success(`Emails: ${e.sent} sent, ${e.skipped} skipped, ${e.failed} failed`)}catch(e){c.toast.error("Failed to send notifications")}finally{C(!1)}};return y&&v?(0,a.jsxs)("div",{className:"container py-8 space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"BYOD Management"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["Manage user database instances and migrations (Latest: v",y.latestVersion,")"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(x.Button,{variant:"outline",onClick:H,disabled:e,children:[e?(0,a.jsx)(r.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(d.RefreshCw,{className:"h-4 w-4 mr-2"}),"Check Health"]}),(0,a.jsxs)(x.Button,{variant:"outline",onClick:M,disabled:g||0===y.pendingMigrations,children:[g?(0,a.jsx)(r.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(n,{className:"h-4 w-4 mr-2"}),"Email Outdated Users"]}),(0,a.jsxs)(x.Button,{onClick:B,disabled:f,children:[f?(0,a.jsx)(r.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(l.Play,{className:"h-4 w-4 mr-2"}),"Run Migrations"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,a.jsxs)(h.Card,{children:[(0,a.jsx)(h.CardHeader,{className:"pb-2",children:(0,a.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Total Instances"})}),(0,a.jsx)(h.CardContent,{children:(0,a.jsx)("p",{className:"text-2xl font-bold",children:y.total})})]}),(0,a.jsxs)(h.Card,{children:[(0,a.jsx)(h.CardHeader,{className:"pb-2",children:(0,a.jsx)(h.CardTitle,{className:"text-sm font-medium text-green-500",children:"Connected"})}),(0,a.jsx)(h.CardContent,{children:(0,a.jsx)("p",{className:"text-2xl font-bold text-green-500",children:y.connected})})]}),(0,a.jsxs)(h.Card,{children:[(0,a.jsx)(h.CardHeader,{className:"pb-2",children:(0,a.jsx)(h.CardTitle,{className:"text-sm font-medium text-red-500",children:"Error"})}),(0,a.jsx)(h.CardContent,{children:(0,a.jsx)("p",{className:"text-2xl font-bold text-red-500",children:y.error})})]}),(0,a.jsxs)(h.Card,{children:[(0,a.jsx)(h.CardHeader,{className:"pb-2",children:(0,a.jsx)(h.CardTitle,{className:"text-sm font-medium text-amber-500",children:"Outdated"})}),(0,a.jsx)(h.CardContent,{children:(0,a.jsx)("p",{className:"text-2xl font-bold text-amber-500",children:y.pendingMigrations})})]}),(0,a.jsxs)(h.Card,{children:[(0,a.jsx)(h.CardHeader,{className:"pb-2",children:(0,a.jsx)(h.CardTitle,{className:"text-sm font-medium",children:"Version Distribution"})}),(0,a.jsx)(h.CardContent,{children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:Object.entries(y.versionDistribution||{}).sort(([e],[a])=>a.localeCompare(e)).map(([e,t])=>(0,a.jsxs)(o.Badge,{variant:e===`v${y.latestVersion}`?"default":"secondary",children:[e,": ",t]},e))})})]})]}),(0,a.jsxs)(h.Card,{children:[(0,a.jsxs)(h.CardHeader,{children:[(0,a.jsx)(h.CardTitle,{children:"Instances"}),(0,a.jsx)(h.CardDescription,{children:"All BYOD database instances and their status"})]}),(0,a.jsx)(h.CardContent,{children:0===v.length?(0,a.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No BYOD instances configured yet"}):(0,a.jsxs)(u.Table,{children:[(0,a.jsx)(u.TableHeader,{children:(0,a.jsxs)(u.TableRow,{children:[(0,a.jsx)(u.TableHead,{children:"User"}),(0,a.jsx)(u.TableHead,{children:"Status"}),(0,a.jsx)(u.TableHead,{children:"Schema"}),(0,a.jsx)(u.TableHead,{children:"Last Check"}),(0,a.jsx)(u.TableHead,{children:"Error"})]})}),(0,a.jsx)(u.TableBody,{children:v.map(e=>{let t=e.schemaVersion<y.latestVersion;return(0,a.jsxs)(u.TableRow,{children:[(0,a.jsx)(u.TableCell,{className:"font-medium",children:e.userEmail||e.userId}),(0,a.jsx)(u.TableCell,{children:(0,a.jsx)(b,{status:e.connectionStatus})}),(0,a.jsx)(u.TableCell,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)("span",{children:["v",e.schemaVersion]}),t&&(0,a.jsx)(o.Badge,{variant:"outline",className:"text-amber-600 border-amber-500/50 text-xs",children:"outdated"})]})}),(0,a.jsx)(u.TableCell,{children:e.lastConnectionTest?new Date(e.lastConnectionTest).toLocaleString():"Never"}),(0,a.jsx)(u.TableCell,{className:"text-sm text-muted-foreground max-w-xs truncate",children:e.connectionError||"-"})]},e._id)})})]})})]})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(r.Loader2,{className:"h-8 w-8 animate-spin"})})}function b({status:e}){switch(e){case"connected":return(0,a.jsx)(o.Badge,{className:"bg-green-500",children:"Connected"});case"error":return(0,a.jsx)(o.Badge,{variant:"destructive",children:"Error"});case"pending":return(0,a.jsx)(o.Badge,{variant:"secondary",children:"Pending"});case"disconnected":return(0,a.jsx)(o.Badge,{variant:"outline",children:"Disconnected"});default:return(0,a.jsx)(o.Badge,{variant:"outline",children:e})}}e.s(["default",()=>j],842937)}]);