(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,497439,e=>{"use strict";let t=(0,e.i(755430).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],497439)},543621,e=>{"use strict";let t=(0,e.i(755430).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],543621)},273661,e=>{"use strict";var t=e.i(379492),s=e.i(283164);e.i(977101);var a=e.i(727630),i=e.i(543621),r=e.i(359548),n=e.i(497439),l=e.i(2138),c=e.i(755589);let o=(0,e.i(755430).default)("vibrate",[["path",{d:"m2 8 2 2-2 2 2 2-2 2",key:"sv1b1"}],["path",{d:"m22 8-2 2 2 2-2 2 2 2",key:"101i4y"}],["rect",{width:"8",height:"14",x:"8",y:"5",rx:"1",key:"1oyrl4"}]]);var d=e.i(603369),m=e.i(430387),u=e.i(384078),x=e.i(985902),h=e.i(610012);function f(){let e=(0,m.useSearchParams)().get("code"),[f,p]=(0,u.useState)(e||""),[g,v]=(0,u.useState)(null),[j,N]=(0,u.useState)(!1),[y,b]=(0,u.useState)(null),k=(0,a.useQuery)(s.api.presentationSessions.joinByCode,6===f.length?{sessionCode:f}:"skip"),w=(0,a.useQuery)(s.api.presentationSessions.get,g?{sessionId:g}:"skip"),S=(0,a.useMutation)(s.api.presentationSessions.navigateSlide),C=(0,a.useMutation)(s.api.presentationSessions.ping),I=(0,a.useQuery)(s.api.presentations.getSlides,w?.presentationId?{presentationId:w.presentationId}:"skip"),T=I?.[w?.currentSlide??0],P=(0,a.useQuery)(s.api.storage.getUrl,T?.imageStorageId?{storageId:T.imageStorageId}:"skip");(0,u.useEffect)(()=>{e&&6===e.length&&p(e)},[e]),(0,u.useEffect)(()=>{if(k&&!g)v(k.sessionId),b(null);else if(6===f.length&&!k&&!j){let e=setTimeout(()=>{k||b("Invalid or expired code")},2e3);return()=>clearTimeout(e)}},[k,g,f,j]),(0,u.useEffect)(()=>{if(!g)return;let e=setInterval(()=>{C({sessionId:g,role:"remote"}).catch(()=>{})},5e3);return C({sessionId:g,role:"remote"}).catch(()=>{}),()=>clearInterval(e)},[g,C]);let B=(0,u.useCallback)(async()=>{if(g)try{await S({sessionId:g,direction:"next"}),"vibrate"in navigator&&navigator.vibrate(50)}catch(e){console.error("Navigation error:",e)}},[g,S]),E=(0,u.useCallback)(async()=>{if(g)try{await S({sessionId:g,direction:"prev"}),"vibrate"in navigator&&navigator.vibrate(50)}catch(e){console.error("Navigation error:",e)}},[g,S]);return g?w&&!w.isActive?(0,t.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 bg-background",children:(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("h1",{className:"text-xl font-semibold",children:"Session Ended"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"This presentation session has ended."}),(0,t.jsx)(x.Button,{onClick:()=>{v(null),p("")},children:"Join Another"})]})}):(0,t.jsxs)("div",{className:"h-[100dvh] flex flex-col bg-background overflow-hidden",children:[(0,t.jsxs)("header",{className:"border-b p-4 flex items-center justify-between shrink-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Presentation,{className:"h-5 w-5 text-primary"}),(0,t.jsx)("span",{className:"font-medium truncate max-w-[200px]",children:k?.presentationTitle||"Presentation"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(n.Clock,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"font-mono",children:((e,t)=>{if(!e&&!t)return"00:00";let s=Math.floor((e?Date.now()-e+(t||0):t||0)/1e3),a=Math.floor(s/60);return`${a.toString().padStart(2,"0")}:${(s%60).toString().padStart(2,"0")}`})(w?.timerStartedAt,w?.timerElapsed)})]})]}),(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center p-3 bg-muted/30 min-h-0",children:P?(0,t.jsx)("div",{className:"relative w-full max-w-sm max-h-[40vh] aspect-video rounded-lg overflow-hidden shadow-lg",children:(0,t.jsx)(d.default,{src:P,alt:T?.title||"Current slide",fill:!0,className:"object-contain bg-black",sizes:"(max-width: 768px) 100vw, 400px"})}):(0,t.jsx)("div",{className:"w-full max-w-sm max-h-[40vh] aspect-video rounded-lg bg-muted flex items-center justify-center",children:(0,t.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})})}),(0,t.jsxs)("div",{className:"py-2 px-3 text-center border-t shrink-0",children:[(0,t.jsxs)("div",{className:"text-base font-medium",children:["Slide ",(w?.currentSlide??0)+1," of"," ",w?.totalSlides??0]}),T?.title&&(0,t.jsx)("div",{className:"text-sm text-muted-foreground truncate",children:T.title})]}),(0,t.jsxs)("div",{className:"p-3 grid grid-cols-2 gap-3 shrink-0",children:[(0,t.jsxs)(x.Button,{size:"lg",variant:"outline",className:"h-20 text-lg",onClick:E,disabled:(w?.currentSlide??0)===0,children:[(0,t.jsx)(i.ChevronLeft,{className:"h-6 w-6 mr-1"}),"Previous"]}),(0,t.jsxs)(x.Button,{size:"lg",className:"h-20 text-lg",onClick:B,disabled:(w?.currentSlide??0)>=(w?.totalSlides??1)-1,children:["Next",(0,t.jsx)(r.ChevronRight,{className:"h-6 w-6 ml-1"})]})]}),(0,t.jsxs)("div",{className:"py-1.5 text-center text-xs text-muted-foreground flex items-center justify-center gap-1",children:[(0,t.jsx)(o,{className:"h-3 w-3"}),"Haptic feedback enabled"]})]}):(0,t.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center p-6 bg-background",children:(0,t.jsxs)("div",{className:"w-full max-w-sm space-y-6",children:[(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)(c.Presentation,{className:"h-12 w-12 mx-auto text-primary"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Remote Control"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Enter the 6-digit code from your presentation"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(h.Input,{type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,placeholder:"000000",value:f,onChange:e=>{p(e.target.value.replace(/\D/g,"")),b(null)},className:"text-center text-3xl font-mono tracking-widest h-16",autoFocus:!0}),y&&(0,t.jsx)("p",{className:"text-sm text-destructive text-center",children:y}),6===f.length&&!k&&!y&&(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(l.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})})]})]})})}function p(){return(0,t.jsx)(u.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),children:(0,t.jsx)(f,{})})}e.s(["default",()=>p],273661)}]);