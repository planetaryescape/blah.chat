(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,264036,e=>{"use strict";var s=e.i(379492),t=e.i(152088);function r({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function a({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function n({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",e),...r})}function o({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-muted-foreground text-sm",e),...r})}function l({className:e,...r}){return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>l,"CardDescription",()=>o,"CardHeader",()=>a,"CardTitle",()=>n])},87056,e=>{"use strict";var s=e.i(371057);e.s(["CheckCircle2",()=>s.default])},593830,e=>{"use strict";let s=(0,e.i(755430).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>s],593830)},271503,e=>{"use strict";var s=e.i(379492),t=e.i(283164);e.i(977101);var r=e.i(727630),a=e.i(310165),n=e.i(87056),o=e.i(462957),l=e.i(2138),i=e.i(593830),c=e.i(430387),d=e.i(384078),m=e.i(799126),u=e.i(907347),x=e.i(985902),h=e.i(264036);function p(){let e=(0,c.useRouter)(),[p,f]=(0,d.useState)(null),[g,v]=(0,d.useState)(null),[j,N]=(0,d.useState)(null),[y,C]=(0,d.useState)(!1),b=(0,r.useMutation)(t.api.import.importConversations),w=async e=>{let s=e.target.files?.[0];if(!s)return;N(null),v(null),f(s);let t=s.size>0xa00000?{valid:!1,error:"File too large. Maximum size is 10MB"}:[".json",".md",".txt"].includes(s.name.toLowerCase().slice(s.name.lastIndexOf(".")))?{valid:!0}:{valid:!1,error:"Invalid file type. Please upload a .json, .md, or .txt file"};if(!t.valid)return void N(t.error||"Invalid file");C(!0);try{let e=await s.text(),t=function(e){switch(function(e){let s=e.trim();if(s.startsWith("{")||s.startsWith("["))try{let e=JSON.parse(s);if(e.version&&e.conversations&&e.exportedAt)return"json";if(e.mapping||Array.isArray(e)&&e[0]?.mapping)return"chatgpt";if(e.conversations)return"json"}catch{}return s.startsWith("#")||s.includes("## You")||s.includes("## Assistant")?"markdown":"unknown"}(e)){case"json":try{let s=JSON.parse(e);if(!s.version||!s.conversations)return{success:!1,error:"Invalid JSON format: missing required fields"};let t=s.conversations.map(e=>({title:e.title,model:e.model,systemPrompt:e.systemPrompt,createdAt:e.createdAt,messages:e.messages.map(e=>({role:e.role,content:e.content,createdAt:e.createdAt,model:e.model}))})),r=t.reduce((e,s)=>e+s.messages.length,0);return{success:!0,data:{conversations:t,format:"json"},conversationsCount:t.length,messagesCount:r}}catch(e){return{success:!1,error:`Failed to parse JSON: ${e instanceof Error?e.message:"Unknown error"}`}}case"markdown":try{let s=e.split(/\n---\n\n/).filter(e=>e.trim().length>0&&!e.startsWith("# blah.chat Export"));if(0===s.length)return{success:!1,error:"No conversations found in markdown file"};let t=s.map(e=>{let s=e.match(/^# (.+?)$/m);if(!s)return null;let t=s[1],r=e.match(/\*\*Model\*\*: (.+?)$/m),a=e.match(/\*\*System Prompt\*\*: (.+?)$/m),n=[];for(let s of[...e.matchAll(/## (You|Assistant|System)\n\n([\s\S]*?)(?=\n## |$)/g)]){let e=s[1],t=s[2].trim();t=t.replace(/\*Cost:.*?\*\n*$/m,"").trim(),n.push({role:"You"===e?"user":"Assistant"===e?"assistant":"system",content:t})}return 0===n.length?null:{title:t,model:r?.[1],systemPrompt:a?.[1],messages:n}}).filter(e=>null!==e);if(0===t.length)return{success:!1,error:"Failed to parse any valid conversations from markdown"};let r=t.reduce((e,s)=>e+s.messages.length,0);return{success:!0,data:{conversations:t,format:"markdown"},conversationsCount:t.length,messagesCount:r}}catch(e){return{success:!1,error:`Failed to parse Markdown: ${e instanceof Error?e.message:"Unknown error"}`}}case"chatgpt":try{let s=JSON.parse(e),t=Array.isArray(s)?s:[s];if(0===t.length)return{success:!1,error:"No conversations found in ChatGPT export"};let r=t.map(e=>{if(!e.mapping||!e.title)return null;let s=Object.values(e.mapping).filter(e=>e.content?.parts?.length>0).map(e=>({role:e.author.role,content:e.content.parts.join("\n"),createdAt:e.create_time?1e3*e.create_time:void 0})).filter(e=>e.content.trim().length>0);return 0===s.length?null:{title:e.title,messages:s,createdAt:e.create_time?1e3*e.create_time:void 0}}).filter(e=>null!==e);if(0===r.length)return{success:!1,error:"Failed to parse any valid conversations from ChatGPT export"};let a=r.reduce((e,s)=>e+s.messages.length,0);return{success:!0,data:{conversations:r,format:"chatgpt"},conversationsCount:r.length,messagesCount:a}}catch(e){return{success:!1,error:`Failed to parse ChatGPT export: ${e instanceof Error?e.message:"Unknown error"}`}}default:return{success:!1,error:"Unable to detect file format. Please upload a JSON, Markdown, or ChatGPT export file."}}}(e);if(!t.success)return void N(t.error||"Failed to parse file");v(t.data),m.toast.success(`Found ${t.conversationsCount} conversations with ${t.messagesCount} messages`)}catch(e){N(e instanceof Error?e.message:"Failed to process file")}finally{C(!1)}},k=async()=>{if(g){C(!0);try{let s=await b({conversations:g.conversations});if(!s.success)throw Error(s.error||"Import failed");m.toast.success(`Successfully imported ${s.importedCount} conversations`),s.conversationIds.length>0?e.push(`/chat/${s.conversationIds[0]}`):e.push("/")}catch(e){m.toast.error(e instanceof Error?e.message:"Failed to import conversations"),N(e instanceof Error?e.message:"Failed to import conversations")}finally{C(!1)}}};return(0,s.jsx)("div",{className:"container max-w-4xl mx-auto p-6",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Import Conversations"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:"Import your conversations from blah.chat JSON exports, Markdown files, or ChatGPT exports"})]}),(0,s.jsx)(h.Card,{className:"p-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(o.FileText,{className:"w-5 h-5 text-primary"}),(0,s.jsx)("h2",{className:"font-semibold text-lg",children:"Select File"})]}),(0,s.jsx)("div",{className:"border-2 border-dashed border-border rounded-lg p-8",children:(0,s.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)(i.Upload,{className:"w-12 h-12 text-muted-foreground"}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"font-medium",children:p?p.name:"Click to upload or drag and drop"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"JSON, Markdown, or Text files (max 10MB)"})]}),(0,s.jsx)(x.Button,{type:"button",variant:"outline",children:"Choose File"})]}),(0,s.jsx)("input",{id:"file-upload",type:"file",className:"sr-only",accept:".json,.md,.txt",onChange:w,disabled:y})]})}),j&&(0,s.jsxs)("div",{className:"flex items-start gap-2 p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:[(0,s.jsx)(a.AlertCircle,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-destructive",children:"Error"}),(0,s.jsx)("p",{className:"text-sm text-destructive/90 mt-1",children:j})]})]})]})}),g&&(0,s.jsx)(h.Card,{className:"p-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.CheckCircle2,{className:"w-5 h-5 text-green-600"}),(0,s.jsx)("h2",{className:"font-semibold text-lg",children:"Import Preview"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"Format Detected"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"json"===g.format?"blah.chat JSON Export":"chatgpt"===g.format?"ChatGPT Export":"Markdown"})]}),(0,s.jsx)(u.Badge,{variant:"outline",children:g.format})]}),(0,s.jsxs)("div",{className:"p-4 bg-muted/50 rounded-lg",children:[(0,s.jsx)("p",{className:"font-medium",children:"Conversations to Import"}),(0,s.jsx)("p",{className:"text-2xl font-bold mt-1",children:g.conversations.length}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Total messages:"," ",g.conversations.reduce((e,s)=>e+s.messages.length,0)]})]}),(0,s.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:g.conversations.map((e,t)=>(0,s.jsxs)("div",{className:"p-3 border border-border rounded-lg",children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:e.title}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[e.messages.length," messages",e.model&&` \xb7 ${e.model}`]})]},t))})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4 border-t",children:[(0,s.jsx)(x.Button,{onClick:k,disabled:y,className:"flex-1",children:y?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):"Import Conversations"}),(0,s.jsx)(x.Button,{variant:"outline",onClick:()=>{f(null),v(null),N(null)},disabled:y,children:"Cancel"})]})]})}),(0,s.jsxs)(h.Card,{className:"p-6 bg-muted/30",children:[(0,s.jsx)("h3",{className:"font-semibold mb-3",children:"Supported Formats"}),(0,s.jsxs)("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-primary mt-0.5",children:"•"}),(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"blah.chat JSON:"})," Full export from Settings → Export"]})]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-primary mt-0.5",children:"•"}),(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"ChatGPT:"})," Export from ChatGPT settings"]})]}),(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-primary mt-0.5",children:"•"}),(0,s.jsxs)("span",{children:[(0,s.jsx)("strong",{children:"Markdown:"})," Plain text conversation exports"]})]})]})]})]})})}e.s(["default",()=>p],271503)}]);