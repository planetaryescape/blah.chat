(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,829164,e=>{"use strict";var t=e.i(379492),s=e.i(152088);function n({className:e,...n}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...n})})}function i({className:e,...n}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",e),...n})}function r({className:e,...n}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...n})}function l({className:e,...n}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...n})}function o({className:e,...n}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-muted-foreground h-10 px-2 text-left align-middle font-medium [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...n})}function a({className:e,...n}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...n})}e.s(["Table",()=>n,"TableBody",()=>r,"TableCell",()=>a,"TableHead",()=>o,"TableHeader",()=>i,"TableRow",()=>l])},70779,e=>{"use strict";var t=e.i(384078),s=e.i(662122);function n(e,t,s){let n,i=s.initialDeps??[],r=!0;function l(){var l,o,a;let c,d;s.key&&(null==(l=s.debug)?void 0:l.call(s))&&(c=Date.now());let h=e();if(!(h.length!==i.length||h.some((e,t)=>i[t]!==e)))return n;if(i=h,s.key&&(null==(o=s.debug)?void 0:o.call(s))&&(d=Date.now()),n=t(...h),s.key&&(null==(a=s.debug)?void 0:a.call(s))){let e=Math.round((Date.now()-c)*100)/100,t=Math.round((Date.now()-d)*100)/100,n=t/16,i=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info(`%c⏱ ${i(t,5)} /${i(e,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*n,120))}deg 100% 31%);`,null==s?void 0:s.key)}return(null==s?void 0:s.onChange)&&!(r&&s.skipInitialOnChange)&&s.onChange(n),r=!1,n}return l.updateDeps=e=>{i=e},l}function i(e,t){if(void 0!==e)return e;throw Error(`Unexpected undefined${t?`: ${t}`:""}`)}e.i(708883);let r=e=>{let{offsetWidth:t,offsetHeight:s}=e;return{width:t,height:s}},l=e=>e,o=e=>{let t=Math.max(e.startIndex-e.overscan,0),s=Math.min(e.endIndex+e.overscan,e.count-1),n=[];for(let e=t;e<=s;e++)n.push(e);return n},a=(e,t)=>{let s=e.scrollElement;if(!s)return;let n=e.targetWindow;if(!n)return;let i=e=>{let{width:s,height:n}=e;t({width:Math.round(s),height:Math.round(n)})};if(i(r(s)),!n.ResizeObserver)return()=>{};let l=new n.ResizeObserver(t=>{let n=()=>{let e=t[0];if(null==e?void 0:e.borderBoxSize){let t=e.borderBoxSize[0];if(t)return void i({width:t.inlineSize,height:t.blockSize})}i(r(s))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(n):n()});return l.observe(s,{box:"border-box"}),()=>{l.unobserve(s)}},c={passive:!0},d="undefined"==typeof window||"onscrollend"in window,h=(e,t)=>{var s,n;let i,r=e.scrollElement;if(!r)return;let l=e.targetWindow;if(!l)return;let o=0,a=e.options.useScrollendEvent&&d?()=>void 0:(s=()=>{t(o,!1)},n=e.options.isScrollingResetDelay,function(...e){l.clearTimeout(i),i=l.setTimeout(()=>s.apply(this,e),n)}),h=s=>()=>{let{horizontal:n,isRtl:i}=e.options;o=n?r.scrollLeft*(i&&-1||1):r.scrollTop,a(),t(o,s)},u=h(!0),m=h(!1);m(),r.addEventListener("scroll",u,c);let g=e.options.useScrollendEvent&&d;return g&&r.addEventListener("scrollend",m,c),()=>{r.removeEventListener("scroll",u),g&&r.removeEventListener("scrollend",m)}},u=(e,t,s)=>{if(null==t?void 0:t.borderBoxSize){let e=t.borderBoxSize[0];if(e)return Math.round(e[s.options.horizontal?"inlineSize":"blockSize"])}return e[s.options.horizontal?"offsetWidth":"offsetHeight"]},m=(e,{adjustments:t=0,behavior:s},n)=>{var i,r;null==(r=null==(i=n.scrollElement)?void 0:i.scrollTo)||r.call(i,{[n.options.horizontal?"left":"top"]:e+t,behavior:s})};class g{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null,t=()=>e||(this.targetWindow&&this.targetWindow.ResizeObserver?e=new this.targetWindow.ResizeObserver(e=>{e.forEach(e=>{let t=()=>{this._measureElement(e.target,e)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(t):t()})}):null);return{disconnect:()=>{var s;null==(s=t())||s.disconnect(),e=null},observe:e=>{var s;return null==(s=t())?void 0:s.observe(e,{box:"border-box"})},unobserve:e=>{var s;return null==(s=t())?void 0:s.unobserve(e)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([t,s])=>{void 0===s&&delete e[t]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:l,rangeExtractor:o,onChange:()=>{},measureElement:u,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var t,s;null==(s=(t=this.options).onChange)||s.call(t,this,e)},this.maybeNotify=n(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;let t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t)return void this.maybeNotify();this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=(null==(e=this.scrollElement)?void 0:e.window)??null,this.elementsCache.forEach(e=>{this.observer.observe(e)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,e=>{this.scrollRect=e,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(e,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e,this.isScrolling=t,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??("function"==typeof this.options.initialOffset?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{let s=new Map,n=new Map;for(let i=t-1;i>=0;i--){let t=e[i];if(s.has(t.lane))continue;let r=n.get(t.lane);if(null==r||t.end>r.end?n.set(t.lane,t):t.end<r.end&&s.set(t.lane,!0),s.size===this.options.lanes)break}return n.size===this.options.lanes?Array.from(n.values()).sort((e,t)=>e.end===t.end?e.index-t.index:e.end-t.end)[0]:void 0},this.getMeasurementOptions=n(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(e,t,s,n,i,r)=>(void 0!==this.prevLanes&&this.prevLanes!==r&&(this.lanesChangedFlag=!0),this.prevLanes=r,this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:s,getItemKey:n,enabled:i,lanes:r}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=n(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:t,scrollMargin:s,getItemKey:n,enabled:i,lanes:r},l)=>{if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>e)for(let t of this.laneAssignments.keys())t>=e&&this.laneAssignments.delete(t);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),0===this.measurementsCache.length&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}));let o=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===e&&(this.lanesSettling=!1);let a=this.measurementsCache.slice(0,o),c=Array(r).fill(void 0);for(let e=0;e<o;e++){let t=a[e];t&&(c[t.lane]=e)}for(let i=o;i<e;i++){let e,r,o=n(i),d=this.laneAssignments.get(i);if(void 0!==d&&this.options.lanes>1){let n=c[e=d],i=void 0!==n?a[n]:void 0;r=i?i.end+this.options.gap:t+s}else{let n=1===this.options.lanes?a[i-1]:this.getFurthestMeasurement(a,i);r=n?n.end+this.options.gap:t+s,e=n?n.lane:i%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(i,e)}let h=l.get(o),u="number"==typeof h?h:this.options.estimateSize(i),m=r+u;a[i]={index:i,start:r,size:u,end:m,key:o,lane:e},c[e]=i}return this.measurementsCache=a,a},{key:!1,debug:()=>this.options.debug}),this.calculateRange=n(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(e,t,s,n)=>this.range=e.length>0&&t>0?function({measurements:e,outerSize:t,scrollOffset:s,lanes:n}){let i=e.length-1;if(e.length<=n)return{startIndex:0,endIndex:i};let r=f(0,i,t=>e[t].start,s),l=r;if(1===n)for(;l<i&&e[l].end<s+t;)l++;else if(n>1){let o=Array(n).fill(0);for(;l<i&&o.some(e=>e<s+t);){let t=e[l];o[t.lane]=t.end,l++}let a=Array(n).fill(s+t);for(;r>=0&&a.some(e=>e>=s);){let t=e[r];a[t.lane]=t.start,r--}r=Math.max(0,r-r%n),l=Math.min(i,l+(n-1-l%n))}return{startIndex:r,endIndex:l}}({measurements:e,outerSize:t,scrollOffset:s,lanes:n}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=n(()=>{let e=null,t=null,s=this.calculateRange();return s&&(e=s.startIndex,t=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,e,t]),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,t]},(e,t,s,n,i)=>null===n||null===i?[]:e({startIndex:n,endIndex:i,overscan:t,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{let t=this.options.indexAttribute,s=e.getAttribute(t);return s?parseInt(s,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{let s=this.indexFromElement(e),n=this.measurementsCache[s];if(!n)return;let i=n.key,r=this.elementsCache.get(i);r!==e&&(r&&this.observer.unobserve(r),this.observer.observe(e),this.elementsCache.set(i,e)),e.isConnected&&this.resizeItem(s,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{let s=this.measurementsCache[e];if(!s)return;let n=t-(this.itemSizeCache.get(s.key)??s.size);0!==n&&((void 0!==this.shouldAdjustScrollPositionOnItemSizeChange?this.shouldAdjustScrollPositionOnItemSizeChange(s,n,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=n,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,t)),this.notify(!1))},this.measureElement=e=>{e?this._measureElement(e,void 0):this.elementsCache.forEach((e,t)=>{e.isConnected||(this.observer.unobserve(e),this.elementsCache.delete(t))})},this.getVirtualItems=n(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,t)=>{let s=[];for(let n=0,i=e.length;n<i;n++){let i=t[e[n]];s.push(i)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{let t=this.getMeasurements();if(0!==t.length)return i(t[f(0,t.length-1,e=>i(t[e]).start,e)])},this.getOffsetForAlignment=(e,t,s=0)=>{let n=this.getSize(),i=this.getScrollOffset();return"auto"===t&&(t=e>=i+n?"end":"start"),"center"===t?e+=(s-n)/2:"end"===t&&(e-=n),Math.max(Math.min(this.getTotalSize()+this.options.scrollMargin-n,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));let s=this.measurementsCache[e];if(!s)return;let n=this.getSize(),i=this.getScrollOffset();if("auto"===t)if(s.end>=i+n-this.options.scrollPaddingEnd)t="end";else{if(!(s.start<=i+this.options.scrollPaddingStart))return[i,t];t="start"}let r="end"===t?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(r,t,s.size),t]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(e,{align:t="start",behavior:s}={})=>{"smooth"===s&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:s})},this.scrollToIndex=(e,{align:t="auto",behavior:s}={})=>{"smooth"===s&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),e=Math.max(0,Math.min(e,this.options.count-1));let n=0,i=t=>{if(!this.targetWindow)return;let n=this.getOffsetForIndex(e,t);if(!n)return void console.warn("Failed to get offset for index:",e);let[i,l]=n;this._scrollToOffset(i,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{let t=this.getScrollOffset(),s=this.getOffsetForIndex(e,l);s?1.01>Math.abs(s[0]-t)||r(l):console.warn("Failed to get offset for index:",e)})},r=t=>{this.targetWindow&&(++n<10?this.targetWindow.requestAnimationFrame(()=>i(t)):console.warn(`Failed to scroll to index ${e} after 10 attempts.`))};i(t)},this.scrollBy=(e,{behavior:t}={})=>{"smooth"===t&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;let t,s=this.getMeasurements();if(0===s.length)t=this.options.paddingStart;else if(1===this.options.lanes)t=(null==(e=s[s.length-1])?void 0:e.end)??0;else{let e=Array(this.options.lanes).fill(null),n=s.length-1;for(;n>=0&&e.some(e=>null===e);){let t=s[n];null===e[t.lane]&&(e[t.lane]=t.end),n--}t=Math.max(...e.filter(e=>null!==e))}return Math.max(t-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:t,behavior:s})=>{this.options.scrollToFn(e,{behavior:s,adjustments:t},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(e)}}let f=(e,t,s,n)=>{for(;e<=t;){let i=(e+t)/2|0,r=s(i);if(r<n)e=i+1;else{if(!(r>n))return i;t=i-1}}return e>0?e-1:0},x="undefined"!=typeof document?t.useLayoutEffect:t.useEffect;function p(e){return function(e){let n=t.useReducer(()=>({}),{})[1],i={...e,onChange:(t,i)=>{var r;i?(0,s.flushSync)(n):n(),null==(r=e.onChange)||r.call(e,t,i)}},[r]=t.useState(()=>new g(i));return r.setOptions(i),x(()=>r._didMount(),[]),x(()=>r._willUpdate()),r}({observeElementRect:a,observeElementOffset:h,scrollToFn:m,...e})}e.s(["useVirtualizer",()=>p],70779)},642024,e=>{"use strict";var t=e.i(384078);function s(e,s,n,i){var r=this,l=(0,t.useRef)(null),o=(0,t.useRef)(0),a=(0,t.useRef)(0),c=(0,t.useRef)(null),d=(0,t.useRef)([]),h=(0,t.useRef)(),u=(0,t.useRef)(),m=(0,t.useRef)(e),g=(0,t.useRef)(!0);m.current=e;var f="undefined"!=typeof window,x=!s&&0!==s&&f;if("function"!=typeof e)throw TypeError("Expected a function");s=+s||0;var p=!!(n=n||{}).leading,b=!("trailing"in n)||!!n.trailing,v="maxWait"in n,w="debounceOnServer"in n&&!!n.debounceOnServer,y=v?Math.max(+n.maxWait||0,s):null;return(0,t.useEffect)(function(){return g.current=!0,function(){g.current=!1}},[]),(0,t.useMemo)(function(){var e=function(e){var t=d.current,s=h.current;return d.current=h.current=null,o.current=e,a.current=a.current||e,u.current=m.current.apply(s,t)},t=function(e,t){x&&cancelAnimationFrame(c.current),c.current=x?requestAnimationFrame(e):setTimeout(e,t)},n=function(e){if(!g.current)return!1;var t=e-l.current;return!l.current||t>=s||t<0||v&&e-o.current>=y},j=function(t){return c.current=null,b&&d.current?e(t):(d.current=h.current=null,u.current)},C=function e(){var i=Date.now();if(p&&a.current===o.current&&S(),n(i))return j(i);if(g.current){var r=s-(i-l.current);t(e,v?Math.min(r,y-(i-o.current)):r)}},S=function(){i&&i({})},N=function(){if(f||w){var i=Date.now(),a=n(i);if(d.current=[].slice.call(arguments),h.current=r,l.current=i,a){if(!c.current&&g.current)return o.current=l.current,t(C,s),p?e(l.current):u.current;if(v)return t(C,s),e(l.current)}return c.current||t(C,s),u.current}};return N.cancel=function(){var e=c.current;e&&(x?cancelAnimationFrame(c.current):clearTimeout(c.current)),o.current=0,d.current=l.current=h.current=c.current=null,e&&i&&i({})},N.isPending=function(){return!!c.current},N.flush=function(){return c.current?j(Date.now()):u.current},N},[p,v,s,y,b,x,f,w,i])}e.s(["useDebouncedCallback",()=>s])},214942,e=>{"use strict";var t=e.i(379492),s=e.i(283164),n=e.i(890901),i=e.i(160607),r=e.i(70779);e.i(977101);var l=e.i(727630),o=e.i(975620),a=e.i(249700),c=e.i(610058);let d=(0,e.i(755430).default)("layout-list",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);var h=e.i(2138),u=e.i(134092),m=e.i(985612),g=e.i(79721),f=e.i(760911),x=e.i(430387),p=e.i(384078),b=e.i(642024),v=e.i(985902),w=e.i(610012),y=e.i(829164),j=e.i(152088);function C({params:e}){let{id:C}=(0,p.use)(e),S=(0,x.useRouter)(),[N,M]=(0,p.useState)(""),[k,z]=(0,p.useState)(!1),[O,R]=(0,p.useState)(null),[E,A]=(0,p.useState)("list"),[T,I]=(0,p.useState)([]),[F,D]=(0,p.useState)({pageIndex:0,pageSize:20}),P=(0,p.useRef)(null),_=(0,p.useRef)(null),B=(0,l.useQuery)(s.api.conversations.list,{projectId:C}),W=(0,l.useAction)(s.api["conversations/hybridSearch"].hybridSearch),L=(0,l.useMutation)(s.api.conversations.create),$=(0,l.useMutation)(s.api.projects.addConversation),V=(0,b.useDebouncedCallback)(async e=>{if(!e.trim()){R(null),z(!1);return}z(!0);try{let t=await W({query:e.trim(),projectId:C,limit:50});R(t)}catch(t){if(console.error("Hybrid search failed:",t),B){let t=e.toLowerCase();R(B.filter(e=>e.title?.toLowerCase().includes(t)||e.model?.toLowerCase().includes(t)))}}finally{z(!1)}},400);(0,p.useEffect)(()=>{V(N)},[N,V]);let K=null!==O?O:B,U=(0,p.useMemo)(()=>K?K.map(e=>({_id:e._id,title:e.title||"Untitled Chat",model:e.model,messageCount:e.messageCount||0,lastMessageAt:e.lastMessageAt||e.createdAt,createdAt:e.createdAt,pinned:e.pinned||!1})):[],[K]),H=(0,p.useMemo)(()=>[{id:"pinned",accessorKey:"pinned",header:"",size:40,cell:({row:e})=>e.original.pinned?(0,t.jsx)("span",{className:"h-2 w-2 rounded-full bg-primary inline-block",title:"Pinned"}):null},{accessorKey:"title",header:({column:e})=>(0,t.jsxs)(v.Button,{variant:"ghost",className:"p-0 hover:bg-transparent",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Title",(0,t.jsx)(a.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,t.jsx)("span",{className:"font-medium truncate max-w-[300px] block",children:e.original.title})},{accessorKey:"model",header:"Model",cell:({row:e})=>(0,t.jsx)("span",{className:"text-muted-foreground text-sm truncate max-w-[150px] block",children:e.original.model.split(":")[1]||e.original.model})},{accessorKey:"messageCount",header:({column:e})=>(0,t.jsxs)(v.Button,{variant:"ghost",className:"p-0 hover:bg-transparent justify-end w-full",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Messages",(0,t.jsx)(a.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,t.jsx)("div",{className:"text-right text-muted-foreground",children:e.original.messageCount})},{accessorKey:"lastMessageAt",header:({column:e})=>(0,t.jsxs)(v.Button,{variant:"ghost",className:"p-0 hover:bg-transparent justify-end w-full",onClick:()=>e.toggleSorting("asc"===e.getIsSorted()),children:["Last Active",(0,t.jsx)(a.ArrowUpDown,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>(0,t.jsx)("div",{className:"text-right text-muted-foreground text-sm font-mono",children:(0,o.formatDistanceToNow)(e.original.lastMessageAt,{addSuffix:!0})})}],[]),q=(0,n.useReactTable)({data:U,columns:H,state:{sorting:T,pagination:F},onSortingChange:I,onPaginationChange:D,getCoreRowModel:(0,i.getCoreRowModel)(),getSortedRowModel:(0,i.getSortedRowModel)(),getPaginationRowModel:(0,i.getPaginationRowModel)(),manualPagination:!1}),G=q.getRowModel().rows,Q=G.length>50,Y=(0,p.useCallback)(()=>56,[]),J=(0,r.useVirtualizer)({count:G.length,getScrollElement:()=>P.current,estimateSize:Y,overscan:10,enabled:Q}),X=async()=>{try{let e=await L({model:"zai:glm-4.6v-flash",title:"New Project Chat"});await $({projectId:C,conversationId:e}),S.push(`/chat/${e}`)}catch(e){console.error("Failed to create chat:",e)}},Z=e=>{S.push(`/chat/${e}`)};return void 0===B?(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)(h.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(0,t.jsxs)("div",{className:"flex flex-col h-full bg-background/50 backdrop-blur-xl overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex-shrink-0",children:[(0,t.jsxs)("header",{className:"flex items-center justify-between p-6 border-b bg-background/40",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Conversations"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"Chats linked to this project"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center bg-secondary/50 rounded-lg p-0.5 border",children:[(0,t.jsx)(v.Button,{variant:"ghost",size:"icon",className:(0,j.cn)("h-8 w-8 rounded-md","list"===E&&"bg-background shadow-sm text-foreground"),onClick:()=>A("list"),children:(0,t.jsx)(d,{className:"h-4 w-4"})}),(0,t.jsx)(v.Button,{variant:"ghost",size:"icon",className:(0,j.cn)("h-8 w-8 rounded-md","grid"===E&&"bg-background shadow-sm text-foreground"),onClick:()=>A("grid"),children:(0,t.jsx)(c.LayoutGrid,{className:"h-4 w-4"})})]}),(0,t.jsxs)(v.Button,{onClick:X,children:[(0,t.jsx)(m.Plus,{className:"mr-2 h-4 w-4"}),"New Chat"]})]})]}),(0,t.jsxs)("div",{className:"p-4 border-b bg-muted/5",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(g.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(w.Input,{ref:_,placeholder:"Search conversations (hybrid: title + message content)...",value:N,onChange:e=>{M(e.target.value)},className:"pl-9 pr-10 bg-background/50 border-muted-foreground/20 focus:bg-background transition-colors"}),k&&(0,t.jsx)(h.Loader2,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 animate-spin text-muted-foreground"}),!k&&N&&(0,t.jsx)("button",{onClick:()=>{M(""),R(null),_.current?.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground text-sm",children:"✕"})]}),N&&null!==O&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Found ",O.length," result",1!==O.length?"s":"",' for "',N,'"']})]})]}),0===U.length?(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center py-20 text-muted-foreground",children:[(0,t.jsx)(u.MessageSquare,{className:"h-10 w-10 mb-4 opacity-20"}),(0,t.jsx)("p",{className:"mb-4",children:N?`No conversations matching "${N}"`:"No conversations linked to this project yet."}),!N&&(0,t.jsx)(v.Button,{variant:"outline",onClick:X,children:"Start a New Chat"})]}):"grid"===E?(0,t.jsx)("div",{className:"flex-1 overflow-auto p-6",children:(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:U.map(e=>(0,t.jsxs)(f.default,{href:`/chat/${e._id}`,className:"group relative flex flex-col justify-between p-5 h-40 rounded-xl border bg-card hover:bg-secondary/10 transition-all hover:shadow-md hover:border-primary/20",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-foreground/90 truncate pr-2 group-hover:text-primary transition-colors",children:e.title}),e.pinned&&(0,t.jsx)("span",{className:"h-2 w-2 rounded-full bg-primary shrink-0 mt-2"})]}),(0,t.jsx)("span",{className:"inline-flex items-center rounded-full bg-secondary px-2 py-0.5 text-xs font-medium text-secondary-foreground opacity-70",children:e.model})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,t.jsxs)("span",{className:"text-xs text-muted-foreground/60",children:[e.messageCount," messages"]}),(0,t.jsx)("span",{className:"text-xs font-mono text-muted-foreground/60",children:(0,o.formatDistanceToNow)(e.lastMessageAt,{addSuffix:!0})})]})]},e._id))})}):(0,t.jsx)("div",{className:"flex-1 flex flex-col min-h-0 px-6 pb-0",children:(0,t.jsx)("div",{className:"border rounded-lg flex-1 flex flex-col min-h-0 overflow-hidden mt-4",children:Q?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex-shrink-0 sticky top-0 z-10 bg-background border-b",children:q.getHeaderGroups().map(e=>(0,t.jsx)("div",{className:"flex",children:e.headers.map(e=>(0,t.jsx)("div",{className:"flex-1 px-4 py-3 text-sm font-medium",style:{width:e.getSize()},children:e.isPlaceholder?null:(0,n.flexRender)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,t.jsx)("div",{ref:P,className:"flex-1 overflow-auto relative",children:(0,t.jsx)("div",{style:{height:`${J.getTotalSize()}px`,position:"relative"},children:J.getVirtualItems().map(e=>{let s=G[e.index];return(0,t.jsx)("div",{"data-index":e.index,ref:J.measureElement,className:"flex cursor-pointer hover:bg-muted/50 border-b absolute left-0 w-full",style:{transform:`translateY(${e.start}px)`},onClick:()=>Z(s.original._id),children:s.getVisibleCells().map(e=>(0,t.jsx)("div",{className:"flex-1 px-4 py-3",style:{width:e.column.getSize()},children:(0,n.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},s.id)})})})]}):(0,t.jsx)("div",{className:"flex-1 overflow-auto",children:(0,t.jsxs)(y.Table,{children:[(0,t.jsx)(y.TableHeader,{children:q.getHeaderGroups().map(e=>(0,t.jsx)(y.TableRow,{children:e.headers.map(e=>(0,t.jsx)(y.TableHead,{children:e.isPlaceholder?null:(0,n.flexRender)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,t.jsx)(y.TableBody,{children:G.length?G.map(e=>(0,t.jsx)(y.TableRow,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>Z(e.original._id),children:e.getVisibleCells().map(e=>(0,t.jsx)(y.TableCell,{children:(0,n.flexRender)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,t.jsx)(y.TableRow,{children:(0,t.jsx)(y.TableCell,{colSpan:H.length,className:"h-24 text-center",children:"No conversations found."})})})]})})})}),"list"===E&&U.length>0&&(0,t.jsx)("div",{className:"flex-shrink-0 px-6 py-4 border-t bg-background/60",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",G.length," of ",U.length," conversations",N&&" (filtered)"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(v.Button,{variant:"outline",size:"sm",onClick:()=>q.previousPage(),disabled:!q.getCanPreviousPage(),children:"Previous"}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Page ",q.getState().pagination.pageIndex+1," of"," ",q.getPageCount()]}),(0,t.jsx)(v.Button,{variant:"outline",size:"sm",onClick:()=>q.nextPage(),disabled:!q.getCanNextPage(),children:"Next"}),(0,t.jsx)("select",{value:F.pageSize,onChange:e=>q.setPageSize(Number(e.target.value)),className:"h-8 rounded-md border border-input bg-background px-3 text-sm",children:[10,20,50,100].map(e=>(0,t.jsxs)("option",{value:e,children:[e," per page"]},e))})]})]})})]})}e.s(["default",()=>C],214942)}]);